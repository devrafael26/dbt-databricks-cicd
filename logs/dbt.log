[0m11:25:00.680848 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:25:00.680848 [error] [Thread-1 (]: 2 of 20 ERROR source_data_type_sqlserver_ecommerce_Category__varchar ........... [[31mERROR[0m in 0.03s]
[0m11:25:00.680848 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m11:25:00.680848 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m11:25:00.680848 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m11:25:00.699497 [info ] [Thread-1 (]: 3 of 20 START test source_data_type_sqlserver_ecommerce_Discount__int .......... [RUN]
[0m11:25:00.704501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21)
[0m11:25:00.707498 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m11:25:00.733207 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:25:00.738221 [error] [Thread-1 (]: 3 of 20 ERROR source_data_type_sqlserver_ecommerce_Discount__int ............... [[31mERROR[0m in 0.03s]
[0m11:25:00.741208 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m11:25:00.744299 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m11:25:00.746298 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m11:25:00.749298 [info ] [Thread-1 (]: 4 of 20 START test source_data_type_sqlserver_ecommerce_Final_Price__float ..... [RUN]
[0m11:25:00.755296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0)
[0m11:25:00.757299 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m11:25:00.773989 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:25:00.773989 [error] [Thread-1 (]: 4 of 20 ERROR source_data_type_sqlserver_ecommerce_Final_Price__float .......... [[31mERROR[0m in 0.02s]
[0m11:25:00.773989 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m11:25:00.773989 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m11:25:00.773989 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m11:25:00.789616 [info ] [Thread-1 (]: 5 of 20 START test source_data_type_sqlserver_ecommerce_Payment_Method__varchar  [RUN]
[0m11:25:00.789616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261)
[0m11:25:00.789616 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m11:25:00.805241 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:25:00.805241 [error] [Thread-1 (]: 5 of 20 ERROR source_data_type_sqlserver_ecommerce_Payment_Method__varchar ..... [[31mERROR[0m in 0.02s]
[0m11:25:00.805241 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m11:25:00.805241 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m11:25:00.805241 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m11:25:00.820869 [info ] [Thread-1 (]: 6 of 20 START test source_data_type_sqlserver_ecommerce_Price__float ........... [RUN]
[0m11:25:00.820869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5)
[0m11:25:00.820869 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m11:25:00.852117 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:25:00.852117 [error] [Thread-1 (]: 6 of 20 ERROR source_data_type_sqlserver_ecommerce_Price__float ................ [[31mERROR[0m in 0.03s]
[0m11:25:00.852117 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m11:25:00.852117 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m11:25:00.852117 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m11:25:00.852117 [info ] [Thread-1 (]: 7 of 20 START test source_data_type_sqlserver_ecommerce_Product_ID__varchar .... [RUN]
[0m11:25:00.867738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db)
[0m11:25:00.867738 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m11:25:00.883366 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:25:00.883366 [error] [Thread-1 (]: 7 of 20 ERROR source_data_type_sqlserver_ecommerce_Product_ID__varchar ......... [[31mERROR[0m in 0.02s]
[0m11:25:00.883366 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m11:25:00.883366 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m11:25:00.883366 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m11:25:00.883366 [info ] [Thread-1 (]: 8 of 20 START test source_data_type_sqlserver_ecommerce_Purchase_Date__date .... [RUN]
[0m11:25:00.899002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f)
[0m11:25:00.899002 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m11:25:00.914627 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:25:00.917447 [error] [Thread-1 (]: 8 of 20 ERROR source_data_type_sqlserver_ecommerce_Purchase_Date__date ......... [[31mERROR[0m in 0.02s]
[0m11:25:00.920446 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m11:25:00.921444 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m11:25:00.922446 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m11:25:00.924443 [info ] [Thread-1 (]: 9 of 20 START test source_data_type_sqlserver_ecommerce_User_ID__varchar ....... [RUN]
[0m11:25:00.926444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14)
[0m11:25:00.928463 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m11:25:00.945146 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:25:00.945146 [error] [Thread-1 (]: 9 of 20 ERROR source_data_type_sqlserver_ecommerce_User_ID__varchar ............ [[31mERROR[0m in 0.02s]
[0m11:25:00.945146 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m11:25:00.945146 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m11:25:00.945146 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m11:25:00.945146 [info ] [Thread-1 (]: 10 of 20 START test source_not_null_sqlserver_ecommerce_Category ............... [RUN]
[0m11:25:00.960766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407)
[0m11:25:00.960766 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m11:25:00.976396 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m11:25:00.976396 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m11:25:00.992022 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m11:25:00.992022 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m11:25:00.992022 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_9582]
   as 
    
    
    



select Category
from "my_db"."dbo"."ecommerce"
where Category is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_9582]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_9582]
  ;')
[0m11:25:00.992022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:00.992022 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:25:00.992022 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:25:01.014831 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:25:01.017834 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: ROLLBACK
[0m11:25:01.019831 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: Close
[0m11:25:01.020831 [info ] [Thread-1 (]: 10 of 20 PASS source_not_null_sqlserver_ecommerce_Category ..................... [[32mPASS[0m in 0.06s]
[0m11:25:01.023831 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m11:25:01.025827 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m11:25:01.026827 [info ] [Thread-1 (]: 11 of 20 START test source_not_null_sqlserver_ecommerce_Discount ............... [RUN]
[0m11:25:01.028828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f)
[0m11:25:01.029826 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m11:25:01.039891 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m11:25:01.039891 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m11:25:01.039891 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m11:25:01.039891 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m11:25:01.055597 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_9004]
   as 
    
    
    



select Discount
from "my_db"."dbo"."ecommerce"
where Discount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_9004]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_9004]
  ;')
[0m11:25:01.055597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:01.055597 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:25:01.055597 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:25:01.071149 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:25:01.071149 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: ROLLBACK
[0m11:25:01.071149 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: Close
[0m11:25:01.071149 [info ] [Thread-1 (]: 11 of 20 PASS source_not_null_sqlserver_ecommerce_Discount ..................... [[32mPASS[0m in 0.04s]
[0m11:25:01.071149 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m11:25:01.071149 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m11:25:01.086771 [info ] [Thread-1 (]: 12 of 20 START test source_not_null_sqlserver_ecommerce_Final_Price ............ [RUN]
[0m11:25:01.086771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d)
[0m11:25:01.086771 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m11:25:01.102401 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m11:25:01.102401 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m11:25:01.102401 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m11:25:01.102401 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m11:25:01.118018 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_3905]
   as 
    
    
    



select Final_Price
from "my_db"."dbo"."ecommerce"
where Final_Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_3905]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_3905]
  ;')
[0m11:25:01.118018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:01.118018 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:25:01.118018 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:25:01.137789 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:25:01.140784 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: ROLLBACK
[0m11:25:01.141784 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: Close
[0m11:25:01.143787 [info ] [Thread-1 (]: 12 of 20 PASS source_not_null_sqlserver_ecommerce_Final_Price .................. [[32mPASS[0m in 0.06s]
[0m11:25:01.146787 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m11:25:01.147786 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m11:25:01.148786 [info ] [Thread-1 (]: 13 of 20 START test source_not_null_sqlserver_ecommerce_Payment_Method ......... [RUN]
[0m11:25:01.149847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae)
[0m11:25:01.149847 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m11:25:01.149847 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m11:25:01.149847 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m11:25:01.165478 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m11:25:01.165478 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m11:25:01.165478 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_15138]
   as 
    
    
    



select Payment_Method
from "my_db"."dbo"."ecommerce"
where Payment_Method is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_15138]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_15138]
  ;')
[0m11:25:01.165478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:01.165478 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:25:01.181105 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:25:01.181105 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:25:01.196741 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: ROLLBACK
[0m11:25:01.196741 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: Close
[0m11:25:01.196741 [info ] [Thread-1 (]: 13 of 20 PASS source_not_null_sqlserver_ecommerce_Payment_Method ............... [[32mPASS[0m in 0.05s]
[0m11:25:01.196741 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m11:25:01.196741 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m11:25:01.196741 [info ] [Thread-1 (]: 14 of 20 START test source_not_null_sqlserver_ecommerce_Price .................. [RUN]
[0m11:25:01.196741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01)
[0m11:25:01.212354 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m11:25:01.212354 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m11:25:01.212354 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m11:25:01.227982 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m11:25:01.227982 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m11:25:01.227982 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_6469]
   as 
    
    
    



select Price
from "my_db"."dbo"."ecommerce"
where Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_6469]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_6469]
  ;')
[0m11:25:01.227982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:01.227982 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:25:01.227982 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:25:01.253227 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:25:01.256223 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: ROLLBACK
[0m11:25:01.257224 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: Close
[0m11:25:01.258296 [info ] [Thread-1 (]: 14 of 20 PASS source_not_null_sqlserver_ecommerce_Price ........................ [[32mPASS[0m in 0.06s]
[0m11:25:01.258296 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m11:25:01.258296 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m11:25:01.258296 [info ] [Thread-1 (]: 15 of 20 START test source_not_null_sqlserver_ecommerce_Product_ID ............. [RUN]
[0m11:25:01.258296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff)
[0m11:25:01.258296 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m11:25:01.273923 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m11:25:01.273923 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m11:25:01.289550 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m11:25:01.289550 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m11:25:01.289550 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_4037]
   as 
    
    
    



select Product_ID
from "my_db"."dbo"."ecommerce"
where Product_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_4037]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_4037]
  ;')
[0m11:25:01.289550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:01.289550 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:25:01.289550 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:25:01.305175 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:25:01.305175 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: ROLLBACK
[0m11:25:01.305175 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: Close
[0m11:25:01.305175 [info ] [Thread-1 (]: 15 of 20 PASS source_not_null_sqlserver_ecommerce_Product_ID ................... [[32mPASS[0m in 0.05s]
[0m11:25:01.320799 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m11:25:01.320799 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m11:25:01.320799 [info ] [Thread-1 (]: 16 of 20 START test source_not_null_sqlserver_ecommerce_Purchase_Date .......... [RUN]
[0m11:25:01.320799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17)
[0m11:25:01.320799 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m11:25:01.336459 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m11:25:01.336459 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m11:25:01.336459 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m11:25:01.336459 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m11:25:01.336459 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_4981]
   as 
    
    
    



select Purchase_Date
from "my_db"."dbo"."ecommerce"
where Purchase_Date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_4981]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_4981]
  ;')
[0m11:25:01.336459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:01.355941 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:25:01.356939 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:25:01.367006 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:25:01.367006 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: ROLLBACK
[0m11:25:01.367006 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: Close
[0m11:25:01.367006 [info ] [Thread-1 (]: 16 of 20 PASS source_not_null_sqlserver_ecommerce_Purchase_Date ................ [[32mPASS[0m in 0.05s]
[0m11:25:01.367006 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m11:25:01.367006 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m11:25:01.367006 [info ] [Thread-1 (]: 17 of 20 START test source_not_null_sqlserver_ecommerce_User_ID ................ [RUN]
[0m11:25:01.382632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc)
[0m11:25:01.382632 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m11:25:01.382632 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m11:25:01.382632 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m11:25:01.398257 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m11:25:01.398257 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m11:25:01.398257 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_14315]
   as 
    
    
    



select User_ID
from "my_db"."dbo"."ecommerce"
where User_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_14315]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_14315]
  ;')
[0m11:25:01.413880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:01.413880 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:25:01.413880 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:25:01.429512 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:25:01.429512 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: ROLLBACK
[0m11:25:01.429512 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: Close
[0m11:25:01.429512 [info ] [Thread-1 (]: 17 of 20 PASS source_not_null_sqlserver_ecommerce_User_ID ...................... [[32mPASS[0m in 0.06s]
[0m11:25:01.429512 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m11:25:01.429512 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce
[0m11:25:01.445412 [info ] [Thread-1 (]: 18 of 20 SKIP relation dbo.src_ecommerce ....................................... [[33mSKIP[0m]
[0m11:25:01.447411 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce
[0m11:25:01.449409 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce_datatypes
[0m11:25:01.449409 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.src_ecommerce' to be skipped because of status 'skipped'. 
[0m11:25:01.451414 [info ] [Thread-1 (]: 19 of 20 SKIP relation dbo.src_ecommerce_datatypes ............................. [[33mSKIP[0m]
[0m11:25:01.455411 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce_datatypes
[0m11:25:01.457411 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.stg_ecommerce
[0m11:25:01.458410 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.src_ecommerce_datatypes' to be skipped because of status 'skipped'. 
[0m11:25:01.459410 [info ] [Thread-1 (]: 20 of 20 SKIP relation dbo.stg_ecommerce ....................................... [[33mSKIP[0m]
[0m11:25:01.463412 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.stg_ecommerce
[0m11:25:01.465411 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.stg_ecommerce' to be skipped because of status 'skipped'. 
[0m11:25:01.468413 [debug] [MainThread]: On master: COMMIT
[0m11:25:01.471451 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:25:01.472411 [debug] [MainThread]: Connection 'list_my_db' was properly closed.
[0m11:25:01.473410 [debug] [MainThread]: Connection 'list_my_db_dbo' was properly closed.
[0m11:25:01.474410 [debug] [MainThread]: Connection 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc' was properly closed.
[0m11:25:01.475409 [info ] [MainThread]: 
[0m11:25:01.477478 [info ] [MainThread]: Finished running 17 data tests, 3 view models in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m11:25:01.477478 [debug] [MainThread]: Command end result
[0m11:25:01.555607 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m11:25:01.574623 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m11:25:01.587710 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m11:25:01.587710 [info ] [MainThread]: 
[0m11:25:01.587710 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m11:25:01.587710 [info ] [MainThread]: 
[0m11:25:01.587710 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m11:25:01.587710 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:25:01.587710 [info ] [MainThread]: 
[0m11:25:01.587710 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m11:25:01.603344 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:25:01.603344 [info ] [MainThread]: 
[0m11:25:01.603344 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m11:25:01.603344 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:25:01.603344 [info ] [MainThread]: 
[0m11:25:01.603344 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m11:25:01.618964 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:25:01.618964 [info ] [MainThread]: 
[0m11:25:01.618964 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m11:25:01.618964 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:25:01.618964 [info ] [MainThread]: 
[0m11:25:01.618964 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m11:25:01.618964 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:25:01.634596 [info ] [MainThread]: 
[0m11:25:01.634596 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m11:25:01.634596 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:25:01.634596 [info ] [MainThread]: 
[0m11:25:01.634596 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m11:25:01.634596 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:25:01.634596 [info ] [MainThread]: 
[0m11:25:01.650215 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=8 SKIP=3 NO-OP=0 TOTAL=20
[0m11:25:01.650215 [debug] [MainThread]: Command `dbt build` failed at 11:25:01.650215 after 7.61 seconds
[0m11:25:01.650215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED55D33DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED5DFDD010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED5B7BFED0>]}
[0m11:25:01.650215 [debug] [MainThread]: Flushing usage events
[0m11:25:02.274909 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:27:22.867771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160A757A550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160A757BA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160A757B350>]}


============================== 11:27:22.883397 | ad62834b-e366-4525-b450-342051c3f580 ==============================
[0m11:27:22.883397 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:27:22.883397 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:27:23.368099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad62834b-e366-4525-b450-342051c3f580', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160A76EDD10>]}
[0m11:27:23.634604 [debug] [MainThread]: Command `dbt clean` succeeded at 11:27:23.634604 after 0.95 seconds
[0m11:27:23.634604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160A757AED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160A0A93C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160A0CF0E10>]}
[0m11:27:23.634604 [debug] [MainThread]: Flushing usage events
[0m11:27:24.617224 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:27:31.540202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7815B7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7815B4ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7815B7C10>]}


============================== 11:27:31.555833 | ef0d08d3-17ce-4bf8-b994-76098cc174f4 ==============================
[0m11:27:31.555833 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:27:31.555833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:27:31.898422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef0d08d3-17ce-4bf8-b994-76098cc174f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7813A4290>]}
[0m11:27:31.960908 [debug] [MainThread]: Set downloads directory='C:\Users\diniz\AppData\Local\Temp\dbt-downloads-oyz2osqi'
[0m11:27:31.960908 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:27:32.146772 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:27:32.147777 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:27:32.304995 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:27:32.320473 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:27:33.196573 [info ] [MainThread]: Installed from version 1.3.0
[0m11:27:33.196573 [info ] [MainThread]: Up to date!
[0m11:27:33.196573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ef0d08d3-17ce-4bf8-b994-76098cc174f4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C780572D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C78168EF50>]}
[0m11:27:33.196573 [debug] [MainThread]: Command `dbt deps` succeeded at 11:27:33.196573 after 1.79 seconds
[0m11:27:33.196573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7FAAC3C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7FADA6290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7FAD20210>]}
[0m11:27:33.196573 [debug] [MainThread]: Flushing usage events
[0m11:27:33.789357 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:27:55.411104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E8B332DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E8B333690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E8B3303D0>]}


============================== 11:27:55.411104 | 6a44b24c-4469-4506-9283-6b4c50b65dc0 ==============================
[0m11:27:55.411104 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:27:55.411104 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --target sqlserver', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:27:56.368829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a44b24c-4469-4506-9283-6b4c50b65dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E8AA9A1D0>]}
[0m11:27:56.476957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a44b24c-4469-4506-9283-6b4c50b65dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E8A37AC50>]}
[0m11:27:56.476957 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m11:27:57.273715 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m11:27:57.273715 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:27:57.273715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6a44b24c-4469-4506-9283-6b4c50b65dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E8CE5ACD0>]}
[0m11:28:01.071945 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_customers' which is disabled
[0m11:28:01.071945 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_customers' which is disabled
[0m11:28:01.071945 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_customers' which is disabled
[0m11:28:01.071945 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_customers' which is disabled
[0m11:28:01.087560 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_5_products' which is disabled
[0m11:28:01.087560 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_5_products' which is disabled
[0m11:28:01.087560 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_5_products' which is disabled
[0m11:28:01.087560 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'monthly_revenue' which is disabled
[0m11:28:01.087560 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'monthly_revenue' which is disabled
[0m11:28:01.087560 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'monthly_revenue' which is disabled
[0m11:28:01.087560 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_discount_by_category' which is disabled
[0m11:28:01.087560 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_discount_by_category' which is disabled
[0m11:28:01.087560 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_discount_by_category' which is disabled
[0m11:28:01.103184 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_ticket_by_category' which is disabled
[0m11:28:01.103184 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_ticket_by_category' which is disabled
[0m11:28:01.103184 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_ticket_by_category' which is disabled
[0m11:28:01.103184 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'payment_distribution' which is disabled
[0m11:28:01.103184 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'payment_distribution' which is disabled
[0m11:28:01.103184 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'payment_distribution' which is disabled
[0m11:28:01.103184 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'payment_distribution' which is disabled
[0m11:28:01.103184 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'sales_by_category' which is disabled
[0m11:28:01.103184 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'sales_by_category' which is disabled
[0m11:28:01.103184 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'sales_by_category' which is disabled
[0m11:28:01.118813 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'sales_by_category' which is disabled
[0m11:28:01.305831 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m11:28:01.332585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a44b24c-4469-4506-9283-6b4c50b65dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E8D2EAC50>]}
[0m11:28:01.617363 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m11:28:01.632992 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m11:28:01.809295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a44b24c-4469-4506-9283-6b4c50b65dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E8D18DA90>]}
[0m11:28:01.811293 [info ] [MainThread]: Found 3 models, 17 data tests, 1 source, 626 macros
[0m11:28:01.828401 [info ] [MainThread]: 
[0m11:28:01.830401 [info ] [MainThread]: Concurrency: 1 threads (target='sqlserver')
[0m11:28:01.833403 [info ] [MainThread]: 
[0m11:28:01.837402 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m11:28:01.853595 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db'
[0m11:28:01.914716 [debug] [ThreadPool]: dbt-sqlserver
[0m11:28:01.914716 [debug] [ThreadPool]: Using sqlserver connection "list_my_db"
[0m11:28:01.914716 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db"} */
USE [my_db];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m11:28:01.914716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:28:01.930349 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:28:02.071536 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m11:28:02.071536 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:28:02.071536 [debug] [ThreadPool]: On list_my_db: Close
[0m11:28:02.087156 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db_dbo'
[0m11:28:02.102780 [debug] [ThreadPool]: dbt-sqlserver
[0m11:28:02.118931 [debug] [ThreadPool]: Using sqlserver connection "list_my_db_dbo"
[0m11:28:02.120944 [debug] [ThreadPool]: On list_my_db_dbo: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db_dbo"} */
USE [my_db];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m11:28:02.122928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:28:02.124928 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:28:02.126928 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m11:28:02.181088 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:28:02.181088 [debug] [ThreadPool]: On list_my_db_dbo: ROLLBACK
[0m11:28:02.196711 [debug] [ThreadPool]: On list_my_db_dbo: Close
[0m11:28:02.196711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a44b24c-4469-4506-9283-6b4c50b65dc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E8D231E50>]}
[0m11:28:02.196711 [debug] [MainThread]: On master: COMMIT
[0m11:28:02.196711 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m11:28:02.196711 [info ] [Thread-1 (]: 1 of 20 START test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [RUN]
[0m11:28:02.212338 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8'
[0m11:28:02.212338 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m11:28:02.232211 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m11:28:02.240919 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m11:28:02.274251 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m11:28:02.274251 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m11:28:02.274251 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_1848]
   as 
    
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from "my_db"."dbo"."ecommerce"
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    ''Credit Card'',''Net Banking'',''UPI'',''Debit Card'',''Cash on Delivery''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_1848]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_1848]
  ;')
[0m11:28:02.274251 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:28:02.274251 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:28:02.289870 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:28:02.305516 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:02.305516 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: ROLLBACK
[0m11:28:02.322274 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: Close
[0m11:28:02.325313 [info ] [Thread-1 (]: 1 of 20 PASS source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [[32mPASS[0m in 0.13s]
[0m11:28:02.327277 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m11:28:02.328275 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m11:28:02.329275 [info ] [Thread-1 (]: 2 of 20 START test source_data_type_sqlserver_ecommerce_Category__varchar ...... [RUN]
[0m11:28:02.331678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e)
[0m11:28:02.332676 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m11:28:02.344948 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e"
[0m11:28:02.346935 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Category'
                AND data_type NOT LIKE 'varchar%'
        
  
[0m11:28:02.347898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:02.348898 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:28:02.349937 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:28:02.383255 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:02.383255 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e"
[0m11:28:02.383255 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m11:28:02.383255 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e"
[0m11:28:02.383255 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e"
[0m11:28:02.398855 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_15657]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_15657]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_15657]
  ;')
[0m11:28:02.398855 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:02.398855 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e: ROLLBACK
[0m11:28:02.398855 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e: Close
[0m11:28:02.398855 [error] [Thread-1 (]: 2 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Category__varchar .......... [[31mFAIL 1[0m in 0.07s]
[0m11:28:02.414517 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m11:28:02.414517 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m11:28:02.414517 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m11:28:02.414517 [info ] [Thread-1 (]: 3 of 20 START test source_data_type_sqlserver_ecommerce_Discount__int .......... [RUN]
[0m11:28:02.414517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21)
[0m11:28:02.414517 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m11:28:02.430146 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"
[0m11:28:02.430146 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Discount'
                AND data_type NOT LIKE 'int%'
        
  
[0m11:28:02.430146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:02.430146 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:28:02.430146 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:28:02.461366 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:02.461366 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"
[0m11:28:02.461366 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m11:28:02.461366 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"
[0m11:28:02.461366 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"
[0m11:28:02.476980 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_3266]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_3266]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_3266]
  ;')
[0m11:28:02.476980 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:02.476980 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21: ROLLBACK
[0m11:28:02.492643 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21: Close
[0m11:28:02.492643 [error] [Thread-1 (]: 3 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Discount__int .............. [[31mFAIL 1[0m in 0.08s]
[0m11:28:02.492643 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m11:28:02.492643 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m11:28:02.492643 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m11:28:02.492643 [info ] [Thread-1 (]: 4 of 20 START test source_data_type_sqlserver_ecommerce_Final_Price__float ..... [RUN]
[0m11:28:02.492643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0)
[0m11:28:02.492643 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m11:28:02.508289 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"
[0m11:28:02.508289 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Final_Price'
                AND data_type NOT LIKE 'float%'
        
  
[0m11:28:02.508289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:02.508289 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:28:02.508289 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:28:02.544672 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:02.547674 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"
[0m11:28:02.554846 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m11:28:02.559883 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"
[0m11:28:02.563415 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"
[0m11:28:02.564412 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_5329]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_5329]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_5329]
  ;')
[0m11:28:02.571577 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:02.571577 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0: ROLLBACK
[0m11:28:02.571577 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0: Close
[0m11:28:02.571577 [error] [Thread-1 (]: 4 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Final_Price__float ......... [[31mFAIL 1[0m in 0.08s]
[0m11:28:02.571577 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m11:28:02.571577 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m11:28:02.571577 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m11:28:02.571577 [info ] [Thread-1 (]: 5 of 20 START test source_data_type_sqlserver_ecommerce_Payment_Method__varchar  [RUN]
[0m11:28:02.571577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261)
[0m11:28:02.571577 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m11:28:02.587210 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261"
[0m11:28:02.587210 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Payment_Method'
                AND data_type NOT LIKE 'varchar%'
        
  
[0m11:28:02.587210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:02.602830 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:28:02.602830 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:28:02.618461 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:02.618461 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261"
[0m11:28:02.634083 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m11:28:02.634083 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261"
[0m11:28:02.634083 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261"
[0m11:28:02.634083 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_12645]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_12645]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_12645]
  ;')
[0m11:28:02.649704 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:02.649704 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261: ROLLBACK
[0m11:28:02.649704 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261: Close
[0m11:28:02.649704 [error] [Thread-1 (]: 5 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Payment_Method__varchar .... [[31mFAIL 1[0m in 0.08s]
[0m11:28:02.649704 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m11:28:02.665508 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m11:28:02.666548 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m11:28:02.667578 [info ] [Thread-1 (]: 6 of 20 START test source_data_type_sqlserver_ecommerce_Price__float ........... [RUN]
[0m11:28:02.669451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5)
[0m11:28:02.671467 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m11:28:02.679507 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"
[0m11:28:02.680630 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Price'
                AND data_type NOT LIKE 'float%'
        
  
[0m11:28:02.680630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:02.680630 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:28:02.680630 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:28:02.727514 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:02.727514 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"
[0m11:28:02.727514 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m11:28:02.727514 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"
[0m11:28:02.727514 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"
[0m11:28:02.727514 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_9473]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_9473]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_9473]
  ;')
[0m11:28:02.743133 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:02.743133 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5: ROLLBACK
[0m11:28:02.743133 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5: Close
[0m11:28:02.758761 [error] [Thread-1 (]: 6 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Price__float ............... [[31mFAIL 1[0m in 0.07s]
[0m11:28:02.758761 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m11:28:02.758761 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m11:28:02.758761 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m11:28:02.758761 [info ] [Thread-1 (]: 7 of 20 START test source_data_type_sqlserver_ecommerce_Product_ID__varchar .... [RUN]
[0m11:28:02.758761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db)
[0m11:28:02.758761 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m11:28:02.775752 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db"
[0m11:28:02.776743 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Product_ID'
                AND data_type NOT LIKE 'varchar%'
        
  
[0m11:28:02.778789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:02.779743 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:28:02.780745 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:28:02.789923 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:02.805551 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db"
[0m11:28:02.805551 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m11:28:02.805551 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db"
[0m11:28:02.805551 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db"
[0m11:28:02.805551 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_9286]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_9286]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_9286]
  ;')
[0m11:28:02.821176 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:02.821176 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db: ROLLBACK
[0m11:28:02.821176 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db: Close
[0m11:28:02.837952 [error] [Thread-1 (]: 7 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Product_ID__varchar ........ [[31mFAIL 1[0m in 0.08s]
[0m11:28:02.839952 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m11:28:02.841947 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m11:28:02.842906 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m11:28:02.843910 [info ] [Thread-1 (]: 8 of 20 START test source_data_type_sqlserver_ecommerce_Purchase_Date__date .... [RUN]
[0m11:28:02.845908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f)
[0m11:28:02.846947 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m11:28:02.852045 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"
[0m11:28:02.852045 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Purchase_Date'
                AND data_type NOT LIKE 'date%'
        
  
[0m11:28:02.852045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:02.852045 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:28:02.852045 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:28:02.883348 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:02.883348 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"
[0m11:28:02.883348 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m11:28:02.883348 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"
[0m11:28:02.898969 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"
[0m11:28:02.898969 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_10008]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_10008]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_10008]
  ;')
[0m11:28:02.898969 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:02.898969 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f: ROLLBACK
[0m11:28:02.914548 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f: Close
[0m11:28:02.914548 [error] [Thread-1 (]: 8 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Purchase_Date__date ........ [[31mFAIL 1[0m in 0.07s]
[0m11:28:02.914548 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m11:28:02.914548 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m11:28:02.914548 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m11:28:02.914548 [info ] [Thread-1 (]: 9 of 20 START test source_data_type_sqlserver_ecommerce_User_ID__varchar ....... [RUN]
[0m11:28:02.914548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14)
[0m11:28:02.914548 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m11:28:02.930219 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14"
[0m11:28:02.930219 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'User_ID'
                AND data_type NOT LIKE 'varchar%'
        
  
[0m11:28:02.930219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:02.930219 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:28:02.930219 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:28:02.961468 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:02.961468 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14"
[0m11:28:02.961468 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m11:28:02.977089 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14"
[0m11:28:02.977089 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14"
[0m11:28:02.977089 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_6490]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_6490]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_6490]
  ;')
[0m11:28:02.996934 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:02.999934 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14: ROLLBACK
[0m11:28:03.000932 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14: Close
[0m11:28:03.001935 [error] [Thread-1 (]: 9 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_User_ID__varchar ........... [[31mFAIL 1[0m in 0.09s]
[0m11:28:03.005250 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m11:28:03.006253 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m11:28:03.007254 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m11:28:03.008450 [info ] [Thread-1 (]: 10 of 20 START test source_not_null_sqlserver_ecommerce_Category ............... [RUN]
[0m11:28:03.008450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407)
[0m11:28:03.008450 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m11:28:03.024075 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m11:28:03.024075 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m11:28:03.024075 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m11:28:03.024075 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m11:28:03.024075 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_11755]
   as 
    
    
    



select Category
from "my_db"."dbo"."ecommerce"
where Category is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_11755]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_11755]
  ;')
[0m11:28:03.024075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:03.039720 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:28:03.039720 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:28:03.039720 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:03.055361 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: ROLLBACK
[0m11:28:03.055361 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: Close
[0m11:28:03.055361 [info ] [Thread-1 (]: 10 of 20 PASS source_not_null_sqlserver_ecommerce_Category ..................... [[32mPASS[0m in 0.05s]
[0m11:28:03.055361 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m11:28:03.055361 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m11:28:03.055361 [info ] [Thread-1 (]: 11 of 20 START test source_not_null_sqlserver_ecommerce_Discount ............... [RUN]
[0m11:28:03.055361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f)
[0m11:28:03.055361 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m11:28:03.070947 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m11:28:03.086569 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m11:28:03.086569 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m11:28:03.086569 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m11:28:03.086569 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_16109]
   as 
    
    
    



select Discount
from "my_db"."dbo"."ecommerce"
where Discount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_16109]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_16109]
  ;')
[0m11:28:03.102498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:03.104497 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:28:03.106500 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:28:03.117613 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:03.117613 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: ROLLBACK
[0m11:28:03.117613 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: Close
[0m11:28:03.117613 [info ] [Thread-1 (]: 11 of 20 PASS source_not_null_sqlserver_ecommerce_Discount ..................... [[32mPASS[0m in 0.06s]
[0m11:28:03.117613 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m11:28:03.133244 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m11:28:03.133244 [info ] [Thread-1 (]: 12 of 20 START test source_not_null_sqlserver_ecommerce_Final_Price ............ [RUN]
[0m11:28:03.133244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d)
[0m11:28:03.133244 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m11:28:03.133244 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m11:28:03.148867 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m11:28:03.148867 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m11:28:03.148867 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m11:28:03.148867 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_7211]
   as 
    
    
    



select Final_Price
from "my_db"."dbo"."ecommerce"
where Final_Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_7211]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_7211]
  ;')
[0m11:28:03.148867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:03.148867 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:28:03.164494 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:28:03.164494 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:03.180126 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: ROLLBACK
[0m11:28:03.180126 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: Close
[0m11:28:03.180126 [info ] [Thread-1 (]: 12 of 20 PASS source_not_null_sqlserver_ecommerce_Final_Price .................. [[32mPASS[0m in 0.05s]
[0m11:28:03.180126 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m11:28:03.180126 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m11:28:03.180126 [info ] [Thread-1 (]: 13 of 20 START test source_not_null_sqlserver_ecommerce_Payment_Method ......... [RUN]
[0m11:28:03.195751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae)
[0m11:28:03.195751 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m11:28:03.195751 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m11:28:03.195751 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m11:28:03.218515 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m11:28:03.222521 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m11:28:03.224521 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_10344]
   as 
    
    
    



select Payment_Method
from "my_db"."dbo"."ecommerce"
where Payment_Method is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_10344]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_10344]
  ;')
[0m11:28:03.226638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:03.226638 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:28:03.226638 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:28:03.226638 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:03.242267 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: ROLLBACK
[0m11:28:03.242267 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: Close
[0m11:28:03.242267 [info ] [Thread-1 (]: 13 of 20 PASS source_not_null_sqlserver_ecommerce_Payment_Method ............... [[32mPASS[0m in 0.05s]
[0m11:28:03.242267 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m11:28:03.242267 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m11:28:03.242267 [info ] [Thread-1 (]: 14 of 20 START test source_not_null_sqlserver_ecommerce_Price .................. [RUN]
[0m11:28:03.242267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01)
[0m11:28:03.242267 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m11:28:03.257901 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m11:28:03.257901 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m11:28:03.257901 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m11:28:03.257901 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m11:28:03.273547 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_12950]
   as 
    
    
    



select Price
from "my_db"."dbo"."ecommerce"
where Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_12950]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_12950]
  ;')
[0m11:28:03.273547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:03.273547 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:28:03.273547 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:28:03.273547 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:03.289183 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: ROLLBACK
[0m11:28:03.289183 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: Close
[0m11:28:03.289183 [info ] [Thread-1 (]: 14 of 20 PASS source_not_null_sqlserver_ecommerce_Price ........................ [[32mPASS[0m in 0.05s]
[0m11:28:03.289183 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m11:28:03.289183 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m11:28:03.289183 [info ] [Thread-1 (]: 15 of 20 START test source_not_null_sqlserver_ecommerce_Product_ID ............. [RUN]
[0m11:28:03.289183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff)
[0m11:28:03.289183 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m11:28:03.311924 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m11:28:03.314926 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m11:28:03.319927 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m11:28:03.323925 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m11:28:03.325922 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_1498]
   as 
    
    
    



select Product_ID
from "my_db"."dbo"."ecommerce"
where Product_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_1498]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_1498]
  ;')
[0m11:28:03.327923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:03.328923 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:28:03.329922 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:28:03.340426 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:03.343476 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: ROLLBACK
[0m11:28:03.344478 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: Close
[0m11:28:03.346483 [info ] [Thread-1 (]: 15 of 20 PASS source_not_null_sqlserver_ecommerce_Product_ID ................... [[32mPASS[0m in 0.06s]
[0m11:28:03.348446 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m11:28:03.350447 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m11:28:03.351446 [info ] [Thread-1 (]: 16 of 20 START test source_not_null_sqlserver_ecommerce_Purchase_Date .......... [RUN]
[0m11:28:03.352503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17)
[0m11:28:03.352503 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m11:28:03.352503 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m11:28:03.352503 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m11:28:03.368137 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m11:28:03.368137 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m11:28:03.368137 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_13308]
   as 
    
    
    



select Purchase_Date
from "my_db"."dbo"."ecommerce"
where Purchase_Date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_13308]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_13308]
  ;')
[0m11:28:03.368137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:03.368137 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:28:03.383764 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:28:03.383764 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:03.383764 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: ROLLBACK
[0m11:28:03.399389 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: Close
[0m11:28:03.399389 [info ] [Thread-1 (]: 16 of 20 PASS source_not_null_sqlserver_ecommerce_Purchase_Date ................ [[32mPASS[0m in 0.05s]
[0m11:28:03.399389 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m11:28:03.399389 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m11:28:03.399389 [info ] [Thread-1 (]: 17 of 20 START test source_not_null_sqlserver_ecommerce_User_ID ................ [RUN]
[0m11:28:03.399389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc)
[0m11:28:03.399389 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m11:28:03.415016 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m11:28:03.415016 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m11:28:03.415016 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m11:28:03.430916 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m11:28:03.431916 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_12347]
   as 
    
    
    



select User_ID
from "my_db"."dbo"."ecommerce"
where User_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_12347]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_12347]
  ;')
[0m11:28:03.432954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:28:03.434914 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:28:03.435915 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:28:03.446230 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:28:03.446230 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: ROLLBACK
[0m11:28:03.446230 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: Close
[0m11:28:03.446230 [info ] [Thread-1 (]: 17 of 20 PASS source_not_null_sqlserver_ecommerce_User_ID ...................... [[32mPASS[0m in 0.05s]
[0m11:28:03.446230 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m11:28:03.446230 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce
[0m11:28:03.446230 [info ] [Thread-1 (]: 18 of 20 SKIP relation dbo.src_ecommerce ....................................... [[33mSKIP[0m]
[0m11:28:03.446230 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce
[0m11:28:03.461865 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce_datatypes
[0m11:28:03.461865 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.src_ecommerce' to be skipped because of status 'skipped'. 
[0m11:28:03.461865 [info ] [Thread-1 (]: 19 of 20 SKIP relation dbo.src_ecommerce_datatypes ............................. [[33mSKIP[0m]
[0m11:28:03.461865 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce_datatypes
[0m11:28:03.461865 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.stg_ecommerce
[0m11:28:03.461865 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.src_ecommerce_datatypes' to be skipped because of status 'skipped'. 
[0m11:28:03.461865 [info ] [Thread-1 (]: 20 of 20 SKIP relation dbo.stg_ecommerce ....................................... [[33mSKIP[0m]
[0m11:28:03.461865 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.stg_ecommerce
[0m11:28:03.477489 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.stg_ecommerce' to be skipped because of status 'skipped'. 
[0m11:28:03.477489 [debug] [MainThread]: On master: COMMIT
[0m11:28:03.477489 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:28:03.477489 [debug] [MainThread]: Connection 'list_my_db' was properly closed.
[0m11:28:03.477489 [debug] [MainThread]: Connection 'list_my_db_dbo' was properly closed.
[0m11:28:03.477489 [debug] [MainThread]: Connection 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc' was properly closed.
[0m11:28:03.477489 [info ] [MainThread]: 
[0m11:28:03.477489 [info ] [MainThread]: Finished running 17 data tests, 3 view models in 0 hours 0 minutes and 1.64 seconds (1.64s).
[0m11:28:03.493167 [debug] [MainThread]: Command end result
[0m11:28:03.586647 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m11:28:03.586647 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m11:28:03.602277 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m11:28:03.602277 [info ] [MainThread]: 
[0m11:28:03.602277 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m11:28:03.617893 [info ] [MainThread]: 
[0m11:28:03.617893 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m11:28:03.617893 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m11:28:03.617893 [info ] [MainThread]: 
[0m11:28:03.617893 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Category__varchar.sql
[0m11:28:03.617893 [info ] [MainThread]: 
[0m11:28:03.617893 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m11:28:03.617893 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m11:28:03.617893 [info ] [MainThread]: 
[0m11:28:03.617893 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Discount__int.sql
[0m11:28:03.633519 [info ] [MainThread]: 
[0m11:28:03.633519 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m11:28:03.633519 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m11:28:03.633519 [info ] [MainThread]: 
[0m11:28:03.633519 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Final_Price__float.sql
[0m11:28:03.633519 [info ] [MainThread]: 
[0m11:28:03.633519 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m11:28:03.633519 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m11:28:03.633519 [info ] [MainThread]: 
[0m11:28:03.651343 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Payment_Method__varchar.sql
[0m11:28:03.653343 [info ] [MainThread]: 
[0m11:28:03.655359 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m11:28:03.658407 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m11:28:03.659346 [info ] [MainThread]: 
[0m11:28:03.661344 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Price__float.sql
[0m11:28:03.662345 [info ] [MainThread]: 
[0m11:28:03.664344 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m11:28:03.665428 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m11:28:03.665428 [info ] [MainThread]: 
[0m11:28:03.665428 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Product_ID__varchar.sql
[0m11:28:03.665428 [info ] [MainThread]: 
[0m11:28:03.665428 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m11:28:03.665428 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m11:28:03.665428 [info ] [MainThread]: 
[0m11:28:03.665428 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Purchase_Date__date.sql
[0m11:28:03.681057 [info ] [MainThread]: 
[0m11:28:03.681057 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m11:28:03.681057 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m11:28:03.681057 [info ] [MainThread]: 
[0m11:28:03.681057 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_User_ID__varchar.sql
[0m11:28:03.696684 [info ] [MainThread]: 
[0m11:28:03.696684 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=8 SKIP=3 NO-OP=0 TOTAL=20
[0m11:28:03.696684 [debug] [MainThread]: Command `dbt build` failed at 11:28:03.696684 after 8.43 seconds
[0m11:28:03.712309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E848B3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E84B111D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E84B110D0>]}
[0m11:28:03.712309 [debug] [MainThread]: Flushing usage events
[0m11:28:04.289898 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:35:02.568980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002817FA57650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002817FA54ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002817FA57990>]}


============================== 11:35:02.584605 | 77408664-d4a8-4285-a3de-e9d254ab0726 ==============================
[0m11:35:02.584605 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:35:02.584605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:35:02.921368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77408664-d4a8-4285-a3de-e9d254ab0726', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002817FB841D0>]}
[0m11:35:03.103477 [debug] [MainThread]: Command `dbt clean` succeeded at 11:35:03.103477 after 0.73 seconds
[0m11:35:03.103477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281790C3C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281792A6290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028179220250>]}
[0m11:35:03.103477 [debug] [MainThread]: Flushing usage events
[0m11:35:03.712003 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:35:26.273484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C7C242D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C7C24750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C7C26CD0>]}


============================== 11:35:26.289112 | 8e29598c-70ac-45f9-8732-e4beeb4e43e9 ==============================
[0m11:35:26.289112 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:35:26.289112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:35:26.601862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e29598c-70ac-45f9-8732-e4beeb4e43e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C7D9BD50>]}
[0m11:35:26.664396 [debug] [MainThread]: Set downloads directory='C:\Users\diniz\AppData\Local\Temp\dbt-downloads-0i6p3_38'
[0m11:35:26.664396 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:35:26.851991 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:35:26.851991 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:35:27.024639 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:35:27.024639 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:35:27.726977 [info ] [MainThread]: Installed from version 1.3.0
[0m11:35:27.726977 [info ] [MainThread]: Up to date!
[0m11:35:27.742601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8e29598c-70ac-45f9-8732-e4beeb4e43e9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C7D13B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C6713B50>]}
[0m11:35:27.742601 [debug] [MainThread]: Command `dbt deps` succeeded at 11:35:27.742601 after 1.59 seconds
[0m11:35:27.742601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C1133C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C1416310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2C1390210>]}
[0m11:35:27.742601 [debug] [MainThread]: Flushing usage events
[0m11:35:28.336075 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:35:37.039353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE34064950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE34067090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE34067910>]}


============================== 11:35:37.054982 | 2af72aa9-5588-4bc4-a5f7-3d7455b22a1d ==============================
[0m11:35:37.054982 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:35:37.054982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --target sqlserver', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:35:37.977680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2af72aa9-5588-4bc4-a5f7-3d7455b22a1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE35943A10>]}
[0m11:35:38.086635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2af72aa9-5588-4bc4-a5f7-3d7455b22a1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE32FC5FD0>]}
[0m11:35:38.086635 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m11:35:38.852839 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m11:35:38.852839 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:35:38.852839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2af72aa9-5588-4bc4-a5f7-3d7455b22a1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE359696D0>]}
[0m11:35:39.282309 [error] [MainThread]: Encountered an error:
Compilation Error
  expected token ',', got '='
    line 4
      --         database=model.database,
[0m11:35:39.285312 [debug] [MainThread]: Command `dbt build` failed at 11:35:39.285312 after 2.37 seconds
[0m11:35:39.287309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE34067550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE35B90090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE340C1650>]}
[0m11:35:39.288322 [debug] [MainThread]: Flushing usage events
[0m11:35:39.899102 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:37:39.633809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CD517110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CD56F390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CD5166D0>]}


============================== 11:37:39.633809 | 4a947a78-6952-4193-b81b-b543622e92be ==============================
[0m11:37:39.633809 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:37:39.649451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m11:37:39.978348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a947a78-6952-4193-b81b-b543622e92be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CD6950D0>]}
[0m11:37:40.132661 [debug] [MainThread]: Command `dbt clean` succeeded at 11:37:40.132661 after 0.63 seconds
[0m11:37:40.132661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C6AD3C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228C6DB6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000228CD617B90>]}
[0m11:37:40.132661 [debug] [MainThread]: Flushing usage events
[0m11:37:40.759384 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:37:52.601668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141407CA6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001414059FF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141407C8690>]}


============================== 11:37:52.601668 | e283f54d-03ed-44d6-8dfe-5af21f2bc7b0 ==============================
[0m11:37:52.601668 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:37:52.601668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:37:52.930122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e283f54d-03ed-44d6-8dfe-5af21f2bc7b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014140945E10>]}
[0m11:37:53.012406 [debug] [MainThread]: Set downloads directory='C:\Users\diniz\AppData\Local\Temp\dbt-downloads-_frfq7mb'
[0m11:37:53.014403 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:37:53.211452 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:37:53.227002 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:37:53.431589 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:37:53.439590 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:37:54.083801 [info ] [MainThread]: Installed from version 1.3.0
[0m11:37:54.085801 [info ] [MainThread]: Up to date!
[0m11:37:54.086799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e283f54d-03ed-44d6-8dfe-5af21f2bc7b0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001413F76EBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141407C93D0>]}
[0m11:37:54.093803 [debug] [MainThread]: Command `dbt deps` succeeded at 11:37:54.093803 after 1.62 seconds
[0m11:37:54.094802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014139D43C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001414089DE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001413A026290>]}
[0m11:37:54.096804 [debug] [MainThread]: Flushing usage events
[0m11:37:54.695362 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:05.487493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1885A9C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1885A9E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1885D8310>]}


============================== 11:38:05.492642 | d46421ab-232d-4393-ae28-eb569e465eba ==============================
[0m11:38:05.492642 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:38:05.492642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --target sqlserver', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:38:06.382750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd46421ab-232d-4393-ae28-eb569e465eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B189D1D650>]}
[0m11:38:06.492088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd46421ab-232d-4393-ae28-eb569e465eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B187501F90>]}
[0m11:38:06.492088 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m11:38:07.320204 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m11:38:07.335822 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:38:07.335822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd46421ab-232d-4393-ae28-eb569e465eba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B189EFE110>]}
[0m11:38:07.760634 [error] [MainThread]: Encountered an error:
Compilation Error
  expected token ',', got '='
    line 4
      --         database=model.database,
[0m11:38:07.763634 [debug] [MainThread]: Command `dbt build` failed at 11:38:07.763634 after 2.44 seconds
[0m11:38:07.765634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B181B53DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B18A0D0090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B18A0BCA50>]}
[0m11:38:07.766632 [debug] [MainThread]: Flushing usage events
[0m11:38:08.367678 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:41:50.377784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028898A19D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028898A0E5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028898A0FAD0>]}


============================== 11:41:50.383822 | c3b43d3a-e69c-4583-9470-12ca00cbdbe4 ==============================
[0m11:41:50.383822 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:41:50.383822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --target sqlserver', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:41:51.289319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3b43d3a-e69c-4583-9470-12ca00cbdbe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002889812FED0>]}
[0m11:41:51.414385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3b43d3a-e69c-4583-9470-12ca00cbdbe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028897971F10>]}
[0m11:41:51.414385 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m11:41:52.164931 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m11:41:52.180555 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:41:52.180555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c3b43d3a-e69c-4583-9470-12ca00cbdbe4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002889A3A7910>]}
[0m11:41:52.492566 [error] [MainThread]: Encountered an error:
Compilation Error
  expected token ',', got '='
    line 4
      --         database=model.database,
[0m11:41:52.492566 [debug] [MainThread]: Command `dbt build` failed at 11:41:52.492566 after 2.26 seconds
[0m11:41:52.508190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028891FC3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028898A0C510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002889A52FB90>]}
[0m11:41:52.508190 [debug] [MainThread]: Flushing usage events
[0m11:41:53.125805 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:42:52.351757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A836317DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8361045D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A836104910>]}


============================== 11:42:52.351757 | 2f08c717-54a8-44e5-8abe-4e30cd4969e2 ==============================
[0m11:42:52.351757 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:42:52.351757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:42:52.664416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f08c717-54a8-44e5-8abe-4e30cd4969e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A836438ED0>]}
[0m11:42:52.852116 [debug] [MainThread]: Command `dbt clean` succeeded at 11:42:52.852116 after 0.64 seconds
[0m11:42:52.852116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A82F863C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A836420090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A82FB46290>]}
[0m11:42:52.852116 [debug] [MainThread]: Flushing usage events
[0m11:42:53.797517 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:52:21.951167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171C22774D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171C2277C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171C2274510>]}


============================== 11:52:21.959161 | 81e2796a-4cbb-437d-81c4-9d2e4733340f ==============================
[0m11:52:21.959161 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:52:21.961438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m11:52:22.289339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81e2796a-4cbb-437d-81c4-9d2e4733340f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171C23F1150>]}
[0m11:52:22.351795 [debug] [MainThread]: Set downloads directory='C:\Users\diniz\AppData\Local\Temp\dbt-downloads-0zwdkl0e'
[0m11:52:22.367593 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:52:22.724169 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:52:22.726170 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:52:22.809095 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:52:22.817091 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:52:23.473998 [info ] [MainThread]: Installed from version 1.3.0
[0m11:52:23.475004 [info ] [MainThread]: Up to date!
[0m11:52:23.477109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '81e2796a-4cbb-437d-81c4-9d2e4733340f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171C236FBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171BF0D4150>]}
[0m11:52:23.483132 [debug] [MainThread]: Command `dbt deps` succeeded at 11:52:23.482111 after 1.67 seconds
[0m11:52:23.484116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171BB843C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171BBB26290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171BBAA0210>]}
[0m11:52:23.486110 [debug] [MainThread]: Flushing usage events
[0m11:52:24.086292 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:52:34.079963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284EE3D2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284EE2D3A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284EE3D0510>]}


============================== 11:52:34.087131 | a4054490-062f-45aa-a7b3-2b1a2ba6ec6d ==============================
[0m11:52:34.087131 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:52:34.087131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --target sqlserver', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:52:37.449252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4054490-062f-45aa-a7b3-2b1a2ba6ec6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284EFC4FD50>]}
[0m11:52:37.663865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4054490-062f-45aa-a7b3-2b1a2ba6ec6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284ED331F10>]}
[0m11:52:37.663865 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m11:52:39.104435 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m11:52:39.108437 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:52:39.109438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a4054490-062f-45aa-a7b3-2b1a2ba6ec6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284EFEED910>]}
[0m11:52:40.384336 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two macros named "test_data_type" in the project
  "dbt_databricks_cicd".
   To fix this error, rename or remove one of the following macros:
      - macros\test_data_type.sql
      - macros\test_data_type.sql
[0m11:52:40.384336 [debug] [MainThread]: Command `dbt build` failed at 11:52:40.384336 after 6.45 seconds
[0m11:52:40.384336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284E7963DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284EE430050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284EFEF7B90>]}
[0m11:52:40.384336 [debug] [MainThread]: Flushing usage events
[0m11:52:40.992849 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:54:43.711047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CEB638D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CEB63AD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CEB3F4110>]}


============================== 11:54:43.726675 | 5fc4ba2a-49bf-4aa9-9759-01d10a917f9c ==============================
[0m11:54:43.726675 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:54:43.726675 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --target sqlserver', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:54:44.820877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fc4ba2a-49bf-4aa9-9759-01d10a917f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CECEAB290>]}
[0m11:54:44.930173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fc4ba2a-49bf-4aa9-9759-01d10a917f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CEA571ED0>]}
[0m11:54:44.930173 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m11:54:45.799547 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m11:54:45.803549 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:54:45.805550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5fc4ba2a-49bf-4aa9-9759-01d10a917f9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CED0DB9D0>]}
[0m11:54:46.117392 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two macros named "test_data_type" in the project
  "dbt_databricks_cicd".
   To fix this error, rename or remove one of the following macros:
      - macros\test_data_type.sql
      - macros\test_data_type.sql
[0m11:54:46.117392 [debug] [MainThread]: Command `dbt build` failed at 11:54:46.117392 after 2.66 seconds
[0m11:54:46.117392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CEB6643D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE4B43DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CED12FB90>]}
[0m11:54:46.133058 [debug] [MainThread]: Flushing usage events
[0m11:54:46.743458 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:55:08.383123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025645F70350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025645D64890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025645F70CD0>]}


============================== 11:55:08.383123 | b6840dcc-4797-4210-8fd6-582f30b39335 ==============================
[0m11:55:08.383123 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:55:08.398711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build --target sqlserver', 'send_anonymous_usage_stats': 'True'}
[0m11:55:09.320693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6840dcc-4797-4210-8fd6-582f30b39335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025644F6D790>]}
[0m11:55:09.445696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6840dcc-4797-4210-8fd6-582f30b39335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025644ECDFD0>]}
[0m11:55:09.445696 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m11:55:10.211765 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m11:55:10.227335 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:55:10.227335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b6840dcc-4797-4210-8fd6-582f30b39335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025647A8EDD0>]}
[0m11:55:13.070372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': 'b6840dcc-4797-4210-8fd6-582f30b39335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025647C3A510>]}
[0m11:55:13.867500 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_customers' which is disabled
[0m11:55:13.867500 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_customers' which is disabled
[0m11:55:13.867500 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_customers' which is disabled
[0m11:55:13.883124 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_customers' which is disabled
[0m11:55:13.883124 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_5_products' which is disabled
[0m11:55:13.883124 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_5_products' which is disabled
[0m11:55:13.883124 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_5_products' which is disabled
[0m11:55:13.883124 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'monthly_revenue' which is disabled
[0m11:55:13.883124 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'monthly_revenue' which is disabled
[0m11:55:13.883124 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'monthly_revenue' which is disabled
[0m11:55:13.883124 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_discount_by_category' which is disabled
[0m11:55:13.883124 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_discount_by_category' which is disabled
[0m11:55:13.883124 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_discount_by_category' which is disabled
[0m11:55:13.883124 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_ticket_by_category' which is disabled
[0m11:55:13.883124 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_ticket_by_category' which is disabled
[0m11:55:13.883124 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_ticket_by_category' which is disabled
[0m11:55:13.883124 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'payment_distribution' which is disabled
[0m11:55:13.898747 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'payment_distribution' which is disabled
[0m11:55:13.898747 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'payment_distribution' which is disabled
[0m11:55:13.898747 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'payment_distribution' which is disabled
[0m11:55:13.898747 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'sales_by_category' which is disabled
[0m11:55:13.898747 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'sales_by_category' which is disabled
[0m11:55:13.898747 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'sales_by_category' which is disabled
[0m11:55:13.898747 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'sales_by_category' which is disabled
[0m11:55:14.070565 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m11:55:14.086195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6840dcc-4797-4210-8fd6-582f30b39335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025647DF4E10>]}
[0m11:55:14.336706 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m11:55:14.352294 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m11:55:14.493276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6840dcc-4797-4210-8fd6-582f30b39335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025647FEC190>]}
[0m11:55:14.493276 [info ] [MainThread]: Found 3 models, 17 data tests, 1 source, 625 macros
[0m11:55:14.493276 [info ] [MainThread]: 
[0m11:55:14.508895 [info ] [MainThread]: Concurrency: 1 threads (target='sqlserver')
[0m11:55:14.508895 [info ] [MainThread]: 
[0m11:55:14.508895 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m11:55:14.508895 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db'
[0m11:55:14.555383 [debug] [ThreadPool]: dbt-sqlserver
[0m11:55:14.555383 [debug] [ThreadPool]: Using sqlserver connection "list_my_db"
[0m11:55:14.555383 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db"} */
USE [my_db];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m11:55:14.555383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:14.555383 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:55:14.711216 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m11:55:14.711216 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:55:14.711216 [debug] [ThreadPool]: On list_my_db: Close
[0m11:55:14.726844 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db_dbo'
[0m11:55:14.742469 [debug] [ThreadPool]: dbt-sqlserver
[0m11:55:14.742469 [debug] [ThreadPool]: Using sqlserver connection "list_my_db_dbo"
[0m11:55:14.742469 [debug] [ThreadPool]: On list_my_db_dbo: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db_dbo"} */
USE [my_db];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m11:55:14.742469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:14.758108 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:55:14.758108 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m11:55:14.804973 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:55:14.804973 [debug] [ThreadPool]: On list_my_db_dbo: ROLLBACK
[0m11:55:14.804973 [debug] [ThreadPool]: On list_my_db_dbo: Close
[0m11:55:14.820595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6840dcc-4797-4210-8fd6-582f30b39335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025648013D90>]}
[0m11:55:14.820595 [debug] [MainThread]: On master: COMMIT
[0m11:55:14.820595 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m11:55:14.820595 [info ] [Thread-1 (]: 1 of 20 START test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [RUN]
[0m11:55:14.836220 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8'
[0m11:55:14.836220 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m11:55:14.863295 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m11:55:14.871230 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m11:55:14.930153 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m11:55:14.930153 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m11:55:14.930153 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_16513]
   as 
    
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from "my_db"."dbo"."ecommerce"
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    ''Credit Card'',''Net Banking'',''UPI'',''Debit Card'',''Cash on Delivery''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_16513]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_16513]
  ;')
[0m11:55:14.930153 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:55:14.930153 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:55:14.945772 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:55:14.961404 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:55:14.961404 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: ROLLBACK
[0m11:55:14.961404 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: Close
[0m11:55:14.977154 [info ] [Thread-1 (]: 1 of 20 PASS source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [[32mPASS[0m in 0.14s]
[0m11:55:14.980196 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m11:55:14.981197 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m11:55:14.982199 [info ] [Thread-1 (]: 2 of 20 START test source_data_type_sqlserver_ecommerce_Category__varchar ...... [RUN]
[0m11:55:14.984155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e)
[0m11:55:14.985200 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m11:55:15.110052 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:55:15.113055 [error] [Thread-1 (]: 2 of 20 ERROR source_data_type_sqlserver_ecommerce_Category__varchar ........... [[31mERROR[0m in 0.13s]
[0m11:55:15.116054 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m11:55:15.118220 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m11:55:15.119222 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m11:55:15.120222 [info ] [Thread-1 (]: 3 of 20 START test source_data_type_sqlserver_ecommerce_Discount__int .......... [RUN]
[0m11:55:15.123223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21)
[0m11:55:15.125218 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m11:55:15.134254 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:55:15.134254 [error] [Thread-1 (]: 3 of 20 ERROR source_data_type_sqlserver_ecommerce_Discount__int ............... [[31mERROR[0m in 0.01s]
[0m11:55:15.134254 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m11:55:15.134254 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m11:55:15.134254 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m11:55:15.134254 [info ] [Thread-1 (]: 4 of 20 START test source_data_type_sqlserver_ecommerce_Final_Price__float ..... [RUN]
[0m11:55:15.134254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0)
[0m11:55:15.134254 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m11:55:15.149883 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:55:15.149883 [error] [Thread-1 (]: 4 of 20 ERROR source_data_type_sqlserver_ecommerce_Final_Price__float .......... [[31mERROR[0m in 0.02s]
[0m11:55:15.149883 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m11:55:15.165554 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m11:55:15.165554 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m11:55:15.165554 [info ] [Thread-1 (]: 5 of 20 START test source_data_type_sqlserver_ecommerce_Payment_Method__varchar  [RUN]
[0m11:55:15.165554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261)
[0m11:55:15.165554 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m11:55:15.181151 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:55:15.181151 [error] [Thread-1 (]: 5 of 20 ERROR source_data_type_sqlserver_ecommerce_Payment_Method__varchar ..... [[31mERROR[0m in 0.02s]
[0m11:55:15.181151 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m11:55:15.181151 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m11:55:15.181151 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m11:55:15.181151 [info ] [Thread-1 (]: 6 of 20 START test source_data_type_sqlserver_ecommerce_Price__float ........... [RUN]
[0m11:55:15.200106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5)
[0m11:55:15.201103 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m11:55:15.212545 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:55:15.212545 [error] [Thread-1 (]: 6 of 20 ERROR source_data_type_sqlserver_ecommerce_Price__float ................ [[31mERROR[0m in 0.01s]
[0m11:55:15.212545 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m11:55:15.212545 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m11:55:15.212545 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m11:55:15.212545 [info ] [Thread-1 (]: 7 of 20 START test source_data_type_sqlserver_ecommerce_Product_ID__varchar .... [RUN]
[0m11:55:15.212545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db)
[0m11:55:15.212545 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m11:55:15.228182 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:55:15.228182 [error] [Thread-1 (]: 7 of 20 ERROR source_data_type_sqlserver_ecommerce_Product_ID__varchar ......... [[31mERROR[0m in 0.02s]
[0m11:55:15.228182 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m11:55:15.228182 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m11:55:15.228182 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m11:55:15.243792 [info ] [Thread-1 (]: 8 of 20 START test source_data_type_sqlserver_ecommerce_Purchase_Date__date .... [RUN]
[0m11:55:15.243792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f)
[0m11:55:15.243792 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m11:55:15.259422 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:55:15.259422 [error] [Thread-1 (]: 8 of 20 ERROR source_data_type_sqlserver_ecommerce_Purchase_Date__date ......... [[31mERROR[0m in 0.02s]
[0m11:55:15.259422 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m11:55:15.259422 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m11:55:15.259422 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m11:55:15.259422 [info ] [Thread-1 (]: 9 of 20 START test source_data_type_sqlserver_ecommerce_User_ID__varchar ....... [RUN]
[0m11:55:15.259422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14)
[0m11:55:15.259422 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m11:55:15.275042 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:55:15.275042 [error] [Thread-1 (]: 9 of 20 ERROR source_data_type_sqlserver_ecommerce_User_ID__varchar ............ [[31mERROR[0m in 0.02s]
[0m11:55:15.290668 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m11:55:15.290668 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m11:55:15.290668 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m11:55:15.290668 [info ] [Thread-1 (]: 10 of 20 START test source_not_null_sqlserver_ecommerce_Category ............... [RUN]
[0m11:55:15.290668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407)
[0m11:55:15.290668 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m11:55:15.318862 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m11:55:15.320863 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m11:55:15.321985 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m11:55:15.321985 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m11:55:15.321985 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_11094]
   as 
    
    
    



select Category
from "my_db"."dbo"."ecommerce"
where Category is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_11094]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_11094]
  ;')
[0m11:55:15.321985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:15.321985 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:55:15.321985 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:55:15.337622 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:55:15.337622 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: ROLLBACK
[0m11:55:15.353240 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: Close
[0m11:55:15.353240 [info ] [Thread-1 (]: 10 of 20 PASS source_not_null_sqlserver_ecommerce_Category ..................... [[32mPASS[0m in 0.06s]
[0m11:55:15.353240 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m11:55:15.353240 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m11:55:15.353240 [info ] [Thread-1 (]: 11 of 20 START test source_not_null_sqlserver_ecommerce_Discount ............... [RUN]
[0m11:55:15.353240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f)
[0m11:55:15.353240 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m11:55:15.368904 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m11:55:15.368904 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m11:55:15.384534 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m11:55:15.384534 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m11:55:15.384534 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_14056]
   as 
    
    
    



select Discount
from "my_db"."dbo"."ecommerce"
where Discount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_14056]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_14056]
  ;')
[0m11:55:15.384534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:15.384534 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:55:15.384534 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:55:15.400153 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:55:15.400153 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: ROLLBACK
[0m11:55:15.400153 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: Close
[0m11:55:15.400153 [info ] [Thread-1 (]: 11 of 20 PASS source_not_null_sqlserver_ecommerce_Discount ..................... [[32mPASS[0m in 0.05s]
[0m11:55:15.400153 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m11:55:15.400153 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m11:55:15.400153 [info ] [Thread-1 (]: 12 of 20 START test source_not_null_sqlserver_ecommerce_Final_Price ............ [RUN]
[0m11:55:15.417287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d)
[0m11:55:15.418286 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m11:55:15.429291 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m11:55:15.430412 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m11:55:15.430412 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m11:55:15.430412 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m11:55:15.430412 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_12216]
   as 
    
    
    



select Final_Price
from "my_db"."dbo"."ecommerce"
where Final_Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_12216]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_12216]
  ;')
[0m11:55:15.430412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:15.430412 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:55:15.446040 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:55:15.446040 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:55:15.446040 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: ROLLBACK
[0m11:55:15.446040 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: Close
[0m11:55:15.461665 [info ] [Thread-1 (]: 12 of 20 PASS source_not_null_sqlserver_ecommerce_Final_Price .................. [[32mPASS[0m in 0.05s]
[0m11:55:15.461665 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m11:55:15.461665 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m11:55:15.461665 [info ] [Thread-1 (]: 13 of 20 START test source_not_null_sqlserver_ecommerce_Payment_Method ......... [RUN]
[0m11:55:15.461665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae)
[0m11:55:15.461665 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m11:55:15.477309 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m11:55:15.477309 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m11:55:15.477309 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m11:55:15.477309 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m11:55:15.492919 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_15903]
   as 
    
    
    



select Payment_Method
from "my_db"."dbo"."ecommerce"
where Payment_Method is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_15903]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_15903]
  ;')
[0m11:55:15.492919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:15.492919 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:55:15.492919 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:55:15.508575 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:55:15.508575 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: ROLLBACK
[0m11:55:15.508575 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: Close
[0m11:55:15.508575 [info ] [Thread-1 (]: 13 of 20 PASS source_not_null_sqlserver_ecommerce_Payment_Method ............... [[32mPASS[0m in 0.05s]
[0m11:55:15.508575 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m11:55:15.508575 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m11:55:15.508575 [info ] [Thread-1 (]: 14 of 20 START test source_not_null_sqlserver_ecommerce_Price .................. [RUN]
[0m11:55:15.508575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01)
[0m11:55:15.524401 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m11:55:15.533438 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m11:55:15.536404 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m11:55:15.539546 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m11:55:15.539546 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m11:55:15.539546 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_14052]
   as 
    
    
    



select Price
from "my_db"."dbo"."ecommerce"
where Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_14052]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_14052]
  ;')
[0m11:55:15.539546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:15.539546 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:55:15.539546 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:55:15.555217 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:55:15.555217 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: ROLLBACK
[0m11:55:15.555217 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: Close
[0m11:55:15.555217 [info ] [Thread-1 (]: 14 of 20 PASS source_not_null_sqlserver_ecommerce_Price ........................ [[32mPASS[0m in 0.05s]
[0m11:55:15.570800 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m11:55:15.570800 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m11:55:15.570800 [info ] [Thread-1 (]: 15 of 20 START test source_not_null_sqlserver_ecommerce_Product_ID ............. [RUN]
[0m11:55:15.570800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff)
[0m11:55:15.570800 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m11:55:15.570800 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m11:55:15.586433 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m11:55:15.586433 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m11:55:15.586433 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m11:55:15.586433 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_1638]
   as 
    
    
    



select Product_ID
from "my_db"."dbo"."ecommerce"
where Product_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_1638]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_1638]
  ;')
[0m11:55:15.586433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:15.586433 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:55:15.602059 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:55:15.602059 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:55:15.602059 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: ROLLBACK
[0m11:55:15.617912 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: Close
[0m11:55:15.619914 [info ] [Thread-1 (]: 15 of 20 PASS source_not_null_sqlserver_ecommerce_Product_ID ................... [[32mPASS[0m in 0.05s]
[0m11:55:15.622912 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m11:55:15.623911 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m11:55:15.624909 [info ] [Thread-1 (]: 16 of 20 START test source_not_null_sqlserver_ecommerce_Purchase_Date .......... [RUN]
[0m11:55:15.627004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17)
[0m11:55:15.628042 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m11:55:15.640263 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m11:55:15.642227 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m11:55:15.648318 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m11:55:15.648318 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m11:55:15.648318 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_14777]
   as 
    
    
    



select Purchase_Date
from "my_db"."dbo"."ecommerce"
where Purchase_Date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_14777]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_14777]
  ;')
[0m11:55:15.648318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:15.648318 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:55:15.648318 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:55:15.663949 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:55:15.663949 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: ROLLBACK
[0m11:55:15.679612 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: Close
[0m11:55:15.679612 [info ] [Thread-1 (]: 16 of 20 PASS source_not_null_sqlserver_ecommerce_Purchase_Date ................ [[32mPASS[0m in 0.05s]
[0m11:55:15.679612 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m11:55:15.679612 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m11:55:15.679612 [info ] [Thread-1 (]: 17 of 20 START test source_not_null_sqlserver_ecommerce_User_ID ................ [RUN]
[0m11:55:15.695199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc)
[0m11:55:15.695199 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m11:55:15.710821 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m11:55:15.710821 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m11:55:15.726492 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m11:55:15.726492 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m11:55:15.726492 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_4325]
   as 
    
    
    



select User_ID
from "my_db"."dbo"."ecommerce"
where User_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_4325]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_4325]
  ;')
[0m11:55:15.726492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:15.726492 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m11:55:15.726492 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m11:55:15.742171 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:55:15.742171 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: ROLLBACK
[0m11:55:15.742171 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: Close
[0m11:55:15.742171 [info ] [Thread-1 (]: 17 of 20 PASS source_not_null_sqlserver_ecommerce_User_ID ...................... [[32mPASS[0m in 0.05s]
[0m11:55:15.757710 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m11:55:15.757710 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce
[0m11:55:15.757710 [info ] [Thread-1 (]: 18 of 20 SKIP relation dbo.src_ecommerce ....................................... [[33mSKIP[0m]
[0m11:55:15.757710 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce
[0m11:55:15.757710 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce_datatypes
[0m11:55:15.757710 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.src_ecommerce' to be skipped because of status 'skipped'. 
[0m11:55:15.757710 [info ] [Thread-1 (]: 19 of 20 SKIP relation dbo.src_ecommerce_datatypes ............................. [[33mSKIP[0m]
[0m11:55:15.757710 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce_datatypes
[0m11:55:15.757710 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.stg_ecommerce
[0m11:55:15.757710 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.src_ecommerce_datatypes' to be skipped because of status 'skipped'. 
[0m11:55:15.757710 [info ] [Thread-1 (]: 20 of 20 SKIP relation dbo.stg_ecommerce ....................................... [[33mSKIP[0m]
[0m11:55:15.773323 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.stg_ecommerce
[0m11:55:15.773323 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.stg_ecommerce' to be skipped because of status 'skipped'. 
[0m11:55:15.773323 [debug] [MainThread]: On master: COMMIT
[0m11:55:15.773323 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:15.773323 [debug] [MainThread]: Connection 'list_my_db' was properly closed.
[0m11:55:15.773323 [debug] [MainThread]: Connection 'list_my_db_dbo' was properly closed.
[0m11:55:15.773323 [debug] [MainThread]: Connection 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc' was properly closed.
[0m11:55:15.773323 [info ] [MainThread]: 
[0m11:55:15.773323 [info ] [MainThread]: Finished running 17 data tests, 3 view models in 0 hours 0 minutes and 1.26 seconds (1.26s).
[0m11:55:15.788953 [debug] [MainThread]: Command end result
[0m11:55:15.867188 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m11:55:15.867188 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m11:55:15.882832 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m11:55:15.882832 [info ] [MainThread]: 
[0m11:55:15.882832 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m11:55:15.882832 [info ] [MainThread]: 
[0m11:55:15.882832 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m11:55:15.882832 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:55:15.882832 [info ] [MainThread]: 
[0m11:55:15.882832 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m11:55:15.882832 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:55:15.898448 [info ] [MainThread]: 
[0m11:55:15.898448 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m11:55:15.898448 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:55:15.898448 [info ] [MainThread]: 
[0m11:55:15.898448 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m11:55:15.898448 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:55:15.898448 [info ] [MainThread]: 
[0m11:55:15.898448 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m11:55:15.914066 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:55:15.914066 [info ] [MainThread]: 
[0m11:55:15.914066 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m11:55:15.914066 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:55:15.914066 [info ] [MainThread]: 
[0m11:55:15.914066 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m11:55:15.914066 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:55:15.914066 [info ] [MainThread]: 
[0m11:55:15.914066 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m11:55:15.929740 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:55:15.929740 [info ] [MainThread]: 
[0m11:55:15.929740 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=8 SKIP=3 NO-OP=0 TOTAL=20
[0m11:55:15.929740 [debug] [MainThread]: Command `dbt build` failed at 11:55:15.929740 after 7.68 seconds
[0m11:55:15.929740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002563F533DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025644B7DCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002563F790550>]}
[0m11:55:15.929740 [debug] [MainThread]: Flushing usage events
[0m11:55:16.539539 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:56:29.804969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A90114290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A9016A690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A9016BFD0>]}


============================== 11:56:29.804969 | 57a469c2-6d16-4d0c-a1b3-ecd91838e424 ==============================
[0m11:56:29.804969 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:56:29.804969 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --target sqlserver', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:56:30.745690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57a469c2-6d16-4d0c-a1b3-ecd91838e424', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A909D6090>]}
[0m11:56:30.851941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57a469c2-6d16-4d0c-a1b3-ecd91838e424', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A8F07DD90>]}
[0m11:56:30.851941 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m11:56:31.602208 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m11:56:32.191139 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:56:32.193141 [debug] [MainThread]: Partial parsing: added file: dbt_databricks_cicd://macros\test_data_type.sql
[0m11:56:32.195252 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two macros named "test_data_type" in the project
  "dbt_databricks_cicd".
   To fix this error, rename or remove one of the following macros:
      - macros\test_data_type.sql
      - macros\test_data_type.sql
[0m11:56:32.195252 [debug] [MainThread]: Command `dbt build` failed at 11:56:32.195252 after 2.55 seconds
[0m11:56:32.195252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A89763DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A901142D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A901173D0>]}
[0m11:56:32.195252 [debug] [MainThread]: Flushing usage events
[0m11:56:32.789921 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:57:43.635319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227160C88D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022715D85310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227160EB250>]}


============================== 11:57:43.642853 | a1a062a0-02d3-4277-86a4-577cd3f22f06 ==============================
[0m11:57:43.642853 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:57:43.644821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build --target sqlserver', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:57:44.586775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1a062a0-02d3-4277-86a4-577cd3f22f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227179240D0>]}
[0m11:57:44.727004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1a062a0-02d3-4277-86a4-577cd3f22f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022714FF1F10>]}
[0m11:57:44.727004 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m11:57:45.476635 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m11:57:45.992128 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:57:45.992128 [debug] [MainThread]: Partial parsing: added file: dbt_databricks_cicd://macros\data_type.sql
[0m11:57:46.007699 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected '}'
    line 8
      -- } %}
[0m11:57:46.007699 [debug] [MainThread]: Command `dbt build` failed at 11:57:46.007699 after 2.51 seconds
[0m11:57:46.007699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002270F623DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022715188850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227160836D0>]}
[0m11:57:46.007699 [debug] [MainThread]: Flushing usage events
[0m11:57:46.602244 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:58:50.351821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026979AF8CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269798B4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026979B1AE10>]}


============================== 11:58:50.351821 | 384b7754-51d9-411d-9d85-abab8864ea08 ==============================
[0m11:58:50.351821 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:58:50.367446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build --target sqlserver', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:58:51.273756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '384b7754-51d9-411d-9d85-abab8864ea08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002697B33FFD0>]}
[0m11:58:51.383092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '384b7754-51d9-411d-9d85-abab8864ea08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026978A31D90>]}
[0m11:58:51.383092 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m11:58:52.180482 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m11:58:52.695644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:58:52.695644 [debug] [MainThread]: Partial parsing: added file: dbt_databricks_cicd://macros\data_type.sql
[0m11:58:52.711266 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected '}'
    line 8
      -- } %}
[0m11:58:52.726894 [debug] [MainThread]: Command `dbt build` failed at 11:58:52.726894 after 2.50 seconds
[0m11:58:52.726894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026972FE3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026979AC3150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026979AC2690>]}
[0m11:58:52.726894 [debug] [MainThread]: Flushing usage events
[0m11:58:53.614991 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:59:43.533106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BDDE76810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BDDE74A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BDDE75F10>]}


============================== 11:59:43.540153 | 431acccd-57a2-475f-9878-5069a0f24b6f ==============================
[0m11:59:43.540153 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:59:43.540153 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --target sqlserver', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:59:44.445667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '431acccd-57a2-475f-9878-5069a0f24b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BDCE22DD0>]}
[0m11:59:44.572015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '431acccd-57a2-475f-9878-5069a0f24b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BDCDD1F50>]}
[0m11:59:44.573019 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m11:59:45.351627 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m11:59:45.898405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:59:45.898405 [debug] [MainThread]: Partial parsing: added file: dbt_databricks_cicd://macros\data_type.sql
[0m11:59:45.914008 [error] [MainThread]: Encountered an error:
Compilation Error
  unexpected '}'
    line 8
      -- } %}
[0m11:59:45.914008 [debug] [MainThread]: Command `dbt build` failed at 11:59:45.914008 after 2.53 seconds
[0m11:59:45.914008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BDDECAC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BD73C3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BDDB64950>]}
[0m11:59:45.914008 [debug] [MainThread]: Flushing usage events
[0m11:59:46.524661 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:01:41.634055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B070761D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B070CAC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B07077AD0>]}


============================== 12:01:41.634055 | 2dfcd4f1-6e2b-41c8-8168-a7acbd4cdb99 ==============================
[0m12:01:41.634055 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:01:41.634055 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m12:01:41.992169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2dfcd4f1-6e2b-41c8-8168-a7acbd4cdb99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B07180C50>]}
[0m12:01:42.180440 [debug] [MainThread]: Command `dbt clean` succeeded at 12:01:42.180440 after 0.68 seconds
[0m12:01:42.180440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B005C3C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B008A6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B00821290>]}
[0m12:01:42.180440 [debug] [MainThread]: Flushing usage events
[0m12:01:42.798446 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:02:18.993253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200F0214F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200F0216F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200F0217890>]}


============================== 12:02:19.008882 | a0ab2d27-2a1b-4424-a56b-5a620733a6c1 ==============================
[0m12:02:19.008882 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:02:19.008882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:02:19.305080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0ab2d27-2a1b-4424-a56b-5a620733a6c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200F0267190>]}
[0m12:02:19.383160 [debug] [MainThread]: Set downloads directory='C:\Users\diniz\AppData\Local\Temp\dbt-downloads-hid1c97t'
[0m12:02:19.383160 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:02:19.477735 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:02:19.477735 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:02:19.571334 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:02:19.586815 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:02:20.243390 [info ] [MainThread]: Installed from version 1.3.0
[0m12:02:20.243390 [info ] [MainThread]: Up to date!
[0m12:02:20.243390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a0ab2d27-2a1b-4424-a56b-5a620733a6c1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200F02D9B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200F02EFC10>]}
[0m12:02:20.259008 [debug] [MainThread]: Command `dbt deps` succeeded at 12:02:20.243390 after 1.39 seconds
[0m12:02:20.259008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200E9723C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200E9980210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200E9980290>]}
[0m12:02:20.259008 [debug] [MainThread]: Flushing usage events
[0m12:02:20.852837 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:02:34.570392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF94A72210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF94A73650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF94A73B90>]}


============================== 12:02:34.586061 | 699a6809-fb42-442c-aa4f-d704718a0caa ==============================
[0m12:02:34.586061 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:02:34.586061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --target sqlserver', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:02:35.523596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '699a6809-fb42-442c-aa4f-d704718a0caa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF9622C8D0>]}
[0m12:02:35.617350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '699a6809-fb42-442c-aa4f-d704718a0caa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF939DDE50>]}
[0m12:02:35.632966 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m12:02:36.420818 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m12:02:36.420818 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:02:36.420818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '699a6809-fb42-442c-aa4f-d704718a0caa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF963F3610>]}
[0m12:02:39.353329 [error] [MainThread]: Encountered an error:
Compilation Error in test data_type (tests\data_type.sql)
  expected token ',', got '='
    line 4
      --         database=model.database,
[0m12:02:39.353329 [debug] [MainThread]: Command `dbt build` failed at 12:02:39.353329 after 4.91 seconds
[0m12:02:39.353329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF94AD0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF96794390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF8E053DD0>]}
[0m12:02:39.353329 [debug] [MainThread]: Flushing usage events
[0m12:02:39.976211 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:03:59.742275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3590E8B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D35913A690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3590EAA50>]}


============================== 12:03:59.757906 | 6783f7ea-9c7c-4f60-a794-b079a24ff212 ==============================
[0m12:03:59.757906 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:03:59.757906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --target sqlserver', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:04:00.820487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6783f7ea-9c7c-4f60-a794-b079a24ff212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D35A996990>]}
[0m12:04:00.976931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6783f7ea-9c7c-4f60-a794-b079a24ff212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D358052010>]}
[0m12:04:00.976931 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m12:04:01.852926 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m12:04:01.852926 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:04:01.852926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6783f7ea-9c7c-4f60-a794-b079a24ff212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D35ABFEE50>]}
[0m12:04:04.765395 [error] [MainThread]: Encountered an error:
Compilation Error in test data_type (tests\data_type.sql)
  expected token ',', got '='
    line 4
      --         database=model.database,
[0m12:04:04.769398 [debug] [MainThread]: Command `dbt build` failed at 12:04:04.769398 after 5.18 seconds
[0m12:04:04.770400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D352683DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D35A8ABE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D35AEB9990>]}
[0m12:04:04.771400 [debug] [MainThread]: Flushing usage events
[0m12:04:05.368042 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:56:55.571274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199DFABBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199DFABBD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199DFA5E190>]}


============================== 12:56:55.586943 | c2faf186-af7d-4a1c-86a0-1e8c043109b7 ==============================
[0m12:56:55.586943 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:56:55.586943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --target sqlserver', 'send_anonymous_usage_stats': 'True'}
[0m12:56:56.524406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2faf186-af7d-4a1c-86a0-1e8c043109b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199DF18FE50>]}
[0m12:56:56.634227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2faf186-af7d-4a1c-86a0-1e8c043109b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199DE9D1E50>]}
[0m12:56:56.634227 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m12:56:57.415558 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m12:56:57.415558 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:56:57.415558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c2faf186-af7d-4a1c-86a0-1e8c043109b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199E153F710>]}
[0m12:57:00.430232 [error] [MainThread]: Encountered an error:
Compilation Error in test data_type (tests\data_type.sql)
  unexpected '}'
    line 84
      -- } %}
[0m12:57:00.430232 [debug] [MainThread]: Command `dbt build` failed at 12:57:00.430232 after 4.99 seconds
[0m12:57:00.430232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199DFA5C5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199E1850090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199DFAC1590>]}
[0m12:57:00.430232 [debug] [MainThread]: Flushing usage events
[0m12:57:01.429974 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:59:15.196225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186092C8D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018608388910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001860906FDD0>]}


============================== 12:59:15.196225 | 43ccef9c-bb2d-418b-a5c2-9b318c9d8d28 ==============================
[0m12:59:15.196225 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:59:15.196225 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --target sqlserver', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:59:16.242178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43ccef9c-bb2d-418b-a5c2-9b318c9d8d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186092D9FD0>]}
[0m12:59:16.398814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43ccef9c-bb2d-418b-a5c2-9b318c9d8d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186081F1E90>]}
[0m12:59:16.398814 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m12:59:17.602334 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m12:59:17.602334 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:59:17.602334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '43ccef9c-bb2d-418b-a5c2-9b318c9d8d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001860ADADED0>]}
[0m12:59:22.118038 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_customers' which is disabled
[0m12:59:22.118038 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_customers' which is disabled
[0m12:59:22.118038 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_customers' which is disabled
[0m12:59:22.118038 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_customers' which is disabled
[0m12:59:22.118038 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_5_products' which is disabled
[0m12:59:22.118038 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_5_products' which is disabled
[0m12:59:22.118038 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_5_products' which is disabled
[0m12:59:22.118038 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'monthly_revenue' which is disabled
[0m12:59:22.118038 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'monthly_revenue' which is disabled
[0m12:59:22.118038 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'monthly_revenue' which is disabled
[0m12:59:22.118038 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_discount_by_category' which is disabled
[0m12:59:22.118038 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_discount_by_category' which is disabled
[0m12:59:22.118038 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_discount_by_category' which is disabled
[0m12:59:22.133662 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_ticket_by_category' which is disabled
[0m12:59:22.133662 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_ticket_by_category' which is disabled
[0m12:59:22.133662 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_ticket_by_category' which is disabled
[0m12:59:22.133662 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'payment_distribution' which is disabled
[0m12:59:22.133662 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'payment_distribution' which is disabled
[0m12:59:22.133662 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'payment_distribution' which is disabled
[0m12:59:22.133662 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'payment_distribution' which is disabled
[0m12:59:22.133662 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'sales_by_category' which is disabled
[0m12:59:22.133662 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'sales_by_category' which is disabled
[0m12:59:22.133662 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'sales_by_category' which is disabled
[0m12:59:22.133662 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'sales_by_category' which is disabled
[0m12:59:22.384310 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m12:59:22.399939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43ccef9c-bb2d-418b-a5c2-9b318c9d8d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001860B1AABD0>]}
[0m12:59:22.618186 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m12:59:22.633812 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m12:59:22.743326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43ccef9c-bb2d-418b-a5c2-9b318c9d8d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186092BF350>]}
[0m12:59:22.743326 [info ] [MainThread]: Found 3 models, 18 data tests, 1 source, 625 macros
[0m12:59:22.743326 [info ] [MainThread]: 
[0m12:59:22.743326 [info ] [MainThread]: Concurrency: 1 threads (target='sqlserver')
[0m12:59:22.743326 [info ] [MainThread]: 
[0m12:59:22.758950 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m12:59:22.758950 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db'
[0m12:59:22.790248 [debug] [ThreadPool]: dbt-sqlserver
[0m12:59:22.790248 [debug] [ThreadPool]: Using sqlserver connection "list_my_db"
[0m12:59:22.790248 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db"} */
USE [my_db];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m12:59:22.790248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:22.790248 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m12:59:22.904506 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m12:59:22.908505 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:59:22.911505 [debug] [ThreadPool]: On list_my_db: Close
[0m12:59:22.914504 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db_dbo'
[0m12:59:22.925504 [debug] [ThreadPool]: dbt-sqlserver
[0m12:59:22.926505 [debug] [ThreadPool]: Using sqlserver connection "list_my_db_dbo"
[0m12:59:22.927506 [debug] [ThreadPool]: On list_my_db_dbo: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db_dbo"} */
USE [my_db];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m12:59:22.928506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:22.929506 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m12:59:22.930608 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m12:59:22.961871 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:59:22.961871 [debug] [ThreadPool]: On list_my_db_dbo: ROLLBACK
[0m12:59:22.961871 [debug] [ThreadPool]: On list_my_db_dbo: Close
[0m12:59:22.977489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43ccef9c-bb2d-418b-a5c2-9b318c9d8d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001860AB6D550>]}
[0m12:59:22.977489 [debug] [MainThread]: On master: COMMIT
[0m12:59:22.977489 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.data_type
[0m12:59:22.977489 [info ] [Thread-1 (]: 1 of 21 START test data_type ................................................... [RUN]
[0m12:59:22.977489 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.dbt_databricks_cicd.data_type'
[0m12:59:22.977489 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.data_type
[0m12:59:23.008740 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.data_type"
[0m12:59:23.008740 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.data_type
[0m12:59:23.040598 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.data_type"
[0m12:59:23.056226 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.data_type"
[0m12:59:23.056226 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.data_type: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.data_type"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_ffa6f908df0e79aee2f411c3dae870ee_13337]
   as 
    
  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_ffa6f908df0e79aee2f411c3dae870ee_13337]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_ffa6f908df0e79aee2f411c3dae870ee_13337]
  ;')
[0m12:59:23.056226 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:59:23.056226 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m12:59:23.056226 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m12:59:23.071849 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:23.071849 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.data_type: ROLLBACK
[0m12:59:23.071849 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.data_type: Close
[0m12:59:23.071849 [error] [Thread-1 (]: [31mUnhandled error while executing target\run\dbt_databricks_cicd\tests\data_type.sql[0m
('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Sintaxe incorreta próxima a ';'. (102) (SQLMoreResults)")
[0m12:59:23.164207 [debug] [Thread-1 (]: Traceback (most recent call last):
  File "C:\Users\diniz\Python\Lib\site-packages\dbt\task\base.py", line 363, in safe_run
    result = self.compile_and_execute(manifest, ctx)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\diniz\Python\Lib\site-packages\dbt\task\base.py", line 310, in compile_and_execute
    result = self.run(ctx.node, manifest)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\diniz\Python\Lib\site-packages\dbt\task\base.py", line 410, in run
    return self.execute(compiled_node, manifest)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\diniz\Python\Lib\site-packages\dbt\task\test.py", line 290, in execute
    test_result = self.execute_data_test(test, manifest)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\diniz\Python\Lib\site-packages\dbt\task\test.py", line 165, in execute_data_test
    macro_func()
  File "C:\Users\diniz\Python\Lib\site-packages\dbt\clients\jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\diniz\Python\Lib\site-packages\dbt_common\clients\jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\diniz\Python\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\diniz\Python\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 170, in macro
  File "C:\Users\diniz\Python\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\diniz\Python\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\diniz\Python\Lib\site-packages\dbt\clients\jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\diniz\Python\Lib\site-packages\dbt_common\clients\jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\diniz\Python\Lib\site-packages\jinja2\runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\diniz\Python\Lib\site-packages\jinja2\runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "C:\Users\diniz\Python\Lib\site-packages\jinja2\sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\diniz\Python\Lib\site-packages\jinja2\runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\diniz\Python\Lib\site-packages\dbt_common\record.py", line 507, in record_replay_wrapper
    return func_to_record(*call_args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\diniz\Python\Lib\site-packages\dbt\adapters\base\impl.py", line 437, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\diniz\Python\Lib\site-packages\dbt\adapters\fabric\fabric_connection_manager.py", line 562, in execute
    if not cursor.nextset():
           ^^^^^^^^^^^^^^^^
pyodbc.ProgrammingError: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Sintaxe incorreta próxima a ';'. (102) (SQLMoreResults)")

[0m12:59:23.164207 [error] [Thread-1 (]: 1 of 21 ERROR data_type ........................................................ [[31mERROR[0m in 0.19s]
[0m12:59:23.164207 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.data_type
[0m12:59:23.164207 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m12:59:23.164207 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.data_type' to be skipped because of status 'error'.  Reason: ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Sintaxe incorreta próxima a ';'. (102) (SQLMoreResults)").
[0m12:59:23.164207 [info ] [Thread-1 (]: 2 of 21 START test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [RUN]
[0m12:59:23.179829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.data_type, now test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8)
[0m12:59:23.179829 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m12:59:23.179829 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m12:59:23.195451 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m12:59:23.195451 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m12:59:23.195451 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m12:59:23.211077 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_11580]
   as 
    
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from "my_db"."dbo"."ecommerce"
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    ''Credit Card'',''Net Banking'',''UPI'',''Debit Card'',''Cash on Delivery''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_11580]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_11580]
  ;')
[0m12:59:23.211077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:23.211077 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m12:59:23.211077 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m12:59:23.234929 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:23.241928 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: ROLLBACK
[0m12:59:23.243930 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: Close
[0m12:59:23.244928 [info ] [Thread-1 (]: 2 of 21 PASS source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [[32mPASS[0m in 0.07s]
[0m12:59:23.247931 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m12:59:23.248929 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m12:59:23.250975 [info ] [Thread-1 (]: 3 of 21 START test source_data_type_sqlserver_ecommerce_Category__varchar ...... [RUN]
[0m12:59:23.252738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e)
[0m12:59:23.253738 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m12:59:23.258801 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:23.258801 [error] [Thread-1 (]: 3 of 21 ERROR source_data_type_sqlserver_ecommerce_Category__varchar ........... [[31mERROR[0m in 0.01s]
[0m12:59:23.274431 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m12:59:23.274431 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m12:59:23.274431 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:59:23.274431 [info ] [Thread-1 (]: 4 of 21 START test source_data_type_sqlserver_ecommerce_Discount__int .......... [RUN]
[0m12:59:23.274431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21)
[0m12:59:23.274431 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m12:59:23.290060 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:23.290060 [error] [Thread-1 (]: 4 of 21 ERROR source_data_type_sqlserver_ecommerce_Discount__int ............... [[31mERROR[0m in 0.02s]
[0m12:59:23.290060 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m12:59:23.290060 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m12:59:23.290060 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:59:23.290060 [info ] [Thread-1 (]: 5 of 21 START test source_data_type_sqlserver_ecommerce_Final_Price__float ..... [RUN]
[0m12:59:23.290060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0)
[0m12:59:23.305679 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m12:59:23.305679 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:23.321316 [error] [Thread-1 (]: 5 of 21 ERROR source_data_type_sqlserver_ecommerce_Final_Price__float .......... [[31mERROR[0m in 0.03s]
[0m12:59:23.321316 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m12:59:23.321316 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m12:59:23.321316 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:59:23.321316 [info ] [Thread-1 (]: 6 of 21 START test source_data_type_sqlserver_ecommerce_Payment_Method__varchar  [RUN]
[0m12:59:23.321316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261)
[0m12:59:23.321316 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m12:59:23.336934 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:23.336934 [error] [Thread-1 (]: 6 of 21 ERROR source_data_type_sqlserver_ecommerce_Payment_Method__varchar ..... [[31mERROR[0m in 0.02s]
[0m12:59:23.336934 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m12:59:23.336934 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m12:59:23.336934 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:59:23.336934 [info ] [Thread-1 (]: 7 of 21 START test source_data_type_sqlserver_ecommerce_Price__float ........... [RUN]
[0m12:59:23.355134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5)
[0m12:59:23.356133 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m12:59:23.367247 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:23.367247 [error] [Thread-1 (]: 7 of 21 ERROR source_data_type_sqlserver_ecommerce_Price__float ................ [[31mERROR[0m in 0.01s]
[0m12:59:23.367247 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m12:59:23.367247 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m12:59:23.367247 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:59:23.367247 [info ] [Thread-1 (]: 8 of 21 START test source_data_type_sqlserver_ecommerce_Product_ID__varchar .... [RUN]
[0m12:59:23.367247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db)
[0m12:59:23.367247 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m12:59:23.382910 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:23.382910 [error] [Thread-1 (]: 8 of 21 ERROR source_data_type_sqlserver_ecommerce_Product_ID__varchar ......... [[31mERROR[0m in 0.02s]
[0m12:59:23.382910 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m12:59:23.398500 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:59:23.382910 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m12:59:23.398500 [info ] [Thread-1 (]: 9 of 21 START test source_data_type_sqlserver_ecommerce_Purchase_Date__date .... [RUN]
[0m12:59:23.398500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f)
[0m12:59:23.398500 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m12:59:23.414126 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:23.414126 [error] [Thread-1 (]: 9 of 21 ERROR source_data_type_sqlserver_ecommerce_Purchase_Date__date ......... [[31mERROR[0m in 0.02s]
[0m12:59:23.414126 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m12:59:23.414126 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m12:59:23.414126 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:59:23.414126 [info ] [Thread-1 (]: 10 of 21 START test source_data_type_sqlserver_ecommerce_User_ID__varchar ...... [RUN]
[0m12:59:23.429752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14)
[0m12:59:23.429752 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m12:59:23.429752 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:23.429752 [error] [Thread-1 (]: 10 of 21 ERROR source_data_type_sqlserver_ecommerce_User_ID__varchar ........... [[31mERROR[0m in 0.00s]
[0m12:59:23.445375 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m12:59:23.445375 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m12:59:23.445375 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:59:23.445375 [info ] [Thread-1 (]: 11 of 21 START test source_not_null_sqlserver_ecommerce_Category ............... [RUN]
[0m12:59:23.445375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407)
[0m12:59:23.445375 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m12:59:23.461000 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m12:59:23.461000 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m12:59:23.483805 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m12:59:23.486803 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m12:59:23.487808 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_12485]
   as 
    
    
    



select Category
from "my_db"."dbo"."ecommerce"
where Category is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_12485]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_12485]
  ;')
[0m12:59:23.488804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:23.489804 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m12:59:23.491803 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m12:59:23.504801 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:23.507803 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: ROLLBACK
[0m12:59:23.509946 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: Close
[0m12:59:23.510944 [info ] [Thread-1 (]: 11 of 21 PASS source_not_null_sqlserver_ecommerce_Category ..................... [[32mPASS[0m in 0.07s]
[0m12:59:23.512964 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m12:59:23.514946 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m12:59:23.516950 [info ] [Thread-1 (]: 12 of 21 START test source_not_null_sqlserver_ecommerce_Discount ............... [RUN]
[0m12:59:23.518948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f)
[0m12:59:23.519946 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m12:59:23.524017 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m12:59:23.524017 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m12:59:23.524017 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m12:59:23.539641 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m12:59:23.539641 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_11804]
   as 
    
    
    



select Discount
from "my_db"."dbo"."ecommerce"
where Discount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_11804]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_11804]
  ;')
[0m12:59:23.539641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:23.539641 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m12:59:23.539641 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m12:59:23.555265 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:23.555265 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: ROLLBACK
[0m12:59:23.555265 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: Close
[0m12:59:23.555265 [info ] [Thread-1 (]: 12 of 21 PASS source_not_null_sqlserver_ecommerce_Discount ..................... [[32mPASS[0m in 0.04s]
[0m12:59:23.555265 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m12:59:23.555265 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m12:59:23.555265 [info ] [Thread-1 (]: 13 of 21 START test source_not_null_sqlserver_ecommerce_Final_Price ............ [RUN]
[0m12:59:23.555265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d)
[0m12:59:23.555265 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m12:59:23.578230 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m12:59:23.580233 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m12:59:23.587289 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m12:59:23.587289 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m12:59:23.587289 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_12128]
   as 
    
    
    



select Final_Price
from "my_db"."dbo"."ecommerce"
where Final_Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_12128]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_12128]
  ;')
[0m12:59:23.587289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:23.587289 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m12:59:23.587289 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m12:59:23.602928 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:23.602928 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: ROLLBACK
[0m12:59:23.602928 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: Close
[0m12:59:23.602928 [info ] [Thread-1 (]: 13 of 21 PASS source_not_null_sqlserver_ecommerce_Final_Price .................. [[32mPASS[0m in 0.05s]
[0m12:59:23.602928 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m12:59:23.602928 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m12:59:23.602928 [info ] [Thread-1 (]: 14 of 21 START test source_not_null_sqlserver_ecommerce_Payment_Method ......... [RUN]
[0m12:59:23.618544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae)
[0m12:59:23.618544 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m12:59:23.618544 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m12:59:23.618544 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m12:59:23.634171 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m12:59:23.634171 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m12:59:23.634171 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_17811]
   as 
    
    
    



select Payment_Method
from "my_db"."dbo"."ecommerce"
where Payment_Method is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_17811]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_17811]
  ;')
[0m12:59:23.634171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:23.634171 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m12:59:23.634171 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m12:59:23.649818 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:23.649818 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: ROLLBACK
[0m12:59:23.649818 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: Close
[0m12:59:23.649818 [info ] [Thread-1 (]: 14 of 21 PASS source_not_null_sqlserver_ecommerce_Payment_Method ............... [[32mPASS[0m in 0.05s]
[0m12:59:23.649818 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m12:59:23.665419 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m12:59:23.665419 [info ] [Thread-1 (]: 15 of 21 START test source_not_null_sqlserver_ecommerce_Price .................. [RUN]
[0m12:59:23.665419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01)
[0m12:59:23.665419 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m12:59:23.665419 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m12:59:23.681040 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m12:59:23.681040 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m12:59:23.696667 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m12:59:23.696667 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_8380]
   as 
    
    
    



select Price
from "my_db"."dbo"."ecommerce"
where Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_8380]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_8380]
  ;')
[0m12:59:23.696667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:23.696667 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m12:59:23.696667 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m12:59:23.712315 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:23.727916 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: ROLLBACK
[0m12:59:23.727916 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: Close
[0m12:59:23.727916 [info ] [Thread-1 (]: 15 of 21 PASS source_not_null_sqlserver_ecommerce_Price ........................ [[32mPASS[0m in 0.06s]
[0m12:59:23.727916 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m12:59:23.727916 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m12:59:23.727916 [info ] [Thread-1 (]: 16 of 21 START test source_not_null_sqlserver_ecommerce_Product_ID ............. [RUN]
[0m12:59:23.727916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff)
[0m12:59:23.727916 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m12:59:23.743542 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m12:59:23.743542 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m12:59:23.759171 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m12:59:23.759171 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m12:59:23.759171 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_12728]
   as 
    
    
    



select Product_ID
from "my_db"."dbo"."ecommerce"
where Product_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_12728]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_12728]
  ;')
[0m12:59:23.774790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:23.774790 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m12:59:23.774790 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m12:59:23.774790 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:23.792603 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: ROLLBACK
[0m12:59:23.793615 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: Close
[0m12:59:23.795609 [info ] [Thread-1 (]: 16 of 21 PASS source_not_null_sqlserver_ecommerce_Product_ID ................... [[32mPASS[0m in 0.07s]
[0m12:59:23.797608 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m12:59:23.799620 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m12:59:23.801608 [info ] [Thread-1 (]: 17 of 21 START test source_not_null_sqlserver_ecommerce_Purchase_Date .......... [RUN]
[0m12:59:23.803609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17)
[0m12:59:23.804682 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m12:59:23.804682 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m12:59:23.804682 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m12:59:23.820311 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m12:59:23.820311 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m12:59:23.820311 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_2597]
   as 
    
    
    



select Purchase_Date
from "my_db"."dbo"."ecommerce"
where Purchase_Date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_2597]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_2597]
  ;')
[0m12:59:23.820311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:23.820311 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m12:59:23.820311 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m12:59:23.835938 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:23.835938 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: ROLLBACK
[0m12:59:23.835938 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: Close
[0m12:59:23.835938 [info ] [Thread-1 (]: 17 of 21 PASS source_not_null_sqlserver_ecommerce_Purchase_Date ................ [[32mPASS[0m in 0.03s]
[0m12:59:23.835938 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m12:59:23.851561 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m12:59:23.851561 [info ] [Thread-1 (]: 18 of 21 START test source_not_null_sqlserver_ecommerce_User_ID ................ [RUN]
[0m12:59:23.851561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc)
[0m12:59:23.851561 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m12:59:23.851561 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m12:59:23.867191 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m12:59:23.867191 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m12:59:23.867191 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m12:59:23.867191 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_16599]
   as 
    
    
    



select User_ID
from "my_db"."dbo"."ecommerce"
where User_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_16599]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_16599]
  ;')
[0m12:59:23.867191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:23.867191 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m12:59:23.883421 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m12:59:23.893419 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:23.896415 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: ROLLBACK
[0m12:59:23.898419 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: Close
[0m12:59:23.900516 [info ] [Thread-1 (]: 18 of 21 PASS source_not_null_sqlserver_ecommerce_User_ID ...................... [[32mPASS[0m in 0.05s]
[0m12:59:23.902517 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m12:59:23.904531 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce
[0m12:59:23.905519 [info ] [Thread-1 (]: 19 of 21 SKIP relation dbo.src_ecommerce ....................................... [[33mSKIP[0m]
[0m12:59:23.907515 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce
[0m12:59:23.908514 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce_datatypes
[0m12:59:23.909520 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.src_ecommerce' to be skipped because of status 'skipped'. 
[0m12:59:23.910517 [info ] [Thread-1 (]: 20 of 21 SKIP relation dbo.src_ecommerce_datatypes ............................. [[33mSKIP[0m]
[0m12:59:23.912515 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce_datatypes
[0m12:59:23.913528 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.stg_ecommerce
[0m12:59:23.914515 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.src_ecommerce_datatypes' to be skipped because of status 'skipped'. 
[0m12:59:23.915837 [info ] [Thread-1 (]: 21 of 21 SKIP relation dbo.stg_ecommerce ....................................... [[33mSKIP[0m]
[0m12:59:23.915837 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.stg_ecommerce
[0m12:59:23.915837 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.stg_ecommerce' to be skipped because of status 'skipped'. 
[0m12:59:23.915837 [debug] [MainThread]: On master: COMMIT
[0m12:59:23.915837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:59:23.915837 [debug] [MainThread]: Connection 'list_my_db' was properly closed.
[0m12:59:23.915837 [debug] [MainThread]: Connection 'list_my_db_dbo' was properly closed.
[0m12:59:23.915837 [debug] [MainThread]: Connection 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc' was properly closed.
[0m12:59:23.915837 [info ] [MainThread]: 
[0m12:59:23.915837 [info ] [MainThread]: Finished running 18 data tests, 3 view models in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m12:59:23.931460 [debug] [MainThread]: Command end result
[0m12:59:24.012590 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m12:59:24.018560 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m12:59:24.033687 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m12:59:24.034691 [info ] [MainThread]: 
[0m12:59:24.036689 [info ] [MainThread]: [31mCompleted with 9 errors, 0 partial successes, and 0 warnings:[0m
[0m12:59:24.037722 [info ] [MainThread]: 
[0m12:59:24.039722 [error] [MainThread]: [31mFailure in test data_type (tests\data_type.sql)[0m
[0m12:59:24.039785 [error] [MainThread]:   ('42000', "[42000] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Sintaxe incorreta próxima a ';'. (102) (SQLMoreResults)")
[0m12:59:24.039785 [info ] [MainThread]: 
[0m12:59:24.039785 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m12:59:24.039785 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:24.039785 [info ] [MainThread]: 
[0m12:59:24.039785 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m12:59:24.039785 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:24.039785 [info ] [MainThread]: 
[0m12:59:24.039785 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m12:59:24.055454 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:24.055454 [info ] [MainThread]: 
[0m12:59:24.055454 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m12:59:24.055454 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:24.055454 [info ] [MainThread]: 
[0m12:59:24.055454 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m12:59:24.055454 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:24.055454 [info ] [MainThread]: 
[0m12:59:24.071042 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m12:59:24.071042 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:24.071042 [info ] [MainThread]: 
[0m12:59:24.071042 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m12:59:24.071042 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:24.071042 [info ] [MainThread]: 
[0m12:59:24.071042 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m12:59:24.086665 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:24.086665 [info ] [MainThread]: 
[0m12:59:24.086665 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=9 SKIP=3 NO-OP=0 TOTAL=21
[0m12:59:24.086665 [debug] [MainThread]: Command `dbt build` failed at 12:59:24.086665 after 9.03 seconds
[0m12:59:24.086665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018602853DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018609084150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018607E9DB10>]}
[0m12:59:24.086665 [debug] [MainThread]: Flushing usage events
[0m12:59:24.711506 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:59:49.056499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280FFBE8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280FFC0B1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280FFBE84D0>]}


============================== 12:59:49.072536 | eabfd87e-39cb-4d99-a53f-2dce7a7311d3 ==============================
[0m12:59:49.072536 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:59:49.075534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --target sqlserver', 'send_anonymous_usage_stats': 'True'}
[0m12:59:50.102043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eabfd87e-39cb-4d99-a53f-2dce7a7311d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028081582C50>]}
[0m12:59:50.227447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eabfd87e-39cb-4d99-a53f-2dce7a7311d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280FEB1E110>]}
[0m12:59:50.227447 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m12:59:51.134755 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m12:59:51.664479 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m12:59:51.664479 [debug] [MainThread]: Partial parsing: added file: dbt_databricks_cicd://macros\data_type.sql
[0m12:59:51.664479 [debug] [MainThread]: Partial parsing: deleted file: dbt_databricks_cicd://tests\data_type.sql
[0m12:59:51.914531 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m12:59:51.955995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eabfd87e-39cb-4d99-a53f-2dce7a7311d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280FEB4CB10>]}
[0m12:59:52.149293 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m12:59:52.149293 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m12:59:52.243659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eabfd87e-39cb-4d99-a53f-2dce7a7311d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280FFBB9290>]}
[0m12:59:52.243659 [info ] [MainThread]: Found 3 models, 17 data tests, 1 source, 626 macros
[0m12:59:52.243659 [info ] [MainThread]: 
[0m12:59:52.259278 [info ] [MainThread]: Concurrency: 1 threads (target='sqlserver')
[0m12:59:52.259278 [info ] [MainThread]: 
[0m12:59:52.259278 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m12:59:52.259278 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db'
[0m12:59:52.289455 [debug] [ThreadPool]: dbt-sqlserver
[0m12:59:52.305173 [debug] [ThreadPool]: Using sqlserver connection "list_my_db"
[0m12:59:52.305173 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db"} */
USE [my_db];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m12:59:52.305173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:52.305173 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m12:59:52.398885 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m12:59:52.398885 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:59:52.398885 [debug] [ThreadPool]: On list_my_db: Close
[0m12:59:52.414498 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db_dbo'
[0m12:59:52.414498 [debug] [ThreadPool]: dbt-sqlserver
[0m12:59:52.414498 [debug] [ThreadPool]: Using sqlserver connection "list_my_db_dbo"
[0m12:59:52.430113 [debug] [ThreadPool]: On list_my_db_dbo: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db_dbo"} */
USE [my_db];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m12:59:52.430113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:52.430113 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m12:59:52.430113 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m12:59:52.461394 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:59:52.461394 [debug] [ThreadPool]: On list_my_db_dbo: ROLLBACK
[0m12:59:52.461394 [debug] [ThreadPool]: On list_my_db_dbo: Close
[0m12:59:52.479147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eabfd87e-39cb-4d99-a53f-2dce7a7311d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280FFBC4490>]}
[0m12:59:52.480203 [debug] [MainThread]: On master: COMMIT
[0m12:59:52.488699 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m12:59:52.489699 [info ] [Thread-1 (]: 1 of 20 START test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [RUN]
[0m12:59:52.491702 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8'
[0m12:59:52.493740 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m12:59:52.524438 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m12:59:52.524438 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m12:59:52.555701 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m12:59:52.555701 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m12:59:52.555701 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_15571]
   as 
    
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from "my_db"."dbo"."ecommerce"
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    ''Credit Card'',''Net Banking'',''UPI'',''Debit Card'',''Cash on Delivery''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_15571]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_15571]
  ;')
[0m12:59:52.571321 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:59:52.571321 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m12:59:52.571321 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m12:59:52.586990 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:52.586990 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: ROLLBACK
[0m12:59:52.603844 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: Close
[0m12:59:52.604841 [info ] [Thread-1 (]: 1 of 20 PASS source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [[32mPASS[0m in 0.11s]
[0m12:59:52.607851 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m12:59:52.608840 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m12:59:52.609841 [info ] [Thread-1 (]: 2 of 20 START test source_data_type_sqlserver_ecommerce_Category__varchar ...... [RUN]
[0m12:59:52.611842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e)
[0m12:59:52.612837 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m12:59:52.618880 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:52.618880 [error] [Thread-1 (]: 2 of 20 ERROR source_data_type_sqlserver_ecommerce_Category__varchar ........... [[31mERROR[0m in 0.01s]
[0m12:59:52.634557 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m12:59:52.634557 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m12:59:52.634557 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:59:52.634557 [info ] [Thread-1 (]: 3 of 20 START test source_data_type_sqlserver_ecommerce_Discount__int .......... [RUN]
[0m12:59:52.634557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21)
[0m12:59:52.634557 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m12:59:52.650138 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:52.650138 [error] [Thread-1 (]: 3 of 20 ERROR source_data_type_sqlserver_ecommerce_Discount__int ............... [[31mERROR[0m in 0.02s]
[0m12:59:52.650138 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m12:59:52.665758 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m12:59:52.665758 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:59:52.665758 [info ] [Thread-1 (]: 4 of 20 START test source_data_type_sqlserver_ecommerce_Final_Price__float ..... [RUN]
[0m12:59:52.665758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0)
[0m12:59:52.665758 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m12:59:52.681388 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:52.697012 [error] [Thread-1 (]: 4 of 20 ERROR source_data_type_sqlserver_ecommerce_Final_Price__float .......... [[31mERROR[0m in 0.03s]
[0m12:59:52.697012 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m12:59:52.697012 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m12:59:52.697012 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:59:52.697012 [info ] [Thread-1 (]: 5 of 20 START test source_data_type_sqlserver_ecommerce_Payment_Method__varchar  [RUN]
[0m12:59:52.715578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261)
[0m12:59:52.717589 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m12:59:52.727604 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:52.727604 [error] [Thread-1 (]: 5 of 20 ERROR source_data_type_sqlserver_ecommerce_Payment_Method__varchar ..... [[31mERROR[0m in 0.01s]
[0m12:59:52.727604 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m12:59:52.727604 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m12:59:52.727604 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:59:52.727604 [info ] [Thread-1 (]: 6 of 20 START test source_data_type_sqlserver_ecommerce_Price__float ........... [RUN]
[0m12:59:52.727604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5)
[0m12:59:52.727604 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m12:59:52.743236 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:52.743236 [error] [Thread-1 (]: 6 of 20 ERROR source_data_type_sqlserver_ecommerce_Price__float ................ [[31mERROR[0m in 0.02s]
[0m12:59:52.743236 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m12:59:52.758859 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m12:59:52.758859 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:59:52.758859 [info ] [Thread-1 (]: 7 of 20 START test source_data_type_sqlserver_ecommerce_Product_ID__varchar .... [RUN]
[0m12:59:52.758859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db)
[0m12:59:52.758859 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m12:59:52.774486 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:52.774486 [error] [Thread-1 (]: 7 of 20 ERROR source_data_type_sqlserver_ecommerce_Product_ID__varchar ......... [[31mERROR[0m in 0.02s]
[0m12:59:52.774486 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m12:59:52.774486 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m12:59:52.774486 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:59:52.774486 [info ] [Thread-1 (]: 8 of 20 START test source_data_type_sqlserver_ecommerce_Purchase_Date__date .... [RUN]
[0m12:59:52.774486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f)
[0m12:59:52.774486 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m12:59:52.790107 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:52.790107 [error] [Thread-1 (]: 8 of 20 ERROR source_data_type_sqlserver_ecommerce_Purchase_Date__date ......... [[31mERROR[0m in 0.02s]
[0m12:59:52.790107 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m12:59:52.805780 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m12:59:52.805780 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:59:52.805780 [info ] [Thread-1 (]: 9 of 20 START test source_data_type_sqlserver_ecommerce_User_ID__varchar ....... [RUN]
[0m12:59:52.805780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14)
[0m12:59:52.805780 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m12:59:52.826163 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:52.827161 [error] [Thread-1 (]: 9 of 20 ERROR source_data_type_sqlserver_ecommerce_User_ID__varchar ............ [[31mERROR[0m in 0.02s]
[0m12:59:52.829161 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m12:59:52.830163 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m12:59:52.831163 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m12:59:52.832165 [info ] [Thread-1 (]: 10 of 20 START test source_not_null_sqlserver_ecommerce_Category ............... [RUN]
[0m12:59:52.835165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407)
[0m12:59:52.836213 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m12:59:52.836213 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m12:59:52.851839 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m12:59:52.851839 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m12:59:52.851839 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m12:59:52.867466 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_2667]
   as 
    
    
    



select Category
from "my_db"."dbo"."ecommerce"
where Category is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_2667]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_2667]
  ;')
[0m12:59:52.867466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:52.867466 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m12:59:52.867466 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m12:59:52.883092 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:52.883092 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: ROLLBACK
[0m12:59:52.883092 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: Close
[0m12:59:52.883092 [info ] [Thread-1 (]: 10 of 20 PASS source_not_null_sqlserver_ecommerce_Category ..................... [[32mPASS[0m in 0.05s]
[0m12:59:52.883092 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m12:59:52.883092 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m12:59:52.883092 [info ] [Thread-1 (]: 11 of 20 START test source_not_null_sqlserver_ecommerce_Discount ............... [RUN]
[0m12:59:52.898765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f)
[0m12:59:52.898765 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m12:59:52.898765 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m12:59:52.898765 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m12:59:52.921137 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m12:59:52.925092 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m12:59:52.926093 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_17818]
   as 
    
    
    



select Discount
from "my_db"."dbo"."ecommerce"
where Discount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_17818]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_17818]
  ;')
[0m12:59:52.927092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:52.929091 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m12:59:52.930090 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m12:59:52.941090 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:52.944091 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: ROLLBACK
[0m12:59:52.945091 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: Close
[0m12:59:52.946247 [info ] [Thread-1 (]: 11 of 20 PASS source_not_null_sqlserver_ecommerce_Discount ..................... [[32mPASS[0m in 0.05s]
[0m12:59:52.946247 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m12:59:52.946247 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m12:59:52.946247 [info ] [Thread-1 (]: 12 of 20 START test source_not_null_sqlserver_ecommerce_Final_Price ............ [RUN]
[0m12:59:52.946247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d)
[0m12:59:52.946247 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m12:59:52.961923 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m12:59:52.961923 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m12:59:52.961923 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m12:59:52.977523 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m12:59:52.977523 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_16159]
   as 
    
    
    



select Final_Price
from "my_db"."dbo"."ecommerce"
where Final_Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_16159]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_16159]
  ;')
[0m12:59:52.977523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:52.977523 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m12:59:52.977523 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m12:59:52.993124 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:52.993124 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: ROLLBACK
[0m12:59:52.993124 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: Close
[0m12:59:52.993124 [info ] [Thread-1 (]: 12 of 20 PASS source_not_null_sqlserver_ecommerce_Final_Price .................. [[32mPASS[0m in 0.05s]
[0m12:59:52.993124 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m12:59:52.993124 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m12:59:52.993124 [info ] [Thread-1 (]: 13 of 20 START test source_not_null_sqlserver_ecommerce_Payment_Method ......... [RUN]
[0m12:59:52.993124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae)
[0m12:59:53.008751 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m12:59:53.008751 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m12:59:53.008751 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m12:59:53.027651 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m12:59:53.029615 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m12:59:53.030652 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_1469]
   as 
    
    
    



select Payment_Method
from "my_db"."dbo"."ecommerce"
where Payment_Method is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_1469]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_1469]
  ;')
[0m12:59:53.032616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:53.033618 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m12:59:53.034657 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m12:59:53.046240 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:53.050211 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: ROLLBACK
[0m12:59:53.051211 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: Close
[0m12:59:53.053217 [info ] [Thread-1 (]: 13 of 20 PASS source_not_null_sqlserver_ecommerce_Payment_Method ............... [[32mPASS[0m in 0.06s]
[0m12:59:53.055775 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m12:59:53.055775 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m12:59:53.055775 [info ] [Thread-1 (]: 14 of 20 START test source_not_null_sqlserver_ecommerce_Price .................. [RUN]
[0m12:59:53.055775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01)
[0m12:59:53.055775 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m12:59:53.055775 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m12:59:53.071450 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m12:59:53.071450 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m12:59:53.071450 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m12:59:53.071450 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_8068]
   as 
    
    
    



select Price
from "my_db"."dbo"."ecommerce"
where Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_8068]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_8068]
  ;')
[0m12:59:53.071450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:53.087073 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m12:59:53.087073 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m12:59:53.087073 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:53.102657 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: ROLLBACK
[0m12:59:53.102657 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: Close
[0m12:59:53.102657 [info ] [Thread-1 (]: 14 of 20 PASS source_not_null_sqlserver_ecommerce_Price ........................ [[32mPASS[0m in 0.05s]
[0m12:59:53.102657 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m12:59:53.102657 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m12:59:53.102657 [info ] [Thread-1 (]: 15 of 20 START test source_not_null_sqlserver_ecommerce_Product_ID ............. [RUN]
[0m12:59:53.102657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff)
[0m12:59:53.102657 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m12:59:53.118321 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m12:59:53.118321 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m12:59:53.133943 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m12:59:53.133943 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m12:59:53.133943 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_16483]
   as 
    
    
    



select Product_ID
from "my_db"."dbo"."ecommerce"
where Product_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_16483]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_16483]
  ;')
[0m12:59:53.133943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:53.133943 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m12:59:53.133943 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m12:59:53.149525 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:53.158931 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: ROLLBACK
[0m12:59:53.159937 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: Close
[0m12:59:53.161935 [info ] [Thread-1 (]: 15 of 20 PASS source_not_null_sqlserver_ecommerce_Product_ID ................... [[32mPASS[0m in 0.06s]
[0m12:59:53.163899 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m12:59:53.165894 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m12:59:53.166902 [info ] [Thread-1 (]: 16 of 20 START test source_not_null_sqlserver_ecommerce_Purchase_Date .......... [RUN]
[0m12:59:53.168893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17)
[0m12:59:53.170892 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m12:59:53.171989 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m12:59:53.171989 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m12:59:53.187671 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m12:59:53.187671 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m12:59:53.187671 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_10754]
   as 
    
    
    



select Purchase_Date
from "my_db"."dbo"."ecommerce"
where Purchase_Date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_10754]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_10754]
  ;')
[0m12:59:53.187671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:53.187671 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m12:59:53.187671 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m12:59:53.203240 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:53.203240 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: ROLLBACK
[0m12:59:53.203240 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: Close
[0m12:59:53.218868 [info ] [Thread-1 (]: 16 of 20 PASS source_not_null_sqlserver_ecommerce_Purchase_Date ................ [[32mPASS[0m in 0.05s]
[0m12:59:53.218868 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m12:59:53.218868 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m12:59:53.218868 [info ] [Thread-1 (]: 17 of 20 START test source_not_null_sqlserver_ecommerce_User_ID ................ [RUN]
[0m12:59:53.218868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc)
[0m12:59:53.218868 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m12:59:53.234497 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m12:59:53.234497 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m12:59:53.234497 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m12:59:53.234497 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m12:59:53.234497 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_12399]
   as 
    
    
    



select User_ID
from "my_db"."dbo"."ecommerce"
where User_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_12399]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_12399]
  ;')
[0m12:59:53.250157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:53.250157 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m12:59:53.250157 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m12:59:53.250157 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:59:53.266981 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: ROLLBACK
[0m12:59:53.268977 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: Close
[0m12:59:53.271014 [info ] [Thread-1 (]: 17 of 20 PASS source_not_null_sqlserver_ecommerce_User_ID ...................... [[32mPASS[0m in 0.05s]
[0m12:59:53.273417 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m12:59:53.274536 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce
[0m12:59:53.274536 [info ] [Thread-1 (]: 18 of 20 SKIP relation dbo.src_ecommerce ....................................... [[33mSKIP[0m]
[0m12:59:53.274536 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce
[0m12:59:53.274536 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce_datatypes
[0m12:59:53.274536 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.src_ecommerce' to be skipped because of status 'skipped'. 
[0m12:59:53.274536 [info ] [Thread-1 (]: 19 of 20 SKIP relation dbo.src_ecommerce_datatypes ............................. [[33mSKIP[0m]
[0m12:59:53.274536 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce_datatypes
[0m12:59:53.274536 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.stg_ecommerce
[0m12:59:53.274536 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.src_ecommerce_datatypes' to be skipped because of status 'skipped'. 
[0m12:59:53.274536 [info ] [Thread-1 (]: 20 of 20 SKIP relation dbo.stg_ecommerce ....................................... [[33mSKIP[0m]
[0m12:59:53.290163 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.stg_ecommerce
[0m12:59:53.290163 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.stg_ecommerce' to be skipped because of status 'skipped'. 
[0m12:59:53.290163 [debug] [MainThread]: On master: COMMIT
[0m12:59:53.290163 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:59:53.290163 [debug] [MainThread]: Connection 'list_my_db' was properly closed.
[0m12:59:53.290163 [debug] [MainThread]: Connection 'list_my_db_dbo' was properly closed.
[0m12:59:53.290163 [debug] [MainThread]: Connection 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc' was properly closed.
[0m12:59:53.290163 [info ] [MainThread]: 
[0m12:59:53.290163 [info ] [MainThread]: Finished running 17 data tests, 3 view models in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m12:59:53.305791 [debug] [MainThread]: Command end result
[0m12:59:53.384037 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m12:59:53.384037 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m12:59:53.399677 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m12:59:53.399677 [info ] [MainThread]: 
[0m12:59:53.399677 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m12:59:53.399677 [info ] [MainThread]: 
[0m12:59:53.415288 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m12:59:53.415288 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:53.415288 [info ] [MainThread]: 
[0m12:59:53.415288 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m12:59:53.415288 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:53.415288 [info ] [MainThread]: 
[0m12:59:53.415288 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m12:59:53.415288 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:53.415288 [info ] [MainThread]: 
[0m12:59:53.430914 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m12:59:53.430914 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:53.430914 [info ] [MainThread]: 
[0m12:59:53.430914 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m12:59:53.430914 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:53.430914 [info ] [MainThread]: 
[0m12:59:53.430914 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m12:59:53.430914 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:53.446542 [info ] [MainThread]: 
[0m12:59:53.446542 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m12:59:53.446542 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:53.446542 [info ] [MainThread]: 
[0m12:59:53.446542 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m12:59:53.446542 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:59:53.446542 [info ] [MainThread]: 
[0m12:59:53.446542 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=8 SKIP=3 NO-OP=0 TOTAL=20
[0m12:59:53.462165 [debug] [MainThread]: Command `dbt build` failed at 12:59:53.462165 after 4.65 seconds
[0m12:59:53.462165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280F9153DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280FFBB3710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280FFBB3450>]}
[0m12:59:53.462165 [debug] [MainThread]: Flushing usage events
[0m12:59:54.071335 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:01:24.711278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD6101AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD615BA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD6101B90>]}


============================== 13:01:24.711278 | ec41ab67-1467-42fc-88c5-20ff0b3cc163 ==============================
[0m13:01:24.711278 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:01:24.726898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt build --target sqlserver', 'send_anonymous_usage_stats': 'True'}
[0m13:01:25.648763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec41ab67-1467-42fc-88c5-20ff0b3cc163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD7999750>]}
[0m13:01:25.773773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec41ab67-1467-42fc-88c5-20ff0b3cc163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD5072010>]}
[0m13:01:25.773773 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m13:01:26.556234 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m13:01:27.101850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:01:27.101850 [debug] [MainThread]: Partial parsing: updated file: dbt_databricks_cicd://dbt_databricks_cicd/models\raw\sqlserver\schema.yml
[0m13:01:28.119790 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m13:01:28.135444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec41ab67-1467-42fc-88c5-20ff0b3cc163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD807B890>]}
[0m13:01:28.321336 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m13:01:28.321336 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m13:01:28.414316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec41ab67-1467-42fc-88c5-20ff0b3cc163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD84D7E10>]}
[0m13:01:28.414316 [info ] [MainThread]: Found 3 models, 17 data tests, 1 source, 626 macros
[0m13:01:28.414316 [info ] [MainThread]: 
[0m13:01:28.414316 [info ] [MainThread]: Concurrency: 1 threads (target='sqlserver')
[0m13:01:28.414316 [info ] [MainThread]: 
[0m13:01:28.429943 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m13:01:28.429943 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db'
[0m13:01:28.461218 [debug] [ThreadPool]: dbt-sqlserver
[0m13:01:28.461218 [debug] [ThreadPool]: Using sqlserver connection "list_my_db"
[0m13:01:28.461218 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db"} */
USE [my_db];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m13:01:28.461218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:28.461218 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:01:28.570464 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m13:01:28.570464 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:01:28.570464 [debug] [ThreadPool]: On list_my_db: Close
[0m13:01:28.570464 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db_dbo'
[0m13:01:28.586133 [debug] [ThreadPool]: dbt-sqlserver
[0m13:01:28.586133 [debug] [ThreadPool]: Using sqlserver connection "list_my_db_dbo"
[0m13:01:28.586133 [debug] [ThreadPool]: On list_my_db_dbo: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db_dbo"} */
USE [my_db];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m13:01:28.586133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:28.586133 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:01:28.586133 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m13:01:28.633011 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:01:28.633011 [debug] [ThreadPool]: On list_my_db_dbo: ROLLBACK
[0m13:01:28.633011 [debug] [ThreadPool]: On list_my_db_dbo: Close
[0m13:01:28.633011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec41ab67-1467-42fc-88c5-20ff0b3cc163', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD613AF10>]}
[0m13:01:28.633011 [debug] [MainThread]: On master: COMMIT
[0m13:01:28.648629 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:01:28.648629 [info ] [Thread-1 (]: 1 of 20 START test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [RUN]
[0m13:01:28.648629 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8'
[0m13:01:28.648629 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:01:28.664220 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m13:01:28.664220 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:01:28.726853 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m13:01:28.742478 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m13:01:28.742478 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_2148]
   as 
    
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from "my_db"."dbo"."ecommerce"
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    ''Credit Card'',''Net Banking'',''UPI'',''Debit Card'',''Cash on Delivery''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_2148]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_2148]
  ;')
[0m13:01:28.742478 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:01:28.742478 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:01:28.742478 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:01:28.758099 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:01:28.773728 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: ROLLBACK
[0m13:01:28.773728 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: Close
[0m13:01:28.773728 [info ] [Thread-1 (]: 1 of 20 PASS source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [[32mPASS[0m in 0.13s]
[0m13:01:28.773728 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:01:28.773728 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:01:28.773728 [info ] [Thread-1 (]: 2 of 20 START test source_not_null_sqlserver_ecommerce_Category ................ [RUN]
[0m13:01:28.773728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407)
[0m13:01:28.789355 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:01:28.789355 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m13:01:28.805017 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:01:28.805017 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m13:01:28.805017 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m13:01:28.805017 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_18894]
   as 
    
    
    



select Category
from "my_db"."dbo"."ecommerce"
where Category is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_18894]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_18894]
  ;')
[0m13:01:28.805017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:28.805017 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:01:28.805017 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:01:28.820602 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:01:28.836264 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: ROLLBACK
[0m13:01:28.836264 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: Close
[0m13:01:28.836264 [info ] [Thread-1 (]: 2 of 20 PASS source_not_null_sqlserver_ecommerce_Category ...................... [[32mPASS[0m in 0.06s]
[0m13:01:28.836264 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:01:28.836264 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:01:28.836264 [info ] [Thread-1 (]: 3 of 20 START test source_not_null_sqlserver_ecommerce_Discount ................ [RUN]
[0m13:01:28.836264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f)
[0m13:01:28.836264 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:01:28.851897 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m13:01:28.851897 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:01:28.851897 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m13:01:28.867476 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m13:01:28.867476 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_6507]
   as 
    
    
    



select Discount
from "my_db"."dbo"."ecommerce"
where Discount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_6507]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_6507]
  ;')
[0m13:01:28.867476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:28.867476 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:01:28.867476 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:01:28.867476 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:01:28.883139 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: ROLLBACK
[0m13:01:28.883139 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: Close
[0m13:01:28.883139 [info ] [Thread-1 (]: 3 of 20 PASS source_not_null_sqlserver_ecommerce_Discount ...................... [[32mPASS[0m in 0.05s]
[0m13:01:28.883139 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:01:28.883139 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:01:28.883139 [info ] [Thread-1 (]: 4 of 20 START test source_not_null_sqlserver_ecommerce_Final_Price ............. [RUN]
[0m13:01:28.883139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d)
[0m13:01:28.883139 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:01:28.906000 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m13:01:28.907964 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:01:28.914182 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m13:01:28.917186 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m13:01:28.918194 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_18176]
   as 
    
    
    



select Final_Price
from "my_db"."dbo"."ecommerce"
where Final_Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_18176]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_18176]
  ;')
[0m13:01:28.919189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:28.920189 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:01:28.922188 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:01:28.930253 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:01:28.930253 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: ROLLBACK
[0m13:01:28.930253 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: Close
[0m13:01:28.930253 [info ] [Thread-1 (]: 4 of 20 PASS source_not_null_sqlserver_ecommerce_Final_Price ................... [[32mPASS[0m in 0.05s]
[0m13:01:28.930253 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:01:28.930253 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:01:28.945916 [info ] [Thread-1 (]: 5 of 20 START test source_not_null_sqlserver_ecommerce_Payment_Method .......... [RUN]
[0m13:01:28.945916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae)
[0m13:01:28.945916 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:01:28.945916 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m13:01:28.945916 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:01:28.961503 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m13:01:28.961503 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m13:01:28.961503 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_7996]
   as 
    
    
    



select Payment_Method
from "my_db"."dbo"."ecommerce"
where Payment_Method is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_7996]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_7996]
  ;')
[0m13:01:28.961503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:28.961503 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:01:28.961503 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:01:28.977176 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:01:28.977176 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: ROLLBACK
[0m13:01:28.977176 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: Close
[0m13:01:28.977176 [info ] [Thread-1 (]: 5 of 20 PASS source_not_null_sqlserver_ecommerce_Payment_Method ................ [[32mPASS[0m in 0.03s]
[0m13:01:28.992805 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:01:28.992805 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:01:28.992805 [info ] [Thread-1 (]: 6 of 20 START test source_not_null_sqlserver_ecommerce_Price ................... [RUN]
[0m13:01:28.992805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01)
[0m13:01:28.992805 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:01:29.008383 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m13:01:29.008383 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:01:29.008383 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m13:01:29.008383 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m13:01:29.008383 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_6977]
   as 
    
    
    



select Price
from "my_db"."dbo"."ecommerce"
where Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_6977]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_6977]
  ;')
[0m13:01:29.024009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:29.025260 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:01:29.027211 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:01:29.037712 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:01:29.040010 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: ROLLBACK
[0m13:01:29.040010 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: Close
[0m13:01:29.040010 [info ] [Thread-1 (]: 6 of 20 PASS source_not_null_sqlserver_ecommerce_Price ......................... [[32mPASS[0m in 0.05s]
[0m13:01:29.040010 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:01:29.040010 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:01:29.040010 [info ] [Thread-1 (]: 7 of 20 START test source_not_null_sqlserver_ecommerce_Product_ID .............. [RUN]
[0m13:01:29.040010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff)
[0m13:01:29.040010 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:01:29.055646 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m13:01:29.055646 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:01:29.055646 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m13:01:29.071271 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m13:01:29.071271 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_6312]
   as 
    
    
    



select Product_ID
from "my_db"."dbo"."ecommerce"
where Product_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_6312]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_6312]
  ;')
[0m13:01:29.071271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:29.071271 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:01:29.071271 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:01:29.086891 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:01:29.086891 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: ROLLBACK
[0m13:01:29.086891 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: Close
[0m13:01:29.086891 [info ] [Thread-1 (]: 7 of 20 PASS source_not_null_sqlserver_ecommerce_Product_ID .................... [[32mPASS[0m in 0.05s]
[0m13:01:29.086891 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:01:29.086891 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:01:29.086891 [info ] [Thread-1 (]: 8 of 20 START test source_not_null_sqlserver_ecommerce_Purchase_Date ........... [RUN]
[0m13:01:29.102520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17)
[0m13:01:29.102520 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:01:29.102520 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m13:01:29.102520 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:01:29.118149 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m13:01:29.118149 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m13:01:29.118149 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_18605]
   as 
    
    
    



select Purchase_Date
from "my_db"."dbo"."ecommerce"
where Purchase_Date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_18605]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_18605]
  ;')
[0m13:01:29.118149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:29.118149 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:01:29.118149 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:01:29.141042 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:01:29.145043 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: ROLLBACK
[0m13:01:29.146043 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: Close
[0m13:01:29.148043 [info ] [Thread-1 (]: 8 of 20 PASS source_not_null_sqlserver_ecommerce_Purchase_Date ................. [[32mPASS[0m in 0.04s]
[0m13:01:29.150756 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:01:29.150756 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:01:29.150756 [info ] [Thread-1 (]: 9 of 20 START test source_not_null_sqlserver_ecommerce_User_ID ................. [RUN]
[0m13:01:29.150756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc)
[0m13:01:29.150756 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:01:29.150756 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m13:01:29.166384 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:01:29.166384 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m13:01:29.166384 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m13:01:29.166384 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_14670]
   as 
    
    
    



select User_ID
from "my_db"."dbo"."ecommerce"
where User_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_14670]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_14670]
  ;')
[0m13:01:29.166384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:29.182005 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:01:29.182005 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:01:29.182005 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:01:29.182005 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: ROLLBACK
[0m13:01:29.197669 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: Close
[0m13:01:29.197669 [info ] [Thread-1 (]: 9 of 20 PASS source_not_null_sqlserver_ecommerce_User_ID ....................... [[32mPASS[0m in 0.05s]
[0m13:01:29.197669 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:01:29.197669 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Category__varchar.115ae79c26
[0m13:01:29.197669 [info ] [Thread-1 (]: 10 of 20 START test source_test_data_type_sqlserver_ecommerce_Category__varchar  [RUN]
[0m13:01:29.197669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc, now test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Category__varchar.115ae79c26)
[0m13:01:29.197669 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Category__varchar.115ae79c26
[0m13:01:29.213259 [debug] [Thread-1 (]: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:01:29.213259 [error] [Thread-1 (]: 10 of 20 ERROR source_test_data_type_sqlserver_ecommerce_Category__varchar ..... [[31mERROR[0m in 0.02s]
[0m13:01:29.229649 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Category__varchar.115ae79c26
[0m13:01:29.231647 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Discount__int.dac66ce1e3
[0m13:01:29.232647 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Category__varchar.115ae79c26' to be skipped because of status 'error'.  Reason: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:01:29.233646 [info ] [Thread-1 (]: 11 of 20 START test source_test_data_type_sqlserver_ecommerce_Discount__int .... [RUN]
[0m13:01:29.235650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Category__varchar.115ae79c26, now test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Discount__int.dac66ce1e3)
[0m13:01:29.236654 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Discount__int.dac66ce1e3
[0m13:01:29.249646 [debug] [Thread-1 (]: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:01:29.251648 [error] [Thread-1 (]: 11 of 20 ERROR source_test_data_type_sqlserver_ecommerce_Discount__int ......... [[31mERROR[0m in 0.01s]
[0m13:01:29.253484 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Discount__int.dac66ce1e3
[0m13:01:29.254483 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Final_Price__float.6019e03d9c
[0m13:01:29.255482 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Discount__int.dac66ce1e3' to be skipped because of status 'error'.  Reason: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:01:29.256482 [info ] [Thread-1 (]: 12 of 20 START test source_test_data_type_sqlserver_ecommerce_Final_Price__float  [RUN]
[0m13:01:29.258583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Discount__int.dac66ce1e3, now test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Final_Price__float.6019e03d9c)
[0m13:01:29.258583 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Final_Price__float.6019e03d9c
[0m13:01:29.274208 [debug] [Thread-1 (]: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:01:29.274208 [error] [Thread-1 (]: 12 of 20 ERROR source_test_data_type_sqlserver_ecommerce_Final_Price__float .... [[31mERROR[0m in 0.02s]
[0m13:01:29.274208 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Final_Price__float.6019e03d9c
[0m13:01:29.274208 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Payment_Method__varchar.8612067a9d
[0m13:01:29.274208 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Final_Price__float.6019e03d9c' to be skipped because of status 'error'.  Reason: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:01:29.274208 [info ] [Thread-1 (]: 13 of 20 START test source_test_data_type_sqlserver_ecommerce_Payment_Method__varchar  [RUN]
[0m13:01:29.274208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Final_Price__float.6019e03d9c, now test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Payment_Method__varchar.8612067a9d)
[0m13:01:29.274208 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Payment_Method__varchar.8612067a9d
[0m13:01:29.289853 [debug] [Thread-1 (]: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:01:29.289853 [error] [Thread-1 (]: 13 of 20 ERROR source_test_data_type_sqlserver_ecommerce_Payment_Method__varchar  [[31mERROR[0m in 0.02s]
[0m13:01:29.289853 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Payment_Method__varchar.8612067a9d
[0m13:01:29.305459 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Payment_Method__varchar.8612067a9d' to be skipped because of status 'error'.  Reason: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:01:29.305459 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Price__float.56f02626aa
[0m13:01:29.305459 [info ] [Thread-1 (]: 14 of 20 START test source_test_data_type_sqlserver_ecommerce_Price__float ..... [RUN]
[0m13:01:29.305459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Payment_Method__varchar.8612067a9d, now test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Price__float.56f02626aa)
[0m13:01:29.305459 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Price__float.56f02626aa
[0m13:01:29.321132 [debug] [Thread-1 (]: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:01:29.321132 [error] [Thread-1 (]: 14 of 20 ERROR source_test_data_type_sqlserver_ecommerce_Price__float .......... [[31mERROR[0m in 0.02s]
[0m13:01:29.321132 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Price__float.56f02626aa
[0m13:01:29.321132 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Product_ID__varchar.a0985f9994
[0m13:01:29.321132 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Price__float.56f02626aa' to be skipped because of status 'error'.  Reason: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:01:29.321132 [info ] [Thread-1 (]: 15 of 20 START test source_test_data_type_sqlserver_ecommerce_Product_ID__varchar  [RUN]
[0m13:01:29.321132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Price__float.56f02626aa, now test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Product_ID__varchar.a0985f9994)
[0m13:01:29.321132 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Product_ID__varchar.a0985f9994
[0m13:01:29.336708 [debug] [Thread-1 (]: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:01:29.336708 [error] [Thread-1 (]: 15 of 20 ERROR source_test_data_type_sqlserver_ecommerce_Product_ID__varchar ... [[31mERROR[0m in 0.02s]
[0m13:01:29.336708 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Product_ID__varchar.a0985f9994
[0m13:01:29.352614 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Purchase_Date__date.74c7a7d3ac
[0m13:01:29.353633 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Product_ID__varchar.a0985f9994' to be skipped because of status 'error'.  Reason: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:01:29.354610 [info ] [Thread-1 (]: 16 of 20 START test source_test_data_type_sqlserver_ecommerce_Purchase_Date__date  [RUN]
[0m13:01:29.356611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Product_ID__varchar.a0985f9994, now test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Purchase_Date__date.74c7a7d3ac)
[0m13:01:29.358613 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Purchase_Date__date.74c7a7d3ac
[0m13:01:29.370741 [debug] [Thread-1 (]: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:01:29.371741 [error] [Thread-1 (]: 16 of 20 ERROR source_test_data_type_sqlserver_ecommerce_Purchase_Date__date ... [[31mERROR[0m in 0.02s]
[0m13:01:29.374744 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Purchase_Date__date.74c7a7d3ac
[0m13:01:29.375742 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_User_ID__varchar.f0bf190fef
[0m13:01:29.377752 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Purchase_Date__date.74c7a7d3ac' to be skipped because of status 'error'.  Reason: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:01:29.379742 [info ] [Thread-1 (]: 17 of 20 START test source_test_data_type_sqlserver_ecommerce_User_ID__varchar . [RUN]
[0m13:01:29.381739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Purchase_Date__date.74c7a7d3ac, now test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_User_ID__varchar.f0bf190fef)
[0m13:01:29.383746 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_User_ID__varchar.f0bf190fef
[0m13:01:29.396737 [debug] [Thread-1 (]: Compilation Error in test source_test_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:01:29.398739 [error] [Thread-1 (]: 17 of 20 ERROR source_test_data_type_sqlserver_ecommerce_User_ID__varchar ...... [[31mERROR[0m in 0.02s]
[0m13:01:29.400932 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_User_ID__varchar.f0bf190fef
[0m13:01:29.401928 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_User_ID__varchar.f0bf190fef' to be skipped because of status 'error'.  Reason: Compilation Error in test source_test_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:01:29.403933 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce
[0m13:01:29.405931 [info ] [Thread-1 (]: 18 of 20 SKIP relation dbo.src_ecommerce ....................................... [[33mSKIP[0m]
[0m13:01:29.407931 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce
[0m13:01:29.409949 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce_datatypes
[0m13:01:29.410939 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.src_ecommerce' to be skipped because of status 'skipped'. 
[0m13:01:29.412933 [info ] [Thread-1 (]: 19 of 20 SKIP relation dbo.src_ecommerce_datatypes ............................. [[33mSKIP[0m]
[0m13:01:29.415803 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce_datatypes
[0m13:01:29.415803 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.stg_ecommerce
[0m13:01:29.415803 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.src_ecommerce_datatypes' to be skipped because of status 'skipped'. 
[0m13:01:29.415803 [info ] [Thread-1 (]: 20 of 20 SKIP relation dbo.stg_ecommerce ....................................... [[33mSKIP[0m]
[0m13:01:29.415803 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.stg_ecommerce
[0m13:01:29.415803 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.stg_ecommerce' to be skipped because of status 'skipped'. 
[0m13:01:29.415803 [debug] [MainThread]: On master: COMMIT
[0m13:01:29.415803 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:29.431429 [debug] [MainThread]: Connection 'list_my_db' was properly closed.
[0m13:01:29.431429 [debug] [MainThread]: Connection 'list_my_db_dbo' was properly closed.
[0m13:01:29.431429 [debug] [MainThread]: Connection 'test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_User_ID__varchar.f0bf190fef' was properly closed.
[0m13:01:29.431429 [info ] [MainThread]: 
[0m13:01:29.431429 [info ] [MainThread]: Finished running 17 data tests, 3 view models in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m13:01:29.431429 [debug] [MainThread]: Command end result
[0m13:01:29.587483 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m13:01:29.587483 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m13:01:29.603156 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m13:01:29.603156 [info ] [MainThread]: 
[0m13:01:29.603156 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m13:01:29.603156 [info ] [MainThread]: 
[0m13:01:29.603156 [error] [MainThread]: [31mFailure in test source_test_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:01:29.618741 [error] [MainThread]:   Compilation Error in test source_test_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:01:29.618741 [info ] [MainThread]: 
[0m13:01:29.618741 [error] [MainThread]: [31mFailure in test source_test_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:01:29.618741 [error] [MainThread]:   Compilation Error in test source_test_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:01:29.618741 [info ] [MainThread]: 
[0m13:01:29.618741 [error] [MainThread]: [31mFailure in test source_test_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:01:29.618741 [error] [MainThread]:   Compilation Error in test source_test_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:01:29.618741 [info ] [MainThread]: 
[0m13:01:29.618741 [error] [MainThread]: [31mFailure in test source_test_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:01:29.618741 [error] [MainThread]:   Compilation Error in test source_test_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:01:29.634400 [info ] [MainThread]: 
[0m13:01:29.634400 [error] [MainThread]: [31mFailure in test source_test_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:01:29.634400 [error] [MainThread]:   Compilation Error in test source_test_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:01:29.634400 [info ] [MainThread]: 
[0m13:01:29.634400 [error] [MainThread]: [31mFailure in test source_test_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:01:29.634400 [error] [MainThread]:   Compilation Error in test source_test_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:01:29.634400 [info ] [MainThread]: 
[0m13:01:29.650016 [error] [MainThread]: [31mFailure in test source_test_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:01:29.650016 [error] [MainThread]:   Compilation Error in test source_test_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:01:29.650016 [info ] [MainThread]: 
[0m13:01:29.650016 [error] [MainThread]: [31mFailure in test source_test_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:01:29.650016 [error] [MainThread]:   Compilation Error in test source_test_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:01:29.650016 [info ] [MainThread]: 
[0m13:01:29.650016 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=8 SKIP=3 NO-OP=0 TOTAL=20
[0m13:01:29.665652 [debug] [MainThread]: Command `dbt build` failed at 13:01:29.665652 after 5.10 seconds
[0m13:01:29.665652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DCF673DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DCF8D0550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD80EECD0>]}
[0m13:01:29.665652 [debug] [MainThread]: Flushing usage events
[0m13:01:30.258061 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:02:46.445633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276DA538790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276DA502090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276DA501FD0>]}


============================== 13:02:46.461259 | 3f0fe54b-9e68-4673-b359-91d924891340 ==============================
[0m13:02:46.461259 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:02:46.461259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --target sqlserver', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:02:47.525058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f0fe54b-9e68-4673-b359-91d924891340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276DBDAB790>]}
[0m13:02:47.633186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f0fe54b-9e68-4673-b359-91d924891340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D9461E90>]}
[0m13:02:47.633186 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m13:02:48.430098 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m13:02:48.945462 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m13:02:48.945462 [debug] [MainThread]: Partial parsing: added file: dbt_databricks_cicd://macros\test_data_type.sql
[0m13:02:48.945462 [debug] [MainThread]: Partial parsing: deleted file: dbt_databricks_cicd://macros\data_type.sql
[0m13:02:49.164498 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m13:02:49.200174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f0fe54b-9e68-4673-b359-91d924891340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276DA539C10>]}
[0m13:02:49.368416 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m13:02:49.384036 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m13:02:49.476399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f0fe54b-9e68-4673-b359-91d924891340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276DC01D290>]}
[0m13:02:49.476399 [info ] [MainThread]: Found 3 models, 17 data tests, 1 source, 626 macros
[0m13:02:49.476399 [info ] [MainThread]: 
[0m13:02:49.476399 [info ] [MainThread]: Concurrency: 1 threads (target='sqlserver')
[0m13:02:49.476399 [info ] [MainThread]: 
[0m13:02:49.476399 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m13:02:49.492017 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db'
[0m13:02:49.523240 [debug] [ThreadPool]: dbt-sqlserver
[0m13:02:49.523240 [debug] [ThreadPool]: Using sqlserver connection "list_my_db"
[0m13:02:49.538851 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db"} */
USE [my_db];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m13:02:49.538851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:49.538851 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:02:49.634577 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m13:02:49.634577 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:02:49.634577 [debug] [ThreadPool]: On list_my_db: Close
[0m13:02:49.650218 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db_dbo'
[0m13:02:49.650218 [debug] [ThreadPool]: dbt-sqlserver
[0m13:02:49.650218 [debug] [ThreadPool]: Using sqlserver connection "list_my_db_dbo"
[0m13:02:49.650218 [debug] [ThreadPool]: On list_my_db_dbo: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db_dbo"} */
USE [my_db];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m13:02:49.650218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:02:49.650218 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:02:49.665834 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m13:02:49.728525 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:02:49.731522 [debug] [ThreadPool]: On list_my_db_dbo: ROLLBACK
[0m13:02:49.732523 [debug] [ThreadPool]: On list_my_db_dbo: Close
[0m13:02:49.735521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f0fe54b-9e68-4673-b359-91d924891340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276DBCF4550>]}
[0m13:02:49.736523 [debug] [MainThread]: On master: COMMIT
[0m13:02:49.743591 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:02:49.743591 [info ] [Thread-1 (]: 1 of 20 START test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [RUN]
[0m13:02:49.743591 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8'
[0m13:02:49.743591 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:02:49.774847 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m13:02:49.774847 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:02:49.821725 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m13:02:49.821725 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m13:02:49.821725 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_9547]
   as 
    
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from "my_db"."dbo"."ecommerce"
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    ''Credit Card'',''Net Banking'',''UPI'',''Debit Card'',''Cash on Delivery''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_9547]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_9547]
  ;')
[0m13:02:49.821725 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:02:49.821725 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:02:49.837473 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:02:49.851976 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:02:49.851976 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: ROLLBACK
[0m13:02:49.851976 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: Close
[0m13:02:49.851976 [info ] [Thread-1 (]: 1 of 20 PASS source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [[32mPASS[0m in 0.11s]
[0m13:02:49.851976 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:02:49.851976 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:02:49.867611 [info ] [Thread-1 (]: 2 of 20 START test source_not_null_sqlserver_ecommerce_Category ................ [RUN]
[0m13:02:49.867611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407)
[0m13:02:49.867611 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:02:49.883230 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m13:02:49.883230 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:02:49.883230 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m13:02:49.883230 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m13:02:49.883230 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_4826]
   as 
    
    
    



select Category
from "my_db"."dbo"."ecommerce"
where Category is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_4826]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_4826]
  ;')
[0m13:02:49.898854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:49.898854 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:02:49.898854 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:02:49.898854 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:02:49.914478 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: ROLLBACK
[0m13:02:49.914478 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: Close
[0m13:02:49.914478 [info ] [Thread-1 (]: 2 of 20 PASS source_not_null_sqlserver_ecommerce_Category ...................... [[32mPASS[0m in 0.05s]
[0m13:02:49.914478 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:02:49.914478 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:02:49.914478 [info ] [Thread-1 (]: 3 of 20 START test source_not_null_sqlserver_ecommerce_Discount ................ [RUN]
[0m13:02:49.914478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f)
[0m13:02:49.914478 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:02:49.930138 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m13:02:49.930138 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:02:49.945761 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m13:02:49.945761 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m13:02:49.945761 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_10055]
   as 
    
    
    



select Discount
from "my_db"."dbo"."ecommerce"
where Discount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_10055]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_10055]
  ;')
[0m13:02:49.945761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:49.945761 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:02:49.945761 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:02:49.961356 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:02:49.961356 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: ROLLBACK
[0m13:02:49.961356 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: Close
[0m13:02:49.961356 [info ] [Thread-1 (]: 3 of 20 PASS source_not_null_sqlserver_ecommerce_Discount ...................... [[32mPASS[0m in 0.05s]
[0m13:02:49.961356 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:02:49.961356 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:02:49.961356 [info ] [Thread-1 (]: 4 of 20 START test source_not_null_sqlserver_ecommerce_Final_Price ............. [RUN]
[0m13:02:49.976982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d)
[0m13:02:49.976982 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:02:49.976982 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m13:02:49.976982 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:02:49.992606 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m13:02:49.992606 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m13:02:49.992606 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_10221]
   as 
    
    
    



select Final_Price
from "my_db"."dbo"."ecommerce"
where Final_Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_10221]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_10221]
  ;')
[0m13:02:49.992606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:49.992606 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:02:49.992606 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:02:50.008229 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:02:50.008229 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: ROLLBACK
[0m13:02:50.008229 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: Close
[0m13:02:50.008229 [info ] [Thread-1 (]: 4 of 20 PASS source_not_null_sqlserver_ecommerce_Final_Price ................... [[32mPASS[0m in 0.03s]
[0m13:02:50.023874 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:02:50.023874 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:02:50.023874 [info ] [Thread-1 (]: 5 of 20 START test source_not_null_sqlserver_ecommerce_Payment_Method .......... [RUN]
[0m13:02:50.023874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae)
[0m13:02:50.023874 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:02:50.039489 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m13:02:50.042879 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:02:50.048903 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m13:02:50.051881 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m13:02:50.052879 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_13706]
   as 
    
    
    



select Payment_Method
from "my_db"."dbo"."ecommerce"
where Payment_Method is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_13706]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_13706]
  ;')
[0m13:02:50.053883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:50.055049 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:02:50.057087 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:02:50.067280 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:02:50.070434 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: ROLLBACK
[0m13:02:50.070434 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: Close
[0m13:02:50.070434 [info ] [Thread-1 (]: 5 of 20 PASS source_not_null_sqlserver_ecommerce_Payment_Method ................ [[32mPASS[0m in 0.05s]
[0m13:02:50.070434 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:02:50.070434 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:02:50.070434 [info ] [Thread-1 (]: 6 of 20 START test source_not_null_sqlserver_ecommerce_Price ................... [RUN]
[0m13:02:50.070434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01)
[0m13:02:50.070434 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:02:50.086120 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m13:02:50.086120 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:02:50.101696 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m13:02:50.101696 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m13:02:50.101696 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_2973]
   as 
    
    
    



select Price
from "my_db"."dbo"."ecommerce"
where Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_2973]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_2973]
  ;')
[0m13:02:50.101696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:50.101696 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:02:50.101696 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:02:50.117321 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:02:50.117321 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: ROLLBACK
[0m13:02:50.117321 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: Close
[0m13:02:50.117321 [info ] [Thread-1 (]: 6 of 20 PASS source_not_null_sqlserver_ecommerce_Price ......................... [[32mPASS[0m in 0.05s]
[0m13:02:50.117321 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:02:50.117321 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:02:50.117321 [info ] [Thread-1 (]: 7 of 20 START test source_not_null_sqlserver_ecommerce_Product_ID .............. [RUN]
[0m13:02:50.132944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff)
[0m13:02:50.132944 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:02:50.132944 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m13:02:50.132944 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:02:50.148567 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m13:02:50.148567 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m13:02:50.148567 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_4799]
   as 
    
    
    



select Product_ID
from "my_db"."dbo"."ecommerce"
where Product_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_4799]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_4799]
  ;')
[0m13:02:50.148567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:50.148567 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:02:50.148567 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:02:50.164202 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:02:50.164202 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: ROLLBACK
[0m13:02:50.164202 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: Close
[0m13:02:50.164202 [info ] [Thread-1 (]: 7 of 20 PASS source_not_null_sqlserver_ecommerce_Product_ID .................... [[32mPASS[0m in 0.03s]
[0m13:02:50.179928 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:02:50.179928 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:02:50.179928 [info ] [Thread-1 (]: 8 of 20 START test source_not_null_sqlserver_ecommerce_Purchase_Date ........... [RUN]
[0m13:02:50.179928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17)
[0m13:02:50.179928 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:02:50.179928 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m13:02:50.195441 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:02:50.195441 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m13:02:50.195441 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m13:02:50.195441 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_14627]
   as 
    
    
    



select Purchase_Date
from "my_db"."dbo"."ecommerce"
where Purchase_Date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_14627]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_14627]
  ;')
[0m13:02:50.195441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:50.195441 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:02:50.195441 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:02:50.211061 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:02:50.211061 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: ROLLBACK
[0m13:02:50.211061 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: Close
[0m13:02:50.226726 [info ] [Thread-1 (]: 8 of 20 PASS source_not_null_sqlserver_ecommerce_Purchase_Date ................. [[32mPASS[0m in 0.05s]
[0m13:02:50.226726 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:02:50.226726 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:02:50.226726 [info ] [Thread-1 (]: 9 of 20 START test source_not_null_sqlserver_ecommerce_User_ID ................. [RUN]
[0m13:02:50.226726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc)
[0m13:02:50.226726 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:02:50.243610 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m13:02:50.246648 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:02:50.252644 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m13:02:50.254646 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m13:02:50.256657 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_18892]
   as 
    
    
    



select User_ID
from "my_db"."dbo"."ecommerce"
where User_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_18892]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_18892]
  ;')
[0m13:02:50.257780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:02:50.259782 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:02:50.261785 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:02:50.271782 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:02:50.274942 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: ROLLBACK
[0m13:02:50.275904 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: Close
[0m13:02:50.277944 [info ] [Thread-1 (]: 9 of 20 PASS source_not_null_sqlserver_ecommerce_User_ID ....................... [[32mPASS[0m in 0.05s]
[0m13:02:50.279917 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:02:50.280908 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Category__varchar.115ae79c26
[0m13:02:50.282908 [info ] [Thread-1 (]: 10 of 20 START test source_test_data_type_sqlserver_ecommerce_Category__varchar  [RUN]
[0m13:02:50.283908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc, now test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Category__varchar.115ae79c26)
[0m13:02:50.284909 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Category__varchar.115ae79c26
[0m13:02:50.289044 [debug] [Thread-1 (]: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:02:50.304681 [error] [Thread-1 (]: 10 of 20 ERROR source_test_data_type_sqlserver_ecommerce_Category__varchar ..... [[31mERROR[0m in 0.02s]
[0m13:02:50.304681 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Category__varchar.115ae79c26
[0m13:02:50.304681 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Discount__int.dac66ce1e3
[0m13:02:50.304681 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Category__varchar.115ae79c26' to be skipped because of status 'error'.  Reason: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:02:50.304681 [info ] [Thread-1 (]: 11 of 20 START test source_test_data_type_sqlserver_ecommerce_Discount__int .... [RUN]
[0m13:02:50.304681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Category__varchar.115ae79c26, now test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Discount__int.dac66ce1e3)
[0m13:02:50.304681 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Discount__int.dac66ce1e3
[0m13:02:50.320311 [debug] [Thread-1 (]: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:02:50.320311 [error] [Thread-1 (]: 11 of 20 ERROR source_test_data_type_sqlserver_ecommerce_Discount__int ......... [[31mERROR[0m in 0.02s]
[0m13:02:50.335928 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Discount__int.dac66ce1e3
[0m13:02:50.335928 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Final_Price__float.6019e03d9c
[0m13:02:50.335928 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Discount__int.dac66ce1e3' to be skipped because of status 'error'.  Reason: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:02:50.335928 [info ] [Thread-1 (]: 12 of 20 START test source_test_data_type_sqlserver_ecommerce_Final_Price__float  [RUN]
[0m13:02:50.335928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Discount__int.dac66ce1e3, now test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Final_Price__float.6019e03d9c)
[0m13:02:50.335928 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Final_Price__float.6019e03d9c
[0m13:02:50.351556 [debug] [Thread-1 (]: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:02:50.351556 [error] [Thread-1 (]: 12 of 20 ERROR source_test_data_type_sqlserver_ecommerce_Final_Price__float .... [[31mERROR[0m in 0.02s]
[0m13:02:50.351556 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Final_Price__float.6019e03d9c
[0m13:02:50.351556 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Payment_Method__varchar.8612067a9d
[0m13:02:50.351556 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Final_Price__float.6019e03d9c' to be skipped because of status 'error'.  Reason: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:02:50.351556 [info ] [Thread-1 (]: 13 of 20 START test source_test_data_type_sqlserver_ecommerce_Payment_Method__varchar  [RUN]
[0m13:02:50.351556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Final_Price__float.6019e03d9c, now test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Payment_Method__varchar.8612067a9d)
[0m13:02:50.368768 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Payment_Method__varchar.8612067a9d
[0m13:02:50.380774 [debug] [Thread-1 (]: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:02:50.382914 [error] [Thread-1 (]: 13 of 20 ERROR source_test_data_type_sqlserver_ecommerce_Payment_Method__varchar  [[31mERROR[0m in 0.03s]
[0m13:02:50.384915 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Payment_Method__varchar.8612067a9d
[0m13:02:50.386920 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Price__float.56f02626aa
[0m13:02:50.386920 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Payment_Method__varchar.8612067a9d' to be skipped because of status 'error'.  Reason: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:02:50.387915 [info ] [Thread-1 (]: 14 of 20 START test source_test_data_type_sqlserver_ecommerce_Price__float ..... [RUN]
[0m13:02:50.390919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Payment_Method__varchar.8612067a9d, now test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Price__float.56f02626aa)
[0m13:02:50.391922 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Price__float.56f02626aa
[0m13:02:50.399351 [debug] [Thread-1 (]: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:02:50.399351 [error] [Thread-1 (]: 14 of 20 ERROR source_test_data_type_sqlserver_ecommerce_Price__float .......... [[31mERROR[0m in 0.01s]
[0m13:02:50.399351 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Price__float.56f02626aa
[0m13:02:50.399351 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Product_ID__varchar.a0985f9994
[0m13:02:50.399351 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Price__float.56f02626aa' to be skipped because of status 'error'.  Reason: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:02:50.399351 [info ] [Thread-1 (]: 15 of 20 START test source_test_data_type_sqlserver_ecommerce_Product_ID__varchar  [RUN]
[0m13:02:50.399351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Price__float.56f02626aa, now test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Product_ID__varchar.a0985f9994)
[0m13:02:50.414944 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Product_ID__varchar.a0985f9994
[0m13:02:50.414944 [debug] [Thread-1 (]: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:02:50.414944 [error] [Thread-1 (]: 15 of 20 ERROR source_test_data_type_sqlserver_ecommerce_Product_ID__varchar ... [[31mERROR[0m in 0.02s]
[0m13:02:50.430595 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Product_ID__varchar.a0985f9994
[0m13:02:50.430595 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Purchase_Date__date.74c7a7d3ac
[0m13:02:50.430595 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Product_ID__varchar.a0985f9994' to be skipped because of status 'error'.  Reason: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:02:50.430595 [info ] [Thread-1 (]: 16 of 20 START test source_test_data_type_sqlserver_ecommerce_Purchase_Date__date  [RUN]
[0m13:02:50.430595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Product_ID__varchar.a0985f9994, now test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Purchase_Date__date.74c7a7d3ac)
[0m13:02:50.430595 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Purchase_Date__date.74c7a7d3ac
[0m13:02:50.446210 [debug] [Thread-1 (]: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:02:50.446210 [error] [Thread-1 (]: 16 of 20 ERROR source_test_data_type_sqlserver_ecommerce_Purchase_Date__date ... [[31mERROR[0m in 0.02s]
[0m13:02:50.446210 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Purchase_Date__date.74c7a7d3ac
[0m13:02:50.446210 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_User_ID__varchar.f0bf190fef
[0m13:02:50.446210 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Purchase_Date__date.74c7a7d3ac' to be skipped because of status 'error'.  Reason: Compilation Error in test source_test_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:02:50.446210 [info ] [Thread-1 (]: 17 of 20 START test source_test_data_type_sqlserver_ecommerce_User_ID__varchar . [RUN]
[0m13:02:50.461826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_Purchase_Date__date.74c7a7d3ac, now test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_User_ID__varchar.f0bf190fef)
[0m13:02:50.461826 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_User_ID__varchar.f0bf190fef
[0m13:02:50.461826 [debug] [Thread-1 (]: Compilation Error in test source_test_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:02:50.477450 [error] [Thread-1 (]: 17 of 20 ERROR source_test_data_type_sqlserver_ecommerce_User_ID__varchar ...... [[31mERROR[0m in 0.02s]
[0m13:02:50.477450 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_User_ID__varchar.f0bf190fef
[0m13:02:50.477450 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_User_ID__varchar.f0bf190fef' to be skipped because of status 'error'.  Reason: Compilation Error in test source_test_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:02:50.477450 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce
[0m13:02:50.477450 [info ] [Thread-1 (]: 18 of 20 SKIP relation dbo.src_ecommerce ....................................... [[33mSKIP[0m]
[0m13:02:50.477450 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce
[0m13:02:50.477450 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce_datatypes
[0m13:02:50.477450 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.src_ecommerce' to be skipped because of status 'skipped'. 
[0m13:02:50.494405 [info ] [Thread-1 (]: 19 of 20 SKIP relation dbo.src_ecommerce_datatypes ............................. [[33mSKIP[0m]
[0m13:02:50.497434 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce_datatypes
[0m13:02:50.499425 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.stg_ecommerce
[0m13:02:50.500410 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.src_ecommerce_datatypes' to be skipped because of status 'skipped'. 
[0m13:02:50.502434 [info ] [Thread-1 (]: 20 of 20 SKIP relation dbo.stg_ecommerce ....................................... [[33mSKIP[0m]
[0m13:02:50.504399 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.stg_ecommerce
[0m13:02:50.506415 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.stg_ecommerce' to be skipped because of status 'skipped'. 
[0m13:02:50.509946 [debug] [MainThread]: On master: COMMIT
[0m13:02:50.509946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:02:50.509946 [debug] [MainThread]: Connection 'list_my_db' was properly closed.
[0m13:02:50.509946 [debug] [MainThread]: Connection 'list_my_db_dbo' was properly closed.
[0m13:02:50.509946 [debug] [MainThread]: Connection 'test.dbt_databricks_cicd.source_test_data_type_sqlserver_ecommerce_User_ID__varchar.f0bf190fef' was properly closed.
[0m13:02:50.509946 [info ] [MainThread]: 
[0m13:02:50.509946 [info ] [MainThread]: Finished running 17 data tests, 3 view models in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m13:02:50.509946 [debug] [MainThread]: Command end result
[0m13:02:50.588078 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m13:02:50.604847 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m13:02:50.617904 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m13:02:50.617904 [info ] [MainThread]: 
[0m13:02:50.617904 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m13:02:50.617904 [info ] [MainThread]: 
[0m13:02:50.617904 [error] [MainThread]: [31mFailure in test source_test_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:02:50.617904 [error] [MainThread]:   Compilation Error in test source_test_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:02:50.617904 [info ] [MainThread]: 
[0m13:02:50.617904 [error] [MainThread]: [31mFailure in test source_test_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:02:50.617904 [error] [MainThread]:   Compilation Error in test source_test_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:02:50.617904 [info ] [MainThread]: 
[0m13:02:50.633532 [error] [MainThread]: [31mFailure in test source_test_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:02:50.633532 [error] [MainThread]:   Compilation Error in test source_test_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:02:50.633532 [info ] [MainThread]: 
[0m13:02:50.633532 [error] [MainThread]: [31mFailure in test source_test_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:02:50.633532 [error] [MainThread]:   Compilation Error in test source_test_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:02:50.633532 [info ] [MainThread]: 
[0m13:02:50.633532 [error] [MainThread]: [31mFailure in test source_test_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:02:50.633532 [error] [MainThread]:   Compilation Error in test source_test_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:02:50.633532 [info ] [MainThread]: 
[0m13:02:50.649194 [error] [MainThread]: [31mFailure in test source_test_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:02:50.649194 [error] [MainThread]:   Compilation Error in test source_test_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:02:50.649194 [info ] [MainThread]: 
[0m13:02:50.649194 [error] [MainThread]: [31mFailure in test source_test_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:02:50.649194 [error] [MainThread]:   Compilation Error in test source_test_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:02:50.649194 [info ] [MainThread]: 
[0m13:02:50.649194 [error] [MainThread]: [31mFailure in test source_test_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:02:50.664794 [error] [MainThread]:   Compilation Error in test source_test_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:02:50.664794 [info ] [MainThread]: 
[0m13:02:50.664794 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=8 SKIP=3 NO-OP=0 TOTAL=20
[0m13:02:50.664794 [debug] [MainThread]: Command `dbt build` failed at 13:02:50.664794 after 4.35 seconds
[0m13:02:50.664794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276D3AB3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276DA502A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276DA503210>]}
[0m13:02:50.664794 [debug] [MainThread]: Flushing usage events
[0m13:02:51.274206 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:04:09.945151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B271FD7E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B271FD75D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B271FD7F50>]}


============================== 13:04:09.960774 | 2b1fe091-bfe5-47a9-9234-f1f8592b19a0 ==============================
[0m13:04:09.960774 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:04:09.960774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --target sqlserver', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:04:10.977928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b1fe091-bfe5-47a9-9234-f1f8592b19a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B273865B90>]}
[0m13:04:11.087200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b1fe091-bfe5-47a9-9234-f1f8592b19a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B270F31D50>]}
[0m13:04:11.087200 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m13:04:11.852722 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m13:04:12.367290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:04:12.367290 [debug] [MainThread]: Partial parsing: updated file: dbt_databricks_cicd://dbt_databricks_cicd/models\raw\sqlserver\schema.yml
[0m13:04:13.382923 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m13:04:13.403367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b1fe091-bfe5-47a9-9234-f1f8592b19a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B273E65DD0>]}
[0m13:04:13.570913 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m13:04:13.570913 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m13:04:13.649247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b1fe091-bfe5-47a9-9234-f1f8592b19a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B274397E50>]}
[0m13:04:13.664876 [info ] [MainThread]: Found 3 models, 17 data tests, 1 source, 626 macros
[0m13:04:13.664876 [info ] [MainThread]: 
[0m13:04:13.664876 [info ] [MainThread]: Concurrency: 1 threads (target='sqlserver')
[0m13:04:13.664876 [info ] [MainThread]: 
[0m13:04:13.664876 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m13:04:13.680501 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db'
[0m13:04:13.727376 [debug] [ThreadPool]: dbt-sqlserver
[0m13:04:13.727376 [debug] [ThreadPool]: Using sqlserver connection "list_my_db"
[0m13:04:13.727376 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db"} */
USE [my_db];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m13:04:13.727376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:13.727376 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:04:13.852603 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m13:04:13.856601 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:04:13.859601 [debug] [ThreadPool]: On list_my_db: Close
[0m13:04:13.862601 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db_dbo'
[0m13:04:13.868659 [debug] [ThreadPool]: dbt-sqlserver
[0m13:04:13.868659 [debug] [ThreadPool]: Using sqlserver connection "list_my_db_dbo"
[0m13:04:13.868659 [debug] [ThreadPool]: On list_my_db_dbo: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db_dbo"} */
USE [my_db];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m13:04:13.868659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:13.868659 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:04:13.868659 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m13:04:13.915542 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:04:13.915542 [debug] [ThreadPool]: On list_my_db_dbo: ROLLBACK
[0m13:04:13.915542 [debug] [ThreadPool]: On list_my_db_dbo: Close
[0m13:04:13.915542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b1fe091-bfe5-47a9-9234-f1f8592b19a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2740BDAD0>]}
[0m13:04:13.915542 [debug] [MainThread]: On master: COMMIT
[0m13:04:13.931164 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:04:13.931164 [info ] [Thread-1 (]: 1 of 20 START test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [RUN]
[0m13:04:13.931164 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8'
[0m13:04:13.931164 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:04:13.946809 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m13:04:13.946809 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:04:13.993346 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m13:04:13.993346 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m13:04:13.993346 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_18764]
   as 
    
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from "my_db"."dbo"."ecommerce"
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    ''Credit Card'',''Net Banking'',''UPI'',''Debit Card'',''Cash on Delivery''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_18764]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_18764]
  ;')
[0m13:04:13.993346 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:04:13.993346 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:04:14.008922 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:04:14.024551 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:04:14.024551 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: ROLLBACK
[0m13:04:14.024551 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: Close
[0m13:04:14.024551 [info ] [Thread-1 (]: 1 of 20 PASS source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [[32mPASS[0m in 0.09s]
[0m13:04:14.024551 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:04:14.040179 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m13:04:14.040179 [info ] [Thread-1 (]: 2 of 20 START test source_data_type_sqlserver_ecommerce_Category__varchar ...... [RUN]
[0m13:04:14.040179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e)
[0m13:04:14.040179 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m13:04:14.055802 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:04:14.055802 [error] [Thread-1 (]: 2 of 20 ERROR source_data_type_sqlserver_ecommerce_Category__varchar ........... [[31mERROR[0m in 0.02s]
[0m13:04:14.055802 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m13:04:14.055802 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m13:04:14.055802 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:04:14.055802 [info ] [Thread-1 (]: 3 of 20 START test source_data_type_sqlserver_ecommerce_Discount__int .......... [RUN]
[0m13:04:14.073774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21)
[0m13:04:14.074774 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m13:04:14.085887 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:04:14.085887 [error] [Thread-1 (]: 3 of 20 ERROR source_data_type_sqlserver_ecommerce_Discount__int ............... [[31mERROR[0m in 0.01s]
[0m13:04:14.085887 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m13:04:14.085887 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m13:04:14.085887 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:04:14.085887 [info ] [Thread-1 (]: 4 of 20 START test source_data_type_sqlserver_ecommerce_Final_Price__float ..... [RUN]
[0m13:04:14.085887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0)
[0m13:04:14.085887 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m13:04:14.101523 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:04:14.101523 [error] [Thread-1 (]: 4 of 20 ERROR source_data_type_sqlserver_ecommerce_Final_Price__float .......... [[31mERROR[0m in 0.02s]
[0m13:04:14.101523 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m13:04:14.101523 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m13:04:14.117140 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:04:14.117140 [info ] [Thread-1 (]: 5 of 20 START test source_data_type_sqlserver_ecommerce_Payment_Method__varchar  [RUN]
[0m13:04:14.117140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261)
[0m13:04:14.117140 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m13:04:14.132776 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:04:14.132776 [error] [Thread-1 (]: 5 of 20 ERROR source_data_type_sqlserver_ecommerce_Payment_Method__varchar ..... [[31mERROR[0m in 0.02s]
[0m13:04:14.132776 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m13:04:14.132776 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m13:04:14.132776 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:04:14.132776 [info ] [Thread-1 (]: 6 of 20 START test source_data_type_sqlserver_ecommerce_Price__float ........... [RUN]
[0m13:04:14.132776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5)
[0m13:04:14.132776 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m13:04:14.148398 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:04:14.148398 [error] [Thread-1 (]: 6 of 20 ERROR source_data_type_sqlserver_ecommerce_Price__float ................ [[31mERROR[0m in 0.02s]
[0m13:04:14.148398 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m13:04:14.164022 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:04:14.148398 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m13:04:14.164022 [info ] [Thread-1 (]: 7 of 20 START test source_data_type_sqlserver_ecommerce_Product_ID__varchar .... [RUN]
[0m13:04:14.164022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db)
[0m13:04:14.164022 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m13:04:14.179670 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:04:14.179670 [error] [Thread-1 (]: 7 of 20 ERROR source_data_type_sqlserver_ecommerce_Product_ID__varchar ......... [[31mERROR[0m in 0.02s]
[0m13:04:14.179670 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m13:04:14.179670 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m13:04:14.179670 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:04:14.179670 [info ] [Thread-1 (]: 8 of 20 START test source_data_type_sqlserver_ecommerce_Purchase_Date__date .... [RUN]
[0m13:04:14.179670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f)
[0m13:04:14.179670 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m13:04:14.195264 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:04:14.195264 [error] [Thread-1 (]: 8 of 20 ERROR source_data_type_sqlserver_ecommerce_Purchase_Date__date ......... [[31mERROR[0m in 0.02s]
[0m13:04:14.195264 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m13:04:14.210893 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m13:04:14.210893 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:04:14.210893 [info ] [Thread-1 (]: 9 of 20 START test source_data_type_sqlserver_ecommerce_User_ID__varchar ....... [RUN]
[0m13:04:14.210893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14)
[0m13:04:14.210893 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m13:04:14.226561 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:04:14.226561 [error] [Thread-1 (]: 9 of 20 ERROR source_data_type_sqlserver_ecommerce_User_ID__varchar ............ [[31mERROR[0m in 0.02s]
[0m13:04:14.226561 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m13:04:14.226561 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:04:14.226561 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:04:14.226561 [info ] [Thread-1 (]: 10 of 20 START test source_not_null_sqlserver_ecommerce_Category ............... [RUN]
[0m13:04:14.226561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407)
[0m13:04:14.242138 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:04:14.257814 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m13:04:14.257814 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:04:14.257814 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m13:04:14.257814 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m13:04:14.257814 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_3050]
   as 
    
    
    



select Category
from "my_db"."dbo"."ecommerce"
where Category is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_3050]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_3050]
  ;')
[0m13:04:14.274626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:14.276628 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:04:14.278632 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:04:14.290631 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:04:14.293630 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: ROLLBACK
[0m13:04:14.294625 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: Close
[0m13:04:14.295632 [info ] [Thread-1 (]: 10 of 20 PASS source_not_null_sqlserver_ecommerce_Category ..................... [[32mPASS[0m in 0.07s]
[0m13:04:14.298633 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:04:14.299632 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:04:14.300630 [info ] [Thread-1 (]: 11 of 20 START test source_not_null_sqlserver_ecommerce_Discount ............... [RUN]
[0m13:04:14.303628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f)
[0m13:04:14.304816 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:04:14.312859 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m13:04:14.315863 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:04:14.320878 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m13:04:14.320878 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m13:04:14.320878 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_5983]
   as 
    
    
    



select Discount
from "my_db"."dbo"."ecommerce"
where Discount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_5983]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_5983]
  ;')
[0m13:04:14.320878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:14.320878 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:04:14.320878 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:04:14.336505 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:04:14.336505 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: ROLLBACK
[0m13:04:14.336505 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: Close
[0m13:04:14.336505 [info ] [Thread-1 (]: 11 of 20 PASS source_not_null_sqlserver_ecommerce_Discount ..................... [[32mPASS[0m in 0.03s]
[0m13:04:14.336505 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:04:14.336505 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:04:14.352136 [info ] [Thread-1 (]: 12 of 20 START test source_not_null_sqlserver_ecommerce_Final_Price ............ [RUN]
[0m13:04:14.352136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d)
[0m13:04:14.352136 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:04:14.352136 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m13:04:14.352136 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:04:14.367759 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m13:04:14.367759 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m13:04:14.367759 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_8140]
   as 
    
    
    



select Final_Price
from "my_db"."dbo"."ecommerce"
where Final_Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_8140]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_8140]
  ;')
[0m13:04:14.367759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:14.383381 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:04:14.383381 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:04:14.400298 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:04:14.403335 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: ROLLBACK
[0m13:04:14.405299 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: Close
[0m13:04:14.406300 [info ] [Thread-1 (]: 12 of 20 PASS source_not_null_sqlserver_ecommerce_Final_Price .................. [[32mPASS[0m in 0.05s]
[0m13:04:14.409303 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:04:14.410302 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:04:14.411300 [info ] [Thread-1 (]: 13 of 20 START test source_not_null_sqlserver_ecommerce_Payment_Method ......... [RUN]
[0m13:04:14.413996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae)
[0m13:04:14.415279 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:04:14.415279 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m13:04:14.415279 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:04:14.430888 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m13:04:14.430888 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m13:04:14.430888 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_9346]
   as 
    
    
    



select Payment_Method
from "my_db"."dbo"."ecommerce"
where Payment_Method is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_9346]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_9346]
  ;')
[0m13:04:14.430888 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:14.430888 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:04:14.430888 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:04:14.446540 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:04:14.446540 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: ROLLBACK
[0m13:04:14.446540 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: Close
[0m13:04:14.446540 [info ] [Thread-1 (]: 13 of 20 PASS source_not_null_sqlserver_ecommerce_Payment_Method ............... [[32mPASS[0m in 0.03s]
[0m13:04:14.446540 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:04:14.462137 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:04:14.462137 [info ] [Thread-1 (]: 14 of 20 START test source_not_null_sqlserver_ecommerce_Price .................. [RUN]
[0m13:04:14.462137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01)
[0m13:04:14.462137 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:04:14.462137 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m13:04:14.462137 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:04:14.477760 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m13:04:14.477760 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m13:04:14.477760 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_2758]
   as 
    
    
    



select Price
from "my_db"."dbo"."ecommerce"
where Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_2758]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_2758]
  ;')
[0m13:04:14.477760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:14.493387 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:04:14.493387 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:04:14.493387 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:04:14.509355 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: ROLLBACK
[0m13:04:14.510356 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: Close
[0m13:04:14.513354 [info ] [Thread-1 (]: 14 of 20 PASS source_not_null_sqlserver_ecommerce_Price ........................ [[32mPASS[0m in 0.05s]
[0m13:04:14.515353 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:04:14.516352 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:04:14.518353 [info ] [Thread-1 (]: 15 of 20 START test source_not_null_sqlserver_ecommerce_Product_ID ............. [RUN]
[0m13:04:14.519353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff)
[0m13:04:14.520353 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:04:14.524459 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m13:04:14.524459 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:04:14.524459 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m13:04:14.540089 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m13:04:14.540089 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_2742]
   as 
    
    
    



select Product_ID
from "my_db"."dbo"."ecommerce"
where Product_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_2742]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_2742]
  ;')
[0m13:04:14.540089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:14.540089 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:04:14.540089 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:04:14.555708 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:04:14.555708 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: ROLLBACK
[0m13:04:14.555708 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: Close
[0m13:04:14.555708 [info ] [Thread-1 (]: 15 of 20 PASS source_not_null_sqlserver_ecommerce_Product_ID ................... [[32mPASS[0m in 0.04s]
[0m13:04:14.555708 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:04:14.555708 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:04:14.555708 [info ] [Thread-1 (]: 16 of 20 START test source_not_null_sqlserver_ecommerce_Purchase_Date .......... [RUN]
[0m13:04:14.555708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17)
[0m13:04:14.555708 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:04:14.571336 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m13:04:14.571336 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:04:14.571336 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m13:04:14.587009 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m13:04:14.587009 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_1984]
   as 
    
    
    



select Purchase_Date
from "my_db"."dbo"."ecommerce"
where Purchase_Date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_1984]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_1984]
  ;')
[0m13:04:14.587009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:14.587009 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:04:14.587009 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:04:14.602627 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:04:14.602627 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: ROLLBACK
[0m13:04:14.602627 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: Close
[0m13:04:14.602627 [info ] [Thread-1 (]: 16 of 20 PASS source_not_null_sqlserver_ecommerce_Purchase_Date ................ [[32mPASS[0m in 0.05s]
[0m13:04:14.602627 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:04:14.602627 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:04:14.602627 [info ] [Thread-1 (]: 17 of 20 START test source_not_null_sqlserver_ecommerce_User_ID ................ [RUN]
[0m13:04:14.619434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc)
[0m13:04:14.620475 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:04:14.628474 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m13:04:14.631446 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:04:14.633553 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m13:04:14.633553 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m13:04:14.633553 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_17656]
   as 
    
    
    



select User_ID
from "my_db"."dbo"."ecommerce"
where User_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_17656]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_17656]
  ;')
[0m13:04:14.633553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:14.633553 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:04:14.633553 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:04:14.649207 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:04:14.649207 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: ROLLBACK
[0m13:04:14.649207 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: Close
[0m13:04:14.649207 [info ] [Thread-1 (]: 17 of 20 PASS source_not_null_sqlserver_ecommerce_User_ID ...................... [[32mPASS[0m in 0.03s]
[0m13:04:14.664845 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:04:14.664845 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce
[0m13:04:14.664845 [info ] [Thread-1 (]: 18 of 20 SKIP relation dbo.src_ecommerce ....................................... [[33mSKIP[0m]
[0m13:04:14.664845 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce
[0m13:04:14.664845 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce_datatypes
[0m13:04:14.664845 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.src_ecommerce' to be skipped because of status 'skipped'. 
[0m13:04:14.664845 [info ] [Thread-1 (]: 19 of 20 SKIP relation dbo.src_ecommerce_datatypes ............................. [[33mSKIP[0m]
[0m13:04:14.664845 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce_datatypes
[0m13:04:14.664845 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.stg_ecommerce
[0m13:04:14.664845 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.src_ecommerce_datatypes' to be skipped because of status 'skipped'. 
[0m13:04:14.664845 [info ] [Thread-1 (]: 20 of 20 SKIP relation dbo.stg_ecommerce ....................................... [[33mSKIP[0m]
[0m13:04:14.680457 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.stg_ecommerce
[0m13:04:14.680457 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.stg_ecommerce' to be skipped because of status 'skipped'. 
[0m13:04:14.680457 [debug] [MainThread]: On master: COMMIT
[0m13:04:14.680457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:04:14.680457 [debug] [MainThread]: Connection 'list_my_db' was properly closed.
[0m13:04:14.680457 [debug] [MainThread]: Connection 'list_my_db_dbo' was properly closed.
[0m13:04:14.696062 [debug] [MainThread]: Connection 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc' was properly closed.
[0m13:04:14.696062 [info ] [MainThread]: 
[0m13:04:14.696062 [info ] [MainThread]: Finished running 17 data tests, 3 view models in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m13:04:14.718125 [debug] [MainThread]: Command end result
[0m13:04:14.868323 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m13:04:14.868323 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m13:04:14.883955 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m13:04:14.883955 [info ] [MainThread]: 
[0m13:04:14.883955 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m13:04:14.883955 [info ] [MainThread]: 
[0m13:04:14.883955 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:04:14.883955 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:04:14.899573 [info ] [MainThread]: 
[0m13:04:14.899573 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:04:14.899573 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:04:14.899573 [info ] [MainThread]: 
[0m13:04:14.899573 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:04:14.899573 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:04:14.899573 [info ] [MainThread]: 
[0m13:04:14.914143 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:04:14.917081 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:04:14.919205 [info ] [MainThread]: 
[0m13:04:14.920833 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:04:14.921827 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:04:14.923789 [info ] [MainThread]: 
[0m13:04:14.924830 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:04:14.926800 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:04:14.927575 [info ] [MainThread]: 
[0m13:04:14.927575 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:04:14.927575 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:04:14.927575 [info ] [MainThread]: 
[0m13:04:14.927575 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:04:14.927575 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  'test_data_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:04:14.927575 [info ] [MainThread]: 
[0m13:04:14.943240 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=8 SKIP=3 NO-OP=0 TOTAL=20
[0m13:04:14.943240 [debug] [MainThread]: Command `dbt build` failed at 13:04:14.943240 after 5.14 seconds
[0m13:04:14.943240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B26B4E3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B26B7411D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B26B7410D0>]}
[0m13:04:14.943240 [debug] [MainThread]: Flushing usage events
[0m13:04:15.548107 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:20:01.571723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002026390B110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002026390BA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202638B1AD0>]}


============================== 13:20:01.571723 | 54eb9ad3-bcf6-4586-b680-20e9429d5c16 ==============================
[0m13:20:01.571723 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:20:01.588539 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt build --target sqlserver', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:20:02.692640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54eb9ad3-bcf6-4586-b680-20e9429d5c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020262FE3F50>]}
[0m13:20:02.820377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54eb9ad3-bcf6-4586-b680-20e9429d5c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020262822050>]}
[0m13:20:02.820377 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m13:20:03.586143 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m13:20:04.164919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:20:04.164919 [debug] [MainThread]: Partial parsing: updated file: dbt_databricks_cicd://macros\test_data_type.sql
[0m13:20:04.383235 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m13:20:04.414490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54eb9ad3-bcf6-4586-b680-20e9429d5c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020262848D50>]}
[0m13:20:04.617384 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m13:20:04.617384 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m13:20:04.758276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54eb9ad3-bcf6-4586-b680-20e9429d5c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202656F0790>]}
[0m13:20:04.758276 [info ] [MainThread]: Found 3 models, 17 data tests, 1 source, 626 macros
[0m13:20:04.758276 [info ] [MainThread]: 
[0m13:20:04.758276 [info ] [MainThread]: Concurrency: 1 threads (target='sqlserver')
[0m13:20:04.758276 [info ] [MainThread]: 
[0m13:20:04.758276 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m13:20:04.789527 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db'
[0m13:20:04.820775 [debug] [ThreadPool]: dbt-sqlserver
[0m13:20:04.820775 [debug] [ThreadPool]: Using sqlserver connection "list_my_db"
[0m13:20:04.820775 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db"} */
USE [my_db];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m13:20:04.820775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:04.836404 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:04.945823 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m13:20:04.961445 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:20:04.961445 [debug] [ThreadPool]: On list_my_db: Close
[0m13:20:04.961445 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db_dbo'
[0m13:20:04.977072 [debug] [ThreadPool]: dbt-sqlserver
[0m13:20:04.977072 [debug] [ThreadPool]: Using sqlserver connection "list_my_db_dbo"
[0m13:20:04.977072 [debug] [ThreadPool]: On list_my_db_dbo: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db_dbo"} */
USE [my_db];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m13:20:04.977072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:04.977072 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:04.977072 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m13:20:05.024575 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:20:05.024575 [debug] [ThreadPool]: On list_my_db_dbo: ROLLBACK
[0m13:20:05.024575 [debug] [ThreadPool]: On list_my_db_dbo: Close
[0m13:20:05.024575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54eb9ad3-bcf6-4586-b680-20e9429d5c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020262FC44D0>]}
[0m13:20:05.024575 [debug] [MainThread]: On master: COMMIT
[0m13:20:05.040201 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:20:05.040201 [info ] [Thread-1 (]: 1 of 20 START test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [RUN]
[0m13:20:05.040201 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8'
[0m13:20:05.040201 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:20:05.071469 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m13:20:05.071469 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:20:05.122536 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m13:20:05.125502 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m13:20:05.126498 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_11471]
   as 
    
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from "my_db"."dbo"."ecommerce"
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    ''Credit Card'',''Net Banking'',''UPI'',''Debit Card'',''Cash on Delivery''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_11471]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_11471]
  ;')
[0m13:20:05.127540 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:20:05.128536 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:05.134189 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:20:05.149862 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:05.149862 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: ROLLBACK
[0m13:20:05.149862 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: Close
[0m13:20:05.149862 [info ] [Thread-1 (]: 1 of 20 PASS source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [[32mPASS[0m in 0.11s]
[0m13:20:05.165441 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:20:05.165441 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m13:20:05.165441 [info ] [Thread-1 (]: 2 of 20 START test source_data_type_sqlserver_ecommerce_Category__varchar ...... [RUN]
[0m13:20:05.165441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e)
[0m13:20:05.165441 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m13:20:05.199963 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  macro 'dbt_macro__test_data_type' takes no keyword argument 'expected'
[0m13:20:05.200925 [error] [Thread-1 (]: 2 of 20 ERROR source_data_type_sqlserver_ecommerce_Category__varchar ........... [[31mERROR[0m in 0.04s]
[0m13:20:05.202930 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m13:20:05.204931 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m13:20:05.204931 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  macro 'dbt_macro__test_data_type' takes no keyword argument 'expected'.
[0m13:20:05.206927 [info ] [Thread-1 (]: 3 of 20 START test source_data_type_sqlserver_ecommerce_Discount__int .......... [RUN]
[0m13:20:05.209934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21)
[0m13:20:05.213126 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m13:20:05.227095 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  macro 'dbt_macro__test_data_type' takes no keyword argument 'expected'
[0m13:20:05.228094 [error] [Thread-1 (]: 3 of 20 ERROR source_data_type_sqlserver_ecommerce_Discount__int ............... [[31mERROR[0m in 0.02s]
[0m13:20:05.230515 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m13:20:05.232444 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m13:20:05.233443 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  macro 'dbt_macro__test_data_type' takes no keyword argument 'expected'.
[0m13:20:05.234117 [info ] [Thread-1 (]: 4 of 20 START test source_data_type_sqlserver_ecommerce_Final_Price__float ..... [RUN]
[0m13:20:05.236133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0)
[0m13:20:05.238134 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m13:20:05.242280 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  macro 'dbt_macro__test_data_type' takes no keyword argument 'expected'
[0m13:20:05.242280 [error] [Thread-1 (]: 4 of 20 ERROR source_data_type_sqlserver_ecommerce_Final_Price__float .......... [[31mERROR[0m in 0.01s]
[0m13:20:05.242280 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m13:20:05.242280 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m13:20:05.242280 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  macro 'dbt_macro__test_data_type' takes no keyword argument 'expected'.
[0m13:20:05.257995 [info ] [Thread-1 (]: 5 of 20 START test source_data_type_sqlserver_ecommerce_Payment_Method__varchar  [RUN]
[0m13:20:05.257995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261)
[0m13:20:05.257995 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m13:20:05.257995 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  macro 'dbt_macro__test_data_type' takes no keyword argument 'expected'
[0m13:20:05.273533 [error] [Thread-1 (]: 5 of 20 ERROR source_data_type_sqlserver_ecommerce_Payment_Method__varchar ..... [[31mERROR[0m in 0.02s]
[0m13:20:05.273533 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m13:20:05.273533 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m13:20:05.273533 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  macro 'dbt_macro__test_data_type' takes no keyword argument 'expected'.
[0m13:20:05.273533 [info ] [Thread-1 (]: 6 of 20 START test source_data_type_sqlserver_ecommerce_Price__float ........... [RUN]
[0m13:20:05.273533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5)
[0m13:20:05.273533 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m13:20:05.289160 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  macro 'dbt_macro__test_data_type' takes no keyword argument 'expected'
[0m13:20:05.289160 [error] [Thread-1 (]: 6 of 20 ERROR source_data_type_sqlserver_ecommerce_Price__float ................ [[31mERROR[0m in 0.02s]
[0m13:20:05.289160 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m13:20:05.289160 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m13:20:05.289160 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  macro 'dbt_macro__test_data_type' takes no keyword argument 'expected'.
[0m13:20:05.304783 [info ] [Thread-1 (]: 7 of 20 START test source_data_type_sqlserver_ecommerce_Product_ID__varchar .... [RUN]
[0m13:20:05.304783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db)
[0m13:20:05.304783 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m13:20:05.320412 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  macro 'dbt_macro__test_data_type' takes no keyword argument 'expected'
[0m13:20:05.320412 [error] [Thread-1 (]: 7 of 20 ERROR source_data_type_sqlserver_ecommerce_Product_ID__varchar ......... [[31mERROR[0m in 0.02s]
[0m13:20:05.320412 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m13:20:05.320412 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m13:20:05.320412 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  macro 'dbt_macro__test_data_type' takes no keyword argument 'expected'.
[0m13:20:05.320412 [info ] [Thread-1 (]: 8 of 20 START test source_data_type_sqlserver_ecommerce_Purchase_Date__date .... [RUN]
[0m13:20:05.320412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f)
[0m13:20:05.320412 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m13:20:05.336033 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  macro 'dbt_macro__test_data_type' takes no keyword argument 'expected'
[0m13:20:05.336033 [error] [Thread-1 (]: 8 of 20 ERROR source_data_type_sqlserver_ecommerce_Purchase_Date__date ......... [[31mERROR[0m in 0.02s]
[0m13:20:05.336033 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m13:20:05.351661 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m13:20:05.351661 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  macro 'dbt_macro__test_data_type' takes no keyword argument 'expected'.
[0m13:20:05.351661 [info ] [Thread-1 (]: 9 of 20 START test source_data_type_sqlserver_ecommerce_User_ID__varchar ....... [RUN]
[0m13:20:05.351661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14)
[0m13:20:05.351661 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m13:20:05.367288 [debug] [Thread-1 (]: Compilation Error in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  macro 'dbt_macro__test_data_type' takes no keyword argument 'expected'
[0m13:20:05.367288 [error] [Thread-1 (]: 9 of 20 ERROR source_data_type_sqlserver_ecommerce_User_ID__varchar ............ [[31mERROR[0m in 0.02s]
[0m13:20:05.367288 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m13:20:05.367288 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:20:05.367288 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14' to be skipped because of status 'error'.  Reason: Compilation Error in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  macro 'dbt_macro__test_data_type' takes no keyword argument 'expected'.
[0m13:20:05.367288 [info ] [Thread-1 (]: 10 of 20 START test source_not_null_sqlserver_ecommerce_Category ............... [RUN]
[0m13:20:05.382907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407)
[0m13:20:05.382907 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:20:05.398540 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m13:20:05.398540 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:20:05.398540 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m13:20:05.398540 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m13:20:05.414159 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_5430]
   as 
    
    
    



select Category
from "my_db"."dbo"."ecommerce"
where Category is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_5430]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_5430]
  ;')
[0m13:20:05.414159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:05.414159 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:05.414159 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:20:05.430982 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:05.434980 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: ROLLBACK
[0m13:20:05.435984 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: Close
[0m13:20:05.437982 [info ] [Thread-1 (]: 10 of 20 PASS source_not_null_sqlserver_ecommerce_Category ..................... [[32mPASS[0m in 0.05s]
[0m13:20:05.439984 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:20:05.442000 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:20:05.442988 [info ] [Thread-1 (]: 11 of 20 START test source_not_null_sqlserver_ecommerce_Discount ............... [RUN]
[0m13:20:05.444981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f)
[0m13:20:05.446983 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:20:05.453981 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m13:20:05.455983 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:20:05.462045 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m13:20:05.462045 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m13:20:05.462045 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_4920]
   as 
    
    
    



select Discount
from "my_db"."dbo"."ecommerce"
where Discount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_4920]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_4920]
  ;')
[0m13:20:05.462045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:05.462045 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:05.462045 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:20:05.477675 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:05.477675 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: ROLLBACK
[0m13:20:05.477675 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: Close
[0m13:20:05.477675 [info ] [Thread-1 (]: 11 of 20 PASS source_not_null_sqlserver_ecommerce_Discount ..................... [[32mPASS[0m in 0.03s]
[0m13:20:05.477675 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:20:05.477675 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:20:05.493302 [info ] [Thread-1 (]: 12 of 20 START test source_not_null_sqlserver_ecommerce_Final_Price ............ [RUN]
[0m13:20:05.493302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d)
[0m13:20:05.493302 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:20:05.493302 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m13:20:05.508919 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:20:05.508919 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m13:20:05.508919 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m13:20:05.508919 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_11879]
   as 
    
    
    



select Final_Price
from "my_db"."dbo"."ecommerce"
where Final_Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_11879]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_11879]
  ;')
[0m13:20:05.508919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:05.508919 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:05.508919 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:20:05.524550 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:05.524550 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: ROLLBACK
[0m13:20:05.524550 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: Close
[0m13:20:05.540171 [info ] [Thread-1 (]: 12 of 20 PASS source_not_null_sqlserver_ecommerce_Final_Price .................. [[32mPASS[0m in 0.03s]
[0m13:20:05.540171 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:20:05.540171 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:20:05.540171 [info ] [Thread-1 (]: 13 of 20 START test source_not_null_sqlserver_ecommerce_Payment_Method ......... [RUN]
[0m13:20:05.540171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae)
[0m13:20:05.540171 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:20:05.557036 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m13:20:05.560038 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:20:05.566068 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m13:20:05.568074 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m13:20:05.570035 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_2118]
   as 
    
    
    



select Payment_Method
from "my_db"."dbo"."ecommerce"
where Payment_Method is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_2118]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_2118]
  ;')
[0m13:20:05.571171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:05.571171 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:05.571171 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:20:05.586505 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:05.589870 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: ROLLBACK
[0m13:20:05.592920 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: Close
[0m13:20:05.594396 [info ] [Thread-1 (]: 13 of 20 PASS source_not_null_sqlserver_ecommerce_Payment_Method ............... [[32mPASS[0m in 0.05s]
[0m13:20:05.596409 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:20:05.598400 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:20:05.600283 [info ] [Thread-1 (]: 14 of 20 START test source_not_null_sqlserver_ecommerce_Price .................. [RUN]
[0m13:20:05.601323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01)
[0m13:20:05.603321 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:20:05.618363 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m13:20:05.620399 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:20:05.629699 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m13:20:05.632251 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m13:20:05.633259 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_13008]
   as 
    
    
    



select Price
from "my_db"."dbo"."ecommerce"
where Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_13008]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_13008]
  ;')
[0m13:20:05.634259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:05.636257 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:05.637257 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:20:05.653326 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:05.657045 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: ROLLBACK
[0m13:20:05.659424 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: Close
[0m13:20:05.661356 [info ] [Thread-1 (]: 14 of 20 PASS source_not_null_sqlserver_ecommerce_Price ........................ [[32mPASS[0m in 0.06s]
[0m13:20:05.663350 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:20:05.665352 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:20:05.666355 [info ] [Thread-1 (]: 15 of 20 START test source_not_null_sqlserver_ecommerce_Product_ID ............. [RUN]
[0m13:20:05.669387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff)
[0m13:20:05.671385 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:20:05.695444 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m13:20:05.698384 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:20:05.711395 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m13:20:05.714384 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m13:20:05.717387 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_17277]
   as 
    
    
    



select Product_ID
from "my_db"."dbo"."ecommerce"
where Product_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_17277]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_17277]
  ;')
[0m13:20:05.719384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:05.728738 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:05.731736 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:20:05.771773 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:05.791555 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: ROLLBACK
[0m13:20:05.793553 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: Close
[0m13:20:05.796555 [info ] [Thread-1 (]: 15 of 20 PASS source_not_null_sqlserver_ecommerce_Product_ID ................... [[32mPASS[0m in 0.13s]
[0m13:20:05.800559 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:20:05.802552 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:20:05.804557 [info ] [Thread-1 (]: 16 of 20 START test source_not_null_sqlserver_ecommerce_Purchase_Date .......... [RUN]
[0m13:20:05.808568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17)
[0m13:20:05.811553 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:20:05.820717 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m13:20:05.820717 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:20:05.836346 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m13:20:05.851969 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m13:20:05.851969 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_16979]
   as 
    
    
    



select Purchase_Date
from "my_db"."dbo"."ecommerce"
where Purchase_Date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_16979]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_16979]
  ;')
[0m13:20:05.851969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:05.851969 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:05.851969 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:20:05.867596 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:05.867596 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: ROLLBACK
[0m13:20:05.867596 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: Close
[0m13:20:05.867596 [info ] [Thread-1 (]: 16 of 20 PASS source_not_null_sqlserver_ecommerce_Purchase_Date ................ [[32mPASS[0m in 0.06s]
[0m13:20:05.867596 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:20:05.867596 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:20:05.867596 [info ] [Thread-1 (]: 17 of 20 START test source_not_null_sqlserver_ecommerce_User_ID ................ [RUN]
[0m13:20:05.867596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc)
[0m13:20:05.867596 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:20:05.883217 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m13:20:05.883217 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:20:05.900992 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m13:20:05.903004 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m13:20:05.904994 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_10071]
   as 
    
    
    



select User_ID
from "my_db"."dbo"."ecommerce"
where User_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_10071]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_10071]
  ;')
[0m13:20:05.906997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:05.909013 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:05.910990 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:20:05.920991 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:05.925002 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: ROLLBACK
[0m13:20:05.926994 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: Close
[0m13:20:05.928998 [info ] [Thread-1 (]: 17 of 20 PASS source_not_null_sqlserver_ecommerce_User_ID ...................... [[32mPASS[0m in 0.06s]
[0m13:20:05.930087 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:20:05.930087 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce
[0m13:20:05.930087 [info ] [Thread-1 (]: 18 of 20 SKIP relation dbo.src_ecommerce ....................................... [[33mSKIP[0m]
[0m13:20:05.930087 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce
[0m13:20:05.930087 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce_datatypes
[0m13:20:05.930087 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.src_ecommerce' to be skipped because of status 'skipped'. 
[0m13:20:05.930087 [info ] [Thread-1 (]: 19 of 20 SKIP relation dbo.src_ecommerce_datatypes ............................. [[33mSKIP[0m]
[0m13:20:05.930087 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce_datatypes
[0m13:20:05.930087 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.stg_ecommerce
[0m13:20:05.930087 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.src_ecommerce_datatypes' to be skipped because of status 'skipped'. 
[0m13:20:05.945713 [info ] [Thread-1 (]: 20 of 20 SKIP relation dbo.stg_ecommerce ....................................... [[33mSKIP[0m]
[0m13:20:05.945713 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.stg_ecommerce
[0m13:20:05.945713 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.stg_ecommerce' to be skipped because of status 'skipped'. 
[0m13:20:05.945713 [debug] [MainThread]: On master: COMMIT
[0m13:20:05.945713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:05.945713 [debug] [MainThread]: Connection 'list_my_db' was properly closed.
[0m13:20:05.945713 [debug] [MainThread]: Connection 'list_my_db_dbo' was properly closed.
[0m13:20:05.945713 [debug] [MainThread]: Connection 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc' was properly closed.
[0m13:20:05.961344 [info ] [MainThread]: 
[0m13:20:05.961344 [info ] [MainThread]: Finished running 17 data tests, 3 view models in 0 hours 0 minutes and 1.20 seconds (1.20s).
[0m13:20:05.961344 [debug] [MainThread]: Command end result
[0m13:20:06.040168 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m13:20:06.055797 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m13:20:06.071445 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m13:20:06.071445 [info ] [MainThread]: 
[0m13:20:06.071445 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m13:20:06.071445 [info ] [MainThread]: 
[0m13:20:06.071445 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:20:06.071445 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  macro 'dbt_macro__test_data_type' takes no keyword argument 'expected'
[0m13:20:06.071445 [info ] [MainThread]: 
[0m13:20:06.071445 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:20:06.071445 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  macro 'dbt_macro__test_data_type' takes no keyword argument 'expected'
[0m13:20:06.087043 [info ] [MainThread]: 
[0m13:20:06.087043 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:20:06.087043 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  macro 'dbt_macro__test_data_type' takes no keyword argument 'expected'
[0m13:20:06.087043 [info ] [MainThread]: 
[0m13:20:06.087043 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:20:06.087043 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  macro 'dbt_macro__test_data_type' takes no keyword argument 'expected'
[0m13:20:06.087043 [info ] [MainThread]: 
[0m13:20:06.087043 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:20:06.102708 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  macro 'dbt_macro__test_data_type' takes no keyword argument 'expected'
[0m13:20:06.102708 [info ] [MainThread]: 
[0m13:20:06.102708 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:20:06.102708 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  macro 'dbt_macro__test_data_type' takes no keyword argument 'expected'
[0m13:20:06.102708 [info ] [MainThread]: 
[0m13:20:06.102708 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:20:06.102708 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  macro 'dbt_macro__test_data_type' takes no keyword argument 'expected'
[0m13:20:06.102708 [info ] [MainThread]: 
[0m13:20:06.118332 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:20:06.118332 [error] [MainThread]:   Compilation Error in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  macro 'dbt_macro__test_data_type' takes no keyword argument 'expected'
[0m13:20:06.118332 [info ] [MainThread]: 
[0m13:20:06.118332 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=8 SKIP=3 NO-OP=0 TOTAL=20
[0m13:20:06.118332 [debug] [MainThread]: Command `dbt build` failed at 13:20:06.118332 after 4.71 seconds
[0m13:20:06.118332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002025CE43DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002025D0A0550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202656F70D0>]}
[0m13:20:06.118332 [debug] [MainThread]: Flushing usage events
[0m13:20:07.126801 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:20:37.508301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E97861D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E9784ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E9787C50>]}


============================== 13:20:37.523921 | 4901be97-075c-4e1b-a12d-12bf1ede4fcc ==============================
[0m13:20:37.523921 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:20:37.523921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --target sqlserver', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:20:38.445660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4901be97-075c-4e1b-a12d-12bf1ede4fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253EB0897D0>]}
[0m13:20:38.568124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4901be97-075c-4e1b-a12d-12bf1ede4fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E86F1F50>]}
[0m13:20:38.569129 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m13:20:39.336357 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m13:20:39.867273 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:20:39.867273 [debug] [MainThread]: Partial parsing: updated file: dbt_databricks_cicd://macros\test_data_type.sql
[0m13:20:40.087668 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m13:20:40.134550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4901be97-075c-4e1b-a12d-12bf1ede4fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E8834890>]}
[0m13:20:40.320264 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m13:20:40.320264 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m13:20:40.414123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4901be97-075c-4e1b-a12d-12bf1ede4fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E97AE210>]}
[0m13:20:40.414123 [info ] [MainThread]: Found 3 models, 17 data tests, 1 source, 626 macros
[0m13:20:40.414123 [info ] [MainThread]: 
[0m13:20:40.414123 [info ] [MainThread]: Concurrency: 1 threads (target='sqlserver')
[0m13:20:40.429727 [info ] [MainThread]: 
[0m13:20:40.429727 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m13:20:40.429727 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db'
[0m13:20:40.476618 [debug] [ThreadPool]: dbt-sqlserver
[0m13:20:40.476618 [debug] [ThreadPool]: Using sqlserver connection "list_my_db"
[0m13:20:40.476618 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db"} */
USE [my_db];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m13:20:40.476618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:40.476618 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:40.579291 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m13:20:40.583290 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:20:40.586327 [debug] [ThreadPool]: On list_my_db: Close
[0m13:20:40.590421 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db_dbo'
[0m13:20:40.601380 [debug] [ThreadPool]: dbt-sqlserver
[0m13:20:40.602381 [debug] [ThreadPool]: Using sqlserver connection "list_my_db_dbo"
[0m13:20:40.603386 [debug] [ThreadPool]: On list_my_db_dbo: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db_dbo"} */
USE [my_db];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m13:20:40.605383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:40.606382 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:40.607381 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m13:20:40.648730 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:20:40.648730 [debug] [ThreadPool]: On list_my_db_dbo: ROLLBACK
[0m13:20:40.648730 [debug] [ThreadPool]: On list_my_db_dbo: Close
[0m13:20:40.648730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4901be97-075c-4e1b-a12d-12bf1ede4fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253EB5C70D0>]}
[0m13:20:40.648730 [debug] [MainThread]: On master: COMMIT
[0m13:20:40.664355 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:20:40.664355 [info ] [Thread-1 (]: 1 of 20 START test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [RUN]
[0m13:20:40.664355 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8'
[0m13:20:40.664355 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:20:40.711231 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m13:20:40.711231 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:20:40.758108 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m13:20:40.758108 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m13:20:40.758108 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_8776]
   as 
    
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from "my_db"."dbo"."ecommerce"
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    ''Credit Card'',''Net Banking'',''UPI'',''Debit Card'',''Cash on Delivery''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_8776]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_8776]
  ;')
[0m13:20:40.758108 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:20:40.758108 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:40.773730 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:20:40.789356 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:40.789356 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: ROLLBACK
[0m13:20:40.789356 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: Close
[0m13:20:40.789356 [info ] [Thread-1 (]: 1 of 20 PASS source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [[32mPASS[0m in 0.13s]
[0m13:20:40.804983 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:20:40.804983 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m13:20:40.804983 [info ] [Thread-1 (]: 2 of 20 START test source_data_type_sqlserver_ecommerce_Category__varchar ...... [RUN]
[0m13:20:40.804983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e)
[0m13:20:40.804983 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m13:20:40.820610 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e"
[0m13:20:40.820610 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Category'
                AND data_type NOT LIKE 'varchar%'
        
  
[0m13:20:40.836232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:40.836232 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:40.836232 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:20:40.867482 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:40.867482 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e"
[0m13:20:40.867482 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m13:20:40.883109 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e"
[0m13:20:40.883109 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e"
[0m13:20:40.883109 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_6783]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_6783]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_6783]
  ;')
[0m13:20:40.898734 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:40.898734 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e: ROLLBACK
[0m13:20:40.898734 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e: Close
[0m13:20:40.898734 [error] [Thread-1 (]: 2 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Category__varchar .......... [[31mFAIL 1[0m in 0.09s]
[0m13:20:40.898734 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m13:20:40.898734 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m13:20:40.898734 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:20:40.898734 [info ] [Thread-1 (]: 3 of 20 START test source_data_type_sqlserver_ecommerce_Discount__int .......... [RUN]
[0m13:20:40.898734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21)
[0m13:20:40.914554 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m13:20:40.925557 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"
[0m13:20:40.926558 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Discount'
                AND data_type NOT LIKE 'int%'
        
  
[0m13:20:40.928553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:40.930728 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:40.931734 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:20:40.945820 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:40.945820 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"
[0m13:20:40.961449 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m13:20:40.961449 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"
[0m13:20:40.961449 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"
[0m13:20:40.961449 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_10734]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_10734]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_10734]
  ;')
[0m13:20:40.977099 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:40.977099 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21: ROLLBACK
[0m13:20:40.977099 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21: Close
[0m13:20:40.977099 [error] [Thread-1 (]: 3 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Discount__int .............. [[31mFAIL 1[0m in 0.08s]
[0m13:20:40.977099 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m13:20:40.992701 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m13:20:40.992701 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:20:40.992701 [info ] [Thread-1 (]: 4 of 20 START test source_data_type_sqlserver_ecommerce_Final_Price__float ..... [RUN]
[0m13:20:40.992701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0)
[0m13:20:40.992701 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m13:20:40.992701 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"
[0m13:20:41.008336 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Final_Price'
                AND data_type NOT LIKE 'float%'
        
  
[0m13:20:41.008336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.008336 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:41.008336 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:20:41.023953 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:41.041934 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"
[0m13:20:41.043939 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m13:20:41.049935 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"
[0m13:20:41.051936 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"
[0m13:20:41.052939 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_18888]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_18888]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_18888]
  ;')
[0m13:20:41.062994 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:41.066050 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0: ROLLBACK
[0m13:20:41.068047 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0: Close
[0m13:20:41.069010 [error] [Thread-1 (]: 4 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Final_Price__float ......... [[31mFAIL 1[0m in 0.08s]
[0m13:20:41.072012 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m13:20:41.074012 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m13:20:41.075010 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:20:41.076015 [info ] [Thread-1 (]: 5 of 20 START test source_data_type_sqlserver_ecommerce_Payment_Method__varchar  [RUN]
[0m13:20:41.078014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261)
[0m13:20:41.079017 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m13:20:41.087014 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261"
[0m13:20:41.087152 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Payment_Method'
                AND data_type NOT LIKE 'varchar%'
        
  
[0m13:20:41.087152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.087152 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:41.087152 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:20:41.102793 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:41.118404 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261"
[0m13:20:41.118404 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m13:20:41.118404 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261"
[0m13:20:41.118404 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261"
[0m13:20:41.134031 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_10389]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_10389]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_10389]
  ;')
[0m13:20:41.134031 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:41.134031 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261: ROLLBACK
[0m13:20:41.134031 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261: Close
[0m13:20:41.151820 [error] [Thread-1 (]: 5 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Payment_Method__varchar .... [[31mFAIL 1[0m in 0.07s]
[0m13:20:41.153821 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m13:20:41.155820 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m13:20:41.156825 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:20:41.158820 [info ] [Thread-1 (]: 6 of 20 START test source_data_type_sqlserver_ecommerce_Price__float ........... [RUN]
[0m13:20:41.160821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5)
[0m13:20:41.161819 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m13:20:41.163917 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"
[0m13:20:41.163917 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Price'
                AND data_type NOT LIKE 'float%'
        
  
[0m13:20:41.163917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.163917 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:41.163917 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:20:41.195176 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:41.195176 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"
[0m13:20:41.195176 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m13:20:41.210807 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"
[0m13:20:41.210807 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"
[0m13:20:41.210807 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_3543]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_3543]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_3543]
  ;')
[0m13:20:41.210807 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:41.226459 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5: ROLLBACK
[0m13:20:41.226459 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5: Close
[0m13:20:41.226459 [error] [Thread-1 (]: 6 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Price__float ............... [[31mFAIL 1[0m in 0.07s]
[0m13:20:41.226459 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m13:20:41.226459 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m13:20:41.226459 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:20:41.226459 [info ] [Thread-1 (]: 7 of 20 START test source_data_type_sqlserver_ecommerce_Product_ID__varchar .... [RUN]
[0m13:20:41.226459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db)
[0m13:20:41.226459 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m13:20:41.242047 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db"
[0m13:20:41.242047 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Product_ID'
                AND data_type NOT LIKE 'varchar%'
        
  
[0m13:20:41.242047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.242047 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:41.242047 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:20:41.273301 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:41.273301 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db"
[0m13:20:41.273301 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m13:20:41.288927 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db"
[0m13:20:41.288927 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db"
[0m13:20:41.288927 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_11877]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_11877]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_11877]
  ;')
[0m13:20:41.304545 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:41.304545 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db: ROLLBACK
[0m13:20:41.304545 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db: Close
[0m13:20:41.304545 [error] [Thread-1 (]: 7 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Product_ID__varchar ........ [[31mFAIL 1[0m in 0.08s]
[0m13:20:41.304545 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m13:20:41.304545 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m13:20:41.304545 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:20:41.304545 [info ] [Thread-1 (]: 8 of 20 START test source_data_type_sqlserver_ecommerce_Purchase_Date__date .... [RUN]
[0m13:20:41.304545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f)
[0m13:20:41.320177 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m13:20:41.320177 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"
[0m13:20:41.320177 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Purchase_Date'
                AND data_type NOT LIKE 'date%'
        
  
[0m13:20:41.320177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.320177 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:41.320177 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:20:41.360641 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:41.363653 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"
[0m13:20:41.365643 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m13:20:41.372641 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"
[0m13:20:41.374646 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"
[0m13:20:41.376644 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_6246]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_6246]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_6246]
  ;')
[0m13:20:41.382745 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:41.382745 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f: ROLLBACK
[0m13:20:41.382745 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f: Close
[0m13:20:41.382745 [error] [Thread-1 (]: 8 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Purchase_Date__date ........ [[31mFAIL 1[0m in 0.08s]
[0m13:20:41.382745 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m13:20:41.382745 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m13:20:41.382745 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:20:41.398412 [info ] [Thread-1 (]: 9 of 20 START test source_data_type_sqlserver_ecommerce_User_ID__varchar ....... [RUN]
[0m13:20:41.398412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14)
[0m13:20:41.398412 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m13:20:41.398412 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14"
[0m13:20:41.414037 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'User_ID'
                AND data_type NOT LIKE 'varchar%'
        
  
[0m13:20:41.414037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.414037 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:41.414037 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:20:41.429629 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:41.445295 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14"
[0m13:20:41.445295 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m13:20:41.445295 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14"
[0m13:20:41.445295 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14"
[0m13:20:41.445295 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_10961]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_10961]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_10961]
  ;')
[0m13:20:41.460942 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:41.460942 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14: ROLLBACK
[0m13:20:41.460942 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14: Close
[0m13:20:41.460942 [error] [Thread-1 (]: 9 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_User_ID__varchar ........... [[31mFAIL 1[0m in 0.06s]
[0m13:20:41.460942 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m13:20:41.476507 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:20:41.460942 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:20:41.476507 [info ] [Thread-1 (]: 10 of 20 START test source_not_null_sqlserver_ecommerce_Category ............... [RUN]
[0m13:20:41.476507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407)
[0m13:20:41.476507 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:20:41.492132 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m13:20:41.492132 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:20:41.492132 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m13:20:41.507753 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m13:20:41.507753 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_14862]
   as 
    
    
    



select Category
from "my_db"."dbo"."ecommerce"
where Category is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_14862]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_14862]
  ;')
[0m13:20:41.507753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.507753 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:41.507753 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:20:41.523416 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:41.523416 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: ROLLBACK
[0m13:20:41.523416 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: Close
[0m13:20:41.523416 [info ] [Thread-1 (]: 10 of 20 PASS source_not_null_sqlserver_ecommerce_Category ..................... [[32mPASS[0m in 0.05s]
[0m13:20:41.523416 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:20:41.523416 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:20:41.523416 [info ] [Thread-1 (]: 11 of 20 START test source_not_null_sqlserver_ecommerce_Discount ............... [RUN]
[0m13:20:41.539008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f)
[0m13:20:41.539008 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:20:41.539008 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m13:20:41.539008 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:20:41.554633 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m13:20:41.554633 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m13:20:41.554633 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_7885]
   as 
    
    
    



select Discount
from "my_db"."dbo"."ecommerce"
where Discount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_7885]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_7885]
  ;')
[0m13:20:41.554633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.554633 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:41.554633 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:20:41.575384 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:41.578386 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: ROLLBACK
[0m13:20:41.579391 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: Close
[0m13:20:41.581388 [info ] [Thread-1 (]: 11 of 20 PASS source_not_null_sqlserver_ecommerce_Discount ..................... [[32mPASS[0m in 0.04s]
[0m13:20:41.583384 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:20:41.585387 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:20:41.587524 [info ] [Thread-1 (]: 12 of 20 START test source_not_null_sqlserver_ecommerce_Final_Price ............ [RUN]
[0m13:20:41.589526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d)
[0m13:20:41.591522 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:20:41.599523 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m13:20:41.601699 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:20:41.601699 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m13:20:41.601699 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m13:20:41.601699 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_18036]
   as 
    
    
    



select Final_Price
from "my_db"."dbo"."ecommerce"
where Final_Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_18036]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_18036]
  ;')
[0m13:20:41.601699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.601699 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:41.601699 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:20:41.617331 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:41.617331 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: ROLLBACK
[0m13:20:41.617331 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: Close
[0m13:20:41.617331 [info ] [Thread-1 (]: 12 of 20 PASS source_not_null_sqlserver_ecommerce_Final_Price .................. [[32mPASS[0m in 0.03s]
[0m13:20:41.632996 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:20:41.632996 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:20:41.632996 [info ] [Thread-1 (]: 13 of 20 START test source_not_null_sqlserver_ecommerce_Payment_Method ......... [RUN]
[0m13:20:41.632996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae)
[0m13:20:41.632996 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:20:41.648621 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m13:20:41.648621 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:20:41.648621 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m13:20:41.648621 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m13:20:41.648621 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_9415]
   as 
    
    
    



select Payment_Method
from "my_db"."dbo"."ecommerce"
where Payment_Method is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_9415]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_9415]
  ;')
[0m13:20:41.664200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.664200 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:41.664200 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:20:41.679825 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:41.679825 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: ROLLBACK
[0m13:20:41.679825 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: Close
[0m13:20:41.679825 [info ] [Thread-1 (]: 13 of 20 PASS source_not_null_sqlserver_ecommerce_Payment_Method ............... [[32mPASS[0m in 0.05s]
[0m13:20:41.695476 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:20:41.695476 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:20:41.695476 [info ] [Thread-1 (]: 14 of 20 START test source_not_null_sqlserver_ecommerce_Price .................. [RUN]
[0m13:20:41.695476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01)
[0m13:20:41.711080 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:20:41.726705 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m13:20:41.726705 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:20:41.742332 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m13:20:41.742332 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m13:20:41.757953 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_14860]
   as 
    
    
    



select Price
from "my_db"."dbo"."ecommerce"
where Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_14860]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_14860]
  ;')
[0m13:20:41.757953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.757953 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:41.757953 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:20:41.757953 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:41.773575 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: ROLLBACK
[0m13:20:41.773575 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: Close
[0m13:20:41.773575 [info ] [Thread-1 (]: 14 of 20 PASS source_not_null_sqlserver_ecommerce_Price ........................ [[32mPASS[0m in 0.08s]
[0m13:20:41.773575 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:20:41.773575 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:20:41.773575 [info ] [Thread-1 (]: 15 of 20 START test source_not_null_sqlserver_ecommerce_Product_ID ............. [RUN]
[0m13:20:41.773575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff)
[0m13:20:41.773575 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:20:41.795401 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m13:20:41.797402 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:20:41.802402 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m13:20:41.806352 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m13:20:41.808352 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_18569]
   as 
    
    
    



select Product_ID
from "my_db"."dbo"."ecommerce"
where Product_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_18569]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_18569]
  ;')
[0m13:20:41.809358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.810350 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:41.812350 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:20:41.821447 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:41.821447 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: ROLLBACK
[0m13:20:41.821447 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: Close
[0m13:20:41.821447 [info ] [Thread-1 (]: 15 of 20 PASS source_not_null_sqlserver_ecommerce_Product_ID ................... [[32mPASS[0m in 0.05s]
[0m13:20:41.821447 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:20:41.821447 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:20:41.821447 [info ] [Thread-1 (]: 16 of 20 START test source_not_null_sqlserver_ecommerce_Purchase_Date .......... [RUN]
[0m13:20:41.837074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17)
[0m13:20:41.837074 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:20:41.837074 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m13:20:41.837074 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:20:41.852713 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m13:20:41.852713 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m13:20:41.852713 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_11817]
   as 
    
    
    



select Purchase_Date
from "my_db"."dbo"."ecommerce"
where Purchase_Date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_11817]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_11817]
  ;')
[0m13:20:41.852713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.852713 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:41.852713 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:20:41.868344 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:41.868344 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: ROLLBACK
[0m13:20:41.868344 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: Close
[0m13:20:41.868344 [info ] [Thread-1 (]: 16 of 20 PASS source_not_null_sqlserver_ecommerce_Purchase_Date ................ [[32mPASS[0m in 0.05s]
[0m13:20:41.883950 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:20:41.883950 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:20:41.883950 [info ] [Thread-1 (]: 17 of 20 START test source_not_null_sqlserver_ecommerce_User_ID ................ [RUN]
[0m13:20:41.883950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc)
[0m13:20:41.883950 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:20:41.899585 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m13:20:41.899585 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:20:41.899585 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m13:20:41.899585 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m13:20:41.899585 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_11208]
   as 
    
    
    



select User_ID
from "my_db"."dbo"."ecommerce"
where User_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_11208]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_11208]
  ;')
[0m13:20:41.915520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:41.917525 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:20:41.918546 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:20:41.929561 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:41.929561 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: ROLLBACK
[0m13:20:41.929561 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: Close
[0m13:20:41.929561 [info ] [Thread-1 (]: 17 of 20 PASS source_not_null_sqlserver_ecommerce_User_ID ...................... [[32mPASS[0m in 0.05s]
[0m13:20:41.929561 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:20:41.929561 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce
[0m13:20:41.929561 [info ] [Thread-1 (]: 18 of 20 SKIP relation dbo.src_ecommerce ....................................... [[33mSKIP[0m]
[0m13:20:41.929561 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce
[0m13:20:41.945203 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce_datatypes
[0m13:20:41.945203 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.src_ecommerce' to be skipped because of status 'skipped'. 
[0m13:20:41.945203 [info ] [Thread-1 (]: 19 of 20 SKIP relation dbo.src_ecommerce_datatypes ............................. [[33mSKIP[0m]
[0m13:20:41.945203 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce_datatypes
[0m13:20:41.945203 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.stg_ecommerce
[0m13:20:41.945203 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.src_ecommerce_datatypes' to be skipped because of status 'skipped'. 
[0m13:20:41.945203 [info ] [Thread-1 (]: 20 of 20 SKIP relation dbo.stg_ecommerce ....................................... [[33mSKIP[0m]
[0m13:20:41.945203 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.stg_ecommerce
[0m13:20:41.945203 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.stg_ecommerce' to be skipped because of status 'skipped'. 
[0m13:20:41.960814 [debug] [MainThread]: On master: COMMIT
[0m13:20:41.960814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:41.960814 [debug] [MainThread]: Connection 'list_my_db' was properly closed.
[0m13:20:41.960814 [debug] [MainThread]: Connection 'list_my_db_dbo' was properly closed.
[0m13:20:41.960814 [debug] [MainThread]: Connection 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc' was properly closed.
[0m13:20:41.960814 [info ] [MainThread]: 
[0m13:20:41.960814 [info ] [MainThread]: Finished running 17 data tests, 3 view models in 0 hours 0 minutes and 1.53 seconds (1.53s).
[0m13:20:41.976443 [debug] [MainThread]: Command end result
[0m13:20:42.038941 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m13:20:42.054604 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m13:20:42.054604 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m13:20:42.070193 [info ] [MainThread]: 
[0m13:20:42.070193 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m13:20:42.070193 [info ] [MainThread]: 
[0m13:20:42.085916 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:20:42.085916 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:20:42.085916 [info ] [MainThread]: 
[0m13:20:42.085916 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Category__varchar.sql
[0m13:20:42.085916 [info ] [MainThread]: 
[0m13:20:42.101784 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:20:42.103791 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:20:42.105803 [info ] [MainThread]: 
[0m13:20:42.108785 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Discount__int.sql
[0m13:20:42.109783 [info ] [MainThread]: 
[0m13:20:42.111785 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:20:42.112783 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:20:42.114784 [info ] [MainThread]: 
[0m13:20:42.115811 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Final_Price__float.sql
[0m13:20:42.117966 [info ] [MainThread]: 
[0m13:20:42.120968 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:20:42.123889 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:20:42.125287 [info ] [MainThread]: 
[0m13:20:42.127662 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Payment_Method__varchar.sql
[0m13:20:42.128662 [info ] [MainThread]: 
[0m13:20:42.129627 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:20:42.131671 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:20:42.134625 [info ] [MainThread]: 
[0m13:20:42.136627 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Price__float.sql
[0m13:20:42.139629 [info ] [MainThread]: 
[0m13:20:42.142625 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:20:42.143623 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:20:42.145635 [info ] [MainThread]: 
[0m13:20:42.146628 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Product_ID__varchar.sql
[0m13:20:42.148626 [info ] [MainThread]: 
[0m13:20:42.149707 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:20:42.149707 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:20:42.149707 [info ] [MainThread]: 
[0m13:20:42.149707 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Purchase_Date__date.sql
[0m13:20:42.149707 [info ] [MainThread]: 
[0m13:20:42.149707 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:20:42.149707 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:20:42.149707 [info ] [MainThread]: 
[0m13:20:42.165377 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_User_ID__varchar.sql
[0m13:20:42.165377 [info ] [MainThread]: 
[0m13:20:42.165377 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=8 SKIP=3 NO-OP=0 TOTAL=20
[0m13:20:42.165377 [debug] [MainThread]: Command `dbt build` failed at 13:20:42.165377 after 4.80 seconds
[0m13:20:42.165377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E2D53DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E2FB0510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E2FB10D0>]}
[0m13:20:42.165377 [debug] [MainThread]: Flushing usage events
[0m13:20:42.774483 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:23:04.774710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FDD809D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FDD82AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FDD821D0>]}


============================== 13:23:04.774710 | 27dbd2aa-c2ef-4572-924f-842be768c9a5 ==============================
[0m13:23:04.774710 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:23:04.790340 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt build --target sqlserver', 'send_anonymous_usage_stats': 'True'}
[0m13:23:05.664439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27dbd2aa-c2ef-4572-924f-842be768c9a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FF689B50>]}
[0m13:23:05.790649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27dbd2aa-c2ef-4572-924f-842be768c9a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FCCF1F10>]}
[0m13:23:05.790649 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m13:23:06.555006 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m13:23:07.086061 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:23:07.101684 [debug] [MainThread]: Partial parsing: updated file: dbt_databricks_cicd://dbt_databricks_cicd/models\raw\sqlserver\schema.yml
[0m13:23:08.117523 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m13:23:08.133148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27dbd2aa-c2ef-4572-924f-842be768c9a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FFC12C50>]}
[0m13:23:08.320525 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m13:23:08.320525 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m13:23:08.414275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27dbd2aa-c2ef-4572-924f-842be768c9a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E780197550>]}
[0m13:23:08.414275 [info ] [MainThread]: Found 3 models, 17 data tests, 1 source, 626 macros
[0m13:23:08.429905 [info ] [MainThread]: 
[0m13:23:08.429905 [info ] [MainThread]: Concurrency: 1 threads (target='sqlserver')
[0m13:23:08.429905 [info ] [MainThread]: 
[0m13:23:08.429905 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m13:23:08.429905 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db'
[0m13:23:08.461149 [debug] [ThreadPool]: dbt-sqlserver
[0m13:23:08.461149 [debug] [ThreadPool]: Using sqlserver connection "list_my_db"
[0m13:23:08.461149 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db"} */
USE [my_db];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m13:23:08.461149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:08.476772 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:23:08.570674 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m13:23:08.570674 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:23:08.570674 [debug] [ThreadPool]: On list_my_db: Close
[0m13:23:08.570674 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db_dbo'
[0m13:23:08.586283 [debug] [ThreadPool]: dbt-sqlserver
[0m13:23:08.586283 [debug] [ThreadPool]: Using sqlserver connection "list_my_db_dbo"
[0m13:23:08.586283 [debug] [ThreadPool]: On list_my_db_dbo: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db_dbo"} */
USE [my_db];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m13:23:08.586283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:08.586283 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:23:08.586283 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m13:23:08.654577 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:23:08.659580 [debug] [ThreadPool]: On list_my_db_dbo: ROLLBACK
[0m13:23:08.661580 [debug] [ThreadPool]: On list_my_db_dbo: Close
[0m13:23:08.664624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27dbd2aa-c2ef-4572-924f-842be768c9a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FF604A10>]}
[0m13:23:08.664624 [debug] [MainThread]: On master: COMMIT
[0m13:23:08.664624 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:23:08.664624 [info ] [Thread-1 (]: 1 of 20 START test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [RUN]
[0m13:23:08.664624 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8'
[0m13:23:08.664624 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:23:08.711514 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m13:23:08.711514 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:23:08.759024 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m13:23:08.759024 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m13:23:08.759024 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_13861]
   as 
    
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from "my_db"."dbo"."ecommerce"
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    ''Credit Card'',''Net Banking'',''UPI'',''Debit Card'',''Cash on Delivery''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_13861]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_13861]
  ;')
[0m13:23:08.759024 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:23:08.759024 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:23:08.759024 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:23:08.774654 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:08.790275 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: ROLLBACK
[0m13:23:08.790275 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: Close
[0m13:23:08.790275 [info ] [Thread-1 (]: 1 of 20 PASS source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [[32mPASS[0m in 0.13s]
[0m13:23:08.790275 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:23:08.790275 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar_16_.a15abf0c2b
[0m13:23:08.790275 [info ] [Thread-1 (]: 2 of 20 START test source_data_type_sqlserver_ecommerce_Category__varchar_16_ .. [RUN]
[0m13:23:08.790275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar_16_.a15abf0c2b)
[0m13:23:08.805899 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar_16_.a15abf0c2b
[0m13:23:08.805899 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar_16_.a15abf0c2b"
[0m13:23:08.805899 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar_16_.a15abf0c2b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar_16_.a15abf0c2b"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Category'
                AND data_type NOT LIKE 'varchar(16)%'
        
  
[0m13:23:08.805899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:08.821561 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:23:08.821561 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:23:08.851594 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:08.851594 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar_16_.a15abf0c2b"
[0m13:23:08.867222 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar_16_.a15abf0c2b
[0m13:23:08.867222 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar_16_.a15abf0c2b"
[0m13:23:08.867222 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar_16_.a15abf0c2b"
[0m13:23:08.867222 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar_16_.a15abf0c2b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar_16_.a15abf0c2b"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_53eba4d0f685f868cae54ead80f5197c_3134]
   as 
    

    

    
        

        
        
        
            SELECT 1 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_53eba4d0f685f868cae54ead80f5197c_3134]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_53eba4d0f685f868cae54ead80f5197c_3134]
  ;')
[0m13:23:08.882896 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:08.882896 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar_16_.a15abf0c2b: ROLLBACK
[0m13:23:08.882896 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar_16_.a15abf0c2b: Close
[0m13:23:08.882896 [error] [Thread-1 (]: 2 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Category__varchar_16_ ...... [[31mFAIL 1[0m in 0.09s]
[0m13:23:08.882896 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar_16_.a15abf0c2b
[0m13:23:08.882896 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m13:23:08.898473 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar_16_.a15abf0c2b' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:23:08.898473 [info ] [Thread-1 (]: 3 of 20 START test source_data_type_sqlserver_ecommerce_Discount__int .......... [RUN]
[0m13:23:08.898473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar_16_.a15abf0c2b, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21)
[0m13:23:08.898473 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m13:23:08.898473 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"
[0m13:23:08.898473 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Discount'
                AND data_type NOT LIKE 'int%'
        
  
[0m13:23:08.914099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:08.914099 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:23:08.914099 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:23:08.929725 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:08.945394 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"
[0m13:23:08.945394 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m13:23:08.945394 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"
[0m13:23:08.945394 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"
[0m13:23:08.945394 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_18912]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_18912]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_18912]
  ;')
[0m13:23:08.960977 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:08.976638 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21: ROLLBACK
[0m13:23:08.976638 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21: Close
[0m13:23:08.976638 [error] [Thread-1 (]: 3 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Discount__int .............. [[31mFAIL 1[0m in 0.08s]
[0m13:23:08.976638 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m13:23:08.976638 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m13:23:08.976638 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:23:08.976638 [info ] [Thread-1 (]: 4 of 20 START test source_data_type_sqlserver_ecommerce_Final_Price__float ..... [RUN]
[0m13:23:08.976638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0)
[0m13:23:08.976638 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m13:23:08.992227 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"
[0m13:23:08.992227 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Final_Price'
                AND data_type NOT LIKE 'float%'
        
  
[0m13:23:08.992227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:09.007864 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:23:09.007864 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:23:09.023519 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:09.023519 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"
[0m13:23:09.023519 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m13:23:09.045324 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"
[0m13:23:09.048325 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"
[0m13:23:09.049325 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_4342]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_4342]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_4342]
  ;')
[0m13:23:09.060873 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:09.063894 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0: ROLLBACK
[0m13:23:09.064893 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0: Close
[0m13:23:09.066894 [error] [Thread-1 (]: 4 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Final_Price__float ......... [[31mFAIL 1[0m in 0.09s]
[0m13:23:09.068903 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m13:23:09.070946 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar_16_.470c9a99ff
[0m13:23:09.070946 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:23:09.070946 [info ] [Thread-1 (]: 5 of 20 START test source_data_type_sqlserver_ecommerce_Payment_Method__varchar_16_  [RUN]
[0m13:23:09.070946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar_16_.470c9a99ff)
[0m13:23:09.070946 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar_16_.470c9a99ff
[0m13:23:09.070946 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar_16_.470c9a99ff"
[0m13:23:09.070946 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar_16_.470c9a99ff: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar_16_.470c9a99ff"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Payment_Method'
                AND data_type NOT LIKE 'varchar(16)%'
        
  
[0m13:23:09.086580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:09.086580 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:23:09.086580 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:23:09.102209 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:09.117832 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar_16_.470c9a99ff"
[0m13:23:09.117832 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar_16_.470c9a99ff
[0m13:23:09.117832 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar_16_.470c9a99ff"
[0m13:23:09.117832 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar_16_.470c9a99ff"
[0m13:23:09.117832 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar_16_.470c9a99ff: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar_16_.470c9a99ff"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_53eba4d0f685f868cae54ead80f5197c_7170]
   as 
    

    

    
        

        
        
        
            SELECT 1 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_53eba4d0f685f868cae54ead80f5197c_7170]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_53eba4d0f685f868cae54ead80f5197c_7170]
  ;')
[0m13:23:09.133460 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:09.133460 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar_16_.470c9a99ff: ROLLBACK
[0m13:23:09.133460 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar_16_.470c9a99ff: Close
[0m13:23:09.133460 [error] [Thread-1 (]: 5 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Payment_Method__varchar_16_  [[31mFAIL 1[0m in 0.06s]
[0m13:23:09.133460 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar_16_.470c9a99ff
[0m13:23:09.149118 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m13:23:09.149118 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar_16_.470c9a99ff' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:23:09.149118 [info ] [Thread-1 (]: 6 of 20 START test source_data_type_sqlserver_ecommerce_Price__float ........... [RUN]
[0m13:23:09.149118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar_16_.470c9a99ff, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5)
[0m13:23:09.149118 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m13:23:09.167984 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"
[0m13:23:09.168985 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Price'
                AND data_type NOT LIKE 'float%'
        
  
[0m13:23:09.169986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:09.170986 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:23:09.172986 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:23:09.195971 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:09.195971 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"
[0m13:23:09.195971 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m13:23:09.195971 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"
[0m13:23:09.195971 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"
[0m13:23:09.211590 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_18241]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_18241]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_18241]
  ;')
[0m13:23:09.227218 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:09.227218 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5: ROLLBACK
[0m13:23:09.227218 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5: Close
[0m13:23:09.227218 [error] [Thread-1 (]: 6 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Price__float ............... [[31mFAIL 1[0m in 0.08s]
[0m13:23:09.227218 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m13:23:09.227218 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar_16_.089c2a9d22
[0m13:23:09.227218 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:23:09.227218 [info ] [Thread-1 (]: 7 of 20 START test source_data_type_sqlserver_ecommerce_Product_ID__varchar_16_  [RUN]
[0m13:23:09.227218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar_16_.089c2a9d22)
[0m13:23:09.227218 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar_16_.089c2a9d22
[0m13:23:09.242843 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar_16_.089c2a9d22"
[0m13:23:09.242843 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar_16_.089c2a9d22: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar_16_.089c2a9d22"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Product_ID'
                AND data_type NOT LIKE 'varchar(16)%'
        
  
[0m13:23:09.242843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:09.242843 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:23:09.242843 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:23:09.281355 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:09.284348 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar_16_.089c2a9d22"
[0m13:23:09.286351 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar_16_.089c2a9d22
[0m13:23:09.289435 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar_16_.089c2a9d22"
[0m13:23:09.289435 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar_16_.089c2a9d22"
[0m13:23:09.289435 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar_16_.089c2a9d22: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar_16_.089c2a9d22"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_53eba4d0f685f868cae54ead80f5197c_7142]
   as 
    

    

    
        

        
        
        
            SELECT 1 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_53eba4d0f685f868cae54ead80f5197c_7142]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_53eba4d0f685f868cae54ead80f5197c_7142]
  ;')
[0m13:23:09.305063 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:09.305063 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar_16_.089c2a9d22: ROLLBACK
[0m13:23:09.305063 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar_16_.089c2a9d22: Close
[0m13:23:09.305063 [error] [Thread-1 (]: 7 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Product_ID__varchar_16_ .... [[31mFAIL 1[0m in 0.08s]
[0m13:23:09.305063 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar_16_.089c2a9d22
[0m13:23:09.305063 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m13:23:09.305063 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar_16_.089c2a9d22' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:23:09.305063 [info ] [Thread-1 (]: 8 of 20 START test source_data_type_sqlserver_ecommerce_Purchase_Date__date .... [RUN]
[0m13:23:09.320687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar_16_.089c2a9d22, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f)
[0m13:23:09.320687 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m13:23:09.320687 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"
[0m13:23:09.320687 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Purchase_Date'
                AND data_type NOT LIKE 'date%'
        
  
[0m13:23:09.320687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:09.320687 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:23:09.336318 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:23:09.351945 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:09.351945 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"
[0m13:23:09.351945 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m13:23:09.372700 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"
[0m13:23:09.375700 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"
[0m13:23:09.376702 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_2008]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_2008]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_2008]
  ;')
[0m13:23:09.387704 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:09.390707 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f: ROLLBACK
[0m13:23:09.391701 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f: Close
[0m13:23:09.393706 [error] [Thread-1 (]: 8 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Purchase_Date__date ........ [[31mFAIL 1[0m in 0.07s]
[0m13:23:09.396705 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m13:23:09.397707 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar_16_.3773754f9c
[0m13:23:09.398759 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:23:09.398759 [info ] [Thread-1 (]: 9 of 20 START test source_data_type_sqlserver_ecommerce_User_ID__varchar_16_ ... [RUN]
[0m13:23:09.398759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar_16_.3773754f9c)
[0m13:23:09.398759 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar_16_.3773754f9c
[0m13:23:09.398759 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar_16_.3773754f9c"
[0m13:23:09.398759 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar_16_.3773754f9c: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar_16_.3773754f9c"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'User_ID'
                AND data_type NOT LIKE 'varchar(16)%'
        
  
[0m13:23:09.414397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:09.414397 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:23:09.414397 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:23:09.430023 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:09.445640 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar_16_.3773754f9c"
[0m13:23:09.445640 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar_16_.3773754f9c
[0m13:23:09.445640 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar_16_.3773754f9c"
[0m13:23:09.445640 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar_16_.3773754f9c"
[0m13:23:09.445640 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar_16_.3773754f9c: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar_16_.3773754f9c"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_53eba4d0f685f868cae54ead80f5197c_4549]
   as 
    

    

    
        

        
        
        
            SELECT 1 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_53eba4d0f685f868cae54ead80f5197c_4549]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_53eba4d0f685f868cae54ead80f5197c_4549]
  ;')
[0m13:23:09.461269 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:09.461269 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar_16_.3773754f9c: ROLLBACK
[0m13:23:09.461269 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar_16_.3773754f9c: Close
[0m13:23:09.461269 [error] [Thread-1 (]: 9 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_User_ID__varchar_16_ ....... [[31mFAIL 1[0m in 0.06s]
[0m13:23:09.461269 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar_16_.3773754f9c
[0m13:23:09.461269 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:23:09.461269 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar_16_.3773754f9c' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:23:09.476894 [info ] [Thread-1 (]: 10 of 20 START test source_not_null_sqlserver_ecommerce_Category ............... [RUN]
[0m13:23:09.476894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar_16_.3773754f9c, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407)
[0m13:23:09.476894 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:23:09.492514 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m13:23:09.492514 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:23:09.508139 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m13:23:09.508139 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m13:23:09.508139 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_6166]
   as 
    
    
    



select Category
from "my_db"."dbo"."ecommerce"
where Category is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_6166]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_6166]
  ;')
[0m13:23:09.508139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:09.523765 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:23:09.523765 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:23:09.523765 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:09.539412 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: ROLLBACK
[0m13:23:09.539412 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: Close
[0m13:23:09.539412 [info ] [Thread-1 (]: 10 of 20 PASS source_not_null_sqlserver_ecommerce_Category ..................... [[32mPASS[0m in 0.06s]
[0m13:23:09.539412 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:23:09.539412 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:23:09.539412 [info ] [Thread-1 (]: 11 of 20 START test source_not_null_sqlserver_ecommerce_Discount ............... [RUN]
[0m13:23:09.555020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f)
[0m13:23:09.555020 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:23:09.570665 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m13:23:09.570665 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:23:09.570665 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m13:23:09.586310 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m13:23:09.586310 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_13863]
   as 
    
    
    



select Discount
from "my_db"."dbo"."ecommerce"
where Discount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_13863]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_13863]
  ;')
[0m13:23:09.586310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:09.586310 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:23:09.586310 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:23:09.621193 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:09.626229 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: ROLLBACK
[0m13:23:09.628226 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: Close
[0m13:23:09.630234 [info ] [Thread-1 (]: 11 of 20 PASS source_not_null_sqlserver_ecommerce_Discount ..................... [[32mPASS[0m in 0.07s]
[0m13:23:09.633191 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:23:09.634188 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:23:09.635187 [info ] [Thread-1 (]: 12 of 20 START test source_not_null_sqlserver_ecommerce_Final_Price ............ [RUN]
[0m13:23:09.637194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d)
[0m13:23:09.638187 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:23:09.647198 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m13:23:09.650295 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:23:09.656286 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m13:23:09.660293 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m13:23:09.663292 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_12296]
   as 
    
    
    



select Final_Price
from "my_db"."dbo"."ecommerce"
where Final_Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_12296]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_12296]
  ;')
[0m13:23:09.665400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:09.666402 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:23:09.667412 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:23:09.680520 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:09.683523 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: ROLLBACK
[0m13:23:09.685525 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: Close
[0m13:23:09.686523 [info ] [Thread-1 (]: 12 of 20 PASS source_not_null_sqlserver_ecommerce_Final_Price .................. [[32mPASS[0m in 0.05s]
[0m13:23:09.689524 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:23:09.691522 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:23:09.694531 [info ] [Thread-1 (]: 13 of 20 START test source_not_null_sqlserver_ecommerce_Payment_Method ......... [RUN]
[0m13:23:09.697523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae)
[0m13:23:09.699525 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:23:09.717657 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m13:23:09.720672 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:23:09.726731 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m13:23:09.726731 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m13:23:09.726731 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_1775]
   as 
    
    
    



select Payment_Method
from "my_db"."dbo"."ecommerce"
where Payment_Method is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_1775]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_1775]
  ;')
[0m13:23:09.742356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:09.742356 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:23:09.742356 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:23:09.757978 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:09.757978 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: ROLLBACK
[0m13:23:09.757978 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: Close
[0m13:23:09.757978 [info ] [Thread-1 (]: 13 of 20 PASS source_not_null_sqlserver_ecommerce_Payment_Method ............... [[32mPASS[0m in 0.06s]
[0m13:23:09.773635 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:23:09.773635 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:23:09.773635 [info ] [Thread-1 (]: 14 of 20 START test source_not_null_sqlserver_ecommerce_Price .................. [RUN]
[0m13:23:09.773635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01)
[0m13:23:09.773635 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:23:09.773635 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m13:23:09.789234 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:23:09.789234 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m13:23:09.789234 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m13:23:09.789234 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_15596]
   as 
    
    
    



select Price
from "my_db"."dbo"."ecommerce"
where Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_15596]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_15596]
  ;')
[0m13:23:09.789234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:09.805214 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:23:09.806213 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:23:09.829213 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:09.832212 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: ROLLBACK
[0m13:23:09.833215 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: Close
[0m13:23:09.835213 [info ] [Thread-1 (]: 14 of 20 PASS source_not_null_sqlserver_ecommerce_Price ........................ [[32mPASS[0m in 0.06s]
[0m13:23:09.836277 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:23:09.836277 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:23:09.836277 [info ] [Thread-1 (]: 15 of 20 START test source_not_null_sqlserver_ecommerce_Product_ID ............. [RUN]
[0m13:23:09.836277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff)
[0m13:23:09.836277 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:23:09.851912 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m13:23:09.851912 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:23:09.946282 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m13:23:09.946282 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m13:23:09.946282 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_15640]
   as 
    
    
    



select Product_ID
from "my_db"."dbo"."ecommerce"
where Product_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_15640]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_15640]
  ;')
[0m13:23:09.961913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:09.961913 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:23:09.961913 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:23:09.977534 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:09.977534 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: ROLLBACK
[0m13:23:09.977534 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: Close
[0m13:23:09.977534 [info ] [Thread-1 (]: 15 of 20 PASS source_not_null_sqlserver_ecommerce_Product_ID ................... [[32mPASS[0m in 0.14s]
[0m13:23:09.977534 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:23:09.977534 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:23:09.977534 [info ] [Thread-1 (]: 16 of 20 START test source_not_null_sqlserver_ecommerce_Purchase_Date .......... [RUN]
[0m13:23:09.993172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17)
[0m13:23:09.993172 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:23:09.993172 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m13:23:09.993172 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:23:10.008787 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m13:23:10.008787 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m13:23:10.008787 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_18270]
   as 
    
    
    



select Purchase_Date
from "my_db"."dbo"."ecommerce"
where Purchase_Date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_18270]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_18270]
  ;')
[0m13:23:10.008787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:10.008787 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:23:10.008787 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:23:10.024415 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:10.024415 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: ROLLBACK
[0m13:23:10.024415 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: Close
[0m13:23:10.024415 [info ] [Thread-1 (]: 16 of 20 PASS source_not_null_sqlserver_ecommerce_Purchase_Date ................ [[32mPASS[0m in 0.05s]
[0m13:23:10.043220 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:23:10.046209 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:23:10.047207 [info ] [Thread-1 (]: 17 of 20 START test source_not_null_sqlserver_ecommerce_User_ID ................ [RUN]
[0m13:23:10.049205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc)
[0m13:23:10.050205 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:23:10.056771 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m13:23:10.056771 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:23:10.056771 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m13:23:10.056771 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m13:23:10.072418 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_8837]
   as 
    
    
    



select User_ID
from "my_db"."dbo"."ecommerce"
where User_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_8837]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_8837]
  ;')
[0m13:23:10.072418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:10.072418 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:23:10.072418 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:23:10.088024 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:23:10.088024 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: ROLLBACK
[0m13:23:10.088024 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: Close
[0m13:23:10.088024 [info ] [Thread-1 (]: 17 of 20 PASS source_not_null_sqlserver_ecommerce_User_ID ...................... [[32mPASS[0m in 0.04s]
[0m13:23:10.088024 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:23:10.103650 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce
[0m13:23:10.103650 [info ] [Thread-1 (]: 18 of 20 SKIP relation dbo.src_ecommerce ....................................... [[33mSKIP[0m]
[0m13:23:10.103650 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce
[0m13:23:10.103650 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce_datatypes
[0m13:23:10.103650 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.src_ecommerce' to be skipped because of status 'skipped'. 
[0m13:23:10.103650 [info ] [Thread-1 (]: 19 of 20 SKIP relation dbo.src_ecommerce_datatypes ............................. [[33mSKIP[0m]
[0m13:23:10.103650 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce_datatypes
[0m13:23:10.103650 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.stg_ecommerce
[0m13:23:10.103650 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.src_ecommerce_datatypes' to be skipped because of status 'skipped'. 
[0m13:23:10.119271 [info ] [Thread-1 (]: 20 of 20 SKIP relation dbo.stg_ecommerce ....................................... [[33mSKIP[0m]
[0m13:23:10.119271 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.stg_ecommerce
[0m13:23:10.119271 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.stg_ecommerce' to be skipped because of status 'skipped'. 
[0m13:23:10.119271 [debug] [MainThread]: On master: COMMIT
[0m13:23:10.119271 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:23:10.119271 [debug] [MainThread]: Connection 'list_my_db' was properly closed.
[0m13:23:10.119271 [debug] [MainThread]: Connection 'list_my_db_dbo' was properly closed.
[0m13:23:10.119271 [debug] [MainThread]: Connection 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc' was properly closed.
[0m13:23:10.119271 [info ] [MainThread]: 
[0m13:23:10.119271 [info ] [MainThread]: Finished running 17 data tests, 3 view models in 0 hours 0 minutes and 1.69 seconds (1.69s).
[0m13:23:10.134898 [debug] [MainThread]: Command end result
[0m13:23:10.243922 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m13:23:10.248917 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m13:23:10.263919 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m13:23:10.265919 [info ] [MainThread]: 
[0m13:23:10.267922 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m13:23:10.268922 [info ] [MainThread]: 
[0m13:23:10.269922 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Category__varchar_16_ (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:23:10.271921 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:23:10.272922 [info ] [MainThread]: 
[0m13:23:10.274982 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Category__varchar_16_.sql
[0m13:23:10.274982 [info ] [MainThread]: 
[0m13:23:10.274982 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:23:10.274982 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:23:10.274982 [info ] [MainThread]: 
[0m13:23:10.274982 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Discount__int.sql
[0m13:23:10.274982 [info ] [MainThread]: 
[0m13:23:10.274982 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:23:10.274982 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:23:10.274982 [info ] [MainThread]: 
[0m13:23:10.274982 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Final_Price__float.sql
[0m13:23:10.290610 [info ] [MainThread]: 
[0m13:23:10.290610 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar_16_ (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:23:10.290610 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:23:10.290610 [info ] [MainThread]: 
[0m13:23:10.290610 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_eco_59b8673f896d9a0d1e03f37d0d4db924.sql
[0m13:23:10.290610 [info ] [MainThread]: 
[0m13:23:10.290610 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:23:10.290610 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:23:10.306237 [info ] [MainThread]: 
[0m13:23:10.306237 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Price__float.sql
[0m13:23:10.306237 [info ] [MainThread]: 
[0m13:23:10.306237 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Product_ID__varchar_16_ (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:23:10.306237 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:23:10.306237 [info ] [MainThread]: 
[0m13:23:10.306237 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Product_ID__varchar_16_.sql
[0m13:23:10.306237 [info ] [MainThread]: 
[0m13:23:10.321860 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:23:10.321860 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:23:10.321860 [info ] [MainThread]: 
[0m13:23:10.321860 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Purchase_Date__date.sql
[0m13:23:10.321860 [info ] [MainThread]: 
[0m13:23:10.321860 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_User_ID__varchar_16_ (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:23:10.321860 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:23:10.321860 [info ] [MainThread]: 
[0m13:23:10.321860 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_User_ID__varchar_16_.sql
[0m13:23:10.337487 [info ] [MainThread]: 
[0m13:23:10.337487 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=8 SKIP=3 NO-OP=0 TOTAL=20
[0m13:23:10.337487 [debug] [MainThread]: Command `dbt build` failed at 13:23:10.337487 after 5.72 seconds
[0m13:23:10.337487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7F72A3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7FA925450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7F7500550>]}
[0m13:23:10.353108 [debug] [MainThread]: Flushing usage events
[0m13:23:10.945854 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:04.102351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D142834E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D142525190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D142836E10>]}


============================== 13:26:04.124739 | b0baabbb-db97-4632-a7ac-8abb90300c32 ==============================
[0m13:26:04.124739 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:26:04.126394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --target sqlserver', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:26:05.055004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0baabbb-db97-4632-a7ac-8abb90300c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1440F34D0>]}
[0m13:26:05.164401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0baabbb-db97-4632-a7ac-8abb90300c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1417A1ED0>]}
[0m13:26:05.164401 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m13:26:05.930105 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m13:26:06.431231 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:26:06.431231 [debug] [MainThread]: Partial parsing: updated file: dbt_databricks_cicd://dbt_databricks_cicd/models\raw\sqlserver\schema.yml
[0m13:26:07.461361 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m13:26:07.494802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0baabbb-db97-4632-a7ac-8abb90300c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D144931710>]}
[0m13:26:07.665220 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m13:26:07.665220 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m13:26:07.774817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0baabbb-db97-4632-a7ac-8abb90300c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D144953950>]}
[0m13:26:07.774817 [info ] [MainThread]: Found 3 models, 17 data tests, 1 source, 626 macros
[0m13:26:07.774817 [info ] [MainThread]: 
[0m13:26:07.774817 [info ] [MainThread]: Concurrency: 1 threads (target='sqlserver')
[0m13:26:07.790393 [info ] [MainThread]: 
[0m13:26:07.790393 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m13:26:07.790393 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db'
[0m13:26:07.821681 [debug] [ThreadPool]: dbt-sqlserver
[0m13:26:07.821681 [debug] [ThreadPool]: Using sqlserver connection "list_my_db"
[0m13:26:07.837431 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db"} */
USE [my_db];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m13:26:07.838476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:07.839472 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:07.930238 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m13:26:07.930238 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:26:07.948030 [debug] [ThreadPool]: On list_my_db: Close
[0m13:26:07.950899 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db_dbo'
[0m13:26:07.961992 [debug] [ThreadPool]: dbt-sqlserver
[0m13:26:07.961992 [debug] [ThreadPool]: Using sqlserver connection "list_my_db_dbo"
[0m13:26:07.961992 [debug] [ThreadPool]: On list_my_db_dbo: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db_dbo"} */
USE [my_db];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m13:26:07.961992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:07.961992 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:07.961992 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m13:26:07.993260 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:26:08.008874 [debug] [ThreadPool]: On list_my_db_dbo: ROLLBACK
[0m13:26:08.008874 [debug] [ThreadPool]: On list_my_db_dbo: Close
[0m13:26:08.008874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0baabbb-db97-4632-a7ac-8abb90300c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D141545FD0>]}
[0m13:26:08.008874 [debug] [MainThread]: On master: COMMIT
[0m13:26:08.008874 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:26:08.024535 [info ] [Thread-1 (]: 1 of 20 START test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [RUN]
[0m13:26:08.024535 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8'
[0m13:26:08.024535 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:26:08.047478 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m13:26:08.050507 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:26:08.086197 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m13:26:08.086197 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m13:26:08.086197 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_8165]
   as 
    
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from "my_db"."dbo"."ecommerce"
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    ''Credit Card'',''Net Banking'',''UPI'',''Debit Card'',''Cash on Delivery''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_8165]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_8165]
  ;')
[0m13:26:08.086197 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:26:08.086197 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:08.101818 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:08.117409 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:08.117409 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: ROLLBACK
[0m13:26:08.117409 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: Close
[0m13:26:08.117409 [info ] [Thread-1 (]: 1 of 20 PASS source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [[32mPASS[0m in 0.09s]
[0m13:26:08.117409 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:26:08.117409 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m13:26:08.117409 [info ] [Thread-1 (]: 2 of 20 START test source_data_type_sqlserver_ecommerce_Category__varchar ...... [RUN]
[0m13:26:08.133070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e)
[0m13:26:08.133070 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m13:26:08.133070 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e"
[0m13:26:08.133070 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Category'
                AND data_type NOT LIKE 'varchar%'
        
  
[0m13:26:08.148655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:08.148655 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:08.148655 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:08.184434 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:08.187433 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e"
[0m13:26:08.189436 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m13:26:08.195632 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e"
[0m13:26:08.198631 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e"
[0m13:26:08.199638 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_2631]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_2631]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_2631]
  ;')
[0m13:26:08.209635 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:08.212720 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e: ROLLBACK
[0m13:26:08.213721 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e: Close
[0m13:26:08.215731 [error] [Thread-1 (]: 2 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Category__varchar .......... [[31mFAIL 1[0m in 0.08s]
[0m13:26:08.217725 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m13:26:08.218724 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m13:26:08.219724 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:26:08.220722 [info ] [Thread-1 (]: 3 of 20 START test source_data_type_sqlserver_ecommerce_Discount__int .......... [RUN]
[0m13:26:08.223724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21)
[0m13:26:08.224726 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m13:26:08.226853 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"
[0m13:26:08.226853 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Discount'
                AND data_type NOT LIKE 'int%'
        
  
[0m13:26:08.226853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:08.226853 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:08.226853 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:08.258115 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:08.258115 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"
[0m13:26:08.258115 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m13:26:08.273742 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"
[0m13:26:08.273742 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"
[0m13:26:08.273742 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_10747]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_10747]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_10747]
  ;')
[0m13:26:08.273742 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:08.289362 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21: ROLLBACK
[0m13:26:08.289362 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21: Close
[0m13:26:08.289362 [error] [Thread-1 (]: 3 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Discount__int .............. [[31mFAIL 1[0m in 0.07s]
[0m13:26:08.289362 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m13:26:08.289362 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m13:26:08.289362 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:26:08.289362 [info ] [Thread-1 (]: 4 of 20 START test source_data_type_sqlserver_ecommerce_Final_Price__float ..... [RUN]
[0m13:26:08.289362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0)
[0m13:26:08.289362 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m13:26:08.304984 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"
[0m13:26:08.304984 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Final_Price'
                AND data_type NOT LIKE 'float%'
        
  
[0m13:26:08.304984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:08.304984 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:08.304984 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:08.336234 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:08.336234 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"
[0m13:26:08.336234 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m13:26:08.351864 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"
[0m13:26:08.351864 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"
[0m13:26:08.351864 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_15200]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_15200]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_15200]
  ;')
[0m13:26:08.367483 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:08.370637 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0: ROLLBACK
[0m13:26:08.372637 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0: Close
[0m13:26:08.373636 [error] [Thread-1 (]: 4 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Final_Price__float ......... [[31mFAIL 1[0m in 0.08s]
[0m13:26:08.376644 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m13:26:08.377635 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m13:26:08.378643 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:26:08.379642 [info ] [Thread-1 (]: 5 of 20 START test source_data_type_sqlserver_ecommerce_Payment_Method__varchar  [RUN]
[0m13:26:08.381635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261)
[0m13:26:08.383646 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m13:26:08.391641 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261"
[0m13:26:08.392643 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Payment_Method'
                AND data_type NOT LIKE 'varchar%'
        
  
[0m13:26:08.393642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:08.395636 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:08.397646 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:08.414950 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:08.414950 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261"
[0m13:26:08.414950 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m13:26:08.430575 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261"
[0m13:26:08.430575 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261"
[0m13:26:08.446211 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_4266]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_4266]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_4266]
  ;')
[0m13:26:08.446211 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:08.461826 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261: ROLLBACK
[0m13:26:08.461826 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261: Close
[0m13:26:08.461826 [error] [Thread-1 (]: 5 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Payment_Method__varchar .... [[31mFAIL 1[0m in 0.08s]
[0m13:26:08.461826 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m13:26:08.461826 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m13:26:08.461826 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:26:08.461826 [info ] [Thread-1 (]: 6 of 20 START test source_data_type_sqlserver_ecommerce_Price__float ........... [RUN]
[0m13:26:08.461826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5)
[0m13:26:08.477454 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m13:26:08.477454 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"
[0m13:26:08.494933 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Price'
                AND data_type NOT LIKE 'float%'
        
  
[0m13:26:08.495932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:08.496935 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:08.499941 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:08.524963 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:08.524963 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"
[0m13:26:08.540582 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m13:26:08.540582 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"
[0m13:26:08.540582 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"
[0m13:26:08.540582 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_5059]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_5059]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_5059]
  ;')
[0m13:26:08.556210 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:08.556210 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5: ROLLBACK
[0m13:26:08.571836 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5: Close
[0m13:26:08.571836 [error] [Thread-1 (]: 6 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Price__float ............... [[31mFAIL 1[0m in 0.11s]
[0m13:26:08.571836 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m13:26:08.571836 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m13:26:08.571836 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:26:08.571836 [info ] [Thread-1 (]: 7 of 20 START test source_data_type_sqlserver_ecommerce_Product_ID__varchar .... [RUN]
[0m13:26:08.571836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db)
[0m13:26:08.571836 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m13:26:08.587457 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db"
[0m13:26:08.603674 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Product_ID'
                AND data_type NOT LIKE 'varchar%'
        
  
[0m13:26:08.604679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:08.606673 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:08.607677 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:08.633378 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:08.633378 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db"
[0m13:26:08.633378 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m13:26:08.649002 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db"
[0m13:26:08.649002 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db"
[0m13:26:08.649002 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_18994]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_18994]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_18994]
  ;')
[0m13:26:08.664633 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:08.664633 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db: ROLLBACK
[0m13:26:08.664633 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db: Close
[0m13:26:08.664633 [error] [Thread-1 (]: 7 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Product_ID__varchar ........ [[31mFAIL 1[0m in 0.09s]
[0m13:26:08.664633 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m13:26:08.680254 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:26:08.664633 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m13:26:08.680254 [info ] [Thread-1 (]: 8 of 20 START test source_data_type_sqlserver_ecommerce_Purchase_Date__date .... [RUN]
[0m13:26:08.680254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f)
[0m13:26:08.680254 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m13:26:08.695879 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"
[0m13:26:08.711780 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Purchase_Date'
                AND data_type NOT LIKE 'date%'
        
  
[0m13:26:08.714780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:08.717783 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:08.720780 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:08.759099 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:08.759099 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"
[0m13:26:08.759099 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m13:26:08.774721 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"
[0m13:26:08.774721 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"
[0m13:26:08.774721 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_7985]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_7985]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_7985]
  ;')
[0m13:26:08.790345 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:08.790345 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f: ROLLBACK
[0m13:26:08.790345 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f: Close
[0m13:26:08.790345 [error] [Thread-1 (]: 8 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Purchase_Date__date ........ [[31mFAIL 1[0m in 0.11s]
[0m13:26:08.790345 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m13:26:08.806309 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:26:08.807307 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m13:26:08.810308 [info ] [Thread-1 (]: 9 of 20 START test source_data_type_sqlserver_ecommerce_User_ID__varchar ....... [RUN]
[0m13:26:08.812305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14)
[0m13:26:08.815308 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m13:26:08.825304 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14"
[0m13:26:08.826305 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'User_ID'
                AND data_type NOT LIKE 'varchar%'
        
  
[0m13:26:08.828305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:08.830303 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:08.833314 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:08.852283 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:08.852283 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14"
[0m13:26:08.852283 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m13:26:08.867898 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14"
[0m13:26:08.867898 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14"
[0m13:26:08.867898 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_2111]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_2111]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_2111]
  ;')
[0m13:26:08.883526 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:08.883526 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14: ROLLBACK
[0m13:26:08.883526 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14: Close
[0m13:26:08.883526 [error] [Thread-1 (]: 9 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_User_ID__varchar ........... [[31mFAIL 1[0m in 0.07s]
[0m13:26:08.883526 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m13:26:08.883526 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:26:08.883526 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:26:08.883526 [info ] [Thread-1 (]: 10 of 20 START test source_not_null_sqlserver_ecommerce_Category ............... [RUN]
[0m13:26:08.899151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407)
[0m13:26:08.899151 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:26:08.899151 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m13:26:08.914775 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:26:08.933828 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m13:26:08.936810 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m13:26:08.938809 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_3015]
   as 
    
    
    



select Category
from "my_db"."dbo"."ecommerce"
where Category is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_3015]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_3015]
  ;')
[0m13:26:08.940811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:08.942809 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:08.944808 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:08.946864 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:08.962493 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: ROLLBACK
[0m13:26:08.962493 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: Close
[0m13:26:08.962493 [info ] [Thread-1 (]: 10 of 20 PASS source_not_null_sqlserver_ecommerce_Category ..................... [[32mPASS[0m in 0.06s]
[0m13:26:08.962493 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:26:08.962493 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:26:08.962493 [info ] [Thread-1 (]: 11 of 20 START test source_not_null_sqlserver_ecommerce_Discount ............... [RUN]
[0m13:26:08.962493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f)
[0m13:26:08.962493 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:26:08.978122 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m13:26:08.978122 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:26:08.978122 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m13:26:08.993745 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m13:26:08.993745 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_5257]
   as 
    
    
    



select Discount
from "my_db"."dbo"."ecommerce"
where Discount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_5257]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_5257]
  ;')
[0m13:26:08.993745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:08.993745 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:08.993745 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:09.009372 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:09.009372 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: ROLLBACK
[0m13:26:09.009372 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: Close
[0m13:26:09.009372 [info ] [Thread-1 (]: 11 of 20 PASS source_not_null_sqlserver_ecommerce_Discount ..................... [[32mPASS[0m in 0.05s]
[0m13:26:09.009372 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:26:09.009372 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:26:09.009372 [info ] [Thread-1 (]: 12 of 20 START test source_not_null_sqlserver_ecommerce_Final_Price ............ [RUN]
[0m13:26:09.009372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d)
[0m13:26:09.009372 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:26:09.025008 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m13:26:09.025008 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:26:09.025008 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m13:26:09.042846 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m13:26:09.043846 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_12420]
   as 
    
    
    



select Final_Price
from "my_db"."dbo"."ecommerce"
where Final_Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_12420]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_12420]
  ;')
[0m13:26:09.044845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:09.046844 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:09.047847 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:09.054963 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:09.054963 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: ROLLBACK
[0m13:26:09.054963 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: Close
[0m13:26:09.054963 [info ] [Thread-1 (]: 12 of 20 PASS source_not_null_sqlserver_ecommerce_Final_Price .................. [[32mPASS[0m in 0.05s]
[0m13:26:09.054963 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:26:09.054963 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:26:09.054963 [info ] [Thread-1 (]: 13 of 20 START test source_not_null_sqlserver_ecommerce_Payment_Method ......... [RUN]
[0m13:26:09.070593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae)
[0m13:26:09.070593 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:26:09.070593 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m13:26:09.070593 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:26:09.086217 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m13:26:09.086217 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m13:26:09.086217 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_11482]
   as 
    
    
    



select Payment_Method
from "my_db"."dbo"."ecommerce"
where Payment_Method is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_11482]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_11482]
  ;')
[0m13:26:09.086217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:09.086217 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:09.086217 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:09.101848 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:09.101848 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: ROLLBACK
[0m13:26:09.101848 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: Close
[0m13:26:09.101848 [info ] [Thread-1 (]: 13 of 20 PASS source_not_null_sqlserver_ecommerce_Payment_Method ............... [[32mPASS[0m in 0.03s]
[0m13:26:09.101848 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:26:09.117466 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:26:09.117466 [info ] [Thread-1 (]: 14 of 20 START test source_not_null_sqlserver_ecommerce_Price .................. [RUN]
[0m13:26:09.117466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01)
[0m13:26:09.117466 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:26:09.117466 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m13:26:09.117466 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:26:09.133093 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m13:26:09.133093 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m13:26:09.133093 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_17823]
   as 
    
    
    



select Price
from "my_db"."dbo"."ecommerce"
where Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_17823]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_17823]
  ;')
[0m13:26:09.133093 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:09.133093 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:09.133093 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:09.148716 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:09.148716 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: ROLLBACK
[0m13:26:09.148716 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: Close
[0m13:26:09.164341 [info ] [Thread-1 (]: 14 of 20 PASS source_not_null_sqlserver_ecommerce_Price ........................ [[32mPASS[0m in 0.05s]
[0m13:26:09.164341 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:26:09.164341 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:26:09.164341 [info ] [Thread-1 (]: 15 of 20 START test source_not_null_sqlserver_ecommerce_Product_ID ............. [RUN]
[0m13:26:09.164341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff)
[0m13:26:09.164341 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:26:09.180002 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m13:26:09.180002 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:26:09.269237 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m13:26:09.271237 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m13:26:09.272242 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_12085]
   as 
    
    
    



select Product_ID
from "my_db"."dbo"."ecommerce"
where Product_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_12085]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_12085]
  ;')
[0m13:26:09.273357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:09.273357 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:09.273357 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:09.273357 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:09.289021 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: ROLLBACK
[0m13:26:09.289021 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: Close
[0m13:26:09.289021 [info ] [Thread-1 (]: 15 of 20 PASS source_not_null_sqlserver_ecommerce_Product_ID ................... [[32mPASS[0m in 0.12s]
[0m13:26:09.289021 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:26:09.289021 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:26:09.289021 [info ] [Thread-1 (]: 16 of 20 START test source_not_null_sqlserver_ecommerce_Purchase_Date .......... [RUN]
[0m13:26:09.289021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17)
[0m13:26:09.289021 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:26:09.304619 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m13:26:09.304619 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:26:09.320274 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m13:26:09.320274 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m13:26:09.320274 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_12852]
   as 
    
    
    



select Purchase_Date
from "my_db"."dbo"."ecommerce"
where Purchase_Date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_12852]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_12852]
  ;')
[0m13:26:09.320274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:09.320274 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:09.320274 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:09.335863 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:09.335863 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: ROLLBACK
[0m13:26:09.335863 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: Close
[0m13:26:09.335863 [info ] [Thread-1 (]: 16 of 20 PASS source_not_null_sqlserver_ecommerce_Purchase_Date ................ [[32mPASS[0m in 0.05s]
[0m13:26:09.335863 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:26:09.335863 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:26:09.351482 [info ] [Thread-1 (]: 17 of 20 START test source_not_null_sqlserver_ecommerce_User_ID ................ [RUN]
[0m13:26:09.351482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc)
[0m13:26:09.351482 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:26:09.351482 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m13:26:09.351482 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:26:09.367149 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m13:26:09.367149 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m13:26:09.367149 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_6754]
   as 
    
    
    



select User_ID
from "my_db"."dbo"."ecommerce"
where User_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_6754]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_6754]
  ;')
[0m13:26:09.367149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:09.367149 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:09.367149 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:09.382752 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:09.382752 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: ROLLBACK
[0m13:26:09.382752 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: Close
[0m13:26:09.382752 [info ] [Thread-1 (]: 17 of 20 PASS source_not_null_sqlserver_ecommerce_User_ID ...................... [[32mPASS[0m in 0.03s]
[0m13:26:09.398381 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:26:09.398381 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce
[0m13:26:09.398381 [info ] [Thread-1 (]: 18 of 20 SKIP relation dbo.src_ecommerce ....................................... [[33mSKIP[0m]
[0m13:26:09.398381 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce
[0m13:26:09.398381 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce_datatypes
[0m13:26:09.398381 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.src_ecommerce' to be skipped because of status 'skipped'. 
[0m13:26:09.398381 [info ] [Thread-1 (]: 19 of 20 SKIP relation dbo.src_ecommerce_datatypes ............................. [[33mSKIP[0m]
[0m13:26:09.398381 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce_datatypes
[0m13:26:09.398381 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.stg_ecommerce
[0m13:26:09.413982 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.src_ecommerce_datatypes' to be skipped because of status 'skipped'. 
[0m13:26:09.413982 [info ] [Thread-1 (]: 20 of 20 SKIP relation dbo.stg_ecommerce ....................................... [[33mSKIP[0m]
[0m13:26:09.413982 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.stg_ecommerce
[0m13:26:09.413982 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.stg_ecommerce' to be skipped because of status 'skipped'. 
[0m13:26:09.413982 [debug] [MainThread]: On master: COMMIT
[0m13:26:09.413982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:26:09.413982 [debug] [MainThread]: Connection 'list_my_db' was properly closed.
[0m13:26:09.413982 [debug] [MainThread]: Connection 'list_my_db_dbo' was properly closed.
[0m13:26:09.413982 [debug] [MainThread]: Connection 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc' was properly closed.
[0m13:26:09.413982 [info ] [MainThread]: 
[0m13:26:09.429647 [info ] [MainThread]: Finished running 17 data tests, 3 view models in 0 hours 0 minutes and 1.62 seconds (1.62s).
[0m13:26:09.429647 [debug] [MainThread]: Command end result
[0m13:26:09.523418 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m13:26:09.539043 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m13:26:09.554662 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m13:26:09.554662 [info ] [MainThread]: 
[0m13:26:09.570287 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m13:26:09.570287 [info ] [MainThread]: 
[0m13:26:09.570287 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:26:09.570287 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:26:09.570287 [info ] [MainThread]: 
[0m13:26:09.570287 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Category__varchar.sql
[0m13:26:09.570287 [info ] [MainThread]: 
[0m13:26:09.570287 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:26:09.570287 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:26:09.570287 [info ] [MainThread]: 
[0m13:26:09.585915 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Discount__int.sql
[0m13:26:09.585915 [info ] [MainThread]: 
[0m13:26:09.585915 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:26:09.585915 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:26:09.585915 [info ] [MainThread]: 
[0m13:26:09.585915 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Final_Price__float.sql
[0m13:26:09.585915 [info ] [MainThread]: 
[0m13:26:09.601536 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:26:09.601536 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:26:09.601536 [info ] [MainThread]: 
[0m13:26:09.601536 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Payment_Method__varchar.sql
[0m13:26:09.601536 [info ] [MainThread]: 
[0m13:26:09.601536 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:26:09.601536 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:26:09.617187 [info ] [MainThread]: 
[0m13:26:09.617187 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Price__float.sql
[0m13:26:09.617187 [info ] [MainThread]: 
[0m13:26:09.617187 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:26:09.617187 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:26:09.632829 [info ] [MainThread]: 
[0m13:26:09.632829 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Product_ID__varchar.sql
[0m13:26:09.632829 [info ] [MainThread]: 
[0m13:26:09.632829 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:26:09.632829 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:26:09.632829 [info ] [MainThread]: 
[0m13:26:09.632829 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Purchase_Date__date.sql
[0m13:26:09.632829 [info ] [MainThread]: 
[0m13:26:09.632829 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:26:09.648429 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:26:09.648429 [info ] [MainThread]: 
[0m13:26:09.648429 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_User_ID__varchar.sql
[0m13:26:09.648429 [info ] [MainThread]: 
[0m13:26:09.648429 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=8 SKIP=3 NO-OP=0 TOTAL=20
[0m13:26:09.664036 [debug] [MainThread]: Command `dbt build` failed at 13:26:09.664036 after 5.69 seconds
[0m13:26:09.664036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D13BE33DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D13C0911D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D13C0910D0>]}
[0m13:26:09.664036 [debug] [MainThread]: Flushing usage events
[0m13:26:10.251806 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:19.538986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C158876490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C158877F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C158877950>]}


============================== 13:26:19.554650 | 54fc03b0-dced-4585-a27f-033e2ebc903a ==============================
[0m13:26:19.554650 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:26:19.554650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:26:19.882904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54fc03b0-dced-4585-a27f-033e2ebc903a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C157FC73D0>]}
[0m13:26:20.071485 [debug] [MainThread]: Command `dbt clean` succeeded at 13:26:20.071485 after 0.66 seconds
[0m13:26:20.071485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C151E73C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1577F8090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C152156290>]}
[0m13:26:20.071485 [debug] [MainThread]: Flushing usage events
[0m13:26:20.680026 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:26.971839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022669D16E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022669D15010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022669D17C50>]}


============================== 13:26:26.980191 | d8d1c758-7b46-46a5-9500-c912d0665c1c ==============================
[0m13:26:26.980191 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:26:26.983189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:26:27.306148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8d1c758-7b46-46a5-9500-c912d0665c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022669DCDED0>]}
[0m13:26:27.368082 [debug] [MainThread]: Set downloads directory='C:\Users\diniz\AppData\Local\Temp\dbt-downloads-k9b06xsk'
[0m13:26:27.368082 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:26:27.617391 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:26:27.617391 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:26:27.950850 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:26:27.957845 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:26:28.616862 [info ] [MainThread]: Installed from version 1.3.0
[0m13:26:28.618886 [info ] [MainThread]: Up to date!
[0m13:26:28.620861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd8d1c758-7b46-46a5-9500-c912d0665c1c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022666B53FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022668CC2C50>]}
[0m13:26:28.624862 [debug] [MainThread]: Command `dbt deps` succeeded at 13:26:28.624862 after 1.79 seconds
[0m13:26:28.626862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022663333C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022669D3AE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022669DEE590>]}
[0m13:26:28.627860 [debug] [MainThread]: Flushing usage events
[0m13:26:29.195531 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:35.930648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210C5EE8D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210C5CA04D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210C5EE84D0>]}


============================== 13:26:35.930648 | 8ac07684-e9b3-45e9-9ab3-a1dafeba9b28 ==============================
[0m13:26:35.930648 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:26:35.930648 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --target sqlserver', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:26:36.867565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ac07684-e9b3-45e9-9ab3-a1dafeba9b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210C775B750>]}
[0m13:26:36.976948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ac07684-e9b3-45e9-9ab3-a1dafeba9b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210C4E11F90>]}
[0m13:26:36.976948 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m13:26:37.757730 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m13:26:37.757730 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:26:37.757730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8ac07684-e9b3-45e9-9ab3-a1dafeba9b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210C7746350>]}
[0m13:26:41.367988 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_customers' which is disabled
[0m13:26:41.367988 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_customers' which is disabled
[0m13:26:41.367988 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_customers' which is disabled
[0m13:26:41.367988 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_customers' which is disabled
[0m13:26:41.367988 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_5_products' which is disabled
[0m13:26:41.367988 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_5_products' which is disabled
[0m13:26:41.367988 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_5_products' which is disabled
[0m13:26:41.367988 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'monthly_revenue' which is disabled
[0m13:26:41.367988 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'monthly_revenue' which is disabled
[0m13:26:41.367988 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'monthly_revenue' which is disabled
[0m13:26:41.383612 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_discount_by_category' which is disabled
[0m13:26:41.383612 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_discount_by_category' which is disabled
[0m13:26:41.383612 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_discount_by_category' which is disabled
[0m13:26:41.383612 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_ticket_by_category' which is disabled
[0m13:26:41.383612 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_ticket_by_category' which is disabled
[0m13:26:41.383612 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_ticket_by_category' which is disabled
[0m13:26:41.383612 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'payment_distribution' which is disabled
[0m13:26:41.383612 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'payment_distribution' which is disabled
[0m13:26:41.383612 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'payment_distribution' which is disabled
[0m13:26:41.383612 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'payment_distribution' which is disabled
[0m13:26:41.383612 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'sales_by_category' which is disabled
[0m13:26:41.383612 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'sales_by_category' which is disabled
[0m13:26:41.383612 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'sales_by_category' which is disabled
[0m13:26:41.383612 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'sales_by_category' which is disabled
[0m13:26:41.559917 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m13:26:41.571012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ac07684-e9b3-45e9-9ab3-a1dafeba9b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210C7F04710>]}
[0m13:26:41.867373 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m13:26:41.883000 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m13:26:41.977764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ac07684-e9b3-45e9-9ab3-a1dafeba9b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210C7D275D0>]}
[0m13:26:41.977764 [info ] [MainThread]: Found 3 models, 17 data tests, 1 source, 626 macros
[0m13:26:41.977764 [info ] [MainThread]: 
[0m13:26:41.977764 [info ] [MainThread]: Concurrency: 1 threads (target='sqlserver')
[0m13:26:41.993390 [info ] [MainThread]: 
[0m13:26:41.993390 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m13:26:41.993390 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db'
[0m13:26:42.024696 [debug] [ThreadPool]: dbt-sqlserver
[0m13:26:42.024696 [debug] [ThreadPool]: Using sqlserver connection "list_my_db"
[0m13:26:42.024696 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db"} */
USE [my_db];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m13:26:42.024696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:42.024696 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:42.102400 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m13:26:42.118027 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:26:42.118027 [debug] [ThreadPool]: On list_my_db: Close
[0m13:26:42.118027 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db_dbo'
[0m13:26:42.133654 [debug] [ThreadPool]: dbt-sqlserver
[0m13:26:42.133654 [debug] [ThreadPool]: Using sqlserver connection "list_my_db_dbo"
[0m13:26:42.133654 [debug] [ThreadPool]: On list_my_db_dbo: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db_dbo"} */
USE [my_db];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m13:26:42.133654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:42.133654 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:42.133654 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m13:26:42.133654 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:26:42.149315 [debug] [ThreadPool]: On list_my_db_dbo: ROLLBACK
[0m13:26:42.149315 [debug] [ThreadPool]: On list_my_db_dbo: Close
[0m13:26:42.149315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ac07684-e9b3-45e9-9ab3-a1dafeba9b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210C7F1A0D0>]}
[0m13:26:42.149315 [debug] [MainThread]: On master: COMMIT
[0m13:26:42.149315 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:26:42.164902 [info ] [Thread-1 (]: 1 of 20 START test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [RUN]
[0m13:26:42.167143 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8'
[0m13:26:42.168181 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:26:42.188178 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m13:26:42.194829 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:26:42.227245 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m13:26:42.227245 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m13:26:42.227245 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_15890]
   as 
    
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from "my_db"."dbo"."ecommerce"
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    ''Credit Card'',''Net Banking'',''UPI'',''Debit Card'',''Cash on Delivery''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_15890]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7999099e1334cef9eb7ae8ca8d3f9f76_15890]
  ;')
[0m13:26:42.227245 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:26:42.242831 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:42.242831 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:42.258492 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:42.258492 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: ROLLBACK
[0m13:26:42.274077 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: Close
[0m13:26:42.274077 [info ] [Thread-1 (]: 1 of 20 PASS source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [[32mPASS[0m in 0.11s]
[0m13:26:42.274077 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m13:26:42.274077 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m13:26:42.274077 [info ] [Thread-1 (]: 2 of 20 START test source_data_type_sqlserver_ecommerce_Category__varchar ...... [RUN]
[0m13:26:42.274077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e)
[0m13:26:42.274077 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m13:26:42.296086 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e"
[0m13:26:42.298088 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Category'
                AND data_type NOT LIKE 'varchar%'
        
  
[0m13:26:42.299059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:42.301058 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:42.303103 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:42.305168 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:42.305168 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e"
[0m13:26:42.305168 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m13:26:42.305168 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e"
[0m13:26:42.305168 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e"
[0m13:26:42.320836 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_13875]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_13875]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_13875]
  ;')
[0m13:26:42.320836 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:42.320836 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e: ROLLBACK
[0m13:26:42.336462 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e: Close
[0m13:26:42.336462 [error] [Thread-1 (]: 2 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Category__varchar .......... [[31mFAIL 1[0m in 0.06s]
[0m13:26:42.336462 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e
[0m13:26:42.336462 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m13:26:42.336462 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:26:42.336462 [info ] [Thread-1 (]: 3 of 20 START test source_data_type_sqlserver_ecommerce_Discount__int .......... [RUN]
[0m13:26:42.336462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Category__varchar.f11519d13e, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21)
[0m13:26:42.336462 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m13:26:42.352112 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"
[0m13:26:42.352112 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Discount'
                AND data_type NOT LIKE 'int%'
        
  
[0m13:26:42.352112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:42.352112 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:42.352112 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:42.352112 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:42.367671 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"
[0m13:26:42.367671 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m13:26:42.367671 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"
[0m13:26:42.367671 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"
[0m13:26:42.367671 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_9411]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_9411]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_9411]
  ;')
[0m13:26:42.383412 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:42.383412 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21: ROLLBACK
[0m13:26:42.398958 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21: Close
[0m13:26:42.401151 [error] [Thread-1 (]: 3 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Discount__int .............. [[31mFAIL 1[0m in 0.06s]
[0m13:26:42.404153 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21
[0m13:26:42.406176 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m13:26:42.407165 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:26:42.408150 [info ] [Thread-1 (]: 4 of 20 START test source_data_type_sqlserver_ecommerce_Final_Price__float ..... [RUN]
[0m13:26:42.410151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Discount__int.cfd7160e21, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0)
[0m13:26:42.412154 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m13:26:42.414382 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"
[0m13:26:42.414382 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Final_Price'
                AND data_type NOT LIKE 'float%'
        
  
[0m13:26:42.414382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:42.414382 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:42.414382 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:42.414382 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:42.430051 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"
[0m13:26:42.430051 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m13:26:42.430051 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"
[0m13:26:42.430051 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"
[0m13:26:42.430051 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_16664]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_16664]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_16664]
  ;')
[0m13:26:42.445641 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:42.445641 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0: ROLLBACK
[0m13:26:42.445641 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0: Close
[0m13:26:42.445641 [error] [Thread-1 (]: 4 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Final_Price__float ......... [[31mFAIL 1[0m in 0.04s]
[0m13:26:42.461263 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0
[0m13:26:42.461263 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m13:26:42.461263 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:26:42.461263 [info ] [Thread-1 (]: 5 of 20 START test source_data_type_sqlserver_ecommerce_Payment_Method__varchar  [RUN]
[0m13:26:42.461263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Final_Price__float.e50de2b8e0, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261)
[0m13:26:42.461263 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m13:26:42.476899 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261"
[0m13:26:42.476899 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Payment_Method'
                AND data_type NOT LIKE 'varchar%'
        
  
[0m13:26:42.476899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:42.476899 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:42.476899 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:42.476899 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:42.492512 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261"
[0m13:26:42.492512 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m13:26:42.492512 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261"
[0m13:26:42.492512 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261"
[0m13:26:42.492512 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_11413]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_11413]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_11413]
  ;')
[0m13:26:42.508173 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:42.508173 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261: ROLLBACK
[0m13:26:42.508173 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261: Close
[0m13:26:42.508173 [error] [Thread-1 (]: 5 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Payment_Method__varchar .... [[31mFAIL 1[0m in 0.05s]
[0m13:26:42.525151 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261
[0m13:26:42.527150 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m13:26:42.528149 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:26:42.528724 [info ] [Thread-1 (]: 6 of 20 START test source_data_type_sqlserver_ecommerce_Price__float ........... [RUN]
[0m13:26:42.530798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Payment_Method__varchar.2779fc3261, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5)
[0m13:26:42.532807 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m13:26:42.540821 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"
[0m13:26:42.542797 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Price'
                AND data_type NOT LIKE 'float%'
        
  
[0m13:26:42.543800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:42.544800 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:42.546799 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:42.548794 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:42.552859 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"
[0m13:26:42.555794 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m13:26:42.562274 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"
[0m13:26:42.565271 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"
[0m13:26:42.567271 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_9785]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_9785]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_9785]
  ;')
[0m13:26:42.571124 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:42.571124 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5: ROLLBACK
[0m13:26:42.571124 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5: Close
[0m13:26:42.571124 [error] [Thread-1 (]: 6 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Price__float ............... [[31mFAIL 1[0m in 0.04s]
[0m13:26:42.571124 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5
[0m13:26:42.586748 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m13:26:42.586748 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:26:42.586748 [info ] [Thread-1 (]: 7 of 20 START test source_data_type_sqlserver_ecommerce_Product_ID__varchar .... [RUN]
[0m13:26:42.586748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Price__float.4809dcccf5, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db)
[0m13:26:42.586748 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m13:26:42.586748 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db"
[0m13:26:42.602413 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Product_ID'
                AND data_type NOT LIKE 'varchar%'
        
  
[0m13:26:42.602413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:42.602413 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:42.602413 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:42.602413 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:42.602413 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db"
[0m13:26:42.602413 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m13:26:42.623431 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db"
[0m13:26:42.625394 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db"
[0m13:26:42.626402 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_17693]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_17693]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_17693]
  ;')
[0m13:26:42.633742 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:42.633742 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db: ROLLBACK
[0m13:26:42.633742 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db: Close
[0m13:26:42.633742 [error] [Thread-1 (]: 7 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Product_ID__varchar ........ [[31mFAIL 1[0m in 0.05s]
[0m13:26:42.633742 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db
[0m13:26:42.633742 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m13:26:42.649439 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:26:42.649439 [info ] [Thread-1 (]: 8 of 20 START test source_data_type_sqlserver_ecommerce_Purchase_Date__date .... [RUN]
[0m13:26:42.649439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Product_ID__varchar.ce765100db, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f)
[0m13:26:42.649439 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m13:26:42.649439 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"
[0m13:26:42.649439 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'Purchase_Date'
                AND data_type NOT LIKE 'date%'
        
  
[0m13:26:42.649439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:42.665034 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:42.665034 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:42.665034 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:42.665034 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"
[0m13:26:42.665034 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m13:26:42.680623 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"
[0m13:26:42.680623 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"
[0m13:26:42.680623 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_9764]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_9764]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_9764]
  ;')
[0m13:26:42.696244 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:42.696244 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f: ROLLBACK
[0m13:26:42.696244 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f: Close
[0m13:26:42.711873 [error] [Thread-1 (]: 8 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_Purchase_Date__date ........ [[31mFAIL 1[0m in 0.06s]
[0m13:26:42.711873 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f
[0m13:26:42.711873 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m13:26:42.711873 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:26:42.711873 [info ] [Thread-1 (]: 9 of 20 START test source_data_type_sqlserver_ecommerce_User_ID__varchar ....... [RUN]
[0m13:26:42.711873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_Purchase_Date__date.9f137c141f, now test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14)
[0m13:26:42.711873 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m13:26:42.740824 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14"
[0m13:26:42.742825 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14"} */

    
            SELECT 
                COUNT(*) AS count_of_mismatched_types
            FROM information_schema.columns
            WHERE 
                table_catalog = 'my_db'
                AND table_schema = 'dbo'
                AND table_name = 'ecommerce'
                AND column_name = 'User_ID'
                AND data_type NOT LIKE 'varchar%'
        
  
[0m13:26:42.743899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:42.743899 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:42.743899 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:42.743899 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:42.743899 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14"
[0m13:26:42.743899 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m13:26:42.743899 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14"
[0m13:26:42.759535 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14"
[0m13:26:42.759535 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_5146]
   as 
    

    

    
        

        
        
        
            SELECT 0 AS test_fail
        
    


  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_5146]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_dbdd2a4c7970e88862a95d72be3bd541_5146]
  ;')
[0m13:26:42.759535 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:42.759535 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14: ROLLBACK
[0m13:26:42.759535 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14: Close
[0m13:26:42.775197 [error] [Thread-1 (]: 9 of 20 FAIL 1 source_data_type_sqlserver_ecommerce_User_ID__varchar ........... [[31mFAIL 1[0m in 0.06s]
[0m13:26:42.775197 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14
[0m13:26:42.775197 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:26:42.775197 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14' to be skipped because of status 'fail'.  Reason: Got 1 result, configured to fail if != 0.
[0m13:26:42.775197 [info ] [Thread-1 (]: 10 of 20 START test source_not_null_sqlserver_ecommerce_Category ............... [RUN]
[0m13:26:42.775197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_data_type_sqlserver_ecommerce_User_ID__varchar.2abe62fb14, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407)
[0m13:26:42.775197 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:26:42.790783 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m13:26:42.790783 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:26:42.806450 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m13:26:42.806450 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m13:26:42.806450 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_17289]
   as 
    
    
    



select Category
from "my_db"."dbo"."ecommerce"
where Category is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_17289]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_491fe7bb43562776c9b8b25f5b1f0e65_17289]
  ;')
[0m13:26:42.806450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:42.806450 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:42.806450 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:42.822026 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:42.822026 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: ROLLBACK
[0m13:26:42.822026 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: Close
[0m13:26:42.822026 [info ] [Thread-1 (]: 10 of 20 PASS source_not_null_sqlserver_ecommerce_Category ..................... [[32mPASS[0m in 0.05s]
[0m13:26:42.839866 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m13:26:42.840865 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:26:42.842864 [info ] [Thread-1 (]: 11 of 20 START test source_not_null_sqlserver_ecommerce_Discount ............... [RUN]
[0m13:26:42.844457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f)
[0m13:26:42.845456 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:26:42.852549 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m13:26:42.852549 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:26:42.852549 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m13:26:42.852549 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m13:26:42.852549 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_2571]
   as 
    
    
    



select Discount
from "my_db"."dbo"."ecommerce"
where Discount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_2571]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_5a693b107c6d94cc971f3f52da874160_2571]
  ;')
[0m13:26:42.852549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:42.868217 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:42.868217 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:42.868217 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:42.868217 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: ROLLBACK
[0m13:26:42.883823 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: Close
[0m13:26:42.883823 [info ] [Thread-1 (]: 11 of 20 PASS source_not_null_sqlserver_ecommerce_Discount ..................... [[32mPASS[0m in 0.04s]
[0m13:26:42.883823 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m13:26:42.883823 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:26:42.883823 [info ] [Thread-1 (]: 12 of 20 START test source_not_null_sqlserver_ecommerce_Final_Price ............ [RUN]
[0m13:26:42.883823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d)
[0m13:26:42.883823 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:26:42.899446 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m13:26:42.899446 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:26:42.899446 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m13:26:42.915053 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m13:26:42.915053 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_18569]
   as 
    
    
    



select Final_Price
from "my_db"."dbo"."ecommerce"
where Final_Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_18569]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_0c828dfdcf5b3aad6aaa994913a3962f_18569]
  ;')
[0m13:26:42.915053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:42.915053 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:42.915053 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:42.930725 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:42.930725 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: ROLLBACK
[0m13:26:42.930725 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: Close
[0m13:26:42.930725 [info ] [Thread-1 (]: 12 of 20 PASS source_not_null_sqlserver_ecommerce_Final_Price .................. [[32mPASS[0m in 0.05s]
[0m13:26:42.930725 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m13:26:42.930725 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:26:42.930725 [info ] [Thread-1 (]: 13 of 20 START test source_not_null_sqlserver_ecommerce_Payment_Method ......... [RUN]
[0m13:26:42.930725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae)
[0m13:26:42.946301 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:26:42.955552 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m13:26:42.957552 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:26:42.961697 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m13:26:42.961697 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m13:26:42.961697 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_4361]
   as 
    
    
    



select Payment_Method
from "my_db"."dbo"."ecommerce"
where Payment_Method is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_4361]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_21a139b11381849eb19de652fee70f66_4361]
  ;')
[0m13:26:42.961697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:42.961697 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:42.961697 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:42.977365 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:42.992997 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: ROLLBACK
[0m13:26:42.992997 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: Close
[0m13:26:42.992997 [info ] [Thread-1 (]: 13 of 20 PASS source_not_null_sqlserver_ecommerce_Payment_Method ............... [[32mPASS[0m in 0.06s]
[0m13:26:42.992997 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m13:26:42.992997 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:26:42.992997 [info ] [Thread-1 (]: 14 of 20 START test source_not_null_sqlserver_ecommerce_Price .................. [RUN]
[0m13:26:42.992997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01)
[0m13:26:42.992997 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:26:43.008579 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m13:26:43.008579 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:26:43.008579 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m13:26:43.024201 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m13:26:43.024201 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_10157]
   as 
    
    
    



select Price
from "my_db"."dbo"."ecommerce"
where Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_10157]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_e72d4251eae6aeb393f5f649a06f5ac0_10157]
  ;')
[0m13:26:43.024201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:43.024201 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:43.024201 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:43.024201 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:43.042115 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: ROLLBACK
[0m13:26:43.044112 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: Close
[0m13:26:43.045073 [info ] [Thread-1 (]: 14 of 20 PASS source_not_null_sqlserver_ecommerce_Price ........................ [[32mPASS[0m in 0.05s]
[0m13:26:43.048076 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m13:26:43.050107 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:26:43.052076 [info ] [Thread-1 (]: 15 of 20 START test source_not_null_sqlserver_ecommerce_Product_ID ............. [RUN]
[0m13:26:43.054075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff)
[0m13:26:43.056074 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:26:43.063110 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m13:26:43.066099 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:26:43.071192 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m13:26:43.071192 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m13:26:43.071192 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_2951]
   as 
    
    
    



select Product_ID
from "my_db"."dbo"."ecommerce"
where Product_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_2951]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_aa576225f643234fe9ca29dea78b3ee4_2951]
  ;')
[0m13:26:43.071192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:43.071192 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:43.071192 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:43.086817 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:43.086817 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: ROLLBACK
[0m13:26:43.086817 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: Close
[0m13:26:43.086817 [info ] [Thread-1 (]: 15 of 20 PASS source_not_null_sqlserver_ecommerce_Product_ID ................... [[32mPASS[0m in 0.03s]
[0m13:26:43.102464 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m13:26:43.102464 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:26:43.102464 [info ] [Thread-1 (]: 16 of 20 START test source_not_null_sqlserver_ecommerce_Purchase_Date .......... [RUN]
[0m13:26:43.102464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17)
[0m13:26:43.102464 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:26:43.102464 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m13:26:43.118109 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:26:43.118109 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m13:26:43.118109 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m13:26:43.118109 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_14117]
   as 
    
    
    



select Purchase_Date
from "my_db"."dbo"."ecommerce"
where Purchase_Date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_14117]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_0f53a46810cccddc285b5a5f2fa86299_14117]
  ;')
[0m13:26:43.118109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:43.133714 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:43.133714 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:43.133714 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:43.149441 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: ROLLBACK
[0m13:26:43.149441 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: Close
[0m13:26:43.149441 [info ] [Thread-1 (]: 16 of 20 PASS source_not_null_sqlserver_ecommerce_Purchase_Date ................ [[32mPASS[0m in 0.05s]
[0m13:26:43.149441 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m13:26:43.149441 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:26:43.149441 [info ] [Thread-1 (]: 17 of 20 START test source_not_null_sqlserver_ecommerce_User_ID ................ [RUN]
[0m13:26:43.149441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc)
[0m13:26:43.149441 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:26:43.171309 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m13:26:43.173308 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:26:43.179304 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m13:26:43.180425 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m13:26:43.180425 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_7024]
   as 
    
    
    



select User_ID
from "my_db"."dbo"."ecommerce"
where User_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_7024]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_cf5a2a1ccc69e2afe103181343e9f1f0_7024]
  ;')
[0m13:26:43.180425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:26:43.180425 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m13:26:43.180425 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m13:26:43.196057 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:26:43.196057 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: ROLLBACK
[0m13:26:43.196057 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: Close
[0m13:26:43.196057 [info ] [Thread-1 (]: 17 of 20 PASS source_not_null_sqlserver_ecommerce_User_ID ...................... [[32mPASS[0m in 0.05s]
[0m13:26:43.196057 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m13:26:43.196057 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce
[0m13:26:43.196057 [info ] [Thread-1 (]: 18 of 20 SKIP relation dbo.src_ecommerce ....................................... [[33mSKIP[0m]
[0m13:26:43.211679 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce
[0m13:26:43.211679 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce_datatypes
[0m13:26:43.211679 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.src_ecommerce' to be skipped because of status 'skipped'. 
[0m13:26:43.211679 [info ] [Thread-1 (]: 19 of 20 SKIP relation dbo.src_ecommerce_datatypes ............................. [[33mSKIP[0m]
[0m13:26:43.211679 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce_datatypes
[0m13:26:43.211679 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.stg_ecommerce
[0m13:26:43.211679 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.src_ecommerce_datatypes' to be skipped because of status 'skipped'. 
[0m13:26:43.211679 [info ] [Thread-1 (]: 20 of 20 SKIP relation dbo.stg_ecommerce ....................................... [[33mSKIP[0m]
[0m13:26:43.211679 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.stg_ecommerce
[0m13:26:43.211679 [debug] [Thread-4 (]: Marking all children of 'model.dbt_databricks_cicd.stg_ecommerce' to be skipped because of status 'skipped'. 
[0m13:26:43.227307 [debug] [MainThread]: On master: COMMIT
[0m13:26:43.227307 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:26:43.227307 [debug] [MainThread]: Connection 'list_my_db' was properly closed.
[0m13:26:43.227307 [debug] [MainThread]: Connection 'list_my_db_dbo' was properly closed.
[0m13:26:43.227307 [debug] [MainThread]: Connection 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc' was properly closed.
[0m13:26:43.227307 [info ] [MainThread]: 
[0m13:26:43.227307 [info ] [MainThread]: Finished running 17 data tests, 3 view models in 0 hours 0 minutes and 1.23 seconds (1.23s).
[0m13:26:43.242969 [debug] [MainThread]: Command end result
[0m13:26:43.321223 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m13:26:43.321223 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m13:26:43.336888 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m13:26:43.336888 [info ] [MainThread]: 
[0m13:26:43.336888 [info ] [MainThread]: [31mCompleted with 8 errors, 0 partial successes, and 0 warnings:[0m
[0m13:26:43.336888 [info ] [MainThread]: 
[0m13:26:43.336888 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Category__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:26:43.336888 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:26:43.352514 [info ] [MainThread]: 
[0m13:26:43.352514 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Category__varchar.sql
[0m13:26:43.352514 [info ] [MainThread]: 
[0m13:26:43.352514 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Discount__int (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:26:43.352514 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:26:43.352514 [info ] [MainThread]: 
[0m13:26:43.352514 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Discount__int.sql
[0m13:26:43.352514 [info ] [MainThread]: 
[0m13:26:43.352514 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Final_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:26:43.352514 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:26:43.368100 [info ] [MainThread]: 
[0m13:26:43.368100 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Final_Price__float.sql
[0m13:26:43.368100 [info ] [MainThread]: 
[0m13:26:43.368100 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Payment_Method__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:26:43.368100 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:26:43.368100 [info ] [MainThread]: 
[0m13:26:43.368100 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Payment_Method__varchar.sql
[0m13:26:43.368100 [info ] [MainThread]: 
[0m13:26:43.386947 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Price__float (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:26:43.388581 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:26:43.390136 [info ] [MainThread]: 
[0m13:26:43.392470 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Price__float.sql
[0m13:26:43.393470 [info ] [MainThread]: 
[0m13:26:43.395433 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Product_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:26:43.397432 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:26:43.399675 [info ] [MainThread]: 
[0m13:26:43.399675 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Product_ID__varchar.sql
[0m13:26:43.399675 [info ] [MainThread]: 
[0m13:26:43.399675 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_Purchase_Date__date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:26:43.399675 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:26:43.399675 [info ] [MainThread]: 
[0m13:26:43.399675 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_Purchase_Date__date.sql
[0m13:26:43.399675 [info ] [MainThread]: 
[0m13:26:43.399675 [error] [MainThread]: [31mFailure in test source_data_type_sqlserver_ecommerce_User_ID__varchar (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m13:26:43.415326 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:26:43.415326 [info ] [MainThread]: 
[0m13:26:43.415326 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_data_type_sqlserver_ecommerce_User_ID__varchar.sql
[0m13:26:43.415326 [info ] [MainThread]: 
[0m13:26:43.415326 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=8 SKIP=3 NO-OP=0 TOTAL=20
[0m13:26:43.415326 [debug] [MainThread]: Command `dbt build` failed at 13:26:43.415326 after 7.63 seconds
[0m13:26:43.415326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210BF3C3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210BF620550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210BF6210D0>]}
[0m13:26:43.430910 [debug] [MainThread]: Flushing usage events
[0m13:26:44.049633 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:28:53.758096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F5EC66650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F5DD68890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F5ECBBC10>]}


============================== 13:28:53.773721 | 36282f72-7afe-4f8e-827a-9f159ecc9372 ==============================
[0m13:28:53.773721 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:28:53.773721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt build --target sqlserver', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:28:54.727078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36282f72-7afe-4f8e-827a-9f159ecc9372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F5DC70B10>]}
[0m13:28:54.837026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36282f72-7afe-4f8e-827a-9f159ecc9372', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F5DBCDE50>]}
[0m13:28:54.837026 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m13:28:55.664633 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m13:28:56.259062 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:28:56.259062 [debug] [MainThread]: Partial parsing: updated file: dbt_databricks_cicd://macros\test_data_type.sql
[0m13:28:56.259062 [error] [MainThread]: Encountered an error:
Compilation Error
  expected token ',', got '='
    line 4
      --         database=model.database,
[0m13:28:56.259062 [debug] [MainThread]: Command `dbt build` failed at 13:28:56.259062 after 2.68 seconds
[0m13:28:56.274729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F5ECBA690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F58243DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020F5EC66090>]}
[0m13:28:56.274729 [debug] [MainThread]: Flushing usage events
[0m13:28:56.867903 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:43:57.042280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4AEE25990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4AEE27010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4AEE24E10>]}


============================== 13:43:57.050242 | 8c7ce299-9f6e-4ca8-bcd7-2de8eac7b1ba ==============================
[0m13:43:57.050242 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:43:57.052248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build --target sqlserver', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:43:57.967430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c7ce299-9f6e-4ca8-bcd7-2de8eac7b1ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4B06B5F10>]}
[0m13:43:58.071089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c7ce299-9f6e-4ca8-bcd7-2de8eac7b1ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4ADD7DE50>]}
[0m13:43:58.071089 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m13:43:58.836426 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m13:43:59.336144 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:43:59.336144 [debug] [MainThread]: Partial parsing: updated file: dbt_databricks_cicd://macros\test_data_type.sql
[0m13:43:59.336144 [error] [MainThread]: Encountered an error:
Compilation Error
  expected token ',', got '='
    line 4
      --         database=model.database,
[0m13:43:59.336144 [debug] [MainThread]: Command `dbt build` failed at 13:43:59.336144 after 2.44 seconds
[0m13:43:59.336144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4A8373DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4A85D0550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4B0B28650>]}
[0m13:43:59.336144 [debug] [MainThread]: Flushing usage events
[0m13:44:00.164523 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:47:00.444238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023D2B5810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023955AAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023D2B6190>]}


============================== 13:47:00.454402 | f2cb4bb6-9b65-4eb6-b9de-5ba47f29695c ==============================
[0m13:47:00.454402 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:47:00.458403 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt build --target sqlserver', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:47:01.507919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2cb4bb6-9b65-4eb6-b9de-5ba47f29695c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023EB93650>]}
[0m13:47:01.618277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2cb4bb6-9b65-4eb6-b9de-5ba47f29695c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023C211F10>]}
[0m13:47:01.618277 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m13:47:02.430156 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m13:47:02.962033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:47:02.962033 [debug] [MainThread]: Partial parsing: updated file: dbt_databricks_cicd://macros\test_data_type.sql
[0m13:47:02.962033 [error] [MainThread]: Encountered an error:
Compilation Error
  expected token ',', got '='
    line 4
      --         database=model.database,
[0m13:47:02.962033 [debug] [MainThread]: Command `dbt build` failed at 13:47:02.962033 after 2.73 seconds
[0m13:47:02.962033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202367F3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023D2B68D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002023D2B6A90>]}
[0m13:47:02.962033 [debug] [MainThread]: Flushing usage events
[0m13:47:03.587707 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:47:14.445173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099B7D01D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099B7D38D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099B7D0250>]}


============================== 13:47:14.445173 | b59808df-da9a-4beb-bb19-46a8f4e7e2e6 ==============================
[0m13:47:14.445173 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:47:14.445173 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m13:47:14.789669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b59808df-da9a-4beb-bb19-46a8f4e7e2e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099B89D450>]}
[0m13:47:14.962409 [debug] [MainThread]: Command `dbt clean` succeeded at 13:47:14.962409 after 0.66 seconds
[0m13:47:14.962409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020994DE3C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099B4C52D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209950C6290>]}
[0m13:47:14.962409 [debug] [MainThread]: Flushing usage events
[0m13:47:15.583703 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:47:21.836744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028925216710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289252178D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028925216D50>]}


============================== 13:47:21.836744 | c188db94-7e97-4409-a201-029a7e2156bd ==============================
[0m13:47:21.836744 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:47:21.836744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:47:22.163509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c188db94-7e97-4409-a201-029a7e2156bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002892529ED90>]}
[0m13:47:22.227054 [debug] [MainThread]: Set downloads directory='C:\Users\diniz\AppData\Local\Temp\dbt-downloads-fz0sa_49'
[0m13:47:22.227054 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:47:22.539601 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:47:22.539601 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:47:22.634097 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:47:22.634097 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:47:23.320673 [info ] [MainThread]: Installed from version 1.3.0
[0m13:47:23.320673 [info ] [MainThread]: Up to date!
[0m13:47:23.320673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c188db94-7e97-4409-a201-029a7e2156bd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028923CAF790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028922339510>]}
[0m13:47:23.320673 [debug] [MainThread]: Command `dbt deps` succeeded at 13:47:23.320673 after 1.63 seconds
[0m13:47:23.320673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002891E7B3C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028924FB48D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028924FB4410>]}
[0m13:47:23.320673 [debug] [MainThread]: Flushing usage events
[0m13:47:23.915199 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:47:30.102555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE17721C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE17722F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE177220D0>]}


============================== 13:47:30.102555 | 7bd5bdef-b247-450d-881f-2e56ddd4c293 ==============================
[0m13:47:30.102555 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:47:30.102555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build --target sqlserver', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:47:31.036622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7bd5bdef-b247-450d-881f-2e56ddd4c293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE19000290>]}
[0m13:47:31.149094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7bd5bdef-b247-450d-881f-2e56ddd4c293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE166A1D50>]}
[0m13:47:31.149094 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m13:47:31.929782 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m13:47:31.929782 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:47:31.929782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7bd5bdef-b247-450d-881f-2e56ddd4c293', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE18FA6F10>]}
[0m13:47:32.345655 [error] [MainThread]: Encountered an error:
Compilation Error
  expected token ',', got '='
    line 4
      --         database=model.database,
[0m13:47:32.349721 [debug] [MainThread]: Command `dbt build` failed at 13:47:32.349721 after 2.38 seconds
[0m13:47:32.351719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE10D73DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE17723790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE190BFB90>]}
[0m13:47:32.351719 [debug] [MainThread]: Flushing usage events
[0m13:47:32.945462 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:48:47.086020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001850C5B14D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001850C2A5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001850C5B2310>]}


============================== 13:48:47.101642 | 5e20b270-45f8-4e42-9b30-d580cff45348 ==============================
[0m13:48:47.101642 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:48:47.101642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt build --target sqlserver', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:48:48.024219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e20b270-45f8-4e42-9b30-d580cff45348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001850DD6EA50>]}
[0m13:48:48.148715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e20b270-45f8-4e42-9b30-d580cff45348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001850B51DE10>]}
[0m13:48:48.148715 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m13:48:48.914123 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m13:48:48.929740 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:48:48.929740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5e20b270-45f8-4e42-9b30-d580cff45348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001850C611750>]}
[0m13:48:49.258995 [error] [MainThread]: Encountered an error:
Compilation Error
  expected token ',', got '='
    line 4
      --         database=model.database,
[0m13:48:49.275984 [debug] [MainThread]: Command `dbt build` failed at 13:48:49.275984 after 2.31 seconds
[0m13:48:49.276986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018505B73DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001850C611910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001850C613950>]}
[0m13:48:49.277983 [debug] [MainThread]: Flushing usage events
[0m13:48:49.867578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:48:58.226584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165F7623DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165F7636310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165F7635CD0>]}


============================== 13:48:58.242210 | d3fad8cb-1ab3-4dc4-85d2-5894cdb740ad ==============================
[0m13:48:58.242210 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:48:58.242210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:48:58.554947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3fad8cb-1ab3-4dc4-85d2-5894cdb740ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165F77622D0>]}
[0m13:48:58.758073 [debug] [MainThread]: Command `dbt clean` succeeded at 13:48:58.758073 after 0.67 seconds
[0m13:48:58.758073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165F0B73C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165F76F1B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165F0E56310>]}
[0m13:48:58.773700 [debug] [MainThread]: Flushing usage events
[0m13:48:59.353194 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:07.633219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2D81F3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2D81F3D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2D81F2B10>]}


============================== 13:49:07.633219 | 2a0bb522-0a66-4e5a-a1c1-c66c9f5dd35f ==============================
[0m13:49:07.633219 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:49:07.648811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:49:07.977394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a0bb522-0a66-4e5a-a1c1-c66c9f5dd35f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2D82CCE90>]}
[0m13:49:08.055660 [debug] [MainThread]: Set downloads directory='C:\Users\diniz\AppData\Local\Temp\dbt-downloads-ygxa8hra'
[0m13:49:08.055660 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:49:08.259240 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:49:08.259240 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:49:08.337365 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:49:08.337365 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:49:09.180084 [info ] [MainThread]: Installed from version 1.3.0
[0m13:49:09.180084 [info ] [MainThread]: Up to date!
[0m13:49:09.180084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2a0bb522-0a66-4e5a-a1c1-c66c9f5dd35f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2D81F0990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2D71C9850>]}
[0m13:49:09.180084 [debug] [MainThread]: Command `dbt deps` succeeded at 13:49:09.180084 after 1.69 seconds
[0m13:49:09.180084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2D1803C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2D1AE6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2D1A60210>]}
[0m13:49:09.180084 [debug] [MainThread]: Flushing usage events
[0m13:49:10.087578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:17.554860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C9A6EFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C9A6DCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C9A6F090>]}


============================== 13:49:17.554860 | 70508ecf-ec92-4068-80b7-9fca6f8c5639 ==============================
[0m13:49:17.554860 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:49:17.554860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build --target sqlserver', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:49:18.477216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70508ecf-ec92-4068-80b7-9fca6f8c5639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221CB32FF10>]}
[0m13:49:18.586432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70508ecf-ec92-4068-80b7-9fca6f8c5639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221CB2EFD90>]}
[0m13:49:18.586432 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m13:49:19.352495 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m13:49:19.352495 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:49:19.352495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '70508ecf-ec92-4068-80b7-9fca6f8c5639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221CB54EE10>]}
[0m13:49:19.773326 [error] [MainThread]: Encountered an error:
Compilation Error
  expected token ',', got '='
    line 4
      --         database=model.database,
[0m13:49:19.773326 [debug] [MainThread]: Command `dbt build` failed at 13:49:19.773326 after 2.35 seconds
[0m13:49:19.773326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C3093DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C9A6E450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C9A6DCD0>]}
[0m13:49:19.773326 [debug] [MainThread]: Flushing usage events
[0m13:49:20.380884 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:53.706761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145C0449750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145C0444ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145C0445F10>]}


============================== 13:49:53.722385 | cc5a755c-3d72-45d4-b951-506cd7efed2f ==============================
[0m13:49:53.722385 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:49:53.722385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile --target sqlserver', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:49:54.677402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc5a755c-3d72-45d4-b951-506cd7efed2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145BFBDC2D0>]}
[0m13:49:54.805263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc5a755c-3d72-45d4-b951-506cd7efed2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145BF3A1F50>]}
[0m13:49:54.805263 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m13:49:55.571032 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m13:49:55.571032 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:49:55.571032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cc5a755c-3d72-45d4-b951-506cd7efed2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145C1F1B210>]}
[0m13:49:55.945188 [error] [MainThread]: Encountered an error:
Compilation Error
  expected token ',', got '='
    line 4
      --         database=model.database,
[0m13:49:55.945188 [debug] [MainThread]: Command `dbt compile` failed at 13:49:55.945188 after 2.38 seconds
[0m13:49:55.945188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145B99F3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145C1F70090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145C1F67B90>]}
[0m13:49:55.945188 [debug] [MainThread]: Flushing usage events
[0m13:49:56.556625 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:56:34.980006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB31E80D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB31BA550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB31BAB10>]}


============================== 13:56:34.995630 | dd222148-d245-4555-93c9-29d674e14862 ==============================
[0m13:56:34.995630 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:56:34.995630 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt compile --target sqlserver', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:56:35.962048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd222148-d245-4555-93c9-29d674e14862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB4A461D0>]}
[0m13:56:36.150877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd222148-d245-4555-93c9-29d674e14862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB3263190>]}
[0m13:56:36.153875 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m13:56:37.133186 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m13:56:37.133186 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:56:37.148811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dd222148-d245-4555-93c9-29d674e14862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB4CD2010>]}
[0m13:56:37.572038 [error] [MainThread]: Encountered an error:
Compilation Error
  expected token ',', got '='
    line 4
      --         database=model.database,
[0m13:56:37.572038 [debug] [MainThread]: Command `dbt compile` failed at 13:56:37.572038 after 2.77 seconds
[0m13:56:37.572038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB31BB790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB4CD0090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB4C97B90>]}
[0m13:56:37.572038 [debug] [MainThread]: Flushing usage events
[0m13:56:38.180151 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:56:48.258413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ACB05A250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ACB05AD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ACB001310>]}


============================== 13:56:48.258413 | 0b7794cf-34d6-44bd-a4bb-8548fff0f53d ==============================
[0m13:56:48.258413 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:56:48.258413 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build --target sqlserver', 'send_anonymous_usage_stats': 'True'}
[0m13:56:49.233414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b7794cf-34d6-44bd-a4bb-8548fff0f53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ACC788DD0>]}
[0m13:56:49.367782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b7794cf-34d6-44bd-a4bb-8548fff0f53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AC9F61F90>]}
[0m13:56:49.367782 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m13:56:50.148631 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m13:56:50.148631 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:56:50.148631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0b7794cf-34d6-44bd-a4bb-8548fff0f53d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ACB061750>]}
[0m13:56:50.509681 [error] [MainThread]: Encountered an error:
Compilation Error
  expected token ',', got '='
    line 4
      --         database=model.database,
[0m13:56:50.509681 [debug] [MainThread]: Command `dbt build` failed at 13:56:50.509681 after 2.39 seconds
[0m13:56:50.509681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AC45E3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ACB003B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020ACB003510>]}
[0m13:56:50.509681 [debug] [MainThread]: Flushing usage events
[0m13:56:51.117945 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:04:49.804808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEDA872B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEDA870790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEDA872F90>]}


============================== 14:04:49.820435 | 42deac84-e013-471f-8008-fc801a2787ea ==============================
[0m14:04:49.820435 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:04:49.820435 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:04:50.148349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42deac84-e013-471f-8008-fc801a2787ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEDA9F97D0>]}
[0m14:04:50.305061 [debug] [MainThread]: Command `dbt clean` succeeded at 14:04:50.305061 after 0.65 seconds
[0m14:04:50.305061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED3E03C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEDA8D0090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED40E6310>]}
[0m14:04:50.320991 [debug] [MainThread]: Flushing usage events
[0m14:04:50.976893 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:04:58.992678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181BA2653D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181BA2671D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181BA265810>]}


============================== 14:04:58.992678 | 4f789755-7fd3-48ef-9c38-5435289473a0 ==============================
[0m14:04:58.992678 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:04:59.008268 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:59.336244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f789755-7fd3-48ef-9c38-5435289473a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181BA380D50>]}
[0m14:04:59.398742 [debug] [MainThread]: Set downloads directory='C:\Users\diniz\AppData\Local\Temp\dbt-downloads-_ffzm4s7'
[0m14:04:59.398742 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:04:59.633211 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:04:59.633211 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:04:59.727575 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:04:59.746586 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:00.448598 [info ] [MainThread]: Installed from version 1.3.0
[0m14:05:00.449639 [info ] [MainThread]: Up to date!
[0m14:05:00.450610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4f789755-7fd3-48ef-9c38-5435289473a0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181B8D47750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181B7369990>]}
[0m14:05:00.456640 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:00.455602 after 1.59 seconds
[0m14:05:00.457603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181B3833C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181B3B16310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181B3A90210>]}
[0m14:05:00.458603 [debug] [MainThread]: Flushing usage events
[0m14:05:01.040145 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:05:11.008634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B8B8EAFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B8B8EBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B8B8EA310>]}


============================== 14:05:11.034791 | 033c69cf-d461-4aae-be93-0a2a683d8e6e ==============================
[0m14:05:11.034791 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:05:11.037751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --target sqlserver', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:12.052784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '033c69cf-d461-4aae-be93-0a2a683d8e6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B88627990>]}
[0m14:05:12.148996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '033c69cf-d461-4aae-be93-0a2a683d8e6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B8A801E90>]}
[0m14:05:12.164614 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:05:12.931137 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m14:05:12.931137 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:12.931137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '033c69cf-d461-4aae-be93-0a2a683d8e6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B8C14AFD0>]}
[0m14:05:13.367894 [error] [MainThread]: Encountered an error:
Compilation Error
  expected token ',', got '='
    line 4
      --         database=model.database,
[0m14:05:13.367894 [debug] [MainThread]: Command `dbt build` failed at 14:05:13.367894 after 2.49 seconds
[0m14:05:13.367894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B84DD3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B8D3B8090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B8B584590>]}
[0m14:05:13.367894 [debug] [MainThread]: Flushing usage events
[0m14:05:13.961225 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:05:54.218920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE5C944350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE5CB51690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE5CB51B50>]}


============================== 14:05:54.226924 | 8e3832a4-98f8-41d8-b7a3-dc7babcd77e5 ==============================
[0m14:05:54.226924 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:05:54.229971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --target sqlserver', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:55.165487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e3832a4-98f8-41d8-b7a3-dc7babcd77e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE5E33CE10>]}
[0m14:05:55.350540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e3832a4-98f8-41d8-b7a3-dc7babcd77e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE5BAB1E50>]}
[0m14:05:55.352662 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:05:56.180127 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m14:05:56.180127 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:05:56.180127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8e3832a4-98f8-41d8-b7a3-dc7babcd77e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE5E66CD10>]}
[0m14:05:59.602461 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_databricks_cicd.src_ecommerce' (dbt_databricks_cicd/models\raw\sqlserver\src_ecommerce.sql) depends on a source named 'sqlserver.ecommerce' which was not found
[0m14:05:59.602461 [debug] [MainThread]: Command `dbt build` failed at 14:05:59.602461 after 5.52 seconds
[0m14:05:59.602461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE560F3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE5EAD3790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE5EB2BE90>]}
[0m14:05:59.602461 [debug] [MainThread]: Flushing usage events
[0m14:06:00.212224 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:06:55.727588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002933D82FB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002933D8075D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002933D805810>]}


============================== 14:06:55.740589 | 79c80076-f6d2-4e43-ab71-4840f07e3b21 ==============================
[0m14:06:55.740589 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:06:55.743594 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build --target sqlserver', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:56.759409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79c80076-f6d2-4e43-ab71-4840f07e3b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002933F0B3010>]}
[0m14:06:56.868794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79c80076-f6d2-4e43-ab71-4840f07e3b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002933C771D90>]}
[0m14:06:56.868794 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:06:57.643507 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m14:06:57.646471 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:06:57.649473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '79c80076-f6d2-4e43-ab71-4840f07e3b21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002933DB69750>]}
[0m14:07:01.156558 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_databricks_cicd.src_ecommerce' (dbt_databricks_cicd/models\raw\sqlserver\src_ecommerce.sql) depends on a source named 'sqlserver.ecommerce' which was not found
[0m14:07:01.161557 [debug] [MainThread]: Command `dbt build` failed at 14:07:01.160557 after 5.59 seconds
[0m14:07:01.163574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029336E03DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002933D85F210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002933F7EFB90>]}
[0m14:07:01.166707 [debug] [MainThread]: Flushing usage events
[0m14:07:01.758932 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:08:03.680832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214658F7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214658F7B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214658F7F50>]}


============================== 14:08:03.700549 | adff6f12-c49c-4497-a61d-37331735d543 ==============================
[0m14:08:03.700549 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:08:03.703563 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt build --target sqlserver', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:08:04.671446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'adff6f12-c49c-4497-a61d-37331735d543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002146721BA50>]}
[0m14:08:04.786244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'adff6f12-c49c-4497-a61d-37331735d543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021464861F10>]}
[0m14:08:04.803196 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:08:05.556310 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m14:08:05.559277 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:08:05.561277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'adff6f12-c49c-4497-a61d-37331735d543', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002146740EF50>]}
[0m14:08:08.945898 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_databricks_cicd.src_ecommerce' (dbt_databricks_cicd/models\raw\sqlserver\src_ecommerce.sql) depends on a source named 'sqlserver.ecommerce' which was not found
[0m14:08:08.945898 [debug] [MainThread]: Command `dbt build` failed at 14:08:08.945898 after 5.40 seconds
[0m14:08:08.945898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002145EED3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214679AF110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214678C5710>]}
[0m14:08:08.945898 [debug] [MainThread]: Flushing usage events
[0m14:08:09.554941 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:08:28.759627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D7FF48050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D7FF4AD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D7FF48150>]}


============================== 14:08:28.759627 | 4ba5dbbc-83a1-4f20-88b5-61e941ec00ed ==============================
[0m14:08:28.759627 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:08:28.759627 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build --target sqlserver', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:08:29.665127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ba5dbbc-83a1-4f20-88b5-61e941ec00ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D7EED8B90>]}
[0m14:08:29.803466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ba5dbbc-83a1-4f20-88b5-61e941ec00ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D7EEB1ED0>]}
[0m14:08:29.804536 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:08:30.551723 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m14:08:30.556083 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:08:30.558047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4ba5dbbc-83a1-4f20-88b5-61e941ec00ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D003B50D0>]}
[0m14:08:33.931179 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_databricks_cicd.src_ecommerce' (dbt_databricks_cicd/models\raw\sqlserver\src_ecommerce.sql) depends on a source named 'sqlserver.ecommerce' which was not found
[0m14:08:33.946779 [debug] [MainThread]: Command `dbt build` failed at 14:08:33.931179 after 5.34 seconds
[0m14:08:33.946779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D794F3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D7FF48590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D01FF7B90>]}
[0m14:08:33.946779 [debug] [MainThread]: Flushing usage events
[0m14:08:34.540230 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:08:53.931393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E849371E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E849373710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E849372290>]}


============================== 14:08:53.947057 | 62288e63-ad50-4736-80cd-64431e2c9e65 ==============================
[0m14:08:53.947057 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:08:53.947057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt clean', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:08:54.258368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62288e63-ad50-4736-80cd-64431e2c9e65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8494F3F10>]}
[0m14:08:54.414641 [debug] [MainThread]: Command `dbt clean` succeeded at 14:08:54.414641 after 0.61 seconds
[0m14:08:54.414641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8428A3C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E849372510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E849372290>]}
[0m14:08:54.414641 [debug] [MainThread]: Flushing usage events
[0m14:08:55.055734 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:09:20.226837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C4D366D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C4D310910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C4D310510>]}


============================== 14:09:20.242510 | 257c2abf-4058-4fa3-b21a-6a89aa5a69d4 ==============================
[0m14:09:20.242510 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:09:20.242510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:09:20.554678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '257c2abf-4058-4fa3-b21a-6a89aa5a69d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C4D431E50>]}
[0m14:09:20.631900 [debug] [MainThread]: Set downloads directory='C:\Users\diniz\AppData\Local\Temp\dbt-downloads-fb1go8oj'
[0m14:09:20.632974 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:09:20.711109 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:09:20.726727 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:09:20.789250 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:09:20.789250 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:09:21.473698 [info ] [MainThread]: Installed from version 1.3.0
[0m14:09:21.475710 [info ] [MainThread]: Up to date!
[0m14:09:21.477702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '257c2abf-4058-4fa3-b21a-6a89aa5a69d4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C4D40FC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C4A174190>]}
[0m14:09:21.484708 [debug] [MainThread]: Command `dbt deps` succeeded at 14:09:21.484708 after 1.38 seconds
[0m14:09:21.485708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C46883C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C46B66310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C46AE0210>]}
[0m14:09:21.486708 [debug] [MainThread]: Flushing usage events
[0m14:09:22.056066 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:09:29.726858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A8ECA510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A8EC8250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A8EC8510>]}


============================== 14:09:29.742497 | 23918d12-af87-420e-b434-700617bce663 ==============================
[0m14:09:29.742497 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:09:29.742497 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt build --target sqlserver', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:09:30.633025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23918d12-af87-420e-b434-700617bce663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A5C34110>]}
[0m14:09:30.773612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23918d12-af87-420e-b434-700617bce663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A7E01F50>]}
[0m14:09:30.773612 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:09:31.524986 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m14:09:31.524986 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:09:31.524986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '23918d12-af87-420e-b434-700617bce663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3AA716210>]}
[0m14:09:34.914200 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_databricks_cicd.src_ecommerce' (dbt_databricks_cicd/models\raw\sqlserver\src_ecommerce.sql) depends on a source named 'sqlserver.ecommerce' which was not found
[0m14:09:34.914200 [debug] [MainThread]: Command `dbt build` failed at 14:09:34.914200 after 5.33 seconds
[0m14:09:34.914200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A2433DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3A8E93250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3AACA7B90>]}
[0m14:09:34.914200 [debug] [MainThread]: Flushing usage events
[0m14:09:35.523779 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:10:11.841566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5B4F49690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5B4F4A9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5B4F48250>]}


============================== 14:10:11.841566 | d7ef7933-7f7c-4d14-9181-0002b0a56c84 ==============================
[0m14:10:11.841566 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:10:11.841566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --target sqlserver', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:10:12.820774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7ef7933-7f7c-4d14-9181-0002b0a56c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5B4F9AAD0>]}
[0m14:10:12.930104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7ef7933-7f7c-4d14-9181-0002b0a56c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5B3EB1E90>]}
[0m14:10:12.930104 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:10:13.679995 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m14:10:13.679995 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:10:13.679995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd7ef7933-7f7c-4d14-9181-0002b0a56c84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5B6A23B50>]}
[0m14:10:16.196300 [error] [MainThread]: Encountered an error:
Compilation Error in model src_ecommerce (dbt_databricks_cicd/models\raw\sqlserver\src_ecommerce.sql)
  expected token ',', got '='
    line 7
      --         materialized='view'
[0m14:10:16.196300 [debug] [MainThread]: Command `dbt build` failed at 14:10:16.196300 after 4.54 seconds
[0m14:10:16.196300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5B4F9AE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5B6D28090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5B4FA1590>]}
[0m14:10:16.196300 [debug] [MainThread]: Flushing usage events
[0m14:10:16.805392 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:11:32.108606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212062F6DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002120634A850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002120634BFD0>]}


============================== 14:11:32.116553 | 41f18126-7a1c-4e1d-b1ca-5c44b91212ea ==============================
[0m14:11:32.116553 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:11:32.118613 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --target sqlserver', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:11:33.097151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41f18126-7a1c-4e1d-b1ca-5c44b91212ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021207ADB750>]}
[0m14:11:33.211959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41f18126-7a1c-4e1d-b1ca-5c44b91212ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021205251E50>]}
[0m14:11:33.211959 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:11:33.992298 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m14:11:33.992298 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:11:33.992298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '41f18126-7a1c-4e1d-b1ca-5c44b91212ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002120634A4D0>]}
[0m14:11:36.571281 [error] [MainThread]: Encountered an error:
Compilation Error in model src_ecommerce (dbt_databricks_cicd/models\raw\sqlserver\src_ecommerce.sql)
  expected token ',', got '='
    line 7
      --         materialized='view'
[0m14:11:36.592071 [debug] [MainThread]: Command `dbt build` failed at 14:11:36.592071 after 4.62 seconds
[0m14:11:36.594125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002127F813DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212062F6610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212062F7050>]}
[0m14:11:36.595112 [debug] [MainThread]: Flushing usage events
[0m14:11:37.195847 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:12:16.055960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C63ACAAB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C63ACA9CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C63ACAB710>]}


============================== 14:12:16.055960 | aaaeb9a6-ccef-4a3d-9e46-ff44a39039e8 ==============================
[0m14:12:16.055960 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:12:16.055960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:12:16.367109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aaaeb9a6-ccef-4a3d-9e46-ff44a39039e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C63ACDE5D0>]}
[0m14:12:16.545354 [debug] [MainThread]: Command `dbt clean` succeeded at 14:12:16.545354 after 0.62 seconds
[0m14:12:16.545354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6341D3C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6344B6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C634431290>]}
[0m14:12:16.545354 [debug] [MainThread]: Flushing usage events
[0m14:12:17.148548 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:12:24.977649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A09ACF68D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A09ACA7990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A09ACA5810>]}


============================== 14:12:24.977649 | ef578a33-8f8f-4460-8391-644540df5832 ==============================
[0m14:12:24.977649 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:12:24.977649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:12:25.325198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef578a33-8f8f-4460-8391-644540df5832', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A09ADBFA90>]}
[0m14:12:25.398674 [debug] [MainThread]: Set downloads directory='C:\Users\diniz\AppData\Local\Temp\dbt-downloads-4j8s3f2x'
[0m14:12:25.398674 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:12:25.487234 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:12:25.489235 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:12:25.556308 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:12:25.571831 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:12:26.196626 [info ] [MainThread]: Installed from version 1.3.0
[0m14:12:26.196626 [info ] [MainThread]: Up to date!
[0m14:12:26.196626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ef578a33-8f8f-4460-8391-644540df5832', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0997B3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A097DB9D10>]}
[0m14:12:26.196626 [debug] [MainThread]: Command `dbt deps` succeeded at 14:12:26.196626 after 1.36 seconds
[0m14:12:26.196626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A094243C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A09AD5DFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A094526310>]}
[0m14:12:26.196626 [debug] [MainThread]: Flushing usage events
[0m14:12:26.806413 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:12:34.726799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4B620C650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4B620F0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4B620E390>]}


============================== 14:12:34.742421 | bc9b99c0-0f21-4686-9522-3cfa90ea3508 ==============================
[0m14:12:34.742421 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:12:34.742421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --target sqlserver', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:12:35.805137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc9b99c0-0f21-4686-9522-3cfa90ea3508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4B79EC650>]}
[0m14:12:35.919011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc9b99c0-0f21-4686-9522-3cfa90ea3508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4B5172050>]}
[0m14:12:35.921021 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:12:36.664722 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m14:12:36.664722 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:12:36.664722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bc9b99c0-0f21-4686-9522-3cfa90ea3508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4B7A9AFD0>]}
[0m14:12:40.086281 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_databricks_cicd.stg_ecommerce' (dbt_databricks_cicd/models\staging\sqlserver\stg_ecommerce.sql) depends on a source named 'sqlserver.ecommerce' which was not found
[0m14:12:40.089743 [debug] [MainThread]: Command `dbt build` failed at 14:12:40.089743 after 5.51 seconds
[0m14:12:40.091739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4AF7E3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4B82E36D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4B825FB90>]}
[0m14:12:40.092732 [debug] [MainThread]: Flushing usage events
[0m14:12:40.696899 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:21:58.492470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B34AAE7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B34AB3BA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B34AB3BFD0>]}


============================== 14:21:58.508130 | af22ae61-b872-4200-86fe-90ea14b3810c ==============================
[0m14:21:58.508130 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:21:58.508130 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --target sqlserver', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:21:59.415288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af22ae61-b872-4200-86fe-90ea14b3810c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B34C37A0D0>]}
[0m14:21:59.538994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af22ae61-b872-4200-86fe-90ea14b3810c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B349A41D50>]}
[0m14:21:59.538994 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:22:00.352783 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m14:22:00.352783 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:22:00.369785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'af22ae61-b872-4200-86fe-90ea14b3810c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B34C477950>]}
[0m14:22:04.215039 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_customers' which is disabled
[0m14:22:04.216034 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_customers' which is disabled
[0m14:22:04.218035 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_customers' which is disabled
[0m14:22:04.219035 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_customers' which is disabled
[0m14:22:04.220036 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_5_products' which is disabled
[0m14:22:04.221076 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_5_products' which is disabled
[0m14:22:04.222077 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_5_products' which is disabled
[0m14:22:04.223073 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'monthly_revenue' which is disabled
[0m14:22:04.225035 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'monthly_revenue' which is disabled
[0m14:22:04.226035 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'monthly_revenue' which is disabled
[0m14:22:04.227034 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_discount_by_category' which is disabled
[0m14:22:04.228075 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_discount_by_category' which is disabled
[0m14:22:04.230035 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_discount_by_category' which is disabled
[0m14:22:04.231035 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_ticket_by_category' which is disabled
[0m14:22:04.232034 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_ticket_by_category' which is disabled
[0m14:22:04.233066 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_ticket_by_category' which is disabled
[0m14:22:04.234076 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'payment_distribution' which is disabled
[0m14:22:04.235073 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'payment_distribution' which is disabled
[0m14:22:04.236074 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'payment_distribution' which is disabled
[0m14:22:04.237073 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'payment_distribution' which is disabled
[0m14:22:04.238034 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'sales_by_category' which is disabled
[0m14:22:04.240035 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'sales_by_category' which is disabled
[0m14:22:04.241034 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'sales_by_category' which is disabled
[0m14:22:04.242094 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'sales_by_category' which is disabled
[0m14:22:04.477711 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m14:22:04.508990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af22ae61-b872-4200-86fe-90ea14b3810c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B34C8B5490>]}
[0m14:22:04.867936 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m14:22:04.867936 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m14:22:04.978342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af22ae61-b872-4200-86fe-90ea14b3810c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B34C9E5490>]}
[0m14:22:04.978342 [info ] [MainThread]: Found 2 models, 10 data tests, 1 source, 626 macros
[0m14:22:04.993962 [info ] [MainThread]: 
[0m14:22:04.993962 [info ] [MainThread]: Concurrency: 1 threads (target='sqlserver')
[0m14:22:04.993962 [info ] [MainThread]: 
[0m14:22:04.993962 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:22:05.009591 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db'
[0m14:22:05.042062 [debug] [ThreadPool]: dbt-sqlserver
[0m14:22:05.044061 [debug] [ThreadPool]: Using sqlserver connection "list_my_db"
[0m14:22:05.045021 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db"} */
USE [my_db];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:22:05.046050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:05.047062 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:22:05.134363 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m14:22:05.152453 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:22:05.155482 [debug] [ThreadPool]: On list_my_db: Close
[0m14:22:05.158446 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db_dbo'
[0m14:22:05.164520 [debug] [ThreadPool]: dbt-sqlserver
[0m14:22:05.164520 [debug] [ThreadPool]: Using sqlserver connection "list_my_db_dbo"
[0m14:22:05.164520 [debug] [ThreadPool]: On list_my_db_dbo: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db_dbo"} */
USE [my_db];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:22:05.164520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:05.164520 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:22:05.164520 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m14:22:05.211443 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:22:05.211443 [debug] [ThreadPool]: On list_my_db_dbo: ROLLBACK
[0m14:22:05.211443 [debug] [ThreadPool]: On list_my_db_dbo: Close
[0m14:22:05.211443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af22ae61-b872-4200-86fe-90ea14b3810c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B34CAB8A10>]}
[0m14:22:05.211443 [debug] [MainThread]: On master: COMMIT
[0m14:22:05.227025 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:22:05.227025 [info ] [Thread-1 (]: 1 of 12 START test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [RUN]
[0m14:22:05.227025 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8'
[0m14:22:05.227025 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:22:05.254989 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:22:05.261934 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:22:05.289802 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:22:05.305425 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:22:05.305425 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7948c8751759ef023ec7d17501389f26_3159]
   as 
    
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from "MY_DB"."dbo"."ecommerce"
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    ''Credit Card'',''Net Banking'',''UPI'',''Debit Card'',''Cash on Delivery''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7948c8751759ef023ec7d17501389f26_3159]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7948c8751759ef023ec7d17501389f26_3159]
  ;')
[0m14:22:05.305425 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:22:05.305425 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:22:05.305425 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:22:05.321050 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:05.336714 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: ROLLBACK
[0m14:22:05.336714 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: Close
[0m14:22:05.336714 [info ] [Thread-1 (]: 1 of 12 PASS source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [[32mPASS[0m in 0.11s]
[0m14:22:05.336714 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:22:05.336714 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:22:05.336714 [info ] [Thread-1 (]: 2 of 12 START test source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_  [RUN]
[0m14:22:05.336714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8, now test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef)
[0m14:22:05.352307 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:22:05.352307 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:22:05.352307 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:22:05.370719 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:22:05.374753 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:22:05.376717 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_9a59e771c154aa693079c3068fb4d43b_8505]
   as 
    
    with actual as (
        select 
            column_name, data_type
        from INFORMATION_SCHEMA.COLUMNS
        where table_name = ''ecommerce''
          and table_schema = ''dbo''
    ),
    expected as (
        select * from (
            values
            
                (''Category'', ''varchar''),
            
                (''Discount'', ''int''),
            
                (''Final_Price'', ''float''),
            
                (''Payment_Method'', ''varchar''),
            
                (''Price'', ''float''),
            
                (''Product_ID'', ''varchar''),
            
                (''Purchase_Date'', ''date''),
            
                (''User_ID'', ''varchar'')
            
        ) as t(column_name, data_type)
    )
    select
        e.column_name,
        e.data_type
    from expected e
    left join actual a
        on e.column_name = a.column_name
       and e.data_type = a.data_type
    where a.column_name is null

  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_9a59e771c154aa693079c3068fb4d43b_8505]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_9a59e771c154aa693079c3068fb4d43b_8505]
  ;')
[0m14:22:05.377716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:05.378718 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:22:05.380717 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:22:05.430749 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:05.430749 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef: ROLLBACK
[0m14:22:05.430749 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef: Close
[0m14:22:05.430749 [info ] [Thread-1 (]: 2 of 12 PASS source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_  [[32mPASS[0m in 0.09s]
[0m14:22:05.430749 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:22:05.430749 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:22:05.430749 [info ] [Thread-1 (]: 3 of 12 START test source_not_null_sqlserver_ecommerce_Category ................ [RUN]
[0m14:22:05.446377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407)
[0m14:22:05.446377 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:22:05.462043 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:22:05.462043 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:22:05.462043 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:22:05.462043 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:22:05.462043 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_8657]
   as 
    
    
    



select Category
from "MY_DB"."dbo"."ecommerce"
where Category is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_8657]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_8657]
  ;')
[0m14:22:05.478227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:05.480235 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:22:05.481231 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:22:05.492332 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:05.492332 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: ROLLBACK
[0m14:22:05.492332 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: Close
[0m14:22:05.492332 [info ] [Thread-1 (]: 3 of 12 PASS source_not_null_sqlserver_ecommerce_Category ...................... [[32mPASS[0m in 0.05s]
[0m14:22:05.492332 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:22:05.492332 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:22:05.507963 [info ] [Thread-1 (]: 4 of 12 START test source_not_null_sqlserver_ecommerce_Discount ................ [RUN]
[0m14:22:05.507963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f)
[0m14:22:05.507963 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:22:05.507963 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:22:05.523583 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:22:05.523583 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:22:05.523583 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:22:05.523583 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_3451]
   as 
    
    
    



select Discount
from "MY_DB"."dbo"."ecommerce"
where Discount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_3451]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_3451]
  ;')
[0m14:22:05.523583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:05.523583 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:22:05.523583 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:22:05.539216 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:05.539216 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: ROLLBACK
[0m14:22:05.554925 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: Close
[0m14:22:05.554925 [info ] [Thread-1 (]: 4 of 12 PASS source_not_null_sqlserver_ecommerce_Discount ...................... [[32mPASS[0m in 0.05s]
[0m14:22:05.554925 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:22:05.554925 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:22:05.554925 [info ] [Thread-1 (]: 5 of 12 START test source_not_null_sqlserver_ecommerce_Final_Price ............. [RUN]
[0m14:22:05.554925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d)
[0m14:22:05.554925 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:22:05.570460 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:22:05.570460 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:22:05.570460 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:22:05.570460 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:22:05.587414 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_4454]
   as 
    
    
    



select Final_Price
from "MY_DB"."dbo"."ecommerce"
where Final_Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_4454]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_4454]
  ;')
[0m14:22:05.589469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:05.591535 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:22:05.592448 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:22:05.602139 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:05.602139 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: ROLLBACK
[0m14:22:05.602139 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: Close
[0m14:22:05.602139 [info ] [Thread-1 (]: 5 of 12 PASS source_not_null_sqlserver_ecommerce_Final_Price ................... [[32mPASS[0m in 0.05s]
[0m14:22:05.602139 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:22:05.602139 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:22:05.602139 [info ] [Thread-1 (]: 6 of 12 START test source_not_null_sqlserver_ecommerce_Payment_Method .......... [RUN]
[0m14:22:05.602139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae)
[0m14:22:05.602139 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:22:05.617808 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:22:05.617808 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:22:05.633401 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:22:05.633401 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:22:05.633401 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_7872]
   as 
    
    
    



select Payment_Method
from "MY_DB"."dbo"."ecommerce"
where Payment_Method is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_7872]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_7872]
  ;')
[0m14:22:05.633401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:05.633401 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:22:05.633401 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:22:05.649061 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:05.649061 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: ROLLBACK
[0m14:22:05.649061 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: Close
[0m14:22:05.649061 [info ] [Thread-1 (]: 6 of 12 PASS source_not_null_sqlserver_ecommerce_Payment_Method ................ [[32mPASS[0m in 0.05s]
[0m14:22:05.664685 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:22:05.664685 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:22:05.664685 [info ] [Thread-1 (]: 7 of 12 START test source_not_null_sqlserver_ecommerce_Price ................... [RUN]
[0m14:22:05.664685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01)
[0m14:22:05.664685 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:22:05.664685 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:22:05.680309 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:22:05.695893 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:22:05.695893 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:22:05.711531 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_5848]
   as 
    
    
    



select Price
from "MY_DB"."dbo"."ecommerce"
where Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_5848]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_5848]
  ;')
[0m14:22:05.711531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:05.711531 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:22:05.711531 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:22:05.727181 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:05.727181 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: ROLLBACK
[0m14:22:05.727181 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: Close
[0m14:22:05.727181 [info ] [Thread-1 (]: 7 of 12 PASS source_not_null_sqlserver_ecommerce_Price ......................... [[32mPASS[0m in 0.06s]
[0m14:22:05.727181 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:22:05.727181 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:22:05.727181 [info ] [Thread-1 (]: 8 of 12 START test source_not_null_sqlserver_ecommerce_Product_ID .............. [RUN]
[0m14:22:05.742767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff)
[0m14:22:05.742767 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:22:05.742767 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:22:05.742767 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:22:05.758392 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:22:05.758392 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:22:05.758392 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_18769]
   as 
    
    
    



select Product_ID
from "MY_DB"."dbo"."ecommerce"
where Product_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_18769]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_18769]
  ;')
[0m14:22:05.758392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:05.758392 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:22:05.758392 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:22:05.774029 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:05.774029 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: ROLLBACK
[0m14:22:05.774029 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: Close
[0m14:22:05.774029 [info ] [Thread-1 (]: 8 of 12 PASS source_not_null_sqlserver_ecommerce_Product_ID .................... [[32mPASS[0m in 0.03s]
[0m14:22:05.790026 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:22:05.791025 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:22:05.793024 [info ] [Thread-1 (]: 9 of 12 START test source_not_null_sqlserver_ecommerce_Purchase_Date ........... [RUN]
[0m14:22:05.794023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17)
[0m14:22:05.796023 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:22:05.803022 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:22:05.806226 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:22:05.806226 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:22:05.806226 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:22:05.806226 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_12717]
   as 
    
    
    



select Purchase_Date
from "MY_DB"."dbo"."ecommerce"
where Purchase_Date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_12717]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_12717]
  ;')
[0m14:22:05.806226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:05.806226 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:22:05.806226 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:22:05.821888 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:05.837476 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: ROLLBACK
[0m14:22:05.837476 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: Close
[0m14:22:05.837476 [info ] [Thread-1 (]: 9 of 12 PASS source_not_null_sqlserver_ecommerce_Purchase_Date ................. [[32mPASS[0m in 0.04s]
[0m14:22:05.837476 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:22:05.837476 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:22:05.837476 [info ] [Thread-1 (]: 10 of 12 START test source_not_null_sqlserver_ecommerce_User_ID ................ [RUN]
[0m14:22:05.837476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc)
[0m14:22:05.837476 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:22:05.853101 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:22:05.853101 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:22:05.853101 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:22:05.868738 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:22:05.868738 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_14871]
   as 
    
    
    



select User_ID
from "MY_DB"."dbo"."ecommerce"
where User_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_14871]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_14871]
  ;')
[0m14:22:05.868738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:05.868738 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:22:05.868738 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:22:05.889229 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:05.892250 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: ROLLBACK
[0m14:22:05.893250 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: Close
[0m14:22:05.895251 [info ] [Thread-1 (]: 10 of 12 PASS source_not_null_sqlserver_ecommerce_User_ID ...................... [[32mPASS[0m in 0.06s]
[0m14:22:05.898036 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:22:05.899081 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce
[0m14:22:05.901092 [info ] [Thread-1 (]: 11 of 12 START sql view model dbo.src_ecommerce ................................ [RUN]
[0m14:22:05.903463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc, now model.dbt_databricks_cicd.src_ecommerce)
[0m14:22:05.905484 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.src_ecommerce
[0m14:22:05.912458 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.src_ecommerce"
[0m14:22:05.914557 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.src_ecommerce
[0m14:22:05.977062 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.src_ecommerce"
[0m14:22:05.977062 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.src_ecommerce"
[0m14:22:05.977062 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.src_ecommerce"} */
USE [my_db];
    
    

    

    
    USE [my_db];
    EXEC('
        create view "dbo"."src_ecommerce__dbt_tmp" as 

select * from "MY_DB"."dbo"."ecommerce";
    ')


[0m14:22:05.977062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:05.977062 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:22:05.977062 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:22:05.992687 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:05.992687 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.src_ecommerce"
[0m14:22:06.008494 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.src_ecommerce"} */
USE [my_db];
      EXEC sp_rename 'dbo.src_ecommerce', 'src_ecommerce__dbt_backup'
[0m14:22:06.242139 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:06.257772 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.src_ecommerce"
[0m14:22:06.257772 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.src_ecommerce"} */
USE [my_db];
      EXEC sp_rename 'dbo.src_ecommerce__dbt_tmp', 'src_ecommerce'
[0m14:22:06.257772 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:06.304643 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: COMMIT
[0m14:22:06.320268 [debug] [Thread-1 (]: Applying DROP to: "my_db"."dbo"."src_ecommerce__dbt_backup"
[0m14:22:06.335893 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:22:06.335893 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.src_ecommerce"
[0m14:22:06.335893 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.src_ecommerce"} */

        USE [my_db];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'my_db'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'src_ecommerce__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:22:06.393353 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:06.396353 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.src_ecommerce"
[0m14:22:06.397354 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.src_ecommerce"} */

      
      
    
    USE [my_db];
    EXEC('DROP view IF EXISTS "dbo"."src_ecommerce__dbt_backup";');

[0m14:22:06.398686 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:06.398686 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: ROLLBACK
[0m14:22:06.398686 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: Close
[0m14:22:06.398686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af22ae61-b872-4200-86fe-90ea14b3810c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B34C8B8150>]}
[0m14:22:06.398686 [info ] [Thread-1 (]: 11 of 12 OK created sql view model dbo.src_ecommerce ........................... [[32mOK[0m in 0.50s]
[0m14:22:06.398686 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce
[0m14:22:06.414320 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.stg_ecommerce
[0m14:22:06.414320 [info ] [Thread-1 (]: 12 of 12 START sql view model dbo.stg_ecommerce ................................ [RUN]
[0m14:22:06.414320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.src_ecommerce, now model.dbt_databricks_cicd.stg_ecommerce)
[0m14:22:06.414320 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.stg_ecommerce
[0m14:22:06.414320 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.stg_ecommerce"
[0m14:22:06.429941 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.stg_ecommerce
[0m14:22:06.429941 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.stg_ecommerce"
[0m14:22:06.445564 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.stg_ecommerce"
[0m14:22:06.445564 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.stg_ecommerce"} */
USE [my_db];
    
    

    

    
    USE [my_db];
    EXEC('
        create view "dbo"."stg_ecommerce__dbt_tmp" as 

SELECT
    
        CAST(User_ID AS VARCHAR) AS User_ID,
        CAST(Product_ID AS VARCHAR) AS Product_ID,
        CAST(Category AS VARCHAR) AS Category,
        CAST(Price AS FLOAT) AS Price,
        CAST(Discount AS INT) AS Discount,
        CAST(Final_Price AS FLOAT) AS Final_Price,
        CAST(Payment_Method AS VARCHAR) AS Payment_Method,
        CAST(Purchase_Date AS DATE) AS Purchase_Date
    
FROM "MY_DB"."dbo"."ecommerce";
    ')


[0m14:22:06.445564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:06.445564 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:22:06.445564 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:22:06.461221 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:06.461221 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.stg_ecommerce"
[0m14:22:06.461221 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.stg_ecommerce"} */
USE [my_db];
      EXEC sp_rename 'dbo.stg_ecommerce', 'stg_ecommerce__dbt_backup'
[0m14:22:06.461221 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:06.476814 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.stg_ecommerce"
[0m14:22:06.476814 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.stg_ecommerce"} */
USE [my_db];
      EXEC sp_rename 'dbo.stg_ecommerce__dbt_tmp', 'stg_ecommerce'
[0m14:22:06.476814 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:06.476814 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: COMMIT
[0m14:22:06.492443 [debug] [Thread-1 (]: Applying DROP to: "my_db"."dbo"."stg_ecommerce__dbt_backup"
[0m14:22:06.492443 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:22:06.492443 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.stg_ecommerce"
[0m14:22:06.492443 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.stg_ecommerce"} */

        USE [my_db];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'my_db'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_ecommerce__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:22:06.523686 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:06.523686 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.stg_ecommerce"
[0m14:22:06.523686 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.stg_ecommerce"} */

      
      
    
    USE [my_db];
    EXEC('DROP view IF EXISTS "dbo"."stg_ecommerce__dbt_backup";');

[0m14:22:06.523686 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:06.539592 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: ROLLBACK
[0m14:22:06.540631 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: Close
[0m14:22:06.542630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af22ae61-b872-4200-86fe-90ea14b3810c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B34C2A6A90>]}
[0m14:22:06.543630 [info ] [Thread-1 (]: 12 of 12 OK created sql view model dbo.stg_ecommerce ........................... [[32mOK[0m in 0.13s]
[0m14:22:06.546611 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.stg_ecommerce
[0m14:22:06.548590 [debug] [MainThread]: On master: COMMIT
[0m14:22:06.550592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:06.551595 [debug] [MainThread]: Connection 'list_my_db' was properly closed.
[0m14:22:06.552598 [debug] [MainThread]: Connection 'list_my_db_dbo' was properly closed.
[0m14:22:06.553601 [debug] [MainThread]: Connection 'model.dbt_databricks_cicd.stg_ecommerce' was properly closed.
[0m14:22:06.556598 [info ] [MainThread]: 
[0m14:22:06.557629 [info ] [MainThread]: Finished running 10 data tests, 2 view models in 0 hours 0 minutes and 1.56 seconds (1.56s).
[0m14:22:06.562627 [debug] [MainThread]: Command end result
[0m14:22:06.633699 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m14:22:06.633699 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m14:22:06.649319 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m14:22:06.649319 [info ] [MainThread]: 
[0m14:22:06.649319 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:22:06.649319 [info ] [MainThread]: 
[0m14:22:06.649319 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m14:22:06.649319 [debug] [MainThread]: Command `dbt build` succeeded at 14:22:06.649319 after 8.29 seconds
[0m14:22:06.649319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B343FF3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3442510D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3442504D0>]}
[0m14:22:06.649319 [debug] [MainThread]: Flushing usage events
[0m14:22:07.338432 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:22:41.390434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BF10F6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BF10F4ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BF10F7C10>]}


============================== 14:22:41.397438 | 13a714ae-5a8b-4331-b978-57fb97b561b8 ==============================
[0m14:22:41.397438 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:22:41.399455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --target sqlserver', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:22:42.352234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13a714ae-5a8b-4331-b978-57fb97b561b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BF14CB110>]}
[0m14:22:42.476874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13a714ae-5a8b-4331-b978-57fb97b561b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BF0061E90>]}
[0m14:22:42.476874 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:22:43.290595 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m14:22:43.852849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:22:43.852849 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:22:43.868472 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m14:22:43.948867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13a714ae-5a8b-4331-b978-57fb97b561b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BF2DFFF90>]}
[0m14:22:44.196878 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m14:22:44.212495 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m14:22:44.289808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13a714ae-5a8b-4331-b978-57fb97b561b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BF2CB8C90>]}
[0m14:22:44.289808 [info ] [MainThread]: Found 2 models, 10 data tests, 1 source, 626 macros
[0m14:22:44.289808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13a714ae-5a8b-4331-b978-57fb97b561b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BF2C17910>]}
[0m14:22:44.289808 [info ] [MainThread]: 
[0m14:22:44.305417 [info ] [MainThread]: Concurrency: 1 threads (target='sqlserver')
[0m14:22:44.305417 [info ] [MainThread]: 
[0m14:22:44.305417 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:22:44.305417 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db_dbo'
[0m14:22:44.356453 [debug] [ThreadPool]: dbt-sqlserver
[0m14:22:44.357457 [debug] [ThreadPool]: Using sqlserver connection "list_my_db_dbo"
[0m14:22:44.359454 [debug] [ThreadPool]: On list_my_db_dbo: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db_dbo"} */
USE [my_db];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:22:44.360454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:44.361456 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:22:44.430672 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m14:22:44.473857 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:22:44.476895 [debug] [ThreadPool]: On list_my_db_dbo: ROLLBACK
[0m14:22:44.477044 [debug] [ThreadPool]: On list_my_db_dbo: Close
[0m14:22:44.477044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13a714ae-5a8b-4331-b978-57fb97b561b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BF2BD2B50>]}
[0m14:22:44.477044 [debug] [MainThread]: On master: COMMIT
[0m14:22:44.477044 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:22:44.477044 [info ] [Thread-1 (]: 1 of 10 START test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [RUN]
[0m14:22:44.492672 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8'
[0m14:22:44.492672 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:22:44.523937 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:22:44.523937 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:22:44.571048 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:22:44.573048 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:22:44.575048 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7948c8751759ef023ec7d17501389f26_16581]
   as 
    
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from "MY_DB"."dbo"."ecommerce"
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    ''Credit Card'',''Net Banking'',''UPI'',''Debit Card'',''Cash on Delivery''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7948c8751759ef023ec7d17501389f26_16581]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7948c8751759ef023ec7d17501389f26_16581]
  ;')
[0m14:22:44.576047 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:22:44.577048 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:22:44.583049 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:22:44.587219 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:44.602846 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: ROLLBACK
[0m14:22:44.602846 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: Close
[0m14:22:44.602846 [info ] [Thread-1 (]: 1 of 10 PASS source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [[32mPASS[0m in 0.11s]
[0m14:22:44.602846 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:22:44.602846 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:22:44.602846 [info ] [Thread-1 (]: 2 of 10 START test source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_  [RUN]
[0m14:22:44.618519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8, now test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef)
[0m14:22:44.618519 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:22:44.634104 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:22:44.649733 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:22:44.649733 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:22:44.649733 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:22:44.665346 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_9a59e771c154aa693079c3068fb4d43b_15976]
   as 
    
    with actual as (
        select 
            column_name, data_type
        from INFORMATION_SCHEMA.COLUMNS
        where table_name = ''ecommerce''
          and table_schema = ''dbo''
    ),
    expected as (
        select * from (
            values
            
                (''Category'', ''varchar''),
            
                (''Discount'', ''int''),
            
                (''Final_Price'', ''float''),
            
                (''Payment_Method'', ''varchar''),
            
                (''Price'', ''float''),
            
                (''Product_ID'', ''varchar''),
            
                (''Purchase_Date'', ''date''),
            
                (''User_ID'', ''varchar'')
            
        ) as t(column_name, data_type)
    )
    select
        e.column_name,
        e.data_type
    from expected e
    left join actual a
        on e.column_name = a.column_name
       and e.data_type = a.data_type
    where a.column_name is null

  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_9a59e771c154aa693079c3068fb4d43b_15976]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_9a59e771c154aa693079c3068fb4d43b_15976]
  ;')
[0m14:22:44.665346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:44.665346 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:22:44.665346 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:22:44.727850 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:44.727850 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef: ROLLBACK
[0m14:22:44.727850 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef: Close
[0m14:22:44.727850 [info ] [Thread-1 (]: 2 of 10 PASS source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_  [[32mPASS[0m in 0.11s]
[0m14:22:44.743480 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:22:44.743480 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:22:44.743480 [info ] [Thread-1 (]: 3 of 10 START test source_not_null_sqlserver_ecommerce_Category ................ [RUN]
[0m14:22:44.743480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407)
[0m14:22:44.743480 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:22:44.759099 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:22:44.759099 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:22:44.759099 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:22:44.759099 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:22:44.775326 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_13097]
   as 
    
    
    



select Category
from "MY_DB"."dbo"."ecommerce"
where Category is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_13097]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_13097]
  ;')
[0m14:22:44.776336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:44.777323 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:22:44.779322 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:22:44.789325 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:44.792667 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: ROLLBACK
[0m14:22:44.793675 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: Close
[0m14:22:44.795669 [info ] [Thread-1 (]: 3 of 10 PASS source_not_null_sqlserver_ecommerce_Category ...................... [[32mPASS[0m in 0.05s]
[0m14:22:44.798666 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:22:44.800668 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:22:44.802665 [info ] [Thread-1 (]: 4 of 10 START test source_not_null_sqlserver_ecommerce_Discount ................ [RUN]
[0m14:22:44.803664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f)
[0m14:22:44.804664 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:22:44.806271 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:22:44.806271 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:22:44.806271 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:22:44.821899 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:22:44.821899 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_6423]
   as 
    
    
    



select Discount
from "MY_DB"."dbo"."ecommerce"
where Discount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_6423]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_6423]
  ;')
[0m14:22:44.821899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:44.821899 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:22:44.821899 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:22:44.837520 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:44.837520 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: ROLLBACK
[0m14:22:44.837520 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: Close
[0m14:22:44.837520 [info ] [Thread-1 (]: 4 of 10 PASS source_not_null_sqlserver_ecommerce_Discount ...................... [[32mPASS[0m in 0.03s]
[0m14:22:44.837520 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:22:44.837520 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:22:44.853183 [info ] [Thread-1 (]: 5 of 10 START test source_not_null_sqlserver_ecommerce_Final_Price ............. [RUN]
[0m14:22:44.853183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d)
[0m14:22:44.853183 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:22:44.853183 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:22:44.853183 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:22:44.868776 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:22:44.868776 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:22:44.868776 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_7373]
   as 
    
    
    



select Final_Price
from "MY_DB"."dbo"."ecommerce"
where Final_Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_7373]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_7373]
  ;')
[0m14:22:44.868776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:44.868776 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:22:44.868776 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:22:44.884409 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:44.884409 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: ROLLBACK
[0m14:22:44.884409 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: Close
[0m14:22:44.884409 [info ] [Thread-1 (]: 5 of 10 PASS source_not_null_sqlserver_ecommerce_Final_Price ................... [[32mPASS[0m in 0.03s]
[0m14:22:44.901826 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:22:44.903824 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:22:44.904824 [info ] [Thread-1 (]: 6 of 10 START test source_not_null_sqlserver_ecommerce_Payment_Method .......... [RUN]
[0m14:22:44.906822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae)
[0m14:22:44.907820 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:22:44.914857 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:22:44.914857 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:22:44.914857 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:22:44.914857 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:22:44.914857 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_17800]
   as 
    
    
    



select Payment_Method
from "MY_DB"."dbo"."ecommerce"
where Payment_Method is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_17800]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_17800]
  ;')
[0m14:22:44.914857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:44.930525 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:22:44.930525 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:22:44.930525 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:44.946111 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: ROLLBACK
[0m14:22:44.946111 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: Close
[0m14:22:44.946111 [info ] [Thread-1 (]: 6 of 10 PASS source_not_null_sqlserver_ecommerce_Payment_Method ................ [[32mPASS[0m in 0.04s]
[0m14:22:44.946111 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:22:44.946111 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:22:44.946111 [info ] [Thread-1 (]: 7 of 10 START test source_not_null_sqlserver_ecommerce_Price ................... [RUN]
[0m14:22:44.946111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01)
[0m14:22:44.946111 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:22:44.961736 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:22:44.961736 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:22:44.977408 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:22:44.977408 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:22:44.977408 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_4749]
   as 
    
    
    



select Price
from "MY_DB"."dbo"."ecommerce"
where Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_4749]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_4749]
  ;')
[0m14:22:44.977408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:44.977408 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:22:44.977408 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:22:44.993037 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:44.993037 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: ROLLBACK
[0m14:22:44.993037 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: Close
[0m14:22:44.993037 [info ] [Thread-1 (]: 7 of 10 PASS source_not_null_sqlserver_ecommerce_Price ......................... [[32mPASS[0m in 0.05s]
[0m14:22:44.993037 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:22:45.008961 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:22:45.009966 [info ] [Thread-1 (]: 8 of 10 START test source_not_null_sqlserver_ecommerce_Product_ID .............. [RUN]
[0m14:22:45.011960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff)
[0m14:22:45.012980 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:22:45.021999 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:22:45.023968 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:22:45.025636 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:22:45.025636 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:22:45.025636 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_9319]
   as 
    
    
    



select Product_ID
from "MY_DB"."dbo"."ecommerce"
where Product_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_9319]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_9319]
  ;')
[0m14:22:45.025636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:45.025636 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:22:45.025636 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:22:45.041301 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:45.041301 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: ROLLBACK
[0m14:22:45.041301 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: Close
[0m14:22:45.056889 [info ] [Thread-1 (]: 8 of 10 PASS source_not_null_sqlserver_ecommerce_Product_ID .................... [[32mPASS[0m in 0.03s]
[0m14:22:45.056889 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:22:45.056889 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:22:45.056889 [info ] [Thread-1 (]: 9 of 10 START test source_not_null_sqlserver_ecommerce_Purchase_Date ........... [RUN]
[0m14:22:45.056889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17)
[0m14:22:45.056889 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:22:45.072556 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:22:45.072556 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:22:45.072556 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:22:45.072556 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:22:45.072556 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_17980]
   as 
    
    
    



select Purchase_Date
from "MY_DB"."dbo"."ecommerce"
where Purchase_Date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_17980]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_17980]
  ;')
[0m14:22:45.088137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:45.088137 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:22:45.088137 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:22:45.088137 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:45.103765 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: ROLLBACK
[0m14:22:45.103765 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: Close
[0m14:22:45.103765 [info ] [Thread-1 (]: 9 of 10 PASS source_not_null_sqlserver_ecommerce_Purchase_Date ................. [[32mPASS[0m in 0.05s]
[0m14:22:45.103765 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:22:45.103765 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:22:45.103765 [info ] [Thread-1 (]: 10 of 10 START test source_not_null_sqlserver_ecommerce_User_ID ................ [RUN]
[0m14:22:45.103765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc)
[0m14:22:45.103765 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:22:45.123708 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:22:45.125670 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:22:45.131677 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:22:45.132782 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:22:45.132782 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_4092]
   as 
    
    
    



select User_ID
from "MY_DB"."dbo"."ecommerce"
where User_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_4092]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_4092]
  ;')
[0m14:22:45.132782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:45.132782 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:22:45.132782 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:22:45.148411 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:22:45.148411 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: ROLLBACK
[0m14:22:45.148411 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: Close
[0m14:22:45.148411 [info ] [Thread-1 (]: 10 of 10 PASS source_not_null_sqlserver_ecommerce_User_ID ...................... [[32mPASS[0m in 0.04s]
[0m14:22:45.148411 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:22:45.148411 [debug] [MainThread]: On master: COMMIT
[0m14:22:45.164072 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:45.164072 [debug] [MainThread]: Connection 'list_my_db_dbo' was properly closed.
[0m14:22:45.164072 [debug] [MainThread]: Connection 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc' was properly closed.
[0m14:22:45.164072 [info ] [MainThread]: 
[0m14:22:45.164072 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m14:22:45.164072 [debug] [MainThread]: Command end result
[0m14:22:45.242212 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m14:22:45.242212 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m14:22:45.257798 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m14:22:45.257798 [info ] [MainThread]: 
[0m14:22:45.257798 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:22:45.257798 [info ] [MainThread]: 
[0m14:22:45.257798 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m14:22:45.273413 [debug] [MainThread]: Command `dbt test` succeeded at 14:22:45.273413 after 4.02 seconds
[0m14:22:45.273413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BEA633DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BEA890510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BEA8904D0>]}
[0m14:22:45.273413 [debug] [MainThread]: Flushing usage events
[0m14:22:45.861684 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:25:08.857115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A803C2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A803C3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A803C2410>]}


============================== 14:25:08.864475 | a9f64861-2b90-439b-9d70-afec1f0ecc88 ==============================
[0m14:25:08.864475 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:25:08.866478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt test --target sqlserver', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:25:09.789641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9f64861-2b90-439b-9d70-afec1f0ecc88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A81C1FD90>]}
[0m14:25:09.915342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9f64861-2b90-439b-9d70-afec1f0ecc88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AFF251FD0>]}
[0m14:25:09.915342 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:25:10.712123 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m14:25:11.211701 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:25:11.211701 [debug] [MainThread]: Partial parsing: updated file: dbt_databricks_cicd://dbt_databricks_cicd/models\raw\sqlserver\schema.yml
[0m14:25:12.320933 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m14:25:12.336561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9f64861-2b90-439b-9d70-afec1f0ecc88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A824478D0>]}
[0m14:25:12.509119 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m14:25:12.524742 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m14:25:12.608585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9f64861-2b90-439b-9d70-afec1f0ecc88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A827509D0>]}
[0m14:25:12.609624 [info ] [MainThread]: Found 2 models, 10 data tests, 1 source, 626 macros
[0m14:25:12.611634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9f64861-2b90-439b-9d70-afec1f0ecc88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A824C96D0>]}
[0m14:25:12.615621 [info ] [MainThread]: 
[0m14:25:12.617625 [info ] [MainThread]: Concurrency: 1 threads (target='sqlserver')
[0m14:25:12.619586 [info ] [MainThread]: 
[0m14:25:12.621588 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:25:12.631590 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db_dbo'
[0m14:25:12.664876 [debug] [ThreadPool]: dbt-sqlserver
[0m14:25:12.665876 [debug] [ThreadPool]: Using sqlserver connection "list_my_db_dbo"
[0m14:25:12.666919 [debug] [ThreadPool]: On list_my_db_dbo: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db_dbo"} */
USE [my_db];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:25:12.668883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:12.670880 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:25:12.804794 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m14:25:12.851670 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:25:12.867300 [debug] [ThreadPool]: On list_my_db_dbo: ROLLBACK
[0m14:25:12.867300 [debug] [ThreadPool]: On list_my_db_dbo: Close
[0m14:25:12.867300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9f64861-2b90-439b-9d70-afec1f0ecc88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A824FE590>]}
[0m14:25:12.867300 [debug] [MainThread]: On master: COMMIT
[0m14:25:12.867300 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:25:12.882955 [info ] [Thread-1 (]: 1 of 10 START test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [RUN]
[0m14:25:12.882955 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8'
[0m14:25:12.882955 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:25:12.898583 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:25:12.898583 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:25:12.946162 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:25:12.946162 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:25:12.946162 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7948c8751759ef023ec7d17501389f26_9641]
   as 
    
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from "MY_DB"."dbo"."ecommerce"
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    ''Credit Card'',''Net Banking'',''UPI'',''Debit Card'',''Cash on Delivery''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7948c8751759ef023ec7d17501389f26_9641]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7948c8751759ef023ec7d17501389f26_9641]
  ;')
[0m14:25:12.946162 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:25:12.946162 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:25:12.946162 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:25:12.977426 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:25:12.977426 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: ROLLBACK
[0m14:25:12.977426 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: Close
[0m14:25:12.977426 [info ] [Thread-1 (]: 1 of 10 PASS source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [[32mPASS[0m in 0.09s]
[0m14:25:12.993026 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:25:12.993026 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_.fab1b630d8
[0m14:25:12.993026 [info ] [Thread-1 (]: 2 of 10 START test source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_  [RUN]
[0m14:25:12.993026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8, now test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_.fab1b630d8)
[0m14:25:12.993026 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_.fab1b630d8
[0m14:25:13.013109 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_.fab1b630d8"
[0m14:25:13.016108 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_.fab1b630d8
[0m14:25:13.024148 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_.fab1b630d8"
[0m14:25:13.027106 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_.fab1b630d8"
[0m14:25:13.028114 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_.fab1b630d8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_.fab1b630d8"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_446955b714c27e93626a2769628cd038_8714]
   as 
    
    with actual as (
        select 
            column_name, data_type
        from INFORMATION_SCHEMA.COLUMNS
        where table_name = ''ecommerce''
          and table_schema = ''dbo''
    ),
    expected as (
        select * from (
            values
            
                (''Category'', ''varchar''),
            
                (''Discount'', ''int''),
            
                (''Final_Price'', ''float''),
            
                (''Payment_Method'', ''varchar''),
            
                (''Price'', ''float''),
            
                (''Product_ID'', ''varchar''),
            
                (''Purchase_Date'', ''date''),
            
                (''User_ID'', ''varchar''),
            
                (''Quantidade'', ''int'')
            
        ) as t(column_name, data_type)
    )
    select
        e.column_name,
        e.data_type
    from expected e
    left join actual a
        on e.column_name = a.column_name
       and e.data_type = a.data_type
    where a.column_name is null

  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_446955b714c27e93626a2769628cd038_8714]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_446955b714c27e93626a2769628cd038_8714]
  ;')
[0m14:25:13.030109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:13.031148 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:25:13.032147 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:25:13.070523 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:25:13.070523 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_.fab1b630d8: ROLLBACK
[0m14:25:13.070523 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_.fab1b630d8: Close
[0m14:25:13.086189 [error] [Thread-1 (]: 2 of 10 FAIL 1 source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_  [[31mFAIL 1[0m in 0.09s]
[0m14:25:13.086189 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_.fab1b630d8
[0m14:25:13.086189 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:25:13.086189 [info ] [Thread-1 (]: 3 of 10 START test source_not_null_sqlserver_ecommerce_Category ................ [RUN]
[0m14:25:13.086189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_.fab1b630d8, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407)
[0m14:25:13.086189 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:25:13.101770 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:25:13.101770 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:25:13.117405 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:25:13.117405 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:25:13.117405 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_11948]
   as 
    
    
    



select Category
from "MY_DB"."dbo"."ecommerce"
where Category is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_11948]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_11948]
  ;')
[0m14:25:13.117405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:13.117405 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:25:13.117405 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:25:13.133029 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:25:13.133029 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: ROLLBACK
[0m14:25:13.133029 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: Close
[0m14:25:13.133029 [info ] [Thread-1 (]: 3 of 10 PASS source_not_null_sqlserver_ecommerce_Category ...................... [[32mPASS[0m in 0.05s]
[0m14:25:13.133029 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:25:13.133029 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:25:13.133029 [info ] [Thread-1 (]: 4 of 10 START test source_not_null_sqlserver_ecommerce_Discount ................ [RUN]
[0m14:25:13.148685 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f)
[0m14:25:13.148685 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:25:13.148685 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:25:13.148685 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:25:13.164273 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:25:13.164273 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:25:13.164273 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_17487]
   as 
    
    
    



select Discount
from "MY_DB"."dbo"."ecommerce"
where Discount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_17487]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_17487]
  ;')
[0m14:25:13.164273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:13.164273 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:25:13.179902 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:25:13.179902 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:25:13.179902 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: ROLLBACK
[0m14:25:13.179902 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: Close
[0m14:25:13.195559 [info ] [Thread-1 (]: 4 of 10 PASS source_not_null_sqlserver_ecommerce_Discount ...................... [[32mPASS[0m in 0.05s]
[0m14:25:13.195559 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:25:13.195559 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:25:13.195559 [info ] [Thread-1 (]: 5 of 10 START test source_not_null_sqlserver_ecommerce_Final_Price ............. [RUN]
[0m14:25:13.195559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d)
[0m14:25:13.195559 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:25:13.211159 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:25:13.211159 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:25:13.211159 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:25:13.211159 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:25:13.226771 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_16479]
   as 
    
    
    



select Final_Price
from "MY_DB"."dbo"."ecommerce"
where Final_Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_16479]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_16479]
  ;')
[0m14:25:13.226771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:13.226771 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:25:13.226771 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:25:13.226771 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:25:13.243841 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: ROLLBACK
[0m14:25:13.245811 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: Close
[0m14:25:13.246845 [info ] [Thread-1 (]: 5 of 10 PASS source_not_null_sqlserver_ecommerce_Final_Price ................... [[32mPASS[0m in 0.05s]
[0m14:25:13.249845 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:25:13.251805 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:25:13.252804 [info ] [Thread-1 (]: 6 of 10 START test source_not_null_sqlserver_ecommerce_Payment_Method .......... [RUN]
[0m14:25:13.255538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae)
[0m14:25:13.256535 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:25:13.258625 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:25:13.258625 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:25:13.258625 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:25:13.274302 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:25:13.274302 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_15036]
   as 
    
    
    



select Payment_Method
from "MY_DB"."dbo"."ecommerce"
where Payment_Method is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_15036]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_15036]
  ;')
[0m14:25:13.274302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:13.274302 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:25:13.274302 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:25:13.289879 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:25:13.289879 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: ROLLBACK
[0m14:25:13.289879 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: Close
[0m14:25:13.289879 [info ] [Thread-1 (]: 6 of 10 PASS source_not_null_sqlserver_ecommerce_Payment_Method ................ [[32mPASS[0m in 0.03s]
[0m14:25:13.289879 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:25:13.289879 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:25:13.305502 [info ] [Thread-1 (]: 7 of 10 START test source_not_null_sqlserver_ecommerce_Price ................... [RUN]
[0m14:25:13.305502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01)
[0m14:25:13.305502 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:25:13.305502 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:25:13.305502 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:25:13.321133 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:25:13.321133 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:25:13.321133 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_8446]
   as 
    
    
    



select Price
from "MY_DB"."dbo"."ecommerce"
where Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_8446]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_8446]
  ;')
[0m14:25:13.321133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:13.321133 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:25:13.321133 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:25:13.344582 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:25:13.347621 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: ROLLBACK
[0m14:25:13.348621 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: Close
[0m14:25:13.350621 [info ] [Thread-1 (]: 7 of 10 PASS source_not_null_sqlserver_ecommerce_Price ......................... [[32mPASS[0m in 0.04s]
[0m14:25:13.354622 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:25:13.355584 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:25:13.356595 [info ] [Thread-1 (]: 8 of 10 START test source_not_null_sqlserver_ecommerce_Product_ID .............. [RUN]
[0m14:25:13.358588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff)
[0m14:25:13.359620 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:25:13.367655 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:25:13.367655 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:25:13.367655 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:25:13.367655 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:25:13.367655 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_16740]
   as 
    
    
    



select Product_ID
from "MY_DB"."dbo"."ecommerce"
where Product_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_16740]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_16740]
  ;')
[0m14:25:13.367655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:13.367655 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:25:13.367655 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:25:13.383293 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:25:13.398949 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: ROLLBACK
[0m14:25:13.398949 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: Close
[0m14:25:13.398949 [info ] [Thread-1 (]: 8 of 10 PASS source_not_null_sqlserver_ecommerce_Product_ID .................... [[32mPASS[0m in 0.04s]
[0m14:25:13.398949 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:25:13.398949 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:25:13.398949 [info ] [Thread-1 (]: 9 of 10 START test source_not_null_sqlserver_ecommerce_Purchase_Date ........... [RUN]
[0m14:25:13.398949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17)
[0m14:25:13.398949 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:25:13.414574 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:25:13.414574 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:25:13.430169 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:25:13.430169 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:25:13.430169 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_9508]
   as 
    
    
    



select Purchase_Date
from "MY_DB"."dbo"."ecommerce"
where Purchase_Date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_9508]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_9508]
  ;')
[0m14:25:13.430169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:13.430169 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:25:13.430169 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:25:13.445788 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:25:13.445788 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: ROLLBACK
[0m14:25:13.445788 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: Close
[0m14:25:13.445788 [info ] [Thread-1 (]: 9 of 10 PASS source_not_null_sqlserver_ecommerce_Purchase_Date ................. [[32mPASS[0m in 0.05s]
[0m14:25:13.445788 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:25:13.445788 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:25:13.461658 [info ] [Thread-1 (]: 10 of 10 START test source_not_null_sqlserver_ecommerce_User_ID ................ [RUN]
[0m14:25:13.462660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc)
[0m14:25:13.464660 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:25:13.472665 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:25:13.474666 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:25:13.476901 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:25:13.476901 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:25:13.476901 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_9998]
   as 
    
    
    



select User_ID
from "MY_DB"."dbo"."ecommerce"
where User_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_9998]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_9998]
  ;')
[0m14:25:13.476901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:13.476901 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:25:13.476901 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:25:13.492527 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:25:13.492527 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: ROLLBACK
[0m14:25:13.492527 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: Close
[0m14:25:13.492527 [info ] [Thread-1 (]: 10 of 10 PASS source_not_null_sqlserver_ecommerce_User_ID ...................... [[32mPASS[0m in 0.03s]
[0m14:25:13.508157 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:25:13.508157 [debug] [MainThread]: On master: COMMIT
[0m14:25:13.508157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:13.508157 [debug] [MainThread]: Connection 'list_my_db_dbo' was properly closed.
[0m14:25:13.508157 [debug] [MainThread]: Connection 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc' was properly closed.
[0m14:25:13.508157 [info ] [MainThread]: 
[0m14:25:13.508157 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m14:25:13.523776 [debug] [MainThread]: Command end result
[0m14:25:13.586501 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m14:25:13.586501 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m14:25:13.602181 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m14:25:13.602181 [info ] [MainThread]: 
[0m14:25:13.602181 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:25:13.617756 [info ] [MainThread]: 
[0m14:25:13.617756 [error] [MainThread]: [31mFailure in test source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_ (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:25:13.617756 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:25:13.617756 [info ] [MainThread]: 
[0m14:25:13.617756 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_assert_source_structure_c6d0cb9679a465156478d8463af48bb4.sql
[0m14:25:13.617756 [info ] [MainThread]: 
[0m14:25:13.617756 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=10
[0m14:25:13.617756 [debug] [MainThread]: Command `dbt test` failed at 14:25:13.617756 after 4.91 seconds
[0m14:25:13.617756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AF9823DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AF9A80550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A823FFB90>]}
[0m14:25:13.634799 [debug] [MainThread]: Flushing usage events
[0m14:25:14.274153 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:26:32.509502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB9C7F9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB9C7F4A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB9C7F42D0>]}


============================== 14:26:32.509502 | 4300654e-cd12-47e4-a0dc-5ac59a3ff363 ==============================
[0m14:26:32.509502 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:26:32.509502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt test --target sqlserver', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:26:33.461361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4300654e-cd12-47e4-a0dc-5ac59a3ff363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB9E0B14D0>]}
[0m14:26:33.570932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4300654e-cd12-47e4-a0dc-5ac59a3ff363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB9B761F90>]}
[0m14:26:33.570932 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:26:34.336427 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m14:26:34.976642 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:26:34.976642 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:26:34.995547 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m14:26:35.117556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4300654e-cd12-47e4-a0dc-5ac59a3ff363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB9CB11E50>]}
[0m14:26:35.305057 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m14:26:35.305057 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m14:26:35.384482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4300654e-cd12-47e4-a0dc-5ac59a3ff363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB9E8019D0>]}
[0m14:26:35.384482 [info ] [MainThread]: Found 2 models, 10 data tests, 1 source, 626 macros
[0m14:26:35.384482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4300654e-cd12-47e4-a0dc-5ac59a3ff363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB9E5C1C10>]}
[0m14:26:35.400108 [info ] [MainThread]: 
[0m14:26:35.400108 [info ] [MainThread]: Concurrency: 1 threads (target='sqlserver')
[0m14:26:35.400108 [info ] [MainThread]: 
[0m14:26:35.400108 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:26:35.416130 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db_dbo'
[0m14:26:35.445204 [debug] [ThreadPool]: dbt-sqlserver
[0m14:26:35.445204 [debug] [ThreadPool]: Using sqlserver connection "list_my_db_dbo"
[0m14:26:35.445204 [debug] [ThreadPool]: On list_my_db_dbo: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db_dbo"} */
USE [my_db];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:26:35.445204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:35.445204 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:26:35.538957 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m14:26:35.585848 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:26:35.585848 [debug] [ThreadPool]: On list_my_db_dbo: ROLLBACK
[0m14:26:35.585848 [debug] [ThreadPool]: On list_my_db_dbo: Close
[0m14:26:35.585848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4300654e-cd12-47e4-a0dc-5ac59a3ff363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB9E3423D0>]}
[0m14:26:35.585848 [debug] [MainThread]: On master: COMMIT
[0m14:26:35.601515 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:26:35.601515 [info ] [Thread-1 (]: 1 of 10 START test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [RUN]
[0m14:26:35.601515 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8'
[0m14:26:35.601515 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:26:35.644937 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:26:35.646940 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:26:35.679862 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:26:35.695431 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:26:35.695431 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7948c8751759ef023ec7d17501389f26_13949]
   as 
    
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from "MY_DB"."dbo"."ecommerce"
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    ''Credit Card'',''Net Banking'',''UPI'',''Debit Card'',''Cash on Delivery''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7948c8751759ef023ec7d17501389f26_13949]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7948c8751759ef023ec7d17501389f26_13949]
  ;')
[0m14:26:35.695431 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:26:35.695431 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:26:35.711055 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:26:35.726683 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:26:35.726683 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: ROLLBACK
[0m14:26:35.742342 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: Close
[0m14:26:35.742342 [info ] [Thread-1 (]: 1 of 10 PASS source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [[32mPASS[0m in 0.14s]
[0m14:26:35.742342 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:26:35.742342 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_.fab1b630d8
[0m14:26:35.742342 [info ] [Thread-1 (]: 2 of 10 START test source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_  [RUN]
[0m14:26:35.742342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8, now test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_.fab1b630d8)
[0m14:26:35.742342 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_.fab1b630d8
[0m14:26:35.773588 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_.fab1b630d8"
[0m14:26:35.773588 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_.fab1b630d8
[0m14:26:35.773588 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_.fab1b630d8"
[0m14:26:35.789193 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_.fab1b630d8"
[0m14:26:35.789193 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_.fab1b630d8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_.fab1b630d8"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_446955b714c27e93626a2769628cd038_11223]
   as 
    
    with actual as (
        select 
            column_name, data_type
        from INFORMATION_SCHEMA.COLUMNS
        where table_name = ''ecommerce''
          and table_schema = ''dbo''
    ),
    expected as (
        select * from (
            values
            
                (''Category'', ''varchar''),
            
                (''Discount'', ''int''),
            
                (''Final_Price'', ''float''),
            
                (''Payment_Method'', ''varchar''),
            
                (''Price'', ''float''),
            
                (''Product_ID'', ''varchar''),
            
                (''Purchase_Date'', ''date''),
            
                (''User_ID'', ''varchar''),
            
                (''Quantidade'', ''int'')
            
        ) as t(column_name, data_type)
    )
    select
        e.column_name,
        e.data_type
    from expected e
    left join actual a
        on e.column_name = a.column_name
       and e.data_type = a.data_type
    where a.column_name is null

  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_446955b714c27e93626a2769628cd038_11223]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_446955b714c27e93626a2769628cd038_11223]
  ;')
[0m14:26:35.789193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:35.789193 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:26:35.789193 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:26:35.836103 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:26:35.836103 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_.fab1b630d8: ROLLBACK
[0m14:26:35.836103 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_.fab1b630d8: Close
[0m14:26:35.836103 [error] [Thread-1 (]: 2 of 10 FAIL 2 source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_  [[31mFAIL 2[0m in 0.09s]
[0m14:26:35.836103 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_.fab1b630d8
[0m14:26:35.853457 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:26:35.855457 [info ] [Thread-1 (]: 3 of 10 START test source_not_null_sqlserver_ecommerce_Category ................ [RUN]
[0m14:26:35.857344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_.fab1b630d8, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407)
[0m14:26:35.858341 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:26:35.871352 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:26:35.875344 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:26:35.880341 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:26:35.882342 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:26:35.883343 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_16599]
   as 
    
    
    



select Category
from "MY_DB"."dbo"."ecommerce"
where Category is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_16599]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_16599]
  ;')
[0m14:26:35.884448 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:35.884448 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:26:35.884448 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:26:35.900115 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:26:35.900115 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: ROLLBACK
[0m14:26:35.900115 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: Close
[0m14:26:35.900115 [info ] [Thread-1 (]: 3 of 10 PASS source_not_null_sqlserver_ecommerce_Category ...................... [[32mPASS[0m in 0.04s]
[0m14:26:35.900115 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:26:35.900115 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:26:35.900115 [info ] [Thread-1 (]: 4 of 10 START test source_not_null_sqlserver_ecommerce_Discount ................ [RUN]
[0m14:26:35.900115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f)
[0m14:26:35.900115 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:26:35.915703 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:26:35.915703 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:26:35.931337 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:26:35.931337 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:26:35.931337 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_6848]
   as 
    
    
    



select Discount
from "MY_DB"."dbo"."ecommerce"
where Discount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_6848]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_6848]
  ;')
[0m14:26:35.931337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:35.931337 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:26:35.931337 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:26:35.946950 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:26:35.946950 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: ROLLBACK
[0m14:26:35.946950 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: Close
[0m14:26:35.946950 [info ] [Thread-1 (]: 4 of 10 PASS source_not_null_sqlserver_ecommerce_Discount ...................... [[32mPASS[0m in 0.05s]
[0m14:26:35.946950 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:26:35.946950 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:26:35.962579 [info ] [Thread-1 (]: 5 of 10 START test source_not_null_sqlserver_ecommerce_Final_Price ............. [RUN]
[0m14:26:35.962579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d)
[0m14:26:35.962579 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:26:35.962579 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:26:35.962579 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:26:35.982588 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:26:35.984591 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:26:35.985625 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_16819]
   as 
    
    
    



select Final_Price
from "MY_DB"."dbo"."ecommerce"
where Final_Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_16819]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_16819]
  ;')
[0m14:26:35.987590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:35.989593 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:26:35.991594 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:26:35.992692 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:26:35.992692 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: ROLLBACK
[0m14:26:35.992692 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: Close
[0m14:26:36.008321 [info ] [Thread-1 (]: 5 of 10 PASS source_not_null_sqlserver_ecommerce_Final_Price ................... [[32mPASS[0m in 0.03s]
[0m14:26:36.008321 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:26:36.008321 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:26:36.008321 [info ] [Thread-1 (]: 6 of 10 START test source_not_null_sqlserver_ecommerce_Payment_Method .......... [RUN]
[0m14:26:36.008321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae)
[0m14:26:36.008321 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:26:36.023952 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:26:36.023952 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:26:36.023952 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:26:36.023952 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:26:36.039597 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_13614]
   as 
    
    
    



select Payment_Method
from "MY_DB"."dbo"."ecommerce"
where Payment_Method is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_13614]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_13614]
  ;')
[0m14:26:36.039597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:36.039597 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:26:36.039597 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:26:36.055196 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:26:36.058449 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: ROLLBACK
[0m14:26:36.059434 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: Close
[0m14:26:36.061441 [info ] [Thread-1 (]: 6 of 10 PASS source_not_null_sqlserver_ecommerce_Payment_Method ................ [[32mPASS[0m in 0.05s]
[0m14:26:36.063039 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:26:36.064994 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:26:36.066002 [info ] [Thread-1 (]: 7 of 10 START test source_not_null_sqlserver_ecommerce_Price ................... [RUN]
[0m14:26:36.068100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01)
[0m14:26:36.069098 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:26:36.078098 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:26:36.080101 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:26:36.085097 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:26:36.089275 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:26:36.090316 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_2242]
   as 
    
    
    



select Price
from "MY_DB"."dbo"."ecommerce"
where Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_2242]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_2242]
  ;')
[0m14:26:36.091314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:36.093315 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:26:36.094275 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:26:36.102635 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:26:36.102635 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: ROLLBACK
[0m14:26:36.102635 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: Close
[0m14:26:36.102635 [info ] [Thread-1 (]: 7 of 10 PASS source_not_null_sqlserver_ecommerce_Price ......................... [[32mPASS[0m in 0.04s]
[0m14:26:36.102635 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:26:36.102635 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:26:36.102635 [info ] [Thread-1 (]: 8 of 10 START test source_not_null_sqlserver_ecommerce_Product_ID .............. [RUN]
[0m14:26:36.118273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff)
[0m14:26:36.118273 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:26:36.118273 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:26:36.118273 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:26:36.133896 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:26:36.133896 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:26:36.133896 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_16330]
   as 
    
    
    



select Product_ID
from "MY_DB"."dbo"."ecommerce"
where Product_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_16330]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_16330]
  ;')
[0m14:26:36.133896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:36.133896 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:26:36.133896 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:26:36.149526 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:26:36.149526 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: ROLLBACK
[0m14:26:36.149526 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: Close
[0m14:26:36.149526 [info ] [Thread-1 (]: 8 of 10 PASS source_not_null_sqlserver_ecommerce_Product_ID .................... [[32mPASS[0m in 0.05s]
[0m14:26:36.165141 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:26:36.165141 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:26:36.165141 [info ] [Thread-1 (]: 9 of 10 START test source_not_null_sqlserver_ecommerce_Purchase_Date ........... [RUN]
[0m14:26:36.165141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17)
[0m14:26:36.165141 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:26:36.165141 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:26:36.180780 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:26:36.196840 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:26:36.198849 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:26:36.200841 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_8068]
   as 
    
    
    



select Purchase_Date
from "MY_DB"."dbo"."ecommerce"
where Purchase_Date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_8068]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_8068]
  ;')
[0m14:26:36.201838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:36.202841 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:26:36.204853 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:26:36.210895 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:26:36.210895 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: ROLLBACK
[0m14:26:36.226539 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: Close
[0m14:26:36.226539 [info ] [Thread-1 (]: 9 of 10 PASS source_not_null_sqlserver_ecommerce_Purchase_Date ................. [[32mPASS[0m in 0.06s]
[0m14:26:36.226539 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:26:36.226539 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:26:36.226539 [info ] [Thread-1 (]: 10 of 10 START test source_not_null_sqlserver_ecommerce_User_ID ................ [RUN]
[0m14:26:36.226539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc)
[0m14:26:36.226539 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:26:36.242159 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:26:36.242159 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:26:36.242159 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:26:36.242159 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:26:36.242159 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_8726]
   as 
    
    
    



select User_ID
from "MY_DB"."dbo"."ecommerce"
where User_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_8726]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_8726]
  ;')
[0m14:26:36.257848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:36.257848 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:26:36.257848 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:26:36.257848 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:26:36.273413 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: ROLLBACK
[0m14:26:36.273413 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: Close
[0m14:26:36.273413 [info ] [Thread-1 (]: 10 of 10 PASS source_not_null_sqlserver_ecommerce_User_ID ...................... [[32mPASS[0m in 0.05s]
[0m14:26:36.273413 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:26:36.273413 [debug] [MainThread]: On master: COMMIT
[0m14:26:36.273413 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:36.273413 [debug] [MainThread]: Connection 'list_my_db_dbo' was properly closed.
[0m14:26:36.273413 [debug] [MainThread]: Connection 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc' was properly closed.
[0m14:26:36.289551 [info ] [MainThread]: 
[0m14:26:36.291561 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m14:26:36.295548 [debug] [MainThread]: Command end result
[0m14:26:36.352899 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m14:26:36.368563 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m14:26:36.384161 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m14:26:36.384161 [info ] [MainThread]: 
[0m14:26:36.384161 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:26:36.384161 [info ] [MainThread]: 
[0m14:26:36.384161 [error] [MainThread]: [31mFailure in test source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar____name_Quantidade_data_type_int_ (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:26:36.384161 [error] [MainThread]:   Got 2 results, configured to fail if != 0
[0m14:26:36.384161 [info ] [MainThread]: 
[0m14:26:36.384161 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_assert_source_structure_c6d0cb9679a465156478d8463af48bb4.sql
[0m14:26:36.384161 [info ] [MainThread]: 
[0m14:26:36.384161 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=10
[0m14:26:36.399782 [debug] [MainThread]: Command `dbt test` failed at 14:26:36.399782 after 4.02 seconds
[0m14:26:36.399782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB95DE3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB9E11F3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB96040550>]}
[0m14:26:36.399782 [debug] [MainThread]: Flushing usage events
[0m14:26:37.008047 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:27:25.429858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E864A07BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E864A05F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E864A07ED0>]}


============================== 14:27:25.445530 | 96f2fdbe-85fe-42c0-af02-c128a22612a9 ==============================
[0m14:27:25.445530 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:27:25.445530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --target sqlserver', 'send_anonymous_usage_stats': 'True'}
[0m14:27:26.386826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96f2fdbe-85fe-42c0-af02-c128a22612a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E86416A3D0>]}
[0m14:27:26.496907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96f2fdbe-85fe-42c0-af02-c128a22612a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E863961D90>]}
[0m14:27:26.498909 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:27:27.337234 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m14:27:27.836198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:27:27.851807 [debug] [MainThread]: Partial parsing: updated file: dbt_databricks_cicd://dbt_databricks_cicd/models\raw\sqlserver\schema.yml
[0m14:27:28.930112 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m14:27:28.945732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96f2fdbe-85fe-42c0-af02-c128a22612a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E866291C90>]}
[0m14:27:29.134247 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m14:27:29.139256 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m14:27:29.211267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96f2fdbe-85fe-42c0-af02-c128a22612a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E866DAC510>]}
[0m14:27:29.211267 [info ] [MainThread]: Found 2 models, 10 data tests, 1 source, 626 macros
[0m14:27:29.211267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96f2fdbe-85fe-42c0-af02-c128a22612a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E866A4A790>]}
[0m14:27:29.226930 [info ] [MainThread]: 
[0m14:27:29.226930 [info ] [MainThread]: Concurrency: 1 threads (target='sqlserver')
[0m14:27:29.226930 [info ] [MainThread]: 
[0m14:27:29.226930 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:27:29.242514 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db_dbo'
[0m14:27:29.273810 [debug] [ThreadPool]: dbt-sqlserver
[0m14:27:29.273810 [debug] [ThreadPool]: Using sqlserver connection "list_my_db_dbo"
[0m14:27:29.273810 [debug] [ThreadPool]: On list_my_db_dbo: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db_dbo"} */
USE [my_db];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:27:29.273810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:29.273810 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:27:29.367737 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m14:27:29.439741 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:27:29.442779 [debug] [ThreadPool]: On list_my_db_dbo: ROLLBACK
[0m14:27:29.443779 [debug] [ThreadPool]: On list_my_db_dbo: Close
[0m14:27:29.446001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96f2fdbe-85fe-42c0-af02-c128a22612a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E861834190>]}
[0m14:27:29.446001 [debug] [MainThread]: On master: COMMIT
[0m14:27:29.446001 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:27:29.446001 [info ] [Thread-1 (]: 1 of 10 START test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [RUN]
[0m14:27:29.446001 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8'
[0m14:27:29.461638 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:27:29.477296 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:27:29.477296 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:27:29.508574 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:27:29.508574 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:27:29.508574 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7948c8751759ef023ec7d17501389f26_18782]
   as 
    
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from "MY_DB"."dbo"."ecommerce"
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    ''Credit Card'',''Net Banking'',''UPI'',''Debit Card'',''Cash on Delivery''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7948c8751759ef023ec7d17501389f26_18782]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7948c8751759ef023ec7d17501389f26_18782]
  ;')
[0m14:27:29.524167 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:27:29.524167 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:27:29.524167 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:27:29.551018 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:27:29.555227 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: ROLLBACK
[0m14:27:29.555227 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: Close
[0m14:27:29.555227 [info ] [Thread-1 (]: 1 of 10 PASS source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [[32mPASS[0m in 0.11s]
[0m14:27:29.555227 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:27:29.555227 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:27:29.555227 [info ] [Thread-1 (]: 2 of 10 START test source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_  [RUN]
[0m14:27:29.555227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8, now test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef)
[0m14:27:29.570881 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:27:29.570881 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:27:29.570881 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:27:29.586523 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:27:29.586523 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:27:29.586523 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_9a59e771c154aa693079c3068fb4d43b_10646]
   as 
    
    with actual as (
        select 
            column_name, data_type
        from INFORMATION_SCHEMA.COLUMNS
        where table_name = ''ecommerce''
          and table_schema = ''dbo''
    ),
    expected as (
        select * from (
            values
            
                (''Category'', ''varchar''),
            
                (''Discount'', ''int''),
            
                (''Final_Price'', ''float''),
            
                (''Payment_Method'', ''varchar''),
            
                (''Price'', ''float''),
            
                (''Product_ID'', ''varchar''),
            
                (''Purchase_Date'', ''date''),
            
                (''User_ID'', ''varchar'')
            
        ) as t(column_name, data_type)
    )
    select
        e.column_name,
        e.data_type
    from expected e
    left join actual a
        on e.column_name = a.column_name
       and e.data_type = a.data_type
    where a.column_name is null

  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_9a59e771c154aa693079c3068fb4d43b_10646]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_9a59e771c154aa693079c3068fb4d43b_10646]
  ;')
[0m14:27:29.586523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:29.586523 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:27:29.586523 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:27:29.633399 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:27:29.633399 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef: ROLLBACK
[0m14:27:29.650251 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef: Close
[0m14:27:29.651228 [error] [Thread-1 (]: 2 of 10 FAIL 1 source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_  [[31mFAIL 1[0m in 0.10s]
[0m14:27:29.654222 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:27:29.655221 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:27:29.656220 [info ] [Thread-1 (]: 3 of 10 START test source_not_null_sqlserver_ecommerce_Category ................ [RUN]
[0m14:27:29.658665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407)
[0m14:27:29.659663 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:27:29.664860 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:27:29.664860 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:27:29.680495 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:27:29.680495 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:27:29.680495 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_16314]
   as 
    
    
    



select Category
from "MY_DB"."dbo"."ecommerce"
where Category is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_16314]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_16314]
  ;')
[0m14:27:29.680495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:29.680495 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:27:29.680495 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:27:29.711733 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:27:29.711733 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: ROLLBACK
[0m14:27:29.711733 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: Close
[0m14:27:29.711733 [info ] [Thread-1 (]: 3 of 10 PASS source_not_null_sqlserver_ecommerce_Category ...................... [[32mPASS[0m in 0.05s]
[0m14:27:29.711733 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:27:29.711733 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:27:29.711733 [info ] [Thread-1 (]: 4 of 10 START test source_not_null_sqlserver_ecommerce_Discount ................ [RUN]
[0m14:27:29.711733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f)
[0m14:27:29.727361 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:27:29.742992 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:27:29.742992 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:27:29.758616 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:27:29.758616 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:27:29.758616 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_5833]
   as 
    
    
    



select Discount
from "MY_DB"."dbo"."ecommerce"
where Discount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_5833]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_5833]
  ;')
[0m14:27:29.758616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:29.774235 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:27:29.774235 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:27:29.789861 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:27:29.789861 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: ROLLBACK
[0m14:27:29.789861 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: Close
[0m14:27:29.805488 [info ] [Thread-1 (]: 4 of 10 PASS source_not_null_sqlserver_ecommerce_Discount ...................... [[32mPASS[0m in 0.08s]
[0m14:27:29.805488 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:27:29.805488 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:27:29.805488 [info ] [Thread-1 (]: 5 of 10 START test source_not_null_sqlserver_ecommerce_Final_Price ............. [RUN]
[0m14:27:29.805488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d)
[0m14:27:29.805488 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:27:29.821112 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:27:29.821112 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:27:29.836742 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:27:29.836742 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:27:29.836742 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_3545]
   as 
    
    
    



select Final_Price
from "MY_DB"."dbo"."ecommerce"
where Final_Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_3545]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_3545]
  ;')
[0m14:27:29.836742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:29.836742 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:27:29.853390 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:27:29.863389 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:27:29.868388 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: ROLLBACK
[0m14:27:29.870390 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: Close
[0m14:27:29.871386 [info ] [Thread-1 (]: 5 of 10 PASS source_not_null_sqlserver_ecommerce_Final_Price ................... [[32mPASS[0m in 0.07s]
[0m14:27:29.874402 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:27:29.876402 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:27:29.877391 [info ] [Thread-1 (]: 6 of 10 START test source_not_null_sqlserver_ecommerce_Payment_Method .......... [RUN]
[0m14:27:29.879387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae)
[0m14:27:29.880391 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:27:29.893739 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:27:29.896739 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:27:29.898810 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:27:29.898810 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:27:29.898810 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_5935]
   as 
    
    
    



select Payment_Method
from "MY_DB"."dbo"."ecommerce"
where Payment_Method is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_5935]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_5935]
  ;')
[0m14:27:29.898810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:29.898810 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:27:29.914439 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:27:29.930067 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:27:29.930067 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: ROLLBACK
[0m14:27:29.930067 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: Close
[0m14:27:29.930067 [info ] [Thread-1 (]: 6 of 10 PASS source_not_null_sqlserver_ecommerce_Payment_Method ................ [[32mPASS[0m in 0.05s]
[0m14:27:29.930067 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:27:29.945691 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:27:29.945691 [info ] [Thread-1 (]: 7 of 10 START test source_not_null_sqlserver_ecommerce_Price ................... [RUN]
[0m14:27:29.945691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01)
[0m14:27:29.945691 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:27:29.945691 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:27:29.961319 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:27:29.961319 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:27:29.976947 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:27:29.976947 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_16717]
   as 
    
    
    



select Price
from "MY_DB"."dbo"."ecommerce"
where Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_16717]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_16717]
  ;')
[0m14:27:29.976947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:29.976947 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:27:29.976947 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:27:29.992566 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:27:30.008192 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: ROLLBACK
[0m14:27:30.008192 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: Close
[0m14:27:30.008192 [info ] [Thread-1 (]: 7 of 10 PASS source_not_null_sqlserver_ecommerce_Price ......................... [[32mPASS[0m in 0.06s]
[0m14:27:30.008192 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:27:30.008192 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:27:30.008192 [info ] [Thread-1 (]: 8 of 10 START test source_not_null_sqlserver_ecommerce_Product_ID .............. [RUN]
[0m14:27:30.008192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff)
[0m14:27:30.008192 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:27:30.023817 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:27:30.023817 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:27:30.023817 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:27:30.039439 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:27:30.039439 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_16364]
   as 
    
    
    



select Product_ID
from "MY_DB"."dbo"."ecommerce"
where Product_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_16364]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_16364]
  ;')
[0m14:27:30.039439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:30.039439 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:27:30.039439 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:27:30.055066 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:27:30.055066 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: ROLLBACK
[0m14:27:30.055066 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: Close
[0m14:27:30.055066 [info ] [Thread-1 (]: 8 of 10 PASS source_not_null_sqlserver_ecommerce_Product_ID .................... [[32mPASS[0m in 0.05s]
[0m14:27:30.055066 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:27:30.055066 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:27:30.055066 [info ] [Thread-1 (]: 9 of 10 START test source_not_null_sqlserver_ecommerce_Purchase_Date ........... [RUN]
[0m14:27:30.055066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17)
[0m14:27:30.070686 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:27:30.070686 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:27:30.070686 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:27:30.086313 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:27:30.086313 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:27:30.086313 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_3261]
   as 
    
    
    



select Purchase_Date
from "MY_DB"."dbo"."ecommerce"
where Purchase_Date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_3261]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_3261]
  ;')
[0m14:27:30.086313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:30.086313 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:27:30.086313 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:27:30.108596 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:27:30.111635 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: ROLLBACK
[0m14:27:30.113650 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: Close
[0m14:27:30.114599 [info ] [Thread-1 (]: 9 of 10 PASS source_not_null_sqlserver_ecommerce_Purchase_Date ................. [[32mPASS[0m in 0.06s]
[0m14:27:30.117600 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:27:30.119773 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:27:30.121729 [info ] [Thread-1 (]: 10 of 10 START test source_not_null_sqlserver_ecommerce_User_ID ................ [RUN]
[0m14:27:30.123794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc)
[0m14:27:30.124792 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:27:30.131791 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:27:30.135842 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:27:30.140829 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:27:30.143793 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:27:30.144832 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_4847]
   as 
    
    
    



select User_ID
from "MY_DB"."dbo"."ecommerce"
where User_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_4847]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_4847]
  ;')
[0m14:27:30.146795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:30.147793 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:27:30.149179 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:27:30.161479 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:27:30.164481 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: ROLLBACK
[0m14:27:30.164653 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: Close
[0m14:27:30.164653 [info ] [Thread-1 (]: 10 of 10 PASS source_not_null_sqlserver_ecommerce_User_ID ...................... [[32mPASS[0m in 0.04s]
[0m14:27:30.164653 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:27:30.164653 [debug] [MainThread]: On master: COMMIT
[0m14:27:30.164653 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:30.164653 [debug] [MainThread]: Connection 'list_my_db_dbo' was properly closed.
[0m14:27:30.164653 [debug] [MainThread]: Connection 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc' was properly closed.
[0m14:27:30.164653 [info ] [MainThread]: 
[0m14:27:30.164653 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m14:27:30.180279 [debug] [MainThread]: Command end result
[0m14:27:30.274030 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m14:27:30.289660 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m14:27:30.305285 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m14:27:30.305285 [info ] [MainThread]: 
[0m14:27:30.305285 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:27:30.305285 [info ] [MainThread]: 
[0m14:27:30.305285 [error] [MainThread]: [31mFailure in test source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_ (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:27:30.322381 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:27:30.323385 [info ] [MainThread]: 
[0m14:27:30.325385 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_assert_source_structure_0af1e5f4dda30d85443523174084b59d.sql
[0m14:27:30.326386 [info ] [MainThread]: 
[0m14:27:30.327393 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=10
[0m14:27:30.330384 [debug] [MainThread]: Command `dbt test` failed at 14:27:30.330384 after 5.03 seconds
[0m14:27:30.331386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E85DF13DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E85E1711D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E85E1710D0>]}
[0m14:27:30.333385 [debug] [MainThread]: Flushing usage events
[0m14:27:30.946383 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:28:22.055037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266F0611390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266F06121D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266F0610E10>]}


============================== 14:28:22.055037 | 405fcd1b-95d6-4948-a0f5-99a3dc14dc44 ==============================
[0m14:28:22.055037 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:28:22.055037 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --target sqlserver', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:28:23.149936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '405fcd1b-95d6-4948-a0f5-99a3dc14dc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266F1EB7050>]}
[0m14:28:23.277902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '405fcd1b-95d6-4948-a0f5-99a3dc14dc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266EF581F50>]}
[0m14:28:23.280905 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:28:24.336497 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m14:28:24.946248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:28:24.946248 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:28:24.946248 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m14:28:25.183642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '405fcd1b-95d6-4948-a0f5-99a3dc14dc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266F232E1D0>]}
[0m14:28:25.404195 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m14:28:25.409197 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m14:28:25.476782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '405fcd1b-95d6-4948-a0f5-99a3dc14dc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266F24EFED0>]}
[0m14:28:25.476782 [info ] [MainThread]: Found 2 models, 10 data tests, 1 source, 626 macros
[0m14:28:25.476782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '405fcd1b-95d6-4948-a0f5-99a3dc14dc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266F21AA350>]}
[0m14:28:25.492412 [info ] [MainThread]: 
[0m14:28:25.492412 [info ] [MainThread]: Concurrency: 1 threads (target='sqlserver')
[0m14:28:25.492412 [info ] [MainThread]: 
[0m14:28:25.492412 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:28:25.508035 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db_dbo'
[0m14:28:25.539289 [debug] [ThreadPool]: dbt-sqlserver
[0m14:28:25.539289 [debug] [ThreadPool]: Using sqlserver connection "list_my_db_dbo"
[0m14:28:25.539289 [debug] [ThreadPool]: On list_my_db_dbo: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db_dbo"} */
USE [my_db];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:28:25.539289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:25.539289 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:28:25.633935 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m14:28:25.680854 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:28:25.696441 [debug] [ThreadPool]: On list_my_db_dbo: ROLLBACK
[0m14:28:25.696441 [debug] [ThreadPool]: On list_my_db_dbo: Close
[0m14:28:25.696441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '405fcd1b-95d6-4948-a0f5-99a3dc14dc44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266F21F7F10>]}
[0m14:28:25.696441 [debug] [MainThread]: On master: COMMIT
[0m14:28:25.712105 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:28:25.712105 [info ] [Thread-1 (]: 1 of 10 START test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [RUN]
[0m14:28:25.712105 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8'
[0m14:28:25.712105 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:28:25.742068 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:28:25.757697 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:28:25.788992 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:28:25.788992 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:28:25.788992 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7948c8751759ef023ec7d17501389f26_4431]
   as 
    
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from "MY_DB"."dbo"."ecommerce"
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    ''Credit Card'',''Net Banking'',''UPI'',''Debit Card'',''Cash on Delivery''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7948c8751759ef023ec7d17501389f26_4431]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7948c8751759ef023ec7d17501389f26_4431]
  ;')
[0m14:28:25.788992 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:28:25.788992 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:28:25.807977 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:28:25.825097 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:25.832135 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: ROLLBACK
[0m14:28:25.834097 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: Close
[0m14:28:25.835093 [info ] [Thread-1 (]: 1 of 10 PASS source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [[32mPASS[0m in 0.12s]
[0m14:28:25.838469 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:28:25.839429 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:28:25.840428 [info ] [Thread-1 (]: 2 of 10 START test source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_  [RUN]
[0m14:28:25.842468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8, now test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef)
[0m14:28:25.844430 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:28:25.867713 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:28:25.867713 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:28:25.867713 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:28:25.883377 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:28:25.883377 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_9a59e771c154aa693079c3068fb4d43b_2622]
   as 
    
    with actual as (
        select 
            column_name, data_type
        from INFORMATION_SCHEMA.COLUMNS
        where table_name = ''ecommerce''
          and table_schema = ''dbo''
    ),
    expected as (
        select * from (
            values
            
                (''Category'', ''varchar''),
            
                (''Discount'', ''int''),
            
                (''Final_Price'', ''float''),
            
                (''Payment_Method'', ''varchar''),
            
                (''Price'', ''float''),
            
                (''Product_ID'', ''varchar''),
            
                (''Purchase_Date'', ''date''),
            
                (''User_ID'', ''varchar'')
            
        ) as t(column_name, data_type)
    )
    select
        e.column_name,
        e.data_type
    from expected e
    left join actual a
        on e.column_name = a.column_name
       and e.data_type = a.data_type
    where a.column_name is null

  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_9a59e771c154aa693079c3068fb4d43b_2622]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_9a59e771c154aa693079c3068fb4d43b_2622]
  ;')
[0m14:28:25.883377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:25.883377 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:28:25.883377 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:28:25.930220 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:25.930220 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef: ROLLBACK
[0m14:28:25.930220 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef: Close
[0m14:28:25.930220 [info ] [Thread-1 (]: 2 of 10 PASS source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_  [[32mPASS[0m in 0.09s]
[0m14:28:25.930220 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:28:25.946748 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:28:25.948742 [info ] [Thread-1 (]: 3 of 10 START test source_not_null_sqlserver_ecommerce_Category ................ [RUN]
[0m14:28:25.950743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407)
[0m14:28:25.951746 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:28:25.962403 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:28:25.962403 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:28:25.962403 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:28:25.962403 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:28:25.962403 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_5059]
   as 
    
    
    



select Category
from "MY_DB"."dbo"."ecommerce"
where Category is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_5059]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_5059]
  ;')
[0m14:28:25.978027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:25.978027 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:28:25.978027 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:28:25.993651 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:25.993651 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: ROLLBACK
[0m14:28:25.993651 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: Close
[0m14:28:25.993651 [info ] [Thread-1 (]: 3 of 10 PASS source_not_null_sqlserver_ecommerce_Category ...................... [[32mPASS[0m in 0.04s]
[0m14:28:25.993651 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:28:25.993651 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:28:25.993651 [info ] [Thread-1 (]: 4 of 10 START test source_not_null_sqlserver_ecommerce_Discount ................ [RUN]
[0m14:28:25.993651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f)
[0m14:28:25.993651 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:28:26.009316 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:28:26.009316 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:28:26.024949 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:28:26.024949 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:28:26.024949 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_16518]
   as 
    
    
    



select Discount
from "MY_DB"."dbo"."ecommerce"
where Discount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_16518]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_16518]
  ;')
[0m14:28:26.024949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:26.024949 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:28:26.024949 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:28:26.040567 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:26.040567 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: ROLLBACK
[0m14:28:26.040567 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: Close
[0m14:28:26.040567 [info ] [Thread-1 (]: 4 of 10 PASS source_not_null_sqlserver_ecommerce_Discount ...................... [[32mPASS[0m in 0.05s]
[0m14:28:26.040567 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:28:26.040567 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:28:26.040567 [info ] [Thread-1 (]: 5 of 10 START test source_not_null_sqlserver_ecommerce_Final_Price ............. [RUN]
[0m14:28:26.057702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d)
[0m14:28:26.058666 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:28:26.066662 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:28:26.069664 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:28:26.071866 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:28:26.071866 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:28:26.071866 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_4877]
   as 
    
    
    



select Final_Price
from "MY_DB"."dbo"."ecommerce"
where Final_Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_4877]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_4877]
  ;')
[0m14:28:26.071866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:26.071866 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:28:26.071866 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:28:26.087533 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:26.087533 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: ROLLBACK
[0m14:28:26.087533 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: Close
[0m14:28:26.087533 [info ] [Thread-1 (]: 5 of 10 PASS source_not_null_sqlserver_ecommerce_Final_Price ................... [[32mPASS[0m in 0.03s]
[0m14:28:26.103119 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:28:26.103119 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:28:26.103119 [info ] [Thread-1 (]: 6 of 10 START test source_not_null_sqlserver_ecommerce_Payment_Method .......... [RUN]
[0m14:28:26.103119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae)
[0m14:28:26.103119 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:28:26.103119 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:28:26.118791 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:28:26.118791 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:28:26.118791 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:28:26.118791 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_17946]
   as 
    
    
    



select Payment_Method
from "MY_DB"."dbo"."ecommerce"
where Payment_Method is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_17946]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_17946]
  ;')
[0m14:28:26.134371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:26.134371 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:28:26.134371 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:28:26.134371 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:26.150034 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: ROLLBACK
[0m14:28:26.150034 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: Close
[0m14:28:26.150034 [info ] [Thread-1 (]: 6 of 10 PASS source_not_null_sqlserver_ecommerce_Payment_Method ................ [[32mPASS[0m in 0.05s]
[0m14:28:26.150034 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:28:26.150034 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:28:26.150034 [info ] [Thread-1 (]: 7 of 10 START test source_not_null_sqlserver_ecommerce_Price ................... [RUN]
[0m14:28:26.150034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01)
[0m14:28:26.150034 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:28:26.176126 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:28:26.179131 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:28:26.186123 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:28:26.188124 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:28:26.189220 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_12647]
   as 
    
    
    



select Price
from "MY_DB"."dbo"."ecommerce"
where Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_12647]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_12647]
  ;')
[0m14:28:26.189220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:26.189220 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:28:26.189220 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:28:26.204846 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:26.204846 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: ROLLBACK
[0m14:28:26.204846 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: Close
[0m14:28:26.204846 [info ] [Thread-1 (]: 7 of 10 PASS source_not_null_sqlserver_ecommerce_Price ......................... [[32mPASS[0m in 0.05s]
[0m14:28:26.204846 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:28:26.204846 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:28:26.204846 [info ] [Thread-1 (]: 8 of 10 START test source_not_null_sqlserver_ecommerce_Product_ID .............. [RUN]
[0m14:28:26.204846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff)
[0m14:28:26.204846 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:28:26.220475 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:28:26.220475 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:28:26.220475 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:28:26.236101 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:28:26.236101 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_7398]
   as 
    
    
    



select Product_ID
from "MY_DB"."dbo"."ecommerce"
where Product_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_7398]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_7398]
  ;')
[0m14:28:26.236101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:26.236101 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:28:26.236101 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:28:26.251727 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:26.251727 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: ROLLBACK
[0m14:28:26.251727 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: Close
[0m14:28:26.251727 [info ] [Thread-1 (]: 8 of 10 PASS source_not_null_sqlserver_ecommerce_Product_ID .................... [[32mPASS[0m in 0.05s]
[0m14:28:26.251727 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:28:26.251727 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:28:26.251727 [info ] [Thread-1 (]: 9 of 10 START test source_not_null_sqlserver_ecommerce_Purchase_Date ........... [RUN]
[0m14:28:26.268030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17)
[0m14:28:26.270033 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:28:26.278040 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:28:26.281032 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:28:26.286066 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:28:26.288068 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:28:26.290114 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_13249]
   as 
    
    
    



select Purchase_Date
from "MY_DB"."dbo"."ecommerce"
where Purchase_Date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_13249]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_13249]
  ;')
[0m14:28:26.291137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:26.292158 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:28:26.293118 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:28:26.305423 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:26.305423 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: ROLLBACK
[0m14:28:26.305423 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: Close
[0m14:28:26.305423 [info ] [Thread-1 (]: 9 of 10 PASS source_not_null_sqlserver_ecommerce_Purchase_Date ................. [[32mPASS[0m in 0.04s]
[0m14:28:26.305423 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:28:26.321094 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:28:26.321094 [info ] [Thread-1 (]: 10 of 10 START test source_not_null_sqlserver_ecommerce_User_ID ................ [RUN]
[0m14:28:26.321094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc)
[0m14:28:26.321094 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:28:26.321094 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:28:26.336711 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:28:26.336711 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:28:26.336711 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:28:26.336711 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_14924]
   as 
    
    
    



select User_ID
from "MY_DB"."dbo"."ecommerce"
where User_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_14924]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_14924]
  ;')
[0m14:28:26.336711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:26.336711 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:28:26.352301 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:28:26.352301 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:26.352301 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: ROLLBACK
[0m14:28:26.367967 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: Close
[0m14:28:26.367967 [info ] [Thread-1 (]: 10 of 10 PASS source_not_null_sqlserver_ecommerce_User_ID ...................... [[32mPASS[0m in 0.05s]
[0m14:28:26.367967 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:28:26.367967 [debug] [MainThread]: On master: COMMIT
[0m14:28:26.367967 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:26.367967 [debug] [MainThread]: Connection 'list_my_db_dbo' was properly closed.
[0m14:28:26.367967 [debug] [MainThread]: Connection 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc' was properly closed.
[0m14:28:26.367967 [info ] [MainThread]: 
[0m14:28:26.384314 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m14:28:26.389340 [debug] [MainThread]: Command end result
[0m14:28:26.462136 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m14:28:26.462136 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m14:28:26.477768 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m14:28:26.477768 [info ] [MainThread]: 
[0m14:28:26.477768 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:28:26.477768 [info ] [MainThread]: 
[0m14:28:26.477768 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m14:28:26.477768 [debug] [MainThread]: Command `dbt test` succeeded at 14:28:26.477768 after 4.62 seconds
[0m14:28:26.494758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266E9B33DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266E9D910D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266E9D904D0>]}
[0m14:28:26.495767 [debug] [MainThread]: Flushing usage events
[0m14:28:27.086718 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:28:40.466096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE429AA050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE429A4ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE429A5F10>]}


============================== 14:28:40.473133 | b3b5e492-1b1f-45c9-9c36-c21d8b86825c ==============================
[0m14:28:40.473133 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:28:40.475120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --target sqlserver', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:28:41.383336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3b5e492-1b1f-45c9-9c36-c21d8b86825c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE420BFE90>]}
[0m14:28:41.492318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3b5e492-1b1f-45c9-9c36-c21d8b86825c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE41901F10>]}
[0m14:28:41.492318 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:28:42.284211 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m14:28:42.775125 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:28:42.775125 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:28:42.790754 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m14:28:42.931659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3b5e492-1b1f-45c9-9c36-c21d8b86825c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE445DC9D0>]}
[0m14:28:43.101656 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m14:28:43.117279 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m14:28:43.195401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3b5e492-1b1f-45c9-9c36-c21d8b86825c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE449C8A50>]}
[0m14:28:43.195401 [info ] [MainThread]: Found 2 models, 10 data tests, 1 source, 626 macros
[0m14:28:43.211027 [info ] [MainThread]: 
[0m14:28:43.211027 [info ] [MainThread]: Concurrency: 1 threads (target='sqlserver')
[0m14:28:43.211027 [info ] [MainThread]: 
[0m14:28:43.211027 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:28:43.226652 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db'
[0m14:28:43.265566 [debug] [ThreadPool]: dbt-sqlserver
[0m14:28:43.266569 [debug] [ThreadPool]: Using sqlserver connection "list_my_db"
[0m14:28:43.267572 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db"} */
USE [my_db];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:28:43.269527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:43.270524 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:28:43.337111 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m14:28:43.337111 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:28:43.352739 [debug] [ThreadPool]: On list_my_db: Close
[0m14:28:43.352739 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db_dbo'
[0m14:28:43.352739 [debug] [ThreadPool]: dbt-sqlserver
[0m14:28:43.369577 [debug] [ThreadPool]: Using sqlserver connection "list_my_db_dbo"
[0m14:28:43.370567 [debug] [ThreadPool]: On list_my_db_dbo: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db_dbo"} */
USE [my_db];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:28:43.371570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:43.372570 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:28:43.373570 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m14:28:43.378569 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:28:43.381570 [debug] [ThreadPool]: On list_my_db_dbo: ROLLBACK
[0m14:28:43.382569 [debug] [ThreadPool]: On list_my_db_dbo: Close
[0m14:28:43.383692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3b5e492-1b1f-45c9-9c36-c21d8b86825c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE44316450>]}
[0m14:28:43.383692 [debug] [MainThread]: On master: COMMIT
[0m14:28:43.383692 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:28:43.383692 [info ] [Thread-1 (]: 1 of 12 START test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [RUN]
[0m14:28:43.383692 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8'
[0m14:28:43.399314 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:28:43.430611 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:28:43.430611 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:28:43.461822 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:28:43.461822 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:28:43.461822 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7948c8751759ef023ec7d17501389f26_16632]
   as 
    
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from "MY_DB"."dbo"."ecommerce"
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    ''Credit Card'',''Net Banking'',''UPI'',''Debit Card'',''Cash on Delivery''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7948c8751759ef023ec7d17501389f26_16632]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7948c8751759ef023ec7d17501389f26_16632]
  ;')
[0m14:28:43.478042 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:28:43.479082 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:28:43.485456 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:28:43.493588 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:43.493588 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: ROLLBACK
[0m14:28:43.509218 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: Close
[0m14:28:43.509218 [info ] [Thread-1 (]: 1 of 12 PASS source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [[32mPASS[0m in 0.13s]
[0m14:28:43.509218 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:28:43.509218 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:28:43.509218 [info ] [Thread-1 (]: 2 of 12 START test source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_  [RUN]
[0m14:28:43.509218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8, now test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef)
[0m14:28:43.509218 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:28:43.540474 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:28:43.540474 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:28:43.540474 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:28:43.540474 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:28:43.556097 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_9a59e771c154aa693079c3068fb4d43b_8232]
   as 
    
    with actual as (
        select 
            column_name, data_type
        from INFORMATION_SCHEMA.COLUMNS
        where table_name = ''ecommerce''
          and table_schema = ''dbo''
    ),
    expected as (
        select * from (
            values
            
                (''Category'', ''varchar''),
            
                (''Discount'', ''int''),
            
                (''Final_Price'', ''float''),
            
                (''Payment_Method'', ''varchar''),
            
                (''Price'', ''float''),
            
                (''Product_ID'', ''varchar''),
            
                (''Purchase_Date'', ''date''),
            
                (''User_ID'', ''varchar'')
            
        ) as t(column_name, data_type)
    )
    select
        e.column_name,
        e.data_type
    from expected e
    left join actual a
        on e.column_name = a.column_name
       and e.data_type = a.data_type
    where a.column_name is null

  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_9a59e771c154aa693079c3068fb4d43b_8232]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_9a59e771c154aa693079c3068fb4d43b_8232]
  ;')
[0m14:28:43.556097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:43.556097 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:28:43.556097 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:28:43.602155 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:43.602155 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef: ROLLBACK
[0m14:28:43.602155 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef: Close
[0m14:28:43.602155 [info ] [Thread-1 (]: 2 of 12 PASS source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_  [[32mPASS[0m in 0.09s]
[0m14:28:43.602155 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:28:43.617818 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:28:43.617818 [info ] [Thread-1 (]: 3 of 12 START test source_not_null_sqlserver_ecommerce_Category ................ [RUN]
[0m14:28:43.617818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407)
[0m14:28:43.617818 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:28:43.633458 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:28:43.633458 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:28:43.633458 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:28:43.633458 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:28:43.633458 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_9185]
   as 
    
    
    



select Category
from "MY_DB"."dbo"."ecommerce"
where Category is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_9185]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_9185]
  ;')
[0m14:28:43.649036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:43.649036 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:28:43.649036 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:28:43.649036 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:43.664662 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: ROLLBACK
[0m14:28:43.664662 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: Close
[0m14:28:43.664662 [info ] [Thread-1 (]: 3 of 12 PASS source_not_null_sqlserver_ecommerce_Category ...................... [[32mPASS[0m in 0.05s]
[0m14:28:43.664662 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:28:43.664662 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:28:43.664662 [info ] [Thread-1 (]: 4 of 12 START test source_not_null_sqlserver_ecommerce_Discount ................ [RUN]
[0m14:28:43.664662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f)
[0m14:28:43.664662 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:28:43.680307 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:28:43.680307 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:28:43.704549 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:28:43.708545 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:28:43.711545 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_1995]
   as 
    
    
    



select Discount
from "MY_DB"."dbo"."ecommerce"
where Discount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_1995]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_1995]
  ;')
[0m14:28:43.713537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:43.713537 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:28:43.713537 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:28:43.729162 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:43.729162 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: ROLLBACK
[0m14:28:43.729162 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: Close
[0m14:28:43.729162 [info ] [Thread-1 (]: 4 of 12 PASS source_not_null_sqlserver_ecommerce_Discount ...................... [[32mPASS[0m in 0.06s]
[0m14:28:43.729162 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:28:43.729162 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:28:43.729162 [info ] [Thread-1 (]: 5 of 12 START test source_not_null_sqlserver_ecommerce_Final_Price ............. [RUN]
[0m14:28:43.744787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d)
[0m14:28:43.744787 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:28:43.744787 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:28:43.744787 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:28:43.760426 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:28:43.760426 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:28:43.760426 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_8004]
   as 
    
    
    



select Final_Price
from "MY_DB"."dbo"."ecommerce"
where Final_Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_8004]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_8004]
  ;')
[0m14:28:43.760426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:43.760426 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:28:43.760426 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:28:43.776037 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:43.776037 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: ROLLBACK
[0m14:28:43.776037 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: Close
[0m14:28:43.776037 [info ] [Thread-1 (]: 5 of 12 PASS source_not_null_sqlserver_ecommerce_Final_Price ................... [[32mPASS[0m in 0.03s]
[0m14:28:43.776037 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:28:43.776037 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:28:43.791661 [info ] [Thread-1 (]: 6 of 12 START test source_not_null_sqlserver_ecommerce_Payment_Method .......... [RUN]
[0m14:28:43.791661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae)
[0m14:28:43.791661 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:28:43.791661 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:28:43.809654 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:28:43.816652 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:28:43.818653 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:28:43.819659 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_6177]
   as 
    
    
    



select Payment_Method
from "MY_DB"."dbo"."ecommerce"
where Payment_Method is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_6177]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_6177]
  ;')
[0m14:28:43.820694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:43.820694 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:28:43.820694 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:28:43.820694 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:43.836325 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: ROLLBACK
[0m14:28:43.836325 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: Close
[0m14:28:43.836325 [info ] [Thread-1 (]: 6 of 12 PASS source_not_null_sqlserver_ecommerce_Payment_Method ................ [[32mPASS[0m in 0.04s]
[0m14:28:43.836325 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:28:43.836325 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:28:43.836325 [info ] [Thread-1 (]: 7 of 12 START test source_not_null_sqlserver_ecommerce_Price ................... [RUN]
[0m14:28:43.836325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01)
[0m14:28:43.836325 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:28:43.851949 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:28:43.851949 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:28:43.867618 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:28:43.867618 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:28:43.867618 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_4008]
   as 
    
    
    



select Price
from "MY_DB"."dbo"."ecommerce"
where Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_4008]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_4008]
  ;')
[0m14:28:43.867618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:43.867618 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:28:43.867618 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:28:43.883235 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:43.883235 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: ROLLBACK
[0m14:28:43.883235 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: Close
[0m14:28:43.883235 [info ] [Thread-1 (]: 7 of 12 PASS source_not_null_sqlserver_ecommerce_Price ......................... [[32mPASS[0m in 0.05s]
[0m14:28:43.883235 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:28:43.883235 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:28:43.883235 [info ] [Thread-1 (]: 8 of 12 START test source_not_null_sqlserver_ecommerce_Product_ID .............. [RUN]
[0m14:28:43.898860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff)
[0m14:28:43.898860 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:28:43.898860 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:28:43.898860 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:28:43.914493 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:28:43.914493 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:28:43.914493 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_7027]
   as 
    
    
    



select Product_ID
from "MY_DB"."dbo"."ecommerce"
where Product_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_7027]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_7027]
  ;')
[0m14:28:43.914493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:43.914493 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:28:43.914493 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:28:43.936078 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:43.939131 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: ROLLBACK
[0m14:28:43.940131 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: Close
[0m14:28:43.942096 [info ] [Thread-1 (]: 8 of 12 PASS source_not_null_sqlserver_ecommerce_Product_ID .................... [[32mPASS[0m in 0.04s]
[0m14:28:43.945114 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:28:43.947127 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:28:43.949094 [info ] [Thread-1 (]: 9 of 12 START test source_not_null_sqlserver_ecommerce_Purchase_Date ........... [RUN]
[0m14:28:43.951092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17)
[0m14:28:43.952101 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:28:43.960099 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:28:43.964404 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:28:43.969404 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:28:43.971403 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:28:43.972406 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_18284]
   as 
    
    
    



select Purchase_Date
from "MY_DB"."dbo"."ecommerce"
where Purchase_Date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_18284]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_18284]
  ;')
[0m14:28:43.973406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:43.975405 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:28:43.976684 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:28:43.987683 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:43.991685 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: ROLLBACK
[0m14:28:43.992682 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: Close
[0m14:28:43.994781 [info ] [Thread-1 (]: 9 of 12 PASS source_not_null_sqlserver_ecommerce_Purchase_Date ................. [[32mPASS[0m in 0.04s]
[0m14:28:43.997788 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:28:43.998786 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:28:43.999786 [info ] [Thread-1 (]: 10 of 12 START test source_not_null_sqlserver_ecommerce_User_ID ................ [RUN]
[0m14:28:44.001785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc)
[0m14:28:44.002787 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:28:44.014447 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:28:44.017494 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:28:44.025593 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:28:44.029598 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:28:44.030595 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_12338]
   as 
    
    
    



select User_ID
from "MY_DB"."dbo"."ecommerce"
where User_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_12338]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_12338]
  ;')
[0m14:28:44.031634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:44.033632 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:28:44.034635 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:28:44.056255 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:44.056255 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: ROLLBACK
[0m14:28:44.056255 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: Close
[0m14:28:44.056255 [info ] [Thread-1 (]: 10 of 12 PASS source_not_null_sqlserver_ecommerce_User_ID ...................... [[32mPASS[0m in 0.05s]
[0m14:28:44.071764 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:28:44.071764 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce
[0m14:28:44.071764 [info ] [Thread-1 (]: 11 of 12 START sql view model dbo.src_ecommerce ................................ [RUN]
[0m14:28:44.071764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc, now model.dbt_databricks_cicd.src_ecommerce)
[0m14:28:44.071764 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.src_ecommerce
[0m14:28:44.071764 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.src_ecommerce"
[0m14:28:44.087383 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.src_ecommerce
[0m14:28:44.150196 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.src_ecommerce"
[0m14:28:44.150196 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.src_ecommerce"
[0m14:28:44.150196 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.src_ecommerce"} */
USE [my_db];
    
    

    

    
    USE [my_db];
    EXEC('
        create view "dbo"."src_ecommerce__dbt_tmp" as 

select * from "MY_DB"."dbo"."ecommerce";
    ')


[0m14:28:44.150196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:44.150196 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:28:44.150196 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:28:44.150196 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:44.165824 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.src_ecommerce"
[0m14:28:44.165824 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.src_ecommerce"} */
USE [my_db];
      EXEC sp_rename 'dbo.src_ecommerce', 'src_ecommerce__dbt_backup'
[0m14:28:44.393384 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:44.393384 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.src_ecommerce"
[0m14:28:44.393384 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.src_ecommerce"} */
USE [my_db];
      EXEC sp_rename 'dbo.src_ecommerce__dbt_tmp', 'src_ecommerce'
[0m14:28:44.409010 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:44.424637 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: COMMIT
[0m14:28:44.440259 [debug] [Thread-1 (]: Applying DROP to: "my_db"."dbo"."src_ecommerce__dbt_backup"
[0m14:28:44.455887 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:28:44.455887 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.src_ecommerce"
[0m14:28:44.455887 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.src_ecommerce"} */

        USE [my_db];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'my_db'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'src_ecommerce__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:28:44.493147 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:44.508773 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.src_ecommerce"
[0m14:28:44.508773 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.src_ecommerce"} */

      
      
    
    USE [my_db];
    EXEC('DROP view IF EXISTS "dbo"."src_ecommerce__dbt_backup";');

[0m14:28:44.508773 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:44.508773 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: ROLLBACK
[0m14:28:44.508773 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: Close
[0m14:28:44.524401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3b5e492-1b1f-45c9-9c36-c21d8b86825c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE44A820D0>]}
[0m14:28:44.524401 [info ] [Thread-1 (]: 11 of 12 OK created sql view model dbo.src_ecommerce ........................... [[32mOK[0m in 0.44s]
[0m14:28:44.524401 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce
[0m14:28:44.524401 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.stg_ecommerce
[0m14:28:44.524401 [info ] [Thread-1 (]: 12 of 12 START sql view model dbo.stg_ecommerce ................................ [RUN]
[0m14:28:44.524401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.src_ecommerce, now model.dbt_databricks_cicd.stg_ecommerce)
[0m14:28:44.524401 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.stg_ecommerce
[0m14:28:44.540026 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.stg_ecommerce"
[0m14:28:44.540026 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.stg_ecommerce
[0m14:28:44.555651 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.stg_ecommerce"
[0m14:28:44.555651 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.stg_ecommerce"
[0m14:28:44.555651 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.stg_ecommerce"} */
USE [my_db];
    
    

    

    
    USE [my_db];
    EXEC('
        create view "dbo"."stg_ecommerce__dbt_tmp" as 

SELECT
    
        CAST(User_ID AS VARCHAR) AS User_ID,
        CAST(Product_ID AS VARCHAR) AS Product_ID,
        CAST(Category AS VARCHAR) AS Category,
        CAST(Price AS FLOAT) AS Price,
        CAST(Discount AS INT) AS Discount,
        CAST(Final_Price AS FLOAT) AS Final_Price,
        CAST(Payment_Method AS VARCHAR) AS Payment_Method,
        CAST(Purchase_Date AS DATE) AS Purchase_Date
    
FROM "MY_DB"."dbo"."ecommerce";
    ')


[0m14:28:44.555651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:44.555651 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:28:44.555651 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:28:44.572534 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:44.579533 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.stg_ecommerce"
[0m14:28:44.580533 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.stg_ecommerce"} */
USE [my_db];
      EXEC sp_rename 'dbo.stg_ecommerce', 'stg_ecommerce__dbt_backup'
[0m14:28:44.584534 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:44.587570 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.stg_ecommerce"
[0m14:28:44.587570 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.stg_ecommerce"} */
USE [my_db];
      EXEC sp_rename 'dbo.stg_ecommerce__dbt_tmp', 'stg_ecommerce'
[0m14:28:44.587570 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:44.587570 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: COMMIT
[0m14:28:44.603205 [debug] [Thread-1 (]: Applying DROP to: "my_db"."dbo"."stg_ecommerce__dbt_backup"
[0m14:28:44.603205 [debug] [Thread-1 (]: dbt-sqlserver
[0m14:28:44.603205 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.stg_ecommerce"
[0m14:28:44.603205 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.stg_ecommerce"} */

        USE [my_db];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'my_db'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_ecommerce__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m14:28:44.618831 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:44.618831 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.stg_ecommerce"
[0m14:28:44.618831 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.stg_ecommerce"} */

      
      
    
    USE [my_db];
    EXEC('DROP view IF EXISTS "dbo"."stg_ecommerce__dbt_backup";');

[0m14:28:44.618831 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:28:44.634448 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: ROLLBACK
[0m14:28:44.634448 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: Close
[0m14:28:44.634448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3b5e492-1b1f-45c9-9c36-c21d8b86825c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE4512B9D0>]}
[0m14:28:44.634448 [info ] [Thread-1 (]: 12 of 12 OK created sql view model dbo.stg_ecommerce ........................... [[32mOK[0m in 0.11s]
[0m14:28:44.634448 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.stg_ecommerce
[0m14:28:44.634448 [debug] [MainThread]: On master: COMMIT
[0m14:28:44.634448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:44.634448 [debug] [MainThread]: Connection 'list_my_db' was properly closed.
[0m14:28:44.634448 [debug] [MainThread]: Connection 'list_my_db_dbo' was properly closed.
[0m14:28:44.650075 [debug] [MainThread]: Connection 'model.dbt_databricks_cicd.stg_ecommerce' was properly closed.
[0m14:28:44.650075 [info ] [MainThread]: 
[0m14:28:44.650075 [info ] [MainThread]: Finished running 10 data tests, 2 view models in 0 hours 0 minutes and 1.44 seconds (1.44s).
[0m14:28:44.650075 [debug] [MainThread]: Command end result
[0m14:28:44.743823 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m14:28:44.759462 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m14:28:44.759462 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m14:28:44.759462 [info ] [MainThread]: 
[0m14:28:44.776336 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:28:44.778335 [info ] [MainThread]: 
[0m14:28:44.780335 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m14:28:44.782333 [debug] [MainThread]: Command `dbt build` succeeded at 14:28:44.782333 after 4.45 seconds
[0m14:28:44.783333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE3BFB3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE44544310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE3C2104D0>]}
[0m14:28:44.785333 [debug] [MainThread]: Flushing usage events
[0m14:28:45.398791 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:29:24.092152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023572A26B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002356ECDAAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023572A24190>]}


============================== 14:29:24.099157 | 555f1654-669e-46c4-80ab-eb5101ba1c31 ==============================
[0m14:29:24.099157 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:29:24.101116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt build --target databricks', 'send_anonymous_usage_stats': 'True'}
[0m14:29:25.992679 [debug] [MainThread]: Spark adapter: Setting pyhive.hive logging to ERROR
[0m14:29:25.992679 [debug] [MainThread]: Spark adapter: Setting thrift.transport logging to ERROR
[0m14:29:25.992679 [debug] [MainThread]: Spark adapter: Setting thrift.protocol logging to ERROR
[0m14:29:32.179873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '555f1654-669e-46c4-80ab-eb5101ba1c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002357BF43AD0>]}
[0m14:29:32.289302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '555f1654-669e-46c4-80ab-eb5101ba1c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023572199B90>]}
[0m14:29:32.289302 [info ] [MainThread]: Registered adapter: databricks=1.10.4
[0m14:29:33.414241 [debug] [MainThread]: checksum: 3fbc73d786818920aecb1b2190495121ce0b60768fe54c46d521f1e82da30af9, vars: {}, profile: , target: databricks, version: 1.10.3
[0m14:29:33.586204 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:29:33.601794 [debug] [MainThread]: previous checksum: 3fbc73d786818920aecb1b2190495121ce0b60768fe54c46d521f1e82da30af9, current checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331
[0m14:29:33.601794 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:29:33.601794 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:29:33.601794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '555f1654-669e-46c4-80ab-eb5101ba1c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235721301D0>]}
[0m14:29:38.802489 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m14:29:38.820194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '555f1654-669e-46c4-80ab-eb5101ba1c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002357F3CD810>]}
[0m14:29:39.007685 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m14:29:39.007685 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m14:29:39.112197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '555f1654-669e-46c4-80ab-eb5101ba1c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002357F703F10>]}
[0m14:29:39.114193 [info ] [MainThread]: Found 9 models, 34 data tests, 1 source, 798 macros
[0m14:29:39.122340 [info ] [MainThread]: 
[0m14:29:39.124357 [info ] [MainThread]: Concurrency: 1 threads (target='databricks')
[0m14:29:39.126345 [info ] [MainThread]: 
[0m14:29:39.128343 [debug] [MainThread]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=master, idle-time=0s, language=None, compute-name=) - Creating connection
[0m14:29:39.129342 [debug] [MainThread]: Acquiring new databricks connection 'master'
[0m14:29:39.134467 [debug] [ThreadPool]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=list_workspace, idle-time=0s, language=None, compute-name=) - Creating connection
[0m14:29:39.134467 [debug] [ThreadPool]: Acquiring new databricks connection 'list_workspace'
[0m14:29:39.134467 [debug] [ThreadPool]: Using databricks connection "list_workspace"
[0m14:29:39.134467 [debug] [ThreadPool]: On list_workspace: GetSchemas(database=workspace, schema=None)
[0m14:29:39.134467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:40.508878 [debug] [ThreadPool]: Databricks adapter: Connection(session-id=01f0836b-6973-11af-a927-97d079165042) - Created
[0m14:30:42.368987 [debug] [ThreadPool]: SQL status: OK in 63.230 seconds
[0m14:30:42.368987 [debug] [ThreadPool]: Databricks adapter: Cursor(session-id=01f0836b-6973-11af-a927-97d079165042, command-id=01f0836b-8d9b-15d6-943c-3b5be45ca921) - Closing
[0m14:30:42.368987 [debug] [ThreadPool]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=list_workspace_default, idle-time=0s, language=None, compute-name=) - Creating connection
[0m14:30:42.368987 [debug] [ThreadPool]: Acquiring new databricks connection 'list_workspace_default'
[0m14:30:42.398973 [debug] [ThreadPool]: Using databricks connection "list_workspace_default"
[0m14:30:42.398973 [debug] [ThreadPool]: On list_workspace_default: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "connection_name": "list_workspace_default"} */

    
SELECT
  table_name,
  if(table_type IN ('EXTERNAL', 'MANAGED', 'MANAGED_SHALLOW_CLONE', 'EXTERNAL_SHALLOW_CLONE'), 'table', lower(table_type)) AS table_type,
  lower(data_source_format) AS file_format,
  table_owner
FROM `system`.`information_schema`.`tables`
WHERE table_catalog = 'workspace' 
  AND table_schema = 'default'

  
[0m14:30:42.398973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:43.142360 [debug] [ThreadPool]: Databricks adapter: Connection(session-id=01f0836b-8ee3-15cf-9bda-ab7a2f116411) - Created
[0m14:30:46.508580 [debug] [ThreadPool]: SQL status: OK in 4.110 seconds
[0m14:30:46.539705 [debug] [ThreadPool]: Databricks adapter: Cursor(session-id=01f0836b-8ee3-15cf-9bda-ab7a2f116411, command-id=01f0836b-8f03-1962-81dc-a01cb51eecfa) - Closing
[0m14:30:46.539705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '555f1654-669e-46c4-80ab-eb5101ba1c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023574F76990>]}
[0m14:30:46.559896 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce
[0m14:30:46.561897 [info ] [Thread-1 (]: 1 of 43 START sql view model default.src_ecommerce ............................. [RUN]
[0m14:30:46.564794 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=model.dbt_databricks_cicd.src_ecommerce, idle-time=0s, language=None, compute-name=) - Creating connection
[0m14:30:46.565761 [debug] [Thread-1 (]: Acquiring new databricks connection 'model.dbt_databricks_cicd.src_ecommerce'
[0m14:30:46.566751 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.src_ecommerce
[0m14:30:46.583793 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.src_ecommerce"
[0m14:30:46.585831 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.src_ecommerce
[0m14:30:46.618532 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:30:46.622532 [warn ] [Thread-1 (]: [[33mWARNING[0m]: Use revamped materializations based on separating create and insert.  This allows more performant column comments, as well as new column features.
You may opt into the new behavior sooner by setting `flags.use_materialization_v2` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m14:30:46.623564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '555f1654-669e-46c4-80ab-eb5101ba1c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002357F750F90>]}
[0m14:30:46.654867 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`src_ecommerce`
[0m14:30:46.678766 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.src_ecommerce"
[0m14:30:46.682874 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.src_ecommerce"
[0m14:30:46.684873 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.src_ecommerce"} */

  
  
  
  create or replace view `workspace`.`default`.`src_ecommerce`
  
  as (
    SELECT * FROM default.sales_ecommerce
  )

[0m14:30:46.687876 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:30:47.399853 [debug] [Thread-1 (]: Databricks adapter: Connection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8) - Created
[0m14:30:51.586969 [debug] [Thread-1 (]: SQL status: OK in 4.900 seconds
[0m14:30:51.588971 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, command-id=01f0836b-918c-1417-8c68-d3ae1b7c7846) - Closing
[0m14:30:51.601993 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:30:51.601993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '555f1654-669e-46c4-80ab-eb5101ba1c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002357F13E2D0>]}
[0m14:30:51.617618 [info ] [Thread-1 (]: 1 of 43 OK created sql view model default.src_ecommerce ........................ [[32mOK[0m in 5.04s]
[0m14:30:51.617618 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce
[0m14:30:51.617618 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:30:51.617618 [info ] [Thread-1 (]: 2 of 43 START test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [RUN]
[0m14:30:51.617618 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.src_ecommerce, now test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8)
[0m14:30:51.617618 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8, idle-time=0.015624761581420898s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.src_ecommerce
[0m14:30:51.617618 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:30:51.633257 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:30:51.633257 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:30:51.680124 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:30:51.680124 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:30:51.680124 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from `my_db`.`dbo`.`ecommerce`
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    'Credit Card','Net Banking','UPI','Debit Card','Cash on Delivery'
)



  
  
      
    ) dbt_internal_test
[0m14:30:52.383981 [debug] [Thread-1 (]: Databricks adapter: Exception while trying to execute query
/* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from `my_db`.`dbo`.`ecommerce`
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    'Credit Card','Net Banking','UPI','Debit Card','Cash on Delivery'
)



  
  
      
    ) dbt_internal_test
: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 20 pos 9
Error properties: diagnostic-info=org.apache.hive.service.cli.HiveSQLException: Error running query: [TABLE_OR_VIEW_NOT_FOUND] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 20 pos 9
	at org.apache.spark.sql.hive.thriftserver.HiveThriftServerErrors$.runningQueryError(HiveThriftServerErrors.scala:49)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:1036)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.org$apache$spark$sql$hive$thriftserver$SparkExecuteStatementOperation$$execute(SparkExecuteStatementOperation.scala:785)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$5(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.execution.SQLExecution$.withRootExecution(SQLExecution.scala:746)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$2(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.DatabricksTracingHelper.withAttributionContext(DatabricksSparkTracingHelper.scala:18)
	at com.databricks.spark.util.DatabricksTracingHelper.withSpanFromRequest(DatabricksSparkTracingHelper.scala:42)
	at com.databricks.spark.util.DBRTracing$.withSpanFromRequest(DBRTracing.scala:43)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$15(ThriftLocalProperties.scala:236)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:96)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:77)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags0(DatabricksSparkUsageLogger.scala:124)
	at com.databricks.spark.util.DatabricksSparkUsageLogger.withAttributionTags(DatabricksSparkUsageLogger.scala:232)
	at com.databricks.spark.util.UsageLogging.$anonfun$withAttributionTags$1(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:780)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:789)
	at com.databricks.spark.util.UsageLogging.withAttributionTags(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging.withAttributionTags$(UsageLogger.scala:666)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withAttributionTags(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$12(ThriftLocalProperties.scala:233)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties(ThriftLocalProperties.scala:229)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties$(ThriftLocalProperties.scala:89)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withLocalProperties(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:549)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:535)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2.run(SparkExecuteStatementOperation.scala:585)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 20 pos 9
	at org.apache.spark.sql.catalyst.ExtendedAnalysisException.copyPlan(ExtendedAnalysisException.scala:91)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:997)
	... 53 more
, operation-id=01f0836b-941b-1267-98d9-d59665d37aa2
[0m14:30:52.477742 [debug] [Thread-1 (]: Database Error in test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 20 pos 9
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_accepted_values_sqlserv_e814246ceecd68245cb8ed7332e2da84.sql
[0m14:30:52.480011 [error] [Thread-1 (]: 2 of 43 ERROR source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [[31mERROR[0m in 0.86s]
[0m14:30:52.483020 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:30:52.485018 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:30:52.486024 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8' to be skipped because of status 'error'.  Reason: Database Error in test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 20 pos 9
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_accepted_values_sqlserv_e814246ceecd68245cb8ed7332e2da84.sql.
[0m14:30:52.488016 [info ] [Thread-1 (]: 3 of 43 START test source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_  [RUN]
[0m14:30:52.490016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8, now test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef)
[0m14:30:52.492072 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef, idle-time=0.011999368667602539s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:30:52.492072 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:30:52.492072 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:30:52.492072 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:30:52.507711 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:30:52.507711 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:30:52.507711 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    with actual as (
        select 
            column_name, data_type
        from INFORMATION_SCHEMA.COLUMNS
        where table_name = 'ecommerce'
          and table_schema = 'dbo'
    ),
    expected as (
        select * from (
            values
            
                ('Category', 'varchar'),
            
                ('Discount', 'int'),
            
                ('Final_Price', 'float'),
            
                ('Payment_Method', 'varchar'),
            
                ('Price', 'float'),
            
                ('Product_ID', 'varchar'),
            
                ('Purchase_Date', 'date'),
            
                ('User_ID', 'varchar')
            
        ) as t(column_name, data_type)
    )
    select
        e.column_name,
        e.data_type
    from expected e
    left join actual a
        on e.column_name = a.column_name
       and e.data_type = a.data_type
    where a.column_name is null

  
  
      
    ) dbt_internal_test
[0m14:30:54.225379 [debug] [Thread-1 (]: SQL status: OK in 1.720 seconds
[0m14:30:54.225379 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, command-id=01f0836b-9497-1784-8511-46437657e9c5) - Closing
[0m14:30:54.225379 [error] [Thread-1 (]: 3 of 43 FAIL 8 source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_  [[31mFAIL 8[0m in 1.74s]
[0m14:30:54.240891 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:30:54.240891 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:30:54.240891 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef' to be skipped because of status 'fail'.  Reason: Got 8 results, configured to fail if != 0.
[0m14:30:54.240891 [info ] [Thread-1 (]: 4 of 43 START test source_not_null_sqlserver_ecommerce_Category ................ [RUN]
[0m14:30:54.240891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407)
[0m14:30:54.240891 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, idle-time=0.015512466430664062s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:30:54.240891 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:30:54.256549 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:30:54.256549 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:30:54.272133 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:30:54.272133 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:30:54.272133 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Category
from `my_db`.`dbo`.`ecommerce`
where Category is null



  
  
      
    ) dbt_internal_test
[0m14:30:54.898644 [debug] [Thread-1 (]: Databricks adapter: Exception while trying to execute query
/* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Category
from `my_db`.`dbo`.`ecommerce`
where Category is null



  
  
      
    ) dbt_internal_test
: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
Error properties: diagnostic-info=org.apache.hive.service.cli.HiveSQLException: Error running query: [TABLE_OR_VIEW_NOT_FOUND] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.hive.thriftserver.HiveThriftServerErrors$.runningQueryError(HiveThriftServerErrors.scala:49)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:1036)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.org$apache$spark$sql$hive$thriftserver$SparkExecuteStatementOperation$$execute(SparkExecuteStatementOperation.scala:785)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$5(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.execution.SQLExecution$.withRootExecution(SQLExecution.scala:746)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$2(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.DatabricksTracingHelper.withAttributionContext(DatabricksSparkTracingHelper.scala:18)
	at com.databricks.spark.util.DatabricksTracingHelper.withSpanFromRequest(DatabricksSparkTracingHelper.scala:42)
	at com.databricks.spark.util.DBRTracing$.withSpanFromRequest(DBRTracing.scala:43)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$15(ThriftLocalProperties.scala:236)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:96)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:77)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags0(DatabricksSparkUsageLogger.scala:124)
	at com.databricks.spark.util.DatabricksSparkUsageLogger.withAttributionTags(DatabricksSparkUsageLogger.scala:232)
	at com.databricks.spark.util.UsageLogging.$anonfun$withAttributionTags$1(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:780)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:789)
	at com.databricks.spark.util.UsageLogging.withAttributionTags(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging.withAttributionTags$(UsageLogger.scala:666)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withAttributionTags(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$12(ThriftLocalProperties.scala:233)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties(ThriftLocalProperties.scala:229)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties$(ThriftLocalProperties.scala:89)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withLocalProperties(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:549)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:535)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2.run(SparkExecuteStatementOperation.scala:585)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.catalyst.ExtendedAnalysisException.copyPlan(ExtendedAnalysisException.scala:91)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:997)
	... 53 more
, operation-id=01f0836b-95a5-161a-8fd1-e017d974c5a5
[0m14:30:54.898644 [debug] [Thread-1 (]: Database Error in test source_not_null_sqlserver_ecommerce_Category (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Category.sql
[0m14:30:54.898644 [error] [Thread-1 (]: 4 of 43 ERROR source_not_null_sqlserver_ecommerce_Category ..................... [[31mERROR[0m in 0.66s]
[0m14:30:54.898644 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:30:54.898644 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:30:54.898644 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_sqlserver_ecommerce_Category (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Category.sql.
[0m14:30:54.914277 [info ] [Thread-1 (]: 5 of 43 START test source_not_null_sqlserver_ecommerce_Discount ................ [RUN]
[0m14:30:54.914277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f)
[0m14:30:54.914277 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, idle-time=0.015633106231689453s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:30:54.914277 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:30:54.929892 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:30:54.929892 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:30:54.945526 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:30:54.945526 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:30:54.945526 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Discount
from `my_db`.`dbo`.`ecommerce`
where Discount is null



  
  
      
    ) dbt_internal_test
[0m14:30:55.446889 [debug] [Thread-1 (]: Databricks adapter: Exception while trying to execute query
/* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Discount
from `my_db`.`dbo`.`ecommerce`
where Discount is null



  
  
      
    ) dbt_internal_test
: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
Error properties: diagnostic-info=org.apache.hive.service.cli.HiveSQLException: Error running query: [TABLE_OR_VIEW_NOT_FOUND] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.hive.thriftserver.HiveThriftServerErrors$.runningQueryError(HiveThriftServerErrors.scala:49)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:1036)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.org$apache$spark$sql$hive$thriftserver$SparkExecuteStatementOperation$$execute(SparkExecuteStatementOperation.scala:785)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$5(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.execution.SQLExecution$.withRootExecution(SQLExecution.scala:746)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$2(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.DatabricksTracingHelper.withAttributionContext(DatabricksSparkTracingHelper.scala:18)
	at com.databricks.spark.util.DatabricksTracingHelper.withSpanFromRequest(DatabricksSparkTracingHelper.scala:42)
	at com.databricks.spark.util.DBRTracing$.withSpanFromRequest(DBRTracing.scala:43)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$15(ThriftLocalProperties.scala:236)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:96)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:77)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags0(DatabricksSparkUsageLogger.scala:124)
	at com.databricks.spark.util.DatabricksSparkUsageLogger.withAttributionTags(DatabricksSparkUsageLogger.scala:232)
	at com.databricks.spark.util.UsageLogging.$anonfun$withAttributionTags$1(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:780)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:789)
	at com.databricks.spark.util.UsageLogging.withAttributionTags(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging.withAttributionTags$(UsageLogger.scala:666)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withAttributionTags(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$12(ThriftLocalProperties.scala:233)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties(ThriftLocalProperties.scala:229)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties$(ThriftLocalProperties.scala:89)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withLocalProperties(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:549)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:535)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2.run(SparkExecuteStatementOperation.scala:585)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.catalyst.ExtendedAnalysisException.copyPlan(ExtendedAnalysisException.scala:91)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:997)
	... 53 more
, operation-id=01f0836b-960c-1589-8cc3-2f4de0f1a255
[0m14:30:55.462571 [debug] [Thread-1 (]: Database Error in test source_not_null_sqlserver_ecommerce_Discount (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Discount.sql
[0m14:30:55.462571 [error] [Thread-1 (]: 5 of 43 ERROR source_not_null_sqlserver_ecommerce_Discount ..................... [[31mERROR[0m in 0.55s]
[0m14:30:55.462571 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:30:55.462571 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:30:55.462571 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_sqlserver_ecommerce_Discount (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Discount.sql.
[0m14:30:55.462571 [info ] [Thread-1 (]: 6 of 43 START test source_not_null_sqlserver_ecommerce_Final_Price ............. [RUN]
[0m14:30:55.462571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d)
[0m14:30:55.462571 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:30:55.462571 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:30:55.478189 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:30:55.478189 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:30:55.493813 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:30:55.493813 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:30:55.493813 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Final_Price
from `my_db`.`dbo`.`ecommerce`
where Final_Price is null



  
  
      
    ) dbt_internal_test
[0m14:30:56.021751 [debug] [Thread-1 (]: Databricks adapter: Exception while trying to execute query
/* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Final_Price
from `my_db`.`dbo`.`ecommerce`
where Final_Price is null



  
  
      
    ) dbt_internal_test
: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
Error properties: diagnostic-info=org.apache.hive.service.cli.HiveSQLException: Error running query: [TABLE_OR_VIEW_NOT_FOUND] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.hive.thriftserver.HiveThriftServerErrors$.runningQueryError(HiveThriftServerErrors.scala:49)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:1036)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.org$apache$spark$sql$hive$thriftserver$SparkExecuteStatementOperation$$execute(SparkExecuteStatementOperation.scala:785)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$5(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.execution.SQLExecution$.withRootExecution(SQLExecution.scala:746)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$2(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.DatabricksTracingHelper.withAttributionContext(DatabricksSparkTracingHelper.scala:18)
	at com.databricks.spark.util.DatabricksTracingHelper.withSpanFromRequest(DatabricksSparkTracingHelper.scala:42)
	at com.databricks.spark.util.DBRTracing$.withSpanFromRequest(DBRTracing.scala:43)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$15(ThriftLocalProperties.scala:236)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:96)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:77)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags0(DatabricksSparkUsageLogger.scala:124)
	at com.databricks.spark.util.DatabricksSparkUsageLogger.withAttributionTags(DatabricksSparkUsageLogger.scala:232)
	at com.databricks.spark.util.UsageLogging.$anonfun$withAttributionTags$1(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:780)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:789)
	at com.databricks.spark.util.UsageLogging.withAttributionTags(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging.withAttributionTags$(UsageLogger.scala:666)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withAttributionTags(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$12(ThriftLocalProperties.scala:233)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties(ThriftLocalProperties.scala:229)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties$(ThriftLocalProperties.scala:89)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withLocalProperties(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:549)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:535)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2.run(SparkExecuteStatementOperation.scala:585)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.catalyst.ExtendedAnalysisException.copyPlan(ExtendedAnalysisException.scala:91)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:997)
	... 53 more
, operation-id=01f0836b-965f-1909-b434-5b8796a4b223
[0m14:30:56.028938 [debug] [Thread-1 (]: Database Error in test source_not_null_sqlserver_ecommerce_Final_Price (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Final_Price.sql
[0m14:30:56.030940 [error] [Thread-1 (]: 6 of 43 ERROR source_not_null_sqlserver_ecommerce_Final_Price .................. [[31mERROR[0m in 0.57s]
[0m14:30:56.033911 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:30:56.034871 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:30:56.035869 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_sqlserver_ecommerce_Final_Price (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Final_Price.sql.
[0m14:30:56.036795 [info ] [Thread-1 (]: 7 of 43 START test source_not_null_sqlserver_ecommerce_Payment_Method .......... [RUN]
[0m14:30:56.039814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae)
[0m14:30:56.041815 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, idle-time=0.009879350662231445s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:30:56.042812 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:30:56.051812 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:30:56.054811 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:30:56.064162 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:30:56.064162 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:30:56.064162 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Payment_Method
from `my_db`.`dbo`.`ecommerce`
where Payment_Method is null



  
  
      
    ) dbt_internal_test
[0m14:30:56.556264 [debug] [Thread-1 (]: Databricks adapter: Exception while trying to execute query
/* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Payment_Method
from `my_db`.`dbo`.`ecommerce`
where Payment_Method is null



  
  
      
    ) dbt_internal_test
: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
Error properties: diagnostic-info=org.apache.hive.service.cli.HiveSQLException: Error running query: [TABLE_OR_VIEW_NOT_FOUND] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.hive.thriftserver.HiveThriftServerErrors$.runningQueryError(HiveThriftServerErrors.scala:49)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:1036)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.org$apache$spark$sql$hive$thriftserver$SparkExecuteStatementOperation$$execute(SparkExecuteStatementOperation.scala:785)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$5(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.execution.SQLExecution$.withRootExecution(SQLExecution.scala:746)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$2(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.DatabricksTracingHelper.withAttributionContext(DatabricksSparkTracingHelper.scala:18)
	at com.databricks.spark.util.DatabricksTracingHelper.withSpanFromRequest(DatabricksSparkTracingHelper.scala:42)
	at com.databricks.spark.util.DBRTracing$.withSpanFromRequest(DBRTracing.scala:43)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$15(ThriftLocalProperties.scala:236)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:96)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:77)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags0(DatabricksSparkUsageLogger.scala:124)
	at com.databricks.spark.util.DatabricksSparkUsageLogger.withAttributionTags(DatabricksSparkUsageLogger.scala:232)
	at com.databricks.spark.util.UsageLogging.$anonfun$withAttributionTags$1(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:780)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:789)
	at com.databricks.spark.util.UsageLogging.withAttributionTags(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging.withAttributionTags$(UsageLogger.scala:666)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withAttributionTags(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$12(ThriftLocalProperties.scala:233)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties(ThriftLocalProperties.scala:229)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties$(ThriftLocalProperties.scala:89)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withLocalProperties(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:549)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:535)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2.run(SparkExecuteStatementOperation.scala:585)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.catalyst.ExtendedAnalysisException.copyPlan(ExtendedAnalysisException.scala:91)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:997)
	... 53 more
, operation-id=01f0836b-96b6-116b-9cb0-dba8c1f5f4ee
[0m14:30:56.565461 [debug] [Thread-1 (]: Database Error in test source_not_null_sqlserver_ecommerce_Payment_Method (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Payment_Method.sql
[0m14:30:56.566425 [error] [Thread-1 (]: 7 of 43 ERROR source_not_null_sqlserver_ecommerce_Payment_Method ............... [[31mERROR[0m in 0.53s]
[0m14:30:56.569465 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:30:56.570426 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:30:56.571431 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_sqlserver_ecommerce_Payment_Method (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Payment_Method.sql.
[0m14:30:56.572372 [info ] [Thread-1 (]: 8 of 43 START test source_not_null_sqlserver_ecommerce_Price ................... [RUN]
[0m14:30:56.574387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01)
[0m14:30:56.576388 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, idle-time=0.00896453857421875s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:30:56.577388 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:30:56.590066 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:30:56.593067 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:30:56.597588 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:30:56.597588 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:30:56.597588 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Price
from `my_db`.`dbo`.`ecommerce`
where Price is null



  
  
      
    ) dbt_internal_test
[0m14:30:57.092460 [debug] [Thread-1 (]: Databricks adapter: Exception while trying to execute query
/* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Price
from `my_db`.`dbo`.`ecommerce`
where Price is null



  
  
      
    ) dbt_internal_test
: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
Error properties: diagnostic-info=org.apache.hive.service.cli.HiveSQLException: Error running query: [TABLE_OR_VIEW_NOT_FOUND] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.hive.thriftserver.HiveThriftServerErrors$.runningQueryError(HiveThriftServerErrors.scala:49)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:1036)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.org$apache$spark$sql$hive$thriftserver$SparkExecuteStatementOperation$$execute(SparkExecuteStatementOperation.scala:785)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$5(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.execution.SQLExecution$.withRootExecution(SQLExecution.scala:746)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$2(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.DatabricksTracingHelper.withAttributionContext(DatabricksSparkTracingHelper.scala:18)
	at com.databricks.spark.util.DatabricksTracingHelper.withSpanFromRequest(DatabricksSparkTracingHelper.scala:42)
	at com.databricks.spark.util.DBRTracing$.withSpanFromRequest(DBRTracing.scala:43)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$15(ThriftLocalProperties.scala:236)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:96)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:77)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags0(DatabricksSparkUsageLogger.scala:124)
	at com.databricks.spark.util.DatabricksSparkUsageLogger.withAttributionTags(DatabricksSparkUsageLogger.scala:232)
	at com.databricks.spark.util.UsageLogging.$anonfun$withAttributionTags$1(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:780)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:789)
	at com.databricks.spark.util.UsageLogging.withAttributionTags(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging.withAttributionTags$(UsageLogger.scala:666)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withAttributionTags(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$12(ThriftLocalProperties.scala:233)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties(ThriftLocalProperties.scala:229)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties$(ThriftLocalProperties.scala:89)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withLocalProperties(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:549)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:535)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2.run(SparkExecuteStatementOperation.scala:585)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.catalyst.ExtendedAnalysisException.copyPlan(ExtendedAnalysisException.scala:91)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:997)
	... 53 more
, operation-id=01f0836b-9708-1899-bdb9-53d1e55177bb
[0m14:30:57.095698 [debug] [Thread-1 (]: Database Error in test source_not_null_sqlserver_ecommerce_Price (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Price.sql
[0m14:30:57.095698 [error] [Thread-1 (]: 8 of 43 ERROR source_not_null_sqlserver_ecommerce_Price ........................ [[31mERROR[0m in 0.52s]
[0m14:30:57.095698 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:30:57.095698 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:30:57.095698 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_sqlserver_ecommerce_Price (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Price.sql.
[0m14:30:57.111362 [info ] [Thread-1 (]: 9 of 43 START test source_not_null_sqlserver_ecommerce_Product_ID .............. [RUN]
[0m14:30:57.111362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff)
[0m14:30:57.111362 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, idle-time=0.015664100646972656s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:30:57.111362 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:30:57.111362 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:30:57.126956 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:30:57.126956 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:30:57.126956 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:30:57.126956 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Product_ID
from `my_db`.`dbo`.`ecommerce`
where Product_ID is null



  
  
      
    ) dbt_internal_test
[0m14:30:57.461575 [debug] [Thread-1 (]: Databricks adapter: Exception while trying to execute query
/* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Product_ID
from `my_db`.`dbo`.`ecommerce`
where Product_ID is null



  
  
      
    ) dbt_internal_test
: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
Error properties: diagnostic-info=org.apache.hive.service.cli.HiveSQLException: Error running query: [TABLE_OR_VIEW_NOT_FOUND] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.hive.thriftserver.HiveThriftServerErrors$.runningQueryError(HiveThriftServerErrors.scala:49)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:1036)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.org$apache$spark$sql$hive$thriftserver$SparkExecuteStatementOperation$$execute(SparkExecuteStatementOperation.scala:785)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$5(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.execution.SQLExecution$.withRootExecution(SQLExecution.scala:746)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$2(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.DatabricksTracingHelper.withAttributionContext(DatabricksSparkTracingHelper.scala:18)
	at com.databricks.spark.util.DatabricksTracingHelper.withSpanFromRequest(DatabricksSparkTracingHelper.scala:42)
	at com.databricks.spark.util.DBRTracing$.withSpanFromRequest(DBRTracing.scala:43)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$15(ThriftLocalProperties.scala:236)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:96)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:77)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags0(DatabricksSparkUsageLogger.scala:124)
	at com.databricks.spark.util.DatabricksSparkUsageLogger.withAttributionTags(DatabricksSparkUsageLogger.scala:232)
	at com.databricks.spark.util.UsageLogging.$anonfun$withAttributionTags$1(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:780)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:789)
	at com.databricks.spark.util.UsageLogging.withAttributionTags(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging.withAttributionTags$(UsageLogger.scala:666)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withAttributionTags(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$12(ThriftLocalProperties.scala:233)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties(ThriftLocalProperties.scala:229)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties$(ThriftLocalProperties.scala:89)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withLocalProperties(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:549)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:535)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2.run(SparkExecuteStatementOperation.scala:585)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.catalyst.ExtendedAnalysisException.copyPlan(ExtendedAnalysisException.scala:91)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:997)
	... 53 more
, operation-id=01f0836b-975a-1390-92c8-1d5b2a521ae9
[0m14:30:57.461575 [debug] [Thread-1 (]: Database Error in test source_not_null_sqlserver_ecommerce_Product_ID (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Product_ID.sql
[0m14:30:57.477084 [error] [Thread-1 (]: 9 of 43 ERROR source_not_null_sqlserver_ecommerce_Product_ID ................... [[31mERROR[0m in 0.35s]
[0m14:30:57.477084 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:30:57.477084 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:30:57.477084 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_sqlserver_ecommerce_Product_ID (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Product_ID.sql.
[0m14:30:57.477084 [info ] [Thread-1 (]: 10 of 43 START test source_not_null_sqlserver_ecommerce_Purchase_Date .......... [RUN]
[0m14:30:57.477084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17)
[0m14:30:57.477084 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, idle-time=0.01550912857055664s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:30:57.477084 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:30:57.492710 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:30:57.492710 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:30:57.492710 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:30:57.510545 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:30:57.512581 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Purchase_Date
from `my_db`.`dbo`.`ecommerce`
where Purchase_Date is null



  
  
      
    ) dbt_internal_test
[0m14:30:57.898881 [debug] [Thread-1 (]: Databricks adapter: Exception while trying to execute query
/* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Purchase_Date
from `my_db`.`dbo`.`ecommerce`
where Purchase_Date is null



  
  
      
    ) dbt_internal_test
: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
Error properties: diagnostic-info=org.apache.hive.service.cli.HiveSQLException: Error running query: [TABLE_OR_VIEW_NOT_FOUND] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.hive.thriftserver.HiveThriftServerErrors$.runningQueryError(HiveThriftServerErrors.scala:49)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:1036)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.org$apache$spark$sql$hive$thriftserver$SparkExecuteStatementOperation$$execute(SparkExecuteStatementOperation.scala:785)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$5(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.execution.SQLExecution$.withRootExecution(SQLExecution.scala:746)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$2(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.DatabricksTracingHelper.withAttributionContext(DatabricksSparkTracingHelper.scala:18)
	at com.databricks.spark.util.DatabricksTracingHelper.withSpanFromRequest(DatabricksSparkTracingHelper.scala:42)
	at com.databricks.spark.util.DBRTracing$.withSpanFromRequest(DBRTracing.scala:43)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$15(ThriftLocalProperties.scala:236)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:96)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:77)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags0(DatabricksSparkUsageLogger.scala:124)
	at com.databricks.spark.util.DatabricksSparkUsageLogger.withAttributionTags(DatabricksSparkUsageLogger.scala:232)
	at com.databricks.spark.util.UsageLogging.$anonfun$withAttributionTags$1(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:780)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:789)
	at com.databricks.spark.util.UsageLogging.withAttributionTags(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging.withAttributionTags$(UsageLogger.scala:666)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withAttributionTags(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$12(ThriftLocalProperties.scala:233)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties(ThriftLocalProperties.scala:229)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties$(ThriftLocalProperties.scala:89)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withLocalProperties(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:549)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:535)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2.run(SparkExecuteStatementOperation.scala:585)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.catalyst.ExtendedAnalysisException.copyPlan(ExtendedAnalysisException.scala:91)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:997)
	... 53 more
, operation-id=01f0836b-9791-1a71-8eab-a09dbd7d1523
[0m14:30:57.914406 [debug] [Thread-1 (]: Database Error in test source_not_null_sqlserver_ecommerce_Purchase_Date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Purchase_Date.sql
[0m14:30:57.914406 [error] [Thread-1 (]: 10 of 43 ERROR source_not_null_sqlserver_ecommerce_Purchase_Date ............... [[31mERROR[0m in 0.44s]
[0m14:30:57.914406 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:30:57.914406 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:30:57.914406 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_sqlserver_ecommerce_Purchase_Date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Purchase_Date.sql.
[0m14:30:57.914406 [info ] [Thread-1 (]: 11 of 43 START test source_not_null_sqlserver_ecommerce_User_ID ................ [RUN]
[0m14:30:57.914406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc)
[0m14:30:57.914406 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:30:57.914406 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:30:57.939332 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:30:57.941338 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:30:57.950298 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:30:57.953294 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:30:57.954297 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select User_ID
from `my_db`.`dbo`.`ecommerce`
where User_ID is null



  
  
      
    ) dbt_internal_test
[0m14:30:58.321922 [debug] [Thread-1 (]: Databricks adapter: Exception while trying to execute query
/* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select User_ID
from `my_db`.`dbo`.`ecommerce`
where User_ID is null



  
  
      
    ) dbt_internal_test
: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
Error properties: diagnostic-info=org.apache.hive.service.cli.HiveSQLException: Error running query: [TABLE_OR_VIEW_NOT_FOUND] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.hive.thriftserver.HiveThriftServerErrors$.runningQueryError(HiveThriftServerErrors.scala:49)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:1036)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.org$apache$spark$sql$hive$thriftserver$SparkExecuteStatementOperation$$execute(SparkExecuteStatementOperation.scala:785)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$5(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.execution.SQLExecution$.withRootExecution(SQLExecution.scala:746)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$2(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.DatabricksTracingHelper.withAttributionContext(DatabricksSparkTracingHelper.scala:18)
	at com.databricks.spark.util.DatabricksTracingHelper.withSpanFromRequest(DatabricksSparkTracingHelper.scala:42)
	at com.databricks.spark.util.DBRTracing$.withSpanFromRequest(DBRTracing.scala:43)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$15(ThriftLocalProperties.scala:236)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:96)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:77)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags0(DatabricksSparkUsageLogger.scala:124)
	at com.databricks.spark.util.DatabricksSparkUsageLogger.withAttributionTags(DatabricksSparkUsageLogger.scala:232)
	at com.databricks.spark.util.UsageLogging.$anonfun$withAttributionTags$1(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:780)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:789)
	at com.databricks.spark.util.UsageLogging.withAttributionTags(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging.withAttributionTags$(UsageLogger.scala:666)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withAttributionTags(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$12(ThriftLocalProperties.scala:233)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties(ThriftLocalProperties.scala:229)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties$(ThriftLocalProperties.scala:89)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withLocalProperties(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:549)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:535)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2.run(SparkExecuteStatementOperation.scala:585)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.catalyst.ExtendedAnalysisException.copyPlan(ExtendedAnalysisException.scala:91)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:997)
	... 53 more
, operation-id=01f0836b-97d5-1c9e-b31e-f5871fb1ba23
[0m14:30:58.337427 [debug] [Thread-1 (]: Database Error in test source_not_null_sqlserver_ecommerce_User_ID (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_User_ID.sql
[0m14:30:58.337427 [error] [Thread-1 (]: 11 of 43 ERROR source_not_null_sqlserver_ecommerce_User_ID ..................... [[31mERROR[0m in 0.42s]
[0m14:30:58.337427 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:30:58.337427 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.stg_ecommerce
[0m14:30:58.337427 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_sqlserver_ecommerce_User_ID (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_User_ID.sql.
[0m14:30:58.337427 [info ] [Thread-1 (]: 12 of 43 START sql view model default.stg_ecommerce ............................ [RUN]
[0m14:30:58.337427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc, now model.dbt_databricks_cicd.stg_ecommerce)
[0m14:30:58.353052 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=model.dbt_databricks_cicd.stg_ecommerce, idle-time=0.0156252384185791s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:30:58.353052 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.stg_ecommerce
[0m14:30:58.353052 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.stg_ecommerce"
[0m14:30:58.353052 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.stg_ecommerce
[0m14:30:58.370956 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:30:58.373918 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`stg_ecommerce`
[0m14:30:58.375956 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.stg_ecommerce"
[0m14:30:58.377916 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.stg_ecommerce"
[0m14:30:58.379936 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.stg_ecommerce"} */

  
  
  
  create or replace view `workspace`.`default`.`stg_ecommerce`
  
  as (
    SELECT
  User_ID,
  Product_ID,
  Category,
  Price,
  Discount,
  Final_Price,
  Payment_Method,
  Purchase_Date
FROM `workspace`.`default`.`src_ecommerce`
  )

[0m14:30:59.158375 [debug] [Thread-1 (]: SQL status: OK in 0.780 seconds
[0m14:30:59.173860 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, command-id=01f0836b-9816-1549-8e22-b4f5ccf18565) - Closing
[0m14:30:59.173860 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:30:59.173860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '555f1654-669e-46c4-80ab-eb5101ba1c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023500079090>]}
[0m14:30:59.173860 [info ] [Thread-1 (]: 12 of 43 OK created sql view model default.stg_ecommerce ....................... [[32mOK[0m in 0.84s]
[0m14:30:59.173860 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.stg_ecommerce
[0m14:30:59.173860 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.avg_discount_by_category
[0m14:30:59.173860 [info ] [Thread-1 (]: 13 of 43 START sql view model default.avg_discount_by_category ................. [RUN]
[0m14:30:59.189522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.stg_ecommerce, now model.dbt_databricks_cicd.avg_discount_by_category)
[0m14:30:59.189522 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=model.dbt_databricks_cicd.avg_discount_by_category, idle-time=0.01566171646118164s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.stg_ecommerce
[0m14:30:59.189522 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.avg_discount_by_category
[0m14:30:59.189522 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.avg_discount_by_category"
[0m14:30:59.205109 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.avg_discount_by_category
[0m14:30:59.205109 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:30:59.205109 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`avg_discount_by_category`
[0m14:30:59.205109 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.avg_discount_by_category"
[0m14:30:59.205109 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.avg_discount_by_category"
[0m14:30:59.220735 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.avg_discount_by_category: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.avg_discount_by_category"} */

  
  
  
  create or replace view `workspace`.`default`.`avg_discount_by_category`
  
  as (
    SELECT
  Category,
  ROUND(AVG(CAST(`Discount` AS DOUBLE)), 2) AS avg_discount_percent
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY Category
ORDER BY avg_discount_percent DESC
  )

[0m14:31:00.305205 [debug] [Thread-1 (]: SQL status: OK in 1.080 seconds
[0m14:31:00.305205 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, command-id=01f0836b-9897-1466-a2ff-485e9f62aa82) - Closing
[0m14:31:00.305205 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:31:00.305205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '555f1654-669e-46c4-80ab-eb5101ba1c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023500506610>]}
[0m14:31:00.320837 [info ] [Thread-1 (]: 13 of 43 OK created sql view model default.avg_discount_by_category ............ [[32mOK[0m in 1.13s]
[0m14:31:00.320837 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.avg_discount_by_category
[0m14:31:00.320837 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.avg_ticket_by_category
[0m14:31:00.320837 [info ] [Thread-1 (]: 14 of 43 START sql view model default.avg_ticket_by_category ................... [RUN]
[0m14:31:00.320837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.avg_discount_by_category, now model.dbt_databricks_cicd.avg_ticket_by_category)
[0m14:31:00.320837 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=model.dbt_databricks_cicd.avg_ticket_by_category, idle-time=0.015631675720214844s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.avg_discount_by_category
[0m14:31:00.320837 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.avg_ticket_by_category
[0m14:31:00.336463 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.avg_ticket_by_category"
[0m14:31:00.336463 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.avg_ticket_by_category
[0m14:31:00.336463 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:31:00.336463 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`avg_ticket_by_category`
[0m14:31:00.352087 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.avg_ticket_by_category"
[0m14:31:00.352087 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.avg_ticket_by_category"
[0m14:31:00.352087 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.avg_ticket_by_category: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.avg_ticket_by_category"} */

  
  
  
  create or replace view `workspace`.`default`.`avg_ticket_by_category`
  
  as (
    SELECT
  Category,
  ROUND(AVG(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS avg_ticket
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY Category
ORDER BY avg_ticket DESC
  )

[0m14:31:01.124883 [debug] [Thread-1 (]: SQL status: OK in 0.770 seconds
[0m14:31:01.124883 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, command-id=01f0836b-9944-108c-b5a6-5ce8fc0fb824) - Closing
[0m14:31:01.124883 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:31:01.124883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '555f1654-669e-46c4-80ab-eb5101ba1c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002350052C350>]}
[0m14:31:01.124883 [info ] [Thread-1 (]: 14 of 43 OK created sql view model default.avg_ticket_by_category .............. [[32mOK[0m in 0.80s]
[0m14:31:01.124883 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.avg_ticket_by_category
[0m14:31:01.124883 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.monthly_revenue
[0m14:31:01.124883 [info ] [Thread-1 (]: 15 of 43 START sql view model default.monthly_revenue .......................... [RUN]
[0m14:31:01.140512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.avg_ticket_by_category, now model.dbt_databricks_cicd.monthly_revenue)
[0m14:31:01.140512 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=model.dbt_databricks_cicd.monthly_revenue, idle-time=0.01562952995300293s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.avg_ticket_by_category
[0m14:31:01.140512 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.monthly_revenue
[0m14:31:01.156174 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.monthly_revenue"
[0m14:31:01.156174 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.monthly_revenue
[0m14:31:01.156174 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:31:01.171761 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`monthly_revenue`
[0m14:31:01.171761 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.monthly_revenue"
[0m14:31:01.171761 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.monthly_revenue"
[0m14:31:01.171761 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.monthly_revenue: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.monthly_revenue"} */

  
  
  
  create or replace view `workspace`.`default`.`monthly_revenue`
  
  as (
    SELECT
  CAST(DATE_TRUNC('month', CAST(Purchase_Date AS DATE)) AS DATE) AS month,
  ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS monthly_revenue
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY 1
ORDER BY 1
  )

[0m14:31:01.977130 [debug] [Thread-1 (]: SQL status: OK in 0.810 seconds
[0m14:31:01.977130 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, command-id=01f0836b-99c1-18ef-ad83-94e62d931f54) - Closing
[0m14:31:01.977130 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:31:01.977130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '555f1654-669e-46c4-80ab-eb5101ba1c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002350051D990>]}
[0m14:31:01.977130 [info ] [Thread-1 (]: 15 of 43 OK created sql view model default.monthly_revenue ..................... [[32mOK[0m in 0.84s]
[0m14:31:01.992739 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.monthly_revenue
[0m14:31:01.992739 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.payment_distribution
[0m14:31:01.992739 [info ] [Thread-1 (]: 16 of 43 START sql view model default.payment_distribution ..................... [RUN]
[0m14:31:01.992739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.monthly_revenue, now model.dbt_databricks_cicd.payment_distribution)
[0m14:31:01.992739 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=model.dbt_databricks_cicd.payment_distribution, idle-time=0.015608787536621094s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.monthly_revenue
[0m14:31:01.992739 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.payment_distribution
[0m14:31:02.008322 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.payment_distribution"
[0m14:31:02.008322 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.payment_distribution
[0m14:31:02.008322 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:31:02.008322 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`payment_distribution`
[0m14:31:02.023957 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.payment_distribution"
[0m14:31:02.023957 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.payment_distribution"
[0m14:31:02.023957 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.payment_distribution: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.payment_distribution"} */

  
  
  
  create or replace view `workspace`.`default`.`payment_distribution`
  
  as (
    SELECT
  Payment_Method,
  COUNT(*) AS total_transactions,
  ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS total_value
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY Payment_Method
ORDER BY total_value DESC
  )

[0m14:31:02.639961 [debug] [Thread-1 (]: SQL status: OK in 0.620 seconds
[0m14:31:02.655455 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, command-id=01f0836b-9a44-1ae7-89c0-850b41744159) - Closing
[0m14:31:02.655455 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:31:02.655455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '555f1654-669e-46c4-80ab-eb5101ba1c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235005CFB50>]}
[0m14:31:02.655455 [info ] [Thread-1 (]: 16 of 43 OK created sql view model default.payment_distribution ................ [[32mOK[0m in 0.66s]
[0m14:31:02.655455 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.payment_distribution
[0m14:31:02.655455 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.sales_by_category
[0m14:31:02.671087 [info ] [Thread-1 (]: 17 of 43 START sql view model default.sales_by_category ........................ [RUN]
[0m14:31:02.671087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.payment_distribution, now model.dbt_databricks_cicd.sales_by_category)
[0m14:31:02.671087 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=model.dbt_databricks_cicd.sales_by_category, idle-time=0.01563096046447754s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.payment_distribution
[0m14:31:02.671087 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.sales_by_category
[0m14:31:02.671087 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.sales_by_category"
[0m14:31:02.671087 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.sales_by_category
[0m14:31:02.686703 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:31:02.702322 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`sales_by_category`
[0m14:31:02.702322 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.sales_by_category"
[0m14:31:02.702322 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.sales_by_category"
[0m14:31:02.702322 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.sales_by_category: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.sales_by_category"} */

  
  
  
  create or replace view `workspace`.`default`.`sales_by_category`
  
  as (
    SELECT
  Category,
  COUNT(*) AS total_orders,
  ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS total_revenue
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY Category
ORDER BY total_revenue DESC
  )

[0m14:31:03.382968 [debug] [Thread-1 (]: SQL status: OK in 0.680 seconds
[0m14:31:03.398460 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, command-id=01f0836b-9aab-1e63-b188-2b1040032507) - Closing
[0m14:31:03.398460 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:31:03.398460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '555f1654-669e-46c4-80ab-eb5101ba1c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235005CE490>]}
[0m14:31:03.398460 [info ] [Thread-1 (]: 17 of 43 OK created sql view model default.sales_by_category ................... [[32mOK[0m in 0.73s]
[0m14:31:03.398460 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.sales_by_category
[0m14:31:03.398460 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.top_5_products
[0m14:31:03.414085 [info ] [Thread-1 (]: 18 of 43 START sql view model default.top_5_products ........................... [RUN]
[0m14:31:03.414085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.sales_by_category, now model.dbt_databricks_cicd.top_5_products)
[0m14:31:03.414085 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=model.dbt_databricks_cicd.top_5_products, idle-time=0.015625s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.sales_by_category
[0m14:31:03.414085 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.top_5_products
[0m14:31:03.414085 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.top_5_products"
[0m14:31:03.414085 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.top_5_products
[0m14:31:03.429709 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:31:03.429709 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`top_5_products`
[0m14:31:03.429709 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.top_5_products"
[0m14:31:03.429709 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.top_5_products"
[0m14:31:03.445336 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.top_5_products: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.top_5_products"} */

  
  
  
  create or replace view `workspace`.`default`.`top_5_products`
  
  as (
    WITH base AS (
    SELECT
        product_id,
        ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS total_sales
    FROM `workspace`.`default`.`stg_ecommerce`
    GROUP BY product_id
)

SELECT
    product_id,
    total_sales
FROM base
ORDER BY total_sales DESC
LIMIT 5
  )

[0m14:31:04.132717 [debug] [Thread-1 (]: SQL status: OK in 0.690 seconds
[0m14:31:04.132717 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, command-id=01f0836b-9b1b-1663-aa2c-588c47171651) - Closing
[0m14:31:04.132717 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:31:04.132717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '555f1654-669e-46c4-80ab-eb5101ba1c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235005CE490>]}
[0m14:31:04.132717 [info ] [Thread-1 (]: 18 of 43 OK created sql view model default.top_5_products ...................... [[32mOK[0m in 0.72s]
[0m14:31:04.132717 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.top_5_products
[0m14:31:04.132717 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.top_customers
[0m14:31:04.148302 [info ] [Thread-1 (]: 19 of 43 START sql view model default.top_customers ............................ [RUN]
[0m14:31:04.148302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.top_5_products, now model.dbt_databricks_cicd.top_customers)
[0m14:31:04.148302 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=model.dbt_databricks_cicd.top_customers, idle-time=0.015584945678710938s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.top_5_products
[0m14:31:04.148302 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.top_customers
[0m14:31:04.148302 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.top_customers"
[0m14:31:04.163925 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.top_customers
[0m14:31:04.163925 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:31:04.163925 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`top_customers`
[0m14:31:04.163925 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.top_customers"
[0m14:31:04.163925 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.top_customers"
[0m14:31:04.163925 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.top_customers: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.top_customers"} */

  
  
  
  create or replace view `workspace`.`default`.`top_customers`
  
  as (
    SELECT
  User_ID,
  COUNT(*) AS total_orders,
  ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS total_spent
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY User_ID
ORDER BY total_spent DESC
LIMIT 10
  )

[0m14:31:04.915062 [debug] [Thread-1 (]: SQL status: OK in 0.740 seconds
[0m14:31:04.915062 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, command-id=01f0836b-9b8b-139b-9ad4-6e584d4831c1) - Closing
[0m14:31:04.915062 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:31:04.915062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '555f1654-669e-46c4-80ab-eb5101ba1c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002357F3A7A90>]}
[0m14:31:04.915062 [info ] [Thread-1 (]: 19 of 43 OK created sql view model default.top_customers ....................... [[32mOK[0m in 0.77s]
[0m14:31:04.915062 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.top_customers
[0m14:31:04.915062 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m14:31:04.915062 [info ] [Thread-1 (]: 20 of 43 START test non_negative_avg_discount_by_category_avg_discount_percent . [RUN]
[0m14:31:04.930604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.top_customers, now test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f)
[0m14:31:04.930604 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f, idle-time=0.015541553497314453s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.top_customers
[0m14:31:04.930604 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m14:31:04.946199 [debug] [Thread-1 (]: Compilation Error in test non_negative_avg_discount_by_category_avg_discount_percent (dbt_databricks_cicd/models\mart\databricks\schema.yml)
  'test_non_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:31:04.946199 [error] [Thread-1 (]: 20 of 43 ERROR non_negative_avg_discount_by_category_avg_discount_percent ...... [[31mERROR[0m in 0.02s]
[0m14:31:04.961818 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m14:31:04.961818 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m14:31:04.961818 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f' to be skipped because of status 'error'.  Reason: Compilation Error in test non_negative_avg_discount_by_category_avg_discount_percent (dbt_databricks_cicd/models\mart\databricks\schema.yml)
  'test_non_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m14:31:04.961818 [info ] [Thread-1 (]: 21 of 43 START test not_null_avg_discount_by_category_Category ................. [RUN]
[0m14:31:04.961818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f, now test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b)
[0m14:31:04.961818 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b, idle-time=0.015619039535522461s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m14:31:04.961818 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m14:31:04.993957 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b"
[0m14:31:04.993957 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m14:31:05.009580 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b"
[0m14:31:05.009580 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b"
[0m14:31:05.009580 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Category
from `workspace`.`default`.`avg_discount_by_category`
where Category is null



  
  
      
    ) dbt_internal_test
[0m14:31:06.336158 [debug] [Thread-1 (]: SQL status: OK in 1.330 seconds
[0m14:31:06.351681 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, command-id=01f0836b-9c0b-1512-8850-1c0480b4c3ef) - Closing
[0m14:31:06.351681 [info ] [Thread-1 (]: 21 of 43 PASS not_null_avg_discount_by_category_Category ....................... [[32mPASS[0m in 1.39s]
[0m14:31:06.351681 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m14:31:06.351681 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m14:31:06.351681 [info ] [Thread-1 (]: 22 of 43 START test not_null_avg_discount_by_category_avg_discount_percent ..... [RUN]
[0m14:31:06.351681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b, now test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101)
[0m14:31:06.351681 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m14:31:06.351681 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m14:31:06.367307 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101"
[0m14:31:06.367307 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m14:31:06.385376 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101"
[0m14:31:06.389377 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101"
[0m14:31:06.391380 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_discount_percent
from `workspace`.`default`.`avg_discount_by_category`
where avg_discount_percent is null



  
  
      
    ) dbt_internal_test
[0m14:31:09.929862 [debug] [Thread-1 (]: SQL status: OK in 3.540 seconds
[0m14:31:09.929862 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, command-id=01f0836b-9cdd-13b8-a53b-65a70667727a) - Closing
[0m14:31:09.945490 [info ] [Thread-1 (]: 22 of 43 PASS not_null_avg_discount_by_category_avg_discount_percent ........... [[32mPASS[0m in 3.59s]
[0m14:31:09.945490 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m14:31:09.945490 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m14:31:09.945490 [info ] [Thread-1 (]: 23 of 43 START test non_negative_avg_ticket_by_category_avg_ticket ............. [RUN]
[0m14:31:09.945490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101, now test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095)
[0m14:31:09.945490 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m14:31:09.945490 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m14:31:09.961117 [debug] [Thread-1 (]: Compilation Error in test non_negative_avg_ticket_by_category_avg_ticket (dbt_databricks_cicd/models\mart\databricks\schema.yml)
  'test_non_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:31:09.961117 [error] [Thread-1 (]: 23 of 43 ERROR non_negative_avg_ticket_by_category_avg_ticket .................. [[31mERROR[0m in 0.02s]
[0m14:31:09.961117 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m14:31:09.976736 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m14:31:09.976736 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095' to be skipped because of status 'error'.  Reason: Compilation Error in test non_negative_avg_ticket_by_category_avg_ticket (dbt_databricks_cicd/models\mart\databricks\schema.yml)
  'test_non_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m14:31:09.976736 [info ] [Thread-1 (]: 24 of 43 START test not_null_avg_ticket_by_category_Category ................... [RUN]
[0m14:31:09.976736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095, now test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f)
[0m14:31:09.976736 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f, idle-time=0.015619754791259766s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m14:31:09.976736 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m14:31:10.001740 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f"
[0m14:31:10.005734 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m14:31:10.013734 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f"
[0m14:31:10.016735 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f"
[0m14:31:10.018741 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Category
from `workspace`.`default`.`avg_ticket_by_category`
where Category is null



  
  
      
    ) dbt_internal_test
[0m14:31:10.827379 [debug] [Thread-1 (]: SQL status: OK in 0.810 seconds
[0m14:31:10.843009 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, command-id=01f0836b-9f06-1d9f-bbf0-3282567a1781) - Closing
[0m14:31:10.843009 [info ] [Thread-1 (]: 24 of 43 PASS not_null_avg_ticket_by_category_Category ......................... [[32mPASS[0m in 0.87s]
[0m14:31:10.843009 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m14:31:10.843009 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m14:31:10.843009 [info ] [Thread-1 (]: 25 of 43 START test not_null_avg_ticket_by_category_avg_ticket ................. [RUN]
[0m14:31:10.843009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f, now test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41)
[0m14:31:10.843009 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m14:31:10.843009 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m14:31:10.858633 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41"
[0m14:31:10.874258 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m14:31:10.992372 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41"
[0m14:31:11.007997 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41"
[0m14:31:11.007997 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_ticket
from `workspace`.`default`.`avg_ticket_by_category`
where avg_ticket is null



  
  
      
    ) dbt_internal_test
[0m14:31:11.884227 [debug] [Thread-1 (]: SQL status: OK in 0.860 seconds
[0m14:31:11.899710 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, command-id=01f0836b-9f9f-1e15-8060-0823d988c315) - Closing
[0m14:31:11.899710 [info ] [Thread-1 (]: 25 of 43 PASS not_null_avg_ticket_by_category_avg_ticket ....................... [[32mPASS[0m in 1.06s]
[0m14:31:11.899710 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m14:31:11.899710 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m14:31:11.899710 [info ] [Thread-1 (]: 26 of 43 START test non_negative_monthly_revenue_monthly_revenue ............... [RUN]
[0m14:31:11.899710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41, now test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294)
[0m14:31:11.899710 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m14:31:11.899710 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m14:31:11.926324 [debug] [Thread-1 (]: Compilation Error in test non_negative_monthly_revenue_monthly_revenue (dbt_databricks_cicd/models\mart\databricks\schema.yml)
  'test_non_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:31:11.928324 [error] [Thread-1 (]: 26 of 43 ERROR non_negative_monthly_revenue_monthly_revenue .................... [[31mERROR[0m in 0.03s]
[0m14:31:11.930290 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m14:31:11.932440 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m14:31:11.932440 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294' to be skipped because of status 'error'.  Reason: Compilation Error in test non_negative_monthly_revenue_monthly_revenue (dbt_databricks_cicd/models\mart\databricks\schema.yml)
  'test_non_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m14:31:11.932440 [info ] [Thread-1 (]: 27 of 43 START test not_null_monthly_revenue_month ............................. [RUN]
[0m14:31:11.932440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294, now test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b)
[0m14:31:11.932440 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b, idle-time=0.004115581512451172s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m14:31:11.932440 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m14:31:11.948051 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b"
[0m14:31:11.948051 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m14:31:11.948051 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b"
[0m14:31:11.948051 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b"
[0m14:31:11.963678 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month
from `workspace`.`default`.`monthly_revenue`
where month is null



  
  
      
    ) dbt_internal_test
[0m14:31:12.805316 [debug] [Thread-1 (]: SQL status: OK in 0.840 seconds
[0m14:31:12.805316 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, command-id=01f0836b-a02f-1afb-81fc-f53a31bffdfb) - Closing
[0m14:31:12.805316 [info ] [Thread-1 (]: 27 of 43 PASS not_null_monthly_revenue_month ................................... [[32mPASS[0m in 0.87s]
[0m14:31:12.820802 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m14:31:12.820802 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m14:31:12.820802 [info ] [Thread-1 (]: 28 of 43 START test not_null_monthly_revenue_monthly_revenue ................... [RUN]
[0m14:31:12.820802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b, now test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b)
[0m14:31:12.820802 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b, idle-time=0.015486001968383789s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m14:31:12.820802 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m14:31:12.836464 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b"
[0m14:31:12.836464 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m14:31:12.836464 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b"
[0m14:31:12.852096 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b"
[0m14:31:12.852096 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select monthly_revenue
from `workspace`.`default`.`monthly_revenue`
where monthly_revenue is null



  
  
      
    ) dbt_internal_test
[0m14:31:13.765043 [debug] [Thread-1 (]: SQL status: OK in 0.910 seconds
[0m14:31:13.768047 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, command-id=01f0836b-a0b7-1340-bddf-1ba932edb13b) - Closing
[0m14:31:13.770047 [info ] [Thread-1 (]: 28 of 43 PASS not_null_monthly_revenue_monthly_revenue ......................... [[32mPASS[0m in 0.95s]
[0m14:31:13.772457 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m14:31:13.774571 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m14:31:13.774571 [info ] [Thread-1 (]: 29 of 43 START test non_negative_payment_distribution_total_value .............. [RUN]
[0m14:31:13.774571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b, now test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282)
[0m14:31:13.774571 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282, idle-time=0.0045239925384521484s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m14:31:13.774571 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m14:31:13.790245 [debug] [Thread-1 (]: Compilation Error in test non_negative_payment_distribution_total_value (dbt_databricks_cicd/models\mart\databricks\schema.yml)
  'test_non_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:31:13.790245 [error] [Thread-1 (]: 29 of 43 ERROR non_negative_payment_distribution_total_value ................... [[31mERROR[0m in 0.02s]
[0m14:31:13.790245 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m14:31:13.790245 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m14:31:13.790245 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282' to be skipped because of status 'error'.  Reason: Compilation Error in test non_negative_payment_distribution_total_value (dbt_databricks_cicd/models\mart\databricks\schema.yml)
  'test_non_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m14:31:13.790245 [info ] [Thread-1 (]: 30 of 43 START test not_null_payment_distribution_Payment_Method ............... [RUN]
[0m14:31:13.790245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282, now test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae)
[0m14:31:13.790245 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m14:31:13.790245 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m14:31:13.805864 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae"
[0m14:31:13.805864 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m14:31:13.821446 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae"
[0m14:31:13.821446 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae"
[0m14:31:13.821446 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Payment_Method
from `workspace`.`default`.`payment_distribution`
where Payment_Method is null



  
  
      
    ) dbt_internal_test
[0m14:31:14.590308 [debug] [Thread-1 (]: SQL status: OK in 0.770 seconds
[0m14:31:14.593310 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, command-id=01f0836b-a14c-1ec1-a2c6-242f9da0260a) - Closing
[0m14:31:14.595058 [info ] [Thread-1 (]: 30 of 43 PASS not_null_payment_distribution_Payment_Method ..................... [[32mPASS[0m in 0.80s]
[0m14:31:14.595058 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m14:31:14.595058 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m14:31:14.595058 [info ] [Thread-1 (]: 31 of 43 START test not_null_payment_distribution_total_transactions ........... [RUN]
[0m14:31:14.595058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae, now test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8)
[0m14:31:14.595058 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m14:31:14.595058 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m14:31:14.610695 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8"
[0m14:31:14.610695 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m14:31:14.610695 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8"
[0m14:31:14.626310 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8"
[0m14:31:14.626310 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_transactions
from `workspace`.`default`.`payment_distribution`
where total_transactions is null



  
  
      
    ) dbt_internal_test
[0m14:31:15.478233 [debug] [Thread-1 (]: SQL status: OK in 0.850 seconds
[0m14:31:15.478233 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, command-id=01f0836b-a1c6-1524-bdc4-649bad405a7c) - Closing
[0m14:31:15.478233 [info ] [Thread-1 (]: 31 of 43 PASS not_null_payment_distribution_total_transactions ................. [[32mPASS[0m in 0.88s]
[0m14:31:15.478233 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m14:31:15.494544 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m14:31:15.496544 [info ] [Thread-1 (]: 32 of 43 START test not_null_payment_distribution_total_value .................. [RUN]
[0m14:31:15.498542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8, now test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03)
[0m14:31:15.500542 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03, idle-time=0.022309303283691406s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m14:31:15.501543 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m14:31:15.508612 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03"
[0m14:31:15.508612 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m14:31:15.508612 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03"
[0m14:31:15.524283 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03"
[0m14:31:15.524283 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_value
from `workspace`.`default`.`payment_distribution`
where total_value is null



  
  
      
    ) dbt_internal_test
[0m14:31:16.289878 [debug] [Thread-1 (]: SQL status: OK in 0.770 seconds
[0m14:31:16.289878 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, command-id=01f0836b-a24f-1a87-9fc9-2e4345164520) - Closing
[0m14:31:16.289878 [info ] [Thread-1 (]: 32 of 43 PASS not_null_payment_distribution_total_value ........................ [[32mPASS[0m in 0.79s]
[0m14:31:16.305372 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m14:31:16.305372 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m14:31:16.305372 [info ] [Thread-1 (]: 33 of 43 START test non_negative_sales_by_category_total_revenue ............... [RUN]
[0m14:31:16.305372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03, now test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41)
[0m14:31:16.305372 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41, idle-time=0.015494585037231445s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m14:31:16.305372 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m14:31:16.321004 [debug] [Thread-1 (]: Compilation Error in test non_negative_sales_by_category_total_revenue (dbt_databricks_cicd/models\mart\databricks\schema.yml)
  'test_non_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:31:16.321004 [error] [Thread-1 (]: 33 of 43 ERROR non_negative_sales_by_category_total_revenue .................... [[31mERROR[0m in 0.02s]
[0m14:31:16.321004 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m14:31:16.321004 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m14:31:16.321004 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41' to be skipped because of status 'error'.  Reason: Compilation Error in test non_negative_sales_by_category_total_revenue (dbt_databricks_cicd/models\mart\databricks\schema.yml)
  'test_non_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m14:31:16.321004 [info ] [Thread-1 (]: 34 of 43 START test not_null_sales_by_category_Category ........................ [RUN]
[0m14:31:16.321004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41, now test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507)
[0m14:31:16.336621 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507, idle-time=0.015616416931152344s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m14:31:16.336621 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m14:31:16.336621 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507"
[0m14:31:16.352528 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m14:31:16.362533 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507"
[0m14:31:16.365530 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507"
[0m14:31:16.366532 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Category
from `workspace`.`default`.`sales_by_category`
where Category is null



  
  
      
    ) dbt_internal_test
[0m14:31:17.243387 [debug] [Thread-1 (]: SQL status: OK in 0.870 seconds
[0m14:31:17.243387 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, command-id=01f0836b-a2cf-1909-92e2-100d15296f25) - Closing
[0m14:31:17.243387 [info ] [Thread-1 (]: 34 of 43 PASS not_null_sales_by_category_Category .............................. [[32mPASS[0m in 0.92s]
[0m14:31:17.243387 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m14:31:17.243387 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m14:31:17.243387 [info ] [Thread-1 (]: 35 of 43 START test not_null_sales_by_category_total_orders .................... [RUN]
[0m14:31:17.243387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507, now test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e)
[0m14:31:17.243387 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m14:31:17.243387 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m14:31:17.259013 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e"
[0m14:31:17.259013 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m14:31:17.274679 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e"
[0m14:31:17.274679 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e"
[0m14:31:17.274679 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from `workspace`.`default`.`sales_by_category`
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m14:31:18.095139 [debug] [Thread-1 (]: SQL status: OK in 0.820 seconds
[0m14:31:18.099144 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, command-id=01f0836b-a35b-15e4-9265-63a2d685999b) - Closing
[0m14:31:18.101153 [info ] [Thread-1 (]: 35 of 43 PASS not_null_sales_by_category_total_orders .......................... [[32mPASS[0m in 0.86s]
[0m14:31:18.104146 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m14:31:18.105144 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m14:31:18.107143 [info ] [Thread-1 (]: 36 of 43 START test not_null_sales_by_category_total_revenue ................... [RUN]
[0m14:31:18.109220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e, now test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd)
[0m14:31:18.109220 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd, idle-time=0.008066415786743164s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m14:31:18.109220 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m14:31:18.109220 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd"
[0m14:31:18.109220 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m14:31:18.124843 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd"
[0m14:31:18.124843 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd"
[0m14:31:18.124843 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from `workspace`.`default`.`sales_by_category`
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m14:31:19.320814 [debug] [Thread-1 (]: SQL status: OK in 1.200 seconds
[0m14:31:19.336305 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, command-id=01f0836b-a3dc-1b19-9ebf-c5a392d88570) - Closing
[0m14:31:19.336305 [info ] [Thread-1 (]: 36 of 43 PASS not_null_sales_by_category_total_revenue ......................... [[32mPASS[0m in 1.23s]
[0m14:31:19.336305 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m14:31:19.336305 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m14:31:19.336305 [info ] [Thread-1 (]: 37 of 43 START test non_negative_top_5_products_total_sales .................... [RUN]
[0m14:31:19.336305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd, now test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34)
[0m14:31:19.336305 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m14:31:19.336305 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m14:31:19.351923 [debug] [Thread-1 (]: Compilation Error in test non_negative_top_5_products_total_sales (dbt_databricks_cicd/models\mart\databricks\schema.yml)
  'test_non_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:31:19.351923 [error] [Thread-1 (]: 37 of 43 ERROR non_negative_top_5_products_total_sales ......................... [[31mERROR[0m in 0.02s]
[0m14:31:19.351923 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m14:31:19.351923 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m14:31:19.351923 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34' to be skipped because of status 'error'.  Reason: Compilation Error in test non_negative_top_5_products_total_sales (dbt_databricks_cicd/models\mart\databricks\schema.yml)
  'test_non_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m14:31:19.367583 [info ] [Thread-1 (]: 38 of 43 START test not_null_top_5_products_product_id ......................... [RUN]
[0m14:31:19.367583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34, now test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe)
[0m14:31:19.367583 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe, idle-time=0.01566004753112793s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m14:31:19.367583 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m14:31:19.383222 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe"
[0m14:31:19.383222 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m14:31:19.383222 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe"
[0m14:31:19.398807 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe"
[0m14:31:19.398807 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `workspace`.`default`.`top_5_products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:31:20.488199 [debug] [Thread-1 (]: SQL status: OK in 1.090 seconds
[0m14:31:20.492202 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, command-id=01f0836b-a49f-188e-80ee-f73b35e14a05) - Closing
[0m14:31:20.493294 [info ] [Thread-1 (]: 38 of 43 PASS not_null_top_5_products_product_id ............................... [[32mPASS[0m in 1.13s]
[0m14:31:20.493294 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m14:31:20.493294 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m14:31:20.493294 [info ] [Thread-1 (]: 39 of 43 START test not_null_top_5_products_total_sales ........................ [RUN]
[0m14:31:20.493294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe, now test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818)
[0m14:31:20.493294 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m14:31:20.493294 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m14:31:20.508961 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818"
[0m14:31:20.508961 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m14:31:20.524595 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818"
[0m14:31:20.524595 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818"
[0m14:31:20.524595 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_sales
from `workspace`.`default`.`top_5_products`
where total_sales is null



  
  
      
    ) dbt_internal_test
[0m14:31:21.476824 [debug] [Thread-1 (]: SQL status: OK in 0.950 seconds
[0m14:31:21.476824 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, command-id=01f0836b-a54a-1cd0-8137-ff108247190f) - Closing
[0m14:31:21.476824 [info ] [Thread-1 (]: 39 of 43 PASS not_null_top_5_products_total_sales .............................. [[32mPASS[0m in 0.98s]
[0m14:31:21.492324 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m14:31:21.492324 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m14:31:21.492324 [info ] [Thread-1 (]: 40 of 43 START test non_negative_top_customers_total_spent ..................... [RUN]
[0m14:31:21.492324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818, now test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667)
[0m14:31:21.492324 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667, idle-time=0.015500307083129883s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m14:31:21.492324 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m14:31:21.508007 [debug] [Thread-1 (]: Compilation Error in test non_negative_top_customers_total_spent (dbt_databricks_cicd/models\mart\databricks\schema.yml)
  'test_non_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:31:21.508007 [error] [Thread-1 (]: 40 of 43 ERROR non_negative_top_customers_total_spent .......................... [[31mERROR[0m in 0.02s]
[0m14:31:21.508007 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m14:31:21.508007 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m14:31:21.508007 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667' to be skipped because of status 'error'.  Reason: Compilation Error in test non_negative_top_customers_total_spent (dbt_databricks_cicd/models\mart\databricks\schema.yml)
  'test_non_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m14:31:21.508007 [info ] [Thread-1 (]: 41 of 43 START test not_null_top_customers_User_ID ............................. [RUN]
[0m14:31:21.523580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667, now test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0)
[0m14:31:21.523580 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0, idle-time=0.015573263168334961s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m14:31:21.523580 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m14:31:21.523580 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0"
[0m14:31:21.539204 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m14:31:21.539204 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0"
[0m14:31:21.539204 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0"
[0m14:31:21.539204 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select User_ID
from `workspace`.`default`.`top_customers`
where User_ID is null



  
  
      
    ) dbt_internal_test
[0m14:31:22.398938 [debug] [Thread-1 (]: SQL status: OK in 0.860 seconds
[0m14:31:22.398938 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, command-id=01f0836b-a5e6-1111-8bf7-874c9c02b091) - Closing
[0m14:31:22.398938 [info ] [Thread-1 (]: 41 of 43 PASS not_null_top_customers_User_ID ................................... [[32mPASS[0m in 0.88s]
[0m14:31:22.398938 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m14:31:22.398938 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m14:31:22.414782 [info ] [Thread-1 (]: 42 of 43 START test not_null_top_customers_total_orders ........................ [RUN]
[0m14:31:22.416598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0, now test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746)
[0m14:31:22.417596 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746, idle-time=0.018657922744750977s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m14:31:22.418597 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m14:31:22.427597 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746"
[0m14:31:22.429597 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m14:31:22.436594 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746"
[0m14:31:22.438612 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746"
[0m14:31:22.440605 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from `workspace`.`default`.`top_customers`
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m14:31:23.008449 [debug] [Thread-1 (]: SQL status: OK in 0.570 seconds
[0m14:31:23.008449 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, command-id=01f0836b-a66e-1dea-9495-b2ae5e9bc542) - Closing
[0m14:31:23.023960 [info ] [Thread-1 (]: 42 of 43 PASS not_null_top_customers_total_orders .............................. [[32mPASS[0m in 0.61s]
[0m14:31:23.023960 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m14:31:23.023960 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73
[0m14:31:23.023960 [info ] [Thread-1 (]: 43 of 43 START test not_null_top_customers_total_spent ......................... [RUN]
[0m14:31:23.023960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746, now test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73)
[0m14:31:23.023960 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, name=test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m14:31:23.023960 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73
[0m14:31:23.039644 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73"
[0m14:31:23.039644 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73
[0m14:31:23.057001 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73"
[0m14:31:23.059988 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73"
[0m14:31:23.061988 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_spent
from `workspace`.`default`.`top_customers`
where total_spent is null



  
  
      
    ) dbt_internal_test
[0m14:31:23.884025 [debug] [Thread-1 (]: SQL status: OK in 0.820 seconds
[0m14:31:23.899546 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8, command-id=01f0836b-a6cc-1f4f-8ca6-346999c467a3) - Closing
[0m14:31:23.899546 [info ] [Thread-1 (]: 43 of 43 PASS not_null_top_customers_total_spent ............................... [[32mPASS[0m in 0.88s]
[0m14:31:23.899546 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73
[0m14:31:23.899546 [debug] [MainThread]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=master, idle-time=37.359840869903564s, language=None, compute-name=) - Reusing connection previously named master
[0m14:31:23.899546 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:31:23.899546 [debug] [MainThread]: Connection 'list_workspace' was properly closed.
[0m14:31:23.899546 [debug] [MainThread]: On list_workspace: Close
[0m14:31:23.899546 [debug] [MainThread]: Databricks adapter: Connection(session-id=01f0836b-6973-11af-a927-97d079165042) - Closing
[0m14:31:24.103486 [debug] [MainThread]: Connection 'list_workspace_default' was properly closed.
[0m14:31:24.119135 [debug] [MainThread]: On list_workspace_default: Close
[0m14:31:24.119135 [debug] [MainThread]: Databricks adapter: Connection(session-id=01f0836b-8ee3-15cf-9bda-ab7a2f116411) - Closing
[0m14:31:24.321096 [debug] [MainThread]: Connection 'test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73' was properly closed.
[0m14:31:24.321096 [debug] [MainThread]: On test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73: Close
[0m14:31:24.321096 [debug] [MainThread]: Databricks adapter: Connection(session-id=01f0836b-916f-108f-8634-2964bcfaf1d8) - Closing
[0m14:31:24.540131 [info ] [MainThread]: 
[0m14:31:24.540131 [info ] [MainThread]: Finished running 34 data tests, 9 view models in 0 hours 1 minutes and 45.41 seconds (105.41s).
[0m14:31:24.570900 [debug] [MainThread]: Command end result
[0m14:31:24.649633 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m14:31:24.649633 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m14:31:24.665257 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m14:31:24.665257 [info ] [MainThread]: 
[0m14:31:24.680879 [info ] [MainThread]: [31mCompleted with 17 errors, 0 partial successes, and 0 warnings:[0m
[0m14:31:24.680879 [info ] [MainThread]: 
[0m14:31:24.680879 [error] [MainThread]: [31mFailure in test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:31:24.680879 [error] [MainThread]:   Database Error in test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 20 pos 9
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_accepted_values_sqlserv_e814246ceecd68245cb8ed7332e2da84.sql
[0m14:31:24.680879 [info ] [MainThread]: 
[0m14:31:24.696499 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_accepted_values_sqlserv_e814246ceecd68245cb8ed7332e2da84.sql
[0m14:31:24.696499 [info ] [MainThread]: 
[0m14:31:24.696499 [error] [MainThread]: [31mFailure in test source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_ (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:31:24.696499 [error] [MainThread]:   Got 8 results, configured to fail if != 0
[0m14:31:24.712144 [info ] [MainThread]: 
[0m14:31:24.712144 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_assert_source_structure_0af1e5f4dda30d85443523174084b59d.sql
[0m14:31:24.712144 [info ] [MainThread]: 
[0m14:31:24.712144 [error] [MainThread]: [31mFailure in test source_not_null_sqlserver_ecommerce_Category (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:31:24.712144 [error] [MainThread]:   Database Error in test source_not_null_sqlserver_ecommerce_Category (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Category.sql
[0m14:31:24.730362 [info ] [MainThread]: 
[0m14:31:24.732363 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Category.sql
[0m14:31:24.734360 [info ] [MainThread]: 
[0m14:31:24.737387 [error] [MainThread]: [31mFailure in test source_not_null_sqlserver_ecommerce_Discount (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:31:24.739432 [error] [MainThread]:   Database Error in test source_not_null_sqlserver_ecommerce_Discount (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Discount.sql
[0m14:31:24.741359 [info ] [MainThread]: 
[0m14:31:24.742360 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Discount.sql
[0m14:31:24.743683 [info ] [MainThread]: 
[0m14:31:24.743683 [error] [MainThread]: [31mFailure in test source_not_null_sqlserver_ecommerce_Final_Price (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:31:24.743683 [error] [MainThread]:   Database Error in test source_not_null_sqlserver_ecommerce_Final_Price (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Final_Price.sql
[0m14:31:24.743683 [info ] [MainThread]: 
[0m14:31:24.743683 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Final_Price.sql
[0m14:31:24.759309 [info ] [MainThread]: 
[0m14:31:24.759309 [error] [MainThread]: [31mFailure in test source_not_null_sqlserver_ecommerce_Payment_Method (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:31:24.759309 [error] [MainThread]:   Database Error in test source_not_null_sqlserver_ecommerce_Payment_Method (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Payment_Method.sql
[0m14:31:24.759309 [info ] [MainThread]: 
[0m14:31:24.759309 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Payment_Method.sql
[0m14:31:24.759309 [info ] [MainThread]: 
[0m14:31:24.759309 [error] [MainThread]: [31mFailure in test source_not_null_sqlserver_ecommerce_Price (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:31:24.759309 [error] [MainThread]:   Database Error in test source_not_null_sqlserver_ecommerce_Price (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Price.sql
[0m14:31:24.774939 [info ] [MainThread]: 
[0m14:31:24.774939 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Price.sql
[0m14:31:24.774939 [info ] [MainThread]: 
[0m14:31:24.774939 [error] [MainThread]: [31mFailure in test source_not_null_sqlserver_ecommerce_Product_ID (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:31:24.774939 [error] [MainThread]:   Database Error in test source_not_null_sqlserver_ecommerce_Product_ID (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Product_ID.sql
[0m14:31:24.774939 [info ] [MainThread]: 
[0m14:31:24.774939 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Product_ID.sql
[0m14:31:24.774939 [info ] [MainThread]: 
[0m14:31:24.791788 [error] [MainThread]: [31mFailure in test source_not_null_sqlserver_ecommerce_Purchase_Date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:31:24.793785 [error] [MainThread]:   Database Error in test source_not_null_sqlserver_ecommerce_Purchase_Date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Purchase_Date.sql
[0m14:31:24.795785 [info ] [MainThread]: 
[0m14:31:24.796785 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Purchase_Date.sql
[0m14:31:24.798793 [info ] [MainThread]: 
[0m14:31:24.799786 [error] [MainThread]: [31mFailure in test source_not_null_sqlserver_ecommerce_User_ID (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:31:24.801786 [error] [MainThread]:   Database Error in test source_not_null_sqlserver_ecommerce_User_ID (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_User_ID.sql
[0m14:31:24.804946 [info ] [MainThread]: 
[0m14:31:24.804946 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_User_ID.sql
[0m14:31:24.804946 [info ] [MainThread]: 
[0m14:31:24.804946 [error] [MainThread]: [31mFailure in test non_negative_avg_discount_by_category_avg_discount_percent (dbt_databricks_cicd/models\mart\databricks\schema.yml)[0m
[0m14:31:24.804946 [error] [MainThread]:   Compilation Error in test non_negative_avg_discount_by_category_avg_discount_percent (dbt_databricks_cicd/models\mart\databricks\schema.yml)
  'test_non_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:31:24.804946 [info ] [MainThread]: 
[0m14:31:24.804946 [error] [MainThread]: [31mFailure in test non_negative_avg_ticket_by_category_avg_ticket (dbt_databricks_cicd/models\mart\databricks\schema.yml)[0m
[0m14:31:24.804946 [error] [MainThread]:   Compilation Error in test non_negative_avg_ticket_by_category_avg_ticket (dbt_databricks_cicd/models\mart\databricks\schema.yml)
  'test_non_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:31:24.804946 [info ] [MainThread]: 
[0m14:31:24.804946 [error] [MainThread]: [31mFailure in test non_negative_monthly_revenue_monthly_revenue (dbt_databricks_cicd/models\mart\databricks\schema.yml)[0m
[0m14:31:24.820574 [error] [MainThread]:   Compilation Error in test non_negative_monthly_revenue_monthly_revenue (dbt_databricks_cicd/models\mart\databricks\schema.yml)
  'test_non_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:31:24.820574 [info ] [MainThread]: 
[0m14:31:24.820574 [error] [MainThread]: [31mFailure in test non_negative_payment_distribution_total_value (dbt_databricks_cicd/models\mart\databricks\schema.yml)[0m
[0m14:31:24.820574 [error] [MainThread]:   Compilation Error in test non_negative_payment_distribution_total_value (dbt_databricks_cicd/models\mart\databricks\schema.yml)
  'test_non_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:31:24.820574 [info ] [MainThread]: 
[0m14:31:24.836198 [error] [MainThread]: [31mFailure in test non_negative_sales_by_category_total_revenue (dbt_databricks_cicd/models\mart\databricks\schema.yml)[0m
[0m14:31:24.836198 [error] [MainThread]:   Compilation Error in test non_negative_sales_by_category_total_revenue (dbt_databricks_cicd/models\mart\databricks\schema.yml)
  'test_non_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:31:24.836198 [info ] [MainThread]: 
[0m14:31:24.836198 [error] [MainThread]: [31mFailure in test non_negative_top_5_products_total_sales (dbt_databricks_cicd/models\mart\databricks\schema.yml)[0m
[0m14:31:24.836198 [error] [MainThread]:   Compilation Error in test non_negative_top_5_products_total_sales (dbt_databricks_cicd/models\mart\databricks\schema.yml)
  'test_non_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:31:24.836198 [info ] [MainThread]: 
[0m14:31:24.836198 [error] [MainThread]: [31mFailure in test non_negative_top_customers_total_spent (dbt_databricks_cicd/models\mart\databricks\schema.yml)[0m
[0m14:31:24.836198 [error] [MainThread]:   Compilation Error in test non_negative_top_customers_total_spent (dbt_databricks_cicd/models\mart\databricks\schema.yml)
  'test_non_negative' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m14:31:24.851824 [info ] [MainThread]: 
[0m14:31:24.851824 [info ] [MainThread]: Done. PASS=26 WARN=0 ERROR=17 SKIP=0 NO-OP=0 TOTAL=43
[0m14:31:24.851824 [debug] [MainThread]: Command `dbt build` failed at 14:31:24.851824 after 120.90 seconds
[0m14:31:24.851824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002356BF53DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002357ED8EA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002356C1B0550>]}
[0m14:31:24.851824 [debug] [MainThread]: Flushing usage events
[0m14:31:25.632600 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:34:00.352279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193C9798C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193C97EBA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193C97EA690>]}


============================== 14:34:00.367907 | 1bb1fefb-a35c-4c29-a540-4067f1bb0921 ==============================
[0m14:34:00.367907 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:34:00.367907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build --target databricks', 'send_anonymous_usage_stats': 'True'}
[0m14:34:02.664278 [debug] [MainThread]: Spark adapter: Setting pyhive.hive logging to ERROR
[0m14:34:02.664278 [debug] [MainThread]: Spark adapter: Setting thrift.transport logging to ERROR
[0m14:34:02.664278 [debug] [MainThread]: Spark adapter: Setting thrift.protocol logging to ERROR
[0m14:34:04.461131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bb1fefb-a35c-4c29-a540-4067f1bb0921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193D4A27C50>]}
[0m14:34:04.587268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bb1fefb-a35c-4c29-a540-4067f1bb0921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193C8F09BD0>]}
[0m14:34:04.587268 [info ] [MainThread]: Registered adapter: databricks=1.10.4
[0m14:34:05.695777 [debug] [MainThread]: checksum: 3fbc73d786818920aecb1b2190495121ce0b60768fe54c46d521f1e82da30af9, vars: {}, profile: , target: databricks, version: 1.10.3
[0m14:34:06.227434 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:34:06.227434 [debug] [MainThread]: Partial parsing: added file: dbt_databricks_cicd://macros\non_negative.sql
[0m14:34:06.476609 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m14:34:06.507847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bb1fefb-a35c-4c29-a540-4067f1bb0921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193D4860D50>]}
[0m14:34:06.711179 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m14:34:06.726804 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m14:34:06.837074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bb1fefb-a35c-4c29-a540-4067f1bb0921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193D484C390>]}
[0m14:34:06.837074 [info ] [MainThread]: Found 9 models, 34 data tests, 1 source, 799 macros
[0m14:34:06.852698 [info ] [MainThread]: 
[0m14:34:06.852698 [info ] [MainThread]: Concurrency: 1 threads (target='databricks')
[0m14:34:06.852698 [info ] [MainThread]: 
[0m14:34:06.852698 [debug] [MainThread]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=master, idle-time=0s, language=None, compute-name=) - Creating connection
[0m14:34:06.852698 [debug] [MainThread]: Acquiring new databricks connection 'master'
[0m14:34:06.883945 [debug] [ThreadPool]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=list_workspace, idle-time=0s, language=None, compute-name=) - Creating connection
[0m14:34:06.883945 [debug] [ThreadPool]: Acquiring new databricks connection 'list_workspace'
[0m14:34:06.883945 [debug] [ThreadPool]: Using databricks connection "list_workspace"
[0m14:34:06.883945 [debug] [ThreadPool]: On list_workspace: GetSchemas(database=workspace, schema=None)
[0m14:34:06.883945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:07.650380 [debug] [ThreadPool]: Databricks adapter: Connection(session-id=01f0836c-08c7-1437-891a-73d72a59597b) - Created
[0m14:34:08.070384 [debug] [ThreadPool]: SQL status: OK in 1.190 seconds
[0m14:34:08.070384 [debug] [ThreadPool]: Databricks adapter: Cursor(session-id=01f0836c-08c7-1437-891a-73d72a59597b, command-id=01f0836c-08ea-1da3-87e6-5534c0fc7cbd) - Closing
[0m14:34:08.070384 [debug] [ThreadPool]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=list_workspace_default, idle-time=0s, language=None, compute-name=) - Creating connection
[0m14:34:08.070384 [debug] [ThreadPool]: Acquiring new databricks connection 'list_workspace_default'
[0m14:34:08.086013 [debug] [ThreadPool]: Using databricks connection "list_workspace_default"
[0m14:34:08.101675 [debug] [ThreadPool]: On list_workspace_default: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "connection_name": "list_workspace_default"} */

    
SELECT
  table_name,
  if(table_type IN ('EXTERNAL', 'MANAGED', 'MANAGED_SHALLOW_CLONE', 'EXTERNAL_SHALLOW_CLONE'), 'table', lower(table_type)) AS table_type,
  lower(data_source_format) AS file_format,
  table_owner
FROM `system`.`information_schema`.`tables`
WHERE table_catalog = 'workspace' 
  AND table_schema = 'default'

  
[0m14:34:08.101675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:08.852891 [debug] [ThreadPool]: Databricks adapter: Connection(session-id=01f0836c-0981-1184-add7-217c3f87b555) - Created
[0m14:34:09.337743 [debug] [ThreadPool]: SQL status: OK in 1.240 seconds
[0m14:34:09.354473 [debug] [ThreadPool]: Databricks adapter: Cursor(session-id=01f0836c-0981-1184-add7-217c3f87b555, command-id=01f0836c-09a0-1e95-afbb-022d8dab37ff) - Closing
[0m14:34:09.359713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bb1fefb-a35c-4c29-a540-4067f1bb0921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193CC125B90>]}
[0m14:34:09.368209 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce
[0m14:34:09.368209 [info ] [Thread-1 (]: 1 of 43 START sql view model default.src_ecommerce ............................. [RUN]
[0m14:34:09.368209 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=model.dbt_databricks_cicd.src_ecommerce, idle-time=0s, language=None, compute-name=) - Creating connection
[0m14:34:09.368209 [debug] [Thread-1 (]: Acquiring new databricks connection 'model.dbt_databricks_cicd.src_ecommerce'
[0m14:34:09.368209 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.src_ecommerce
[0m14:34:09.383878 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.src_ecommerce"
[0m14:34:09.383878 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.src_ecommerce
[0m14:34:09.415129 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:34:09.415129 [warn ] [Thread-1 (]: [[33mWARNING[0m]: Use revamped materializations based on separating create and insert.  This allows more performant column comments, as well as new column features.
You may opt into the new behavior sooner by setting `flags.use_materialization_v2` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m14:34:09.415129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '1bb1fefb-a35c-4c29-a540-4067f1bb0921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193D5BD9490>]}
[0m14:34:09.446378 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`src_ecommerce`
[0m14:34:09.476169 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.src_ecommerce"
[0m14:34:09.478244 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.src_ecommerce"
[0m14:34:09.478244 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.src_ecommerce"} */

  
  
  
  create or replace view `workspace`.`default`.`src_ecommerce`
  
  as (
    SELECT * FROM default.sales_ecommerce
  )

[0m14:34:09.478244 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:34:10.236034 [debug] [Thread-1 (]: Databricks adapter: Connection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d) - Created
[0m14:34:10.889863 [debug] [Thread-1 (]: SQL status: OK in 1.410 seconds
[0m14:34:10.892868 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-0a71-1f7c-b918-dedb5867a1e8) - Closing
[0m14:34:10.915046 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:34:10.930725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bb1fefb-a35c-4c29-a540-4067f1bb0921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193D5B0C090>]}
[0m14:34:10.930725 [info ] [Thread-1 (]: 1 of 43 OK created sql view model default.src_ecommerce ........................ [[32mOK[0m in 1.56s]
[0m14:34:10.930725 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce
[0m14:34:10.930725 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:34:10.930725 [info ] [Thread-1 (]: 2 of 43 START test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [RUN]
[0m14:34:10.946303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.src_ecommerce, now test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8)
[0m14:34:10.946303 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8, idle-time=0.01557779312133789s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.src_ecommerce
[0m14:34:10.946303 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:34:10.977563 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:34:10.977563 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:34:11.025173 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:34:11.025173 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:34:11.025173 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from `my_db`.`dbo`.`ecommerce`
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    'Credit Card','Net Banking','UPI','Debit Card','Cash on Delivery'
)



  
  
      
    ) dbt_internal_test
[0m14:34:11.544068 [debug] [Thread-1 (]: Databricks adapter: Exception while trying to execute query
/* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from `my_db`.`dbo`.`ecommerce`
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    'Credit Card','Net Banking','UPI','Debit Card','Cash on Delivery'
)



  
  
      
    ) dbt_internal_test
: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 20 pos 9
Error properties: diagnostic-info=org.apache.hive.service.cli.HiveSQLException: Error running query: [TABLE_OR_VIEW_NOT_FOUND] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 20 pos 9
	at org.apache.spark.sql.hive.thriftserver.HiveThriftServerErrors$.runningQueryError(HiveThriftServerErrors.scala:49)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:1036)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.org$apache$spark$sql$hive$thriftserver$SparkExecuteStatementOperation$$execute(SparkExecuteStatementOperation.scala:785)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$5(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.execution.SQLExecution$.withRootExecution(SQLExecution.scala:746)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$2(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.DatabricksTracingHelper.withAttributionContext(DatabricksSparkTracingHelper.scala:18)
	at com.databricks.spark.util.DatabricksTracingHelper.withSpanFromRequest(DatabricksSparkTracingHelper.scala:42)
	at com.databricks.spark.util.DBRTracing$.withSpanFromRequest(DBRTracing.scala:43)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$15(ThriftLocalProperties.scala:236)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:96)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:77)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags0(DatabricksSparkUsageLogger.scala:124)
	at com.databricks.spark.util.DatabricksSparkUsageLogger.withAttributionTags(DatabricksSparkUsageLogger.scala:232)
	at com.databricks.spark.util.UsageLogging.$anonfun$withAttributionTags$1(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:780)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:789)
	at com.databricks.spark.util.UsageLogging.withAttributionTags(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging.withAttributionTags$(UsageLogger.scala:666)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withAttributionTags(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$12(ThriftLocalProperties.scala:233)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties(ThriftLocalProperties.scala:229)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties$(ThriftLocalProperties.scala:89)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withLocalProperties(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:549)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:535)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2.run(SparkExecuteStatementOperation.scala:585)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 20 pos 9
	at org.apache.spark.sql.catalyst.ExtendedAnalysisException.copyPlan(ExtendedAnalysisException.scala:91)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:997)
	... 53 more
, operation-id=01f0836c-0aeb-175c-a0b2-dbb0be28f996
[0m14:34:11.557068 [debug] [Thread-1 (]: Database Error in test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 20 pos 9
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_accepted_values_sqlserv_e814246ceecd68245cb8ed7332e2da84.sql
[0m14:34:11.558068 [error] [Thread-1 (]: 2 of 43 ERROR source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [[31mERROR[0m in 0.61s]
[0m14:34:11.561310 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:34:11.562267 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:34:11.563272 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8' to be skipped because of status 'error'.  Reason: Database Error in test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 20 pos 9
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_accepted_values_sqlserv_e814246ceecd68245cb8ed7332e2da84.sql.
[0m14:34:11.564296 [info ] [Thread-1 (]: 3 of 43 START test source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_  [RUN]
[0m14:34:11.567313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8, now test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef)
[0m14:34:11.568311 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef, idle-time=0.010243415832519531s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:34:11.569313 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:34:11.586359 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:34:11.586359 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:34:11.601943 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:34:11.601943 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:34:11.601943 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    with actual as (
        select 
            column_name, data_type
        from INFORMATION_SCHEMA.COLUMNS
        where table_name = 'ecommerce'
          and table_schema = 'dbo'
    ),
    expected as (
        select * from (
            values
            
                ('Category', 'varchar'),
            
                ('Discount', 'int'),
            
                ('Final_Price', 'float'),
            
                ('Payment_Method', 'varchar'),
            
                ('Price', 'float'),
            
                ('Product_ID', 'varchar'),
            
                ('Purchase_Date', 'date'),
            
                ('User_ID', 'varchar')
            
        ) as t(column_name, data_type)
    )
    select
        e.column_name,
        e.data_type
    from expected e
    left join actual a
        on e.column_name = a.column_name
       and e.data_type = a.data_type
    where a.column_name is null

  
  
      
    ) dbt_internal_test
[0m14:34:12.258033 [debug] [Thread-1 (]: SQL status: OK in 0.660 seconds
[0m14:34:12.273662 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-0b44-10fb-98b0-cdeb315f51d4) - Closing
[0m14:34:12.273662 [error] [Thread-1 (]: 3 of 43 FAIL 8 source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_  [[31mFAIL 8[0m in 0.71s]
[0m14:34:12.289284 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:34:12.289284 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:34:12.289284 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef' to be skipped because of status 'fail'.  Reason: Got 8 results, configured to fail if != 0.
[0m14:34:12.289284 [info ] [Thread-1 (]: 4 of 43 START test source_not_null_sqlserver_ecommerce_Category ................ [RUN]
[0m14:34:12.289284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407)
[0m14:34:12.289284 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, idle-time=0.015622138977050781s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:34:12.289284 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:34:12.322438 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:34:12.326439 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:34:12.336437 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:34:12.338130 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:34:12.338130 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Category
from `my_db`.`dbo`.`ecommerce`
where Category is null



  
  
      
    ) dbt_internal_test
[0m14:34:12.805342 [debug] [Thread-1 (]: Databricks adapter: Exception while trying to execute query
/* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Category
from `my_db`.`dbo`.`ecommerce`
where Category is null



  
  
      
    ) dbt_internal_test
: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
Error properties: diagnostic-info=org.apache.hive.service.cli.HiveSQLException: Error running query: [TABLE_OR_VIEW_NOT_FOUND] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.hive.thriftserver.HiveThriftServerErrors$.runningQueryError(HiveThriftServerErrors.scala:49)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:1036)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.org$apache$spark$sql$hive$thriftserver$SparkExecuteStatementOperation$$execute(SparkExecuteStatementOperation.scala:785)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$5(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.execution.SQLExecution$.withRootExecution(SQLExecution.scala:746)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$2(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.DatabricksTracingHelper.withAttributionContext(DatabricksSparkTracingHelper.scala:18)
	at com.databricks.spark.util.DatabricksTracingHelper.withSpanFromRequest(DatabricksSparkTracingHelper.scala:42)
	at com.databricks.spark.util.DBRTracing$.withSpanFromRequest(DBRTracing.scala:43)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$15(ThriftLocalProperties.scala:236)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:96)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:77)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags0(DatabricksSparkUsageLogger.scala:124)
	at com.databricks.spark.util.DatabricksSparkUsageLogger.withAttributionTags(DatabricksSparkUsageLogger.scala:232)
	at com.databricks.spark.util.UsageLogging.$anonfun$withAttributionTags$1(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:780)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:789)
	at com.databricks.spark.util.UsageLogging.withAttributionTags(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging.withAttributionTags$(UsageLogger.scala:666)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withAttributionTags(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$12(ThriftLocalProperties.scala:233)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties(ThriftLocalProperties.scala:229)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties$(ThriftLocalProperties.scala:89)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withLocalProperties(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:549)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:535)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2.run(SparkExecuteStatementOperation.scala:585)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.catalyst.ExtendedAnalysisException.copyPlan(ExtendedAnalysisException.scala:91)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:997)
	... 53 more
, operation-id=01f0836c-0bb3-1766-9a05-efcafa1be12d
[0m14:34:12.805342 [debug] [Thread-1 (]: Database Error in test source_not_null_sqlserver_ecommerce_Category (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Category.sql
[0m14:34:12.805342 [error] [Thread-1 (]: 4 of 43 ERROR source_not_null_sqlserver_ecommerce_Category ..................... [[31mERROR[0m in 0.52s]
[0m14:34:12.805342 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:34:12.805342 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:34:12.820932 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_sqlserver_ecommerce_Category (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Category.sql.
[0m14:34:12.820932 [info ] [Thread-1 (]: 5 of 43 START test source_not_null_sqlserver_ecommerce_Discount ................ [RUN]
[0m14:34:12.820932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f)
[0m14:34:12.820932 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, idle-time=0.015590429306030273s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:34:12.820932 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:34:12.836550 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:34:12.836550 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:34:12.836550 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:34:12.852182 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:34:12.852182 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Discount
from `my_db`.`dbo`.`ecommerce`
where Discount is null



  
  
      
    ) dbt_internal_test
[0m14:34:13.336253 [debug] [Thread-1 (]: Databricks adapter: Exception while trying to execute query
/* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Discount
from `my_db`.`dbo`.`ecommerce`
where Discount is null



  
  
      
    ) dbt_internal_test
: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
Error properties: diagnostic-info=org.apache.hive.service.cli.HiveSQLException: Error running query: [TABLE_OR_VIEW_NOT_FOUND] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.hive.thriftserver.HiveThriftServerErrors$.runningQueryError(HiveThriftServerErrors.scala:49)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:1036)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.org$apache$spark$sql$hive$thriftserver$SparkExecuteStatementOperation$$execute(SparkExecuteStatementOperation.scala:785)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$5(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.execution.SQLExecution$.withRootExecution(SQLExecution.scala:746)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$2(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.DatabricksTracingHelper.withAttributionContext(DatabricksSparkTracingHelper.scala:18)
	at com.databricks.spark.util.DatabricksTracingHelper.withSpanFromRequest(DatabricksSparkTracingHelper.scala:42)
	at com.databricks.spark.util.DBRTracing$.withSpanFromRequest(DBRTracing.scala:43)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$15(ThriftLocalProperties.scala:236)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:96)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:77)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags0(DatabricksSparkUsageLogger.scala:124)
	at com.databricks.spark.util.DatabricksSparkUsageLogger.withAttributionTags(DatabricksSparkUsageLogger.scala:232)
	at com.databricks.spark.util.UsageLogging.$anonfun$withAttributionTags$1(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:780)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:789)
	at com.databricks.spark.util.UsageLogging.withAttributionTags(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging.withAttributionTags$(UsageLogger.scala:666)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withAttributionTags(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$12(ThriftLocalProperties.scala:233)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties(ThriftLocalProperties.scala:229)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties$(ThriftLocalProperties.scala:89)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withLocalProperties(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:549)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:535)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2.run(SparkExecuteStatementOperation.scala:585)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.catalyst.ExtendedAnalysisException.copyPlan(ExtendedAnalysisException.scala:91)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:997)
	... 53 more
, operation-id=01f0836c-0c01-13b0-80e0-196e43898c43
[0m14:34:13.336253 [debug] [Thread-1 (]: Database Error in test source_not_null_sqlserver_ecommerce_Discount (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Discount.sql
[0m14:34:13.336253 [error] [Thread-1 (]: 5 of 43 ERROR source_not_null_sqlserver_ecommerce_Discount ..................... [[31mERROR[0m in 0.52s]
[0m14:34:13.336253 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:34:13.336253 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:34:13.351880 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_sqlserver_ecommerce_Discount (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Discount.sql.
[0m14:34:13.351880 [info ] [Thread-1 (]: 6 of 43 START test source_not_null_sqlserver_ecommerce_Final_Price ............. [RUN]
[0m14:34:13.351880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d)
[0m14:34:13.351880 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, idle-time=0.015626907348632812s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:34:13.351880 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:34:13.351880 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:34:13.367515 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:34:13.367515 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:34:13.367515 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:34:13.367515 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Final_Price
from `my_db`.`dbo`.`ecommerce`
where Final_Price is null



  
  
      
    ) dbt_internal_test
[0m14:34:13.696548 [debug] [Thread-1 (]: Databricks adapter: Exception while trying to execute query
/* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Final_Price
from `my_db`.`dbo`.`ecommerce`
where Final_Price is null



  
  
      
    ) dbt_internal_test
: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
Error properties: diagnostic-info=org.apache.hive.service.cli.HiveSQLException: Error running query: [TABLE_OR_VIEW_NOT_FOUND] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.hive.thriftserver.HiveThriftServerErrors$.runningQueryError(HiveThriftServerErrors.scala:49)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:1036)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.org$apache$spark$sql$hive$thriftserver$SparkExecuteStatementOperation$$execute(SparkExecuteStatementOperation.scala:785)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$5(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.execution.SQLExecution$.withRootExecution(SQLExecution.scala:746)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$2(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.DatabricksTracingHelper.withAttributionContext(DatabricksSparkTracingHelper.scala:18)
	at com.databricks.spark.util.DatabricksTracingHelper.withSpanFromRequest(DatabricksSparkTracingHelper.scala:42)
	at com.databricks.spark.util.DBRTracing$.withSpanFromRequest(DBRTracing.scala:43)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$15(ThriftLocalProperties.scala:236)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:96)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:77)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags0(DatabricksSparkUsageLogger.scala:124)
	at com.databricks.spark.util.DatabricksSparkUsageLogger.withAttributionTags(DatabricksSparkUsageLogger.scala:232)
	at com.databricks.spark.util.UsageLogging.$anonfun$withAttributionTags$1(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:780)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:789)
	at com.databricks.spark.util.UsageLogging.withAttributionTags(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging.withAttributionTags$(UsageLogger.scala:666)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withAttributionTags(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$12(ThriftLocalProperties.scala:233)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties(ThriftLocalProperties.scala:229)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties$(ThriftLocalProperties.scala:89)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withLocalProperties(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:549)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:535)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2.run(SparkExecuteStatementOperation.scala:585)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.catalyst.ExtendedAnalysisException.copyPlan(ExtendedAnalysisException.scala:91)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:997)
	... 53 more
, operation-id=01f0836c-0c53-13e8-bf0a-a78ddb7d9c7b
[0m14:34:13.712176 [debug] [Thread-1 (]: Database Error in test source_not_null_sqlserver_ecommerce_Final_Price (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Final_Price.sql
[0m14:34:13.712176 [error] [Thread-1 (]: 6 of 43 ERROR source_not_null_sqlserver_ecommerce_Final_Price .................. [[31mERROR[0m in 0.36s]
[0m14:34:13.731285 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:34:13.732291 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:34:13.734287 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_sqlserver_ecommerce_Final_Price (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Final_Price.sql.
[0m14:34:13.735284 [info ] [Thread-1 (]: 7 of 43 START test source_not_null_sqlserver_ecommerce_Payment_Method .......... [RUN]
[0m14:34:13.738286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae)
[0m14:34:13.740284 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, idle-time=0.027108430862426758s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:34:13.741282 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:34:13.750496 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:34:13.752500 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:34:13.759548 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:34:13.759548 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:34:13.759548 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Payment_Method
from `my_db`.`dbo`.`ecommerce`
where Payment_Method is null



  
  
      
    ) dbt_internal_test
[0m14:34:14.078375 [debug] [Thread-1 (]: Databricks adapter: Exception while trying to execute query
/* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Payment_Method
from `my_db`.`dbo`.`ecommerce`
where Payment_Method is null



  
  
      
    ) dbt_internal_test
: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
Error properties: diagnostic-info=org.apache.hive.service.cli.HiveSQLException: Error running query: [TABLE_OR_VIEW_NOT_FOUND] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.hive.thriftserver.HiveThriftServerErrors$.runningQueryError(HiveThriftServerErrors.scala:49)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:1036)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.org$apache$spark$sql$hive$thriftserver$SparkExecuteStatementOperation$$execute(SparkExecuteStatementOperation.scala:785)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$5(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.execution.SQLExecution$.withRootExecution(SQLExecution.scala:746)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$2(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.DatabricksTracingHelper.withAttributionContext(DatabricksSparkTracingHelper.scala:18)
	at com.databricks.spark.util.DatabricksTracingHelper.withSpanFromRequest(DatabricksSparkTracingHelper.scala:42)
	at com.databricks.spark.util.DBRTracing$.withSpanFromRequest(DBRTracing.scala:43)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$15(ThriftLocalProperties.scala:236)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:96)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:77)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags0(DatabricksSparkUsageLogger.scala:124)
	at com.databricks.spark.util.DatabricksSparkUsageLogger.withAttributionTags(DatabricksSparkUsageLogger.scala:232)
	at com.databricks.spark.util.UsageLogging.$anonfun$withAttributionTags$1(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:780)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:789)
	at com.databricks.spark.util.UsageLogging.withAttributionTags(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging.withAttributionTags$(UsageLogger.scala:666)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withAttributionTags(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$12(ThriftLocalProperties.scala:233)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties(ThriftLocalProperties.scala:229)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties$(ThriftLocalProperties.scala:89)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withLocalProperties(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:549)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:535)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2.run(SparkExecuteStatementOperation.scala:585)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.catalyst.ExtendedAnalysisException.copyPlan(ExtendedAnalysisException.scala:91)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:997)
	... 53 more
, operation-id=01f0836c-0c8c-1052-9612-6c52a4b1e2a2
[0m14:34:14.084376 [debug] [Thread-1 (]: Database Error in test source_not_null_sqlserver_ecommerce_Payment_Method (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Payment_Method.sql
[0m14:34:14.086379 [error] [Thread-1 (]: 7 of 43 ERROR source_not_null_sqlserver_ecommerce_Payment_Method ............... [[31mERROR[0m in 0.35s]
[0m14:34:14.088485 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:34:14.088485 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:34:14.088485 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_sqlserver_ecommerce_Payment_Method (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Payment_Method.sql.
[0m14:34:14.088485 [info ] [Thread-1 (]: 8 of 43 START test source_not_null_sqlserver_ecommerce_Price ................... [RUN]
[0m14:34:14.088485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01)
[0m14:34:14.088485 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, idle-time=0.0031082630157470703s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:34:14.088485 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:34:14.104134 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:34:14.104134 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:34:14.104134 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:34:14.104134 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:34:14.104134 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Price
from `my_db`.`dbo`.`ecommerce`
where Price is null



  
  
      
    ) dbt_internal_test
[0m14:34:14.414993 [debug] [Thread-1 (]: Databricks adapter: Exception while trying to execute query
/* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Price
from `my_db`.`dbo`.`ecommerce`
where Price is null



  
  
      
    ) dbt_internal_test
: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
Error properties: diagnostic-info=org.apache.hive.service.cli.HiveSQLException: Error running query: [TABLE_OR_VIEW_NOT_FOUND] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.hive.thriftserver.HiveThriftServerErrors$.runningQueryError(HiveThriftServerErrors.scala:49)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:1036)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.org$apache$spark$sql$hive$thriftserver$SparkExecuteStatementOperation$$execute(SparkExecuteStatementOperation.scala:785)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$5(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.execution.SQLExecution$.withRootExecution(SQLExecution.scala:746)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$2(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.DatabricksTracingHelper.withAttributionContext(DatabricksSparkTracingHelper.scala:18)
	at com.databricks.spark.util.DatabricksTracingHelper.withSpanFromRequest(DatabricksSparkTracingHelper.scala:42)
	at com.databricks.spark.util.DBRTracing$.withSpanFromRequest(DBRTracing.scala:43)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$15(ThriftLocalProperties.scala:236)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:96)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:77)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags0(DatabricksSparkUsageLogger.scala:124)
	at com.databricks.spark.util.DatabricksSparkUsageLogger.withAttributionTags(DatabricksSparkUsageLogger.scala:232)
	at com.databricks.spark.util.UsageLogging.$anonfun$withAttributionTags$1(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:780)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:789)
	at com.databricks.spark.util.UsageLogging.withAttributionTags(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging.withAttributionTags$(UsageLogger.scala:666)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withAttributionTags(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$12(ThriftLocalProperties.scala:233)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties(ThriftLocalProperties.scala:229)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties$(ThriftLocalProperties.scala:89)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withLocalProperties(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:549)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:535)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2.run(SparkExecuteStatementOperation.scala:585)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.catalyst.ExtendedAnalysisException.copyPlan(ExtendedAnalysisException.scala:91)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:997)
	... 53 more
, operation-id=01f0836c-0cc1-18c0-97c8-b90203ab9558
[0m14:34:14.414993 [debug] [Thread-1 (]: Database Error in test source_not_null_sqlserver_ecommerce_Price (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Price.sql
[0m14:34:14.414993 [error] [Thread-1 (]: 8 of 43 ERROR source_not_null_sqlserver_ecommerce_Price ........................ [[31mERROR[0m in 0.33s]
[0m14:34:14.430622 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:34:14.430622 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:34:14.430622 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_sqlserver_ecommerce_Price (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Price.sql.
[0m14:34:14.430622 [info ] [Thread-1 (]: 9 of 43 START test source_not_null_sqlserver_ecommerce_Product_ID .............. [RUN]
[0m14:34:14.430622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff)
[0m14:34:14.430622 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, idle-time=0.01562786102294922s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:34:14.430622 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:34:14.446295 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:34:14.446295 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:34:14.446295 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:34:14.461930 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:34:14.461930 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Product_ID
from `my_db`.`dbo`.`ecommerce`
where Product_ID is null



  
  
      
    ) dbt_internal_test
[0m14:34:14.773478 [debug] [Thread-1 (]: Databricks adapter: Exception while trying to execute query
/* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Product_ID
from `my_db`.`dbo`.`ecommerce`
where Product_ID is null



  
  
      
    ) dbt_internal_test
: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
Error properties: diagnostic-info=org.apache.hive.service.cli.HiveSQLException: Error running query: [TABLE_OR_VIEW_NOT_FOUND] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.hive.thriftserver.HiveThriftServerErrors$.runningQueryError(HiveThriftServerErrors.scala:49)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:1036)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.org$apache$spark$sql$hive$thriftserver$SparkExecuteStatementOperation$$execute(SparkExecuteStatementOperation.scala:785)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$5(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.execution.SQLExecution$.withRootExecution(SQLExecution.scala:746)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$2(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.DatabricksTracingHelper.withAttributionContext(DatabricksSparkTracingHelper.scala:18)
	at com.databricks.spark.util.DatabricksTracingHelper.withSpanFromRequest(DatabricksSparkTracingHelper.scala:42)
	at com.databricks.spark.util.DBRTracing$.withSpanFromRequest(DBRTracing.scala:43)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$15(ThriftLocalProperties.scala:236)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:96)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:77)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags0(DatabricksSparkUsageLogger.scala:124)
	at com.databricks.spark.util.DatabricksSparkUsageLogger.withAttributionTags(DatabricksSparkUsageLogger.scala:232)
	at com.databricks.spark.util.UsageLogging.$anonfun$withAttributionTags$1(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:780)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:789)
	at com.databricks.spark.util.UsageLogging.withAttributionTags(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging.withAttributionTags$(UsageLogger.scala:666)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withAttributionTags(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$12(ThriftLocalProperties.scala:233)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties(ThriftLocalProperties.scala:229)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties$(ThriftLocalProperties.scala:89)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withLocalProperties(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:549)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:535)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2.run(SparkExecuteStatementOperation.scala:585)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.catalyst.ExtendedAnalysisException.copyPlan(ExtendedAnalysisException.scala:91)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:997)
	... 53 more
, operation-id=01f0836c-0cf6-151b-ae23-722fee5f8aa3
[0m14:34:14.773478 [debug] [Thread-1 (]: Database Error in test source_not_null_sqlserver_ecommerce_Product_ID (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Product_ID.sql
[0m14:34:14.773478 [error] [Thread-1 (]: 9 of 43 ERROR source_not_null_sqlserver_ecommerce_Product_ID ................... [[31mERROR[0m in 0.34s]
[0m14:34:14.773478 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:34:14.773478 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:34:14.773478 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_sqlserver_ecommerce_Product_ID (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Product_ID.sql.
[0m14:34:14.789103 [info ] [Thread-1 (]: 10 of 43 START test source_not_null_sqlserver_ecommerce_Purchase_Date .......... [RUN]
[0m14:34:14.789103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17)
[0m14:34:14.789103 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, idle-time=0.015625476837158203s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:34:14.789103 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:34:14.789103 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:34:14.804730 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:34:14.804730 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:34:14.804730 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:34:14.804730 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Purchase_Date
from `my_db`.`dbo`.`ecommerce`
where Purchase_Date is null



  
  
      
    ) dbt_internal_test
[0m14:34:15.171779 [debug] [Thread-1 (]: Databricks adapter: Exception while trying to execute query
/* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Purchase_Date
from `my_db`.`dbo`.`ecommerce`
where Purchase_Date is null



  
  
      
    ) dbt_internal_test
: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
Error properties: diagnostic-info=org.apache.hive.service.cli.HiveSQLException: Error running query: [TABLE_OR_VIEW_NOT_FOUND] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.hive.thriftserver.HiveThriftServerErrors$.runningQueryError(HiveThriftServerErrors.scala:49)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:1036)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.org$apache$spark$sql$hive$thriftserver$SparkExecuteStatementOperation$$execute(SparkExecuteStatementOperation.scala:785)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$5(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.execution.SQLExecution$.withRootExecution(SQLExecution.scala:746)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$2(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.DatabricksTracingHelper.withAttributionContext(DatabricksSparkTracingHelper.scala:18)
	at com.databricks.spark.util.DatabricksTracingHelper.withSpanFromRequest(DatabricksSparkTracingHelper.scala:42)
	at com.databricks.spark.util.DBRTracing$.withSpanFromRequest(DBRTracing.scala:43)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$15(ThriftLocalProperties.scala:236)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:96)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:77)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags0(DatabricksSparkUsageLogger.scala:124)
	at com.databricks.spark.util.DatabricksSparkUsageLogger.withAttributionTags(DatabricksSparkUsageLogger.scala:232)
	at com.databricks.spark.util.UsageLogging.$anonfun$withAttributionTags$1(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:780)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:789)
	at com.databricks.spark.util.UsageLogging.withAttributionTags(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging.withAttributionTags$(UsageLogger.scala:666)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withAttributionTags(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$12(ThriftLocalProperties.scala:233)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties(ThriftLocalProperties.scala:229)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties$(ThriftLocalProperties.scala:89)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withLocalProperties(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:549)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:535)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2.run(SparkExecuteStatementOperation.scala:585)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.catalyst.ExtendedAnalysisException.copyPlan(ExtendedAnalysisException.scala:91)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:997)
	... 53 more
, operation-id=01f0836c-0d35-122a-b0dc-b5cfc07ba031
[0m14:34:15.178779 [debug] [Thread-1 (]: Database Error in test source_not_null_sqlserver_ecommerce_Purchase_Date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Purchase_Date.sql
[0m14:34:15.180781 [error] [Thread-1 (]: 10 of 43 ERROR source_not_null_sqlserver_ecommerce_Purchase_Date ............... [[31mERROR[0m in 0.39s]
[0m14:34:15.181320 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:34:15.181320 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:34:15.181320 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_sqlserver_ecommerce_Purchase_Date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Purchase_Date.sql.
[0m14:34:15.181320 [info ] [Thread-1 (]: 11 of 43 START test source_not_null_sqlserver_ecommerce_User_ID ................ [RUN]
[0m14:34:15.181320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc)
[0m14:34:15.181320 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc, idle-time=0.0015411376953125s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:34:15.181320 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:34:15.196947 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:34:15.196947 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:34:15.196947 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:34:15.212567 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:34:15.212567 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select User_ID
from `my_db`.`dbo`.`ecommerce`
where User_ID is null



  
  
      
    ) dbt_internal_test
[0m14:34:15.508032 [debug] [Thread-1 (]: Databricks adapter: Exception while trying to execute query
/* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select User_ID
from `my_db`.`dbo`.`ecommerce`
where User_ID is null



  
  
      
    ) dbt_internal_test
: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
Error properties: diagnostic-info=org.apache.hive.service.cli.HiveSQLException: Error running query: [TABLE_OR_VIEW_NOT_FOUND] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.hive.thriftserver.HiveThriftServerErrors$.runningQueryError(HiveThriftServerErrors.scala:49)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:1036)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.org$apache$spark$sql$hive$thriftserver$SparkExecuteStatementOperation$$execute(SparkExecuteStatementOperation.scala:785)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$5(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.execution.SQLExecution$.withRootExecution(SQLExecution.scala:746)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$2(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.DatabricksTracingHelper.withAttributionContext(DatabricksSparkTracingHelper.scala:18)
	at com.databricks.spark.util.DatabricksTracingHelper.withSpanFromRequest(DatabricksSparkTracingHelper.scala:42)
	at com.databricks.spark.util.DBRTracing$.withSpanFromRequest(DBRTracing.scala:43)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$15(ThriftLocalProperties.scala:236)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:96)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:77)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags0(DatabricksSparkUsageLogger.scala:124)
	at com.databricks.spark.util.DatabricksSparkUsageLogger.withAttributionTags(DatabricksSparkUsageLogger.scala:232)
	at com.databricks.spark.util.UsageLogging.$anonfun$withAttributionTags$1(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:780)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:789)
	at com.databricks.spark.util.UsageLogging.withAttributionTags(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging.withAttributionTags$(UsageLogger.scala:666)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withAttributionTags(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$12(ThriftLocalProperties.scala:233)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties(ThriftLocalProperties.scala:229)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties$(ThriftLocalProperties.scala:89)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withLocalProperties(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:549)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:535)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2.run(SparkExecuteStatementOperation.scala:585)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.catalyst.ExtendedAnalysisException.copyPlan(ExtendedAnalysisException.scala:91)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:997)
	... 53 more
, operation-id=01f0836c-0d68-1955-b1ad-4537887f2146
[0m14:34:15.523518 [debug] [Thread-1 (]: Database Error in test source_not_null_sqlserver_ecommerce_User_ID (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_User_ID.sql
[0m14:34:15.523518 [error] [Thread-1 (]: 11 of 43 ERROR source_not_null_sqlserver_ecommerce_User_ID ..................... [[31mERROR[0m in 0.34s]
[0m14:34:15.523518 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:34:15.523518 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.stg_ecommerce
[0m14:34:15.523518 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_sqlserver_ecommerce_User_ID (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_User_ID.sql.
[0m14:34:15.523518 [info ] [Thread-1 (]: 12 of 43 START sql view model default.stg_ecommerce ............................ [RUN]
[0m14:34:15.523518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc, now model.dbt_databricks_cicd.stg_ecommerce)
[0m14:34:15.539182 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=model.dbt_databricks_cicd.stg_ecommerce, idle-time=0.015664100646972656s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:34:15.539182 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.stg_ecommerce
[0m14:34:15.539182 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.stg_ecommerce"
[0m14:34:15.539182 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.stg_ecommerce
[0m14:34:15.554810 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:34:15.554810 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`stg_ecommerce`
[0m14:34:15.554810 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.stg_ecommerce"
[0m14:34:15.554810 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.stg_ecommerce"
[0m14:34:15.554810 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.stg_ecommerce"} */

  
  
  
  create or replace view `workspace`.`default`.`stg_ecommerce`
  
  as (
    SELECT
  User_ID,
  Product_ID,
  Category,
  Price,
  Discount,
  Final_Price,
  Payment_Method,
  Purchase_Date
FROM `workspace`.`default`.`src_ecommerce`
  )

[0m14:34:16.086635 [debug] [Thread-1 (]: SQL status: OK in 0.530 seconds
[0m14:34:16.086635 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-0d9e-1a29-9a3c-56399cc818f0) - Closing
[0m14:34:16.086635 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:34:16.086635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bb1fefb-a35c-4c29-a540-4067f1bb0921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193D659DAD0>]}
[0m14:34:16.102180 [info ] [Thread-1 (]: 12 of 43 OK created sql view model default.stg_ecommerce ....................... [[32mOK[0m in 0.56s]
[0m14:34:16.102180 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.stg_ecommerce
[0m14:34:16.102180 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.avg_discount_by_category
[0m14:34:16.102180 [info ] [Thread-1 (]: 13 of 43 START sql view model default.avg_discount_by_category ................. [RUN]
[0m14:34:16.102180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.stg_ecommerce, now model.dbt_databricks_cicd.avg_discount_by_category)
[0m14:34:16.102180 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=model.dbt_databricks_cicd.avg_discount_by_category, idle-time=0.015545845031738281s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.stg_ecommerce
[0m14:34:16.102180 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.avg_discount_by_category
[0m14:34:16.117788 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.avg_discount_by_category"
[0m14:34:16.117788 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.avg_discount_by_category
[0m14:34:16.133395 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:34:16.133395 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`avg_discount_by_category`
[0m14:34:16.133395 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.avg_discount_by_category"
[0m14:34:16.133395 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.avg_discount_by_category"
[0m14:34:16.133395 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.avg_discount_by_category: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.avg_discount_by_category"} */

  
  
  
  create or replace view `workspace`.`default`.`avg_discount_by_category`
  
  as (
    SELECT
  Category,
  ROUND(AVG(CAST(`Discount` AS DOUBLE)), 2) AS avg_discount_percent
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY Category
ORDER BY avg_discount_percent DESC
  )

[0m14:34:16.695402 [debug] [Thread-1 (]: SQL status: OK in 0.560 seconds
[0m14:34:16.695402 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-0df7-10c0-a926-4623921fc676) - Closing
[0m14:34:16.712251 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:34:16.714253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bb1fefb-a35c-4c29-a540-4067f1bb0921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193D65739D0>]}
[0m14:34:16.716251 [info ] [Thread-1 (]: 13 of 43 OK created sql view model default.avg_discount_by_category ............ [[32mOK[0m in 0.61s]
[0m14:34:16.717781 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.avg_discount_by_category
[0m14:34:16.719739 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.avg_ticket_by_category
[0m14:34:16.720878 [info ] [Thread-1 (]: 14 of 43 START sql view model default.avg_ticket_by_category ................... [RUN]
[0m14:34:16.723172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.avg_discount_by_category, now model.dbt_databricks_cicd.avg_ticket_by_category)
[0m14:34:16.724137 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=model.dbt_databricks_cicd.avg_ticket_by_category, idle-time=0.009884357452392578s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.avg_discount_by_category
[0m14:34:16.725187 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.avg_ticket_by_category
[0m14:34:16.732133 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.avg_ticket_by_category"
[0m14:34:16.735168 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.avg_ticket_by_category
[0m14:34:16.742170 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:34:16.744303 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`avg_ticket_by_category`
[0m14:34:16.746301 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.avg_ticket_by_category"
[0m14:34:16.748301 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.avg_ticket_by_category"
[0m14:34:16.751305 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.avg_ticket_by_category: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.avg_ticket_by_category"} */

  
  
  
  create or replace view `workspace`.`default`.`avg_ticket_by_category`
  
  as (
    SELECT
  Category,
  ROUND(AVG(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS avg_ticket
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY Category
ORDER BY avg_ticket DESC
  )

[0m14:34:17.399134 [debug] [Thread-1 (]: SQL status: OK in 0.650 seconds
[0m14:34:17.399134 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-0e53-1b96-ba00-3202d451ac4f) - Closing
[0m14:34:17.399134 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:34:17.414624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bb1fefb-a35c-4c29-a540-4067f1bb0921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193D6562F10>]}
[0m14:34:17.414624 [info ] [Thread-1 (]: 14 of 43 OK created sql view model default.avg_ticket_by_category .............. [[32mOK[0m in 0.69s]
[0m14:34:17.414624 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.avg_ticket_by_category
[0m14:34:17.414624 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.monthly_revenue
[0m14:34:17.414624 [info ] [Thread-1 (]: 15 of 43 START sql view model default.monthly_revenue .......................... [RUN]
[0m14:34:17.414624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.avg_ticket_by_category, now model.dbt_databricks_cicd.monthly_revenue)
[0m14:34:17.414624 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=model.dbt_databricks_cicd.monthly_revenue, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.avg_ticket_by_category
[0m14:34:17.414624 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.monthly_revenue
[0m14:34:17.430247 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.monthly_revenue"
[0m14:34:17.430247 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.monthly_revenue
[0m14:34:17.430247 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:34:17.430247 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`monthly_revenue`
[0m14:34:17.445879 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.monthly_revenue"
[0m14:34:17.445879 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.monthly_revenue"
[0m14:34:17.445879 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.monthly_revenue: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.monthly_revenue"} */

  
  
  
  create or replace view `workspace`.`default`.`monthly_revenue`
  
  as (
    SELECT
  CAST(DATE_TRUNC('month', CAST(Purchase_Date AS DATE)) AS DATE) AS month,
  ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS monthly_revenue
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY 1
ORDER BY 1
  )

[0m14:34:18.133204 [debug] [Thread-1 (]: SQL status: OK in 0.690 seconds
[0m14:34:18.133204 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-0ebe-1468-a74c-3d9195b585cf) - Closing
[0m14:34:18.148832 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:34:18.148832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bb1fefb-a35c-4c29-a540-4067f1bb0921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193D6587450>]}
[0m14:34:18.148832 [info ] [Thread-1 (]: 15 of 43 OK created sql view model default.monthly_revenue ..................... [[32mOK[0m in 0.73s]
[0m14:34:18.148832 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.monthly_revenue
[0m14:34:18.148832 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.payment_distribution
[0m14:34:18.148832 [info ] [Thread-1 (]: 16 of 43 START sql view model default.payment_distribution ..................... [RUN]
[0m14:34:18.148832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.monthly_revenue, now model.dbt_databricks_cicd.payment_distribution)
[0m14:34:18.148832 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=model.dbt_databricks_cicd.payment_distribution, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.monthly_revenue
[0m14:34:18.164476 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.payment_distribution
[0m14:34:18.164476 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.payment_distribution"
[0m14:34:18.164476 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.payment_distribution
[0m14:34:18.180122 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:34:18.180122 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`payment_distribution`
[0m14:34:18.180122 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.payment_distribution"
[0m14:34:18.180122 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.payment_distribution"
[0m14:34:18.180122 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.payment_distribution: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.payment_distribution"} */

  
  
  
  create or replace view `workspace`.`default`.`payment_distribution`
  
  as (
    SELECT
  Payment_Method,
  COUNT(*) AS total_transactions,
  ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS total_value
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY Payment_Method
ORDER BY total_value DESC
  )

[0m14:34:18.898827 [debug] [Thread-1 (]: SQL status: OK in 0.720 seconds
[0m14:34:18.898827 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-0f2f-1fa8-81c1-8965fe345cbd) - Closing
[0m14:34:18.898827 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:34:18.898827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bb1fefb-a35c-4c29-a540-4067f1bb0921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193D661B7D0>]}
[0m14:34:18.898827 [info ] [Thread-1 (]: 16 of 43 OK created sql view model default.payment_distribution ................ [[32mOK[0m in 0.75s]
[0m14:34:18.898827 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.payment_distribution
[0m14:34:18.914459 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.sales_by_category
[0m14:34:18.914459 [info ] [Thread-1 (]: 17 of 43 START sql view model default.sales_by_category ........................ [RUN]
[0m14:34:18.914459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.payment_distribution, now model.dbt_databricks_cicd.sales_by_category)
[0m14:34:18.914459 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=model.dbt_databricks_cicd.sales_by_category, idle-time=0.01563262939453125s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.payment_distribution
[0m14:34:18.914459 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.sales_by_category
[0m14:34:18.914459 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.sales_by_category"
[0m14:34:18.930080 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.sales_by_category
[0m14:34:18.930080 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:34:18.930080 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`sales_by_category`
[0m14:34:18.930080 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.sales_by_category"
[0m14:34:18.930080 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.sales_by_category"
[0m14:34:18.945745 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.sales_by_category: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.sales_by_category"} */

  
  
  
  create or replace view `workspace`.`default`.`sales_by_category`
  
  as (
    SELECT
  Category,
  COUNT(*) AS total_orders,
  ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS total_revenue
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY Category
ORDER BY total_revenue DESC
  )

[0m14:34:19.696079 [debug] [Thread-1 (]: SQL status: OK in 0.750 seconds
[0m14:34:19.696079 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-0fa2-1578-ab38-31b9d551067b) - Closing
[0m14:34:19.711707 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:34:19.711707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bb1fefb-a35c-4c29-a540-4067f1bb0921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193D65FD7D0>]}
[0m14:34:19.711707 [info ] [Thread-1 (]: 17 of 43 OK created sql view model default.sales_by_category ................... [[32mOK[0m in 0.80s]
[0m14:34:19.711707 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.sales_by_category
[0m14:34:19.711707 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.top_5_products
[0m14:34:19.711707 [info ] [Thread-1 (]: 18 of 43 START sql view model default.top_5_products ........................... [RUN]
[0m14:34:19.711707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.sales_by_category, now model.dbt_databricks_cicd.top_5_products)
[0m14:34:19.711707 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=model.dbt_databricks_cicd.top_5_products, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.sales_by_category
[0m14:34:19.727328 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.top_5_products
[0m14:34:19.727328 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.top_5_products"
[0m14:34:19.727328 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.top_5_products
[0m14:34:19.742958 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:34:19.742958 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`top_5_products`
[0m14:34:19.742958 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.top_5_products"
[0m14:34:19.742958 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.top_5_products"
[0m14:34:19.742958 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.top_5_products: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.top_5_products"} */

  
  
  
  create or replace view `workspace`.`default`.`top_5_products`
  
  as (
    WITH base AS (
    SELECT
        product_id,
        ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS total_sales
    FROM `workspace`.`default`.`stg_ecommerce`
    GROUP BY product_id
)

SELECT
    product_id,
    total_sales
FROM base
ORDER BY total_sales DESC
LIMIT 5
  )

[0m14:34:20.367326 [debug] [Thread-1 (]: SQL status: OK in 0.620 seconds
[0m14:34:20.367326 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-101d-1a74-b091-30846769ca7e) - Closing
[0m14:34:20.367326 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:34:20.367326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bb1fefb-a35c-4c29-a540-4067f1bb0921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193D657F150>]}
[0m14:34:20.367326 [info ] [Thread-1 (]: 18 of 43 OK created sql view model default.top_5_products ...................... [[32mOK[0m in 0.66s]
[0m14:34:20.382816 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.top_5_products
[0m14:34:20.382816 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.top_customers
[0m14:34:20.382816 [info ] [Thread-1 (]: 19 of 43 START sql view model default.top_customers ............................ [RUN]
[0m14:34:20.382816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.top_5_products, now model.dbt_databricks_cicd.top_customers)
[0m14:34:20.382816 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=model.dbt_databricks_cicd.top_customers, idle-time=0.015490293502807617s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.top_5_products
[0m14:34:20.382816 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.top_customers
[0m14:34:20.398446 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.top_customers"
[0m14:34:20.398446 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.top_customers
[0m14:34:20.398446 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:34:20.398446 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`top_customers`
[0m14:34:20.398446 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.top_customers"
[0m14:34:20.414067 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.top_customers"
[0m14:34:20.414067 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.top_customers: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.top_customers"} */

  
  
  
  create or replace view `workspace`.`default`.`top_customers`
  
  as (
    SELECT
  User_ID,
  COUNT(*) AS total_orders,
  ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS total_spent
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY User_ID
ORDER BY total_spent DESC
LIMIT 10
  )

[0m14:34:20.976884 [debug] [Thread-1 (]: SQL status: OK in 0.560 seconds
[0m14:34:20.976884 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-1082-1a1b-aa58-213436fd7ef0) - Closing
[0m14:34:20.992370 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:34:20.992370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bb1fefb-a35c-4c29-a540-4067f1bb0921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193D6546AD0>]}
[0m14:34:20.992370 [info ] [Thread-1 (]: 19 of 43 OK created sql view model default.top_customers ....................... [[32mOK[0m in 0.61s]
[0m14:34:20.992370 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.top_customers
[0m14:34:20.992370 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m14:34:20.992370 [info ] [Thread-1 (]: 20 of 43 START test non_negative_avg_discount_by_category_avg_discount_percent . [RUN]
[0m14:34:20.992370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.top_customers, now test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f)
[0m14:34:20.992370 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.top_customers
[0m14:34:21.008001 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m14:34:21.008001 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f"
[0m14:34:21.008001 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m14:34:21.023627 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f"
[0m14:34:21.023627 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f"
[0m14:34:21.023627 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`avg_discount_by_category`
where TRY_CAST(REPLACE(avg_discount_percent, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m14:34:21.899228 [debug] [Thread-1 (]: SQL status: OK in 0.880 seconds
[0m14:34:21.899228 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-10e1-1ec6-b7fb-509b7e1cc9fa) - Closing
[0m14:34:21.899228 [info ] [Thread-1 (]: 20 of 43 PASS non_negative_avg_discount_by_category_avg_discount_percent ....... [[32mPASS[0m in 0.91s]
[0m14:34:21.914731 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m14:34:21.914731 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m14:34:21.914731 [info ] [Thread-1 (]: 21 of 43 START test not_null_avg_discount_by_category_Category ................. [RUN]
[0m14:34:21.914731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f, now test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b)
[0m14:34:21.914731 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b, idle-time=0.0155029296875s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m14:34:21.914731 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m14:34:21.930406 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b"
[0m14:34:21.930406 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m14:34:21.930406 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b"
[0m14:34:21.947625 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b"
[0m14:34:21.949665 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Category
from `workspace`.`default`.`avg_discount_by_category`
where Category is null



  
  
      
    ) dbt_internal_test
[0m14:34:22.286530 [debug] [Thread-1 (]: SQL status: OK in 0.330 seconds
[0m14:34:22.290614 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-116c-1c53-a18c-55ec0e6aaf56) - Closing
[0m14:34:22.293630 [info ] [Thread-1 (]: 21 of 43 PASS not_null_avg_discount_by_category_Category ....................... [[32mPASS[0m in 0.38s]
[0m14:34:22.295624 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m14:34:22.297617 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m14:34:22.298618 [info ] [Thread-1 (]: 22 of 43 START test not_null_avg_discount_by_category_avg_discount_percent ..... [RUN]
[0m14:34:22.300623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b, now test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101)
[0m14:34:22.302621 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101, idle-time=0.008994102478027344s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m14:34:22.304619 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m14:34:22.305674 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101"
[0m14:34:22.321302 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m14:34:22.321302 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101"
[0m14:34:22.321302 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101"
[0m14:34:22.321302 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_discount_percent
from `workspace`.`default`.`avg_discount_by_category`
where avg_discount_percent is null



  
  
      
    ) dbt_internal_test
[0m14:34:22.720190 [debug] [Thread-1 (]: SQL status: OK in 0.380 seconds
[0m14:34:22.724190 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-11a7-1f4d-88fa-3bb4dfcf2d3f) - Closing
[0m14:34:22.726191 [info ] [Thread-1 (]: 22 of 43 PASS not_null_avg_discount_by_category_avg_discount_percent ........... [[32mPASS[0m in 0.43s]
[0m14:34:22.727319 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m14:34:22.727319 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m14:34:22.727319 [info ] [Thread-1 (]: 23 of 43 START test non_negative_avg_ticket_by_category_avg_ticket ............. [RUN]
[0m14:34:22.727319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101, now test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095)
[0m14:34:22.727319 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095, idle-time=0.0011279582977294922s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m14:34:22.727319 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m14:34:22.742941 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095"
[0m14:34:22.742941 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m14:34:22.742941 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095"
[0m14:34:22.742941 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095"
[0m14:34:22.742941 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`avg_ticket_by_category`
where TRY_CAST(REPLACE(avg_ticket, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m14:34:23.524487 [debug] [Thread-1 (]: SQL status: OK in 0.770 seconds
[0m14:34:23.524487 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-11e8-1297-8fee-d3aa9aa2a460) - Closing
[0m14:34:23.524487 [info ] [Thread-1 (]: 23 of 43 PASS non_negative_avg_ticket_by_category_avg_ticket ................... [[32mPASS[0m in 0.80s]
[0m14:34:23.524487 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m14:34:23.524487 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m14:34:23.524487 [info ] [Thread-1 (]: 24 of 43 START test not_null_avg_ticket_by_category_Category ................... [RUN]
[0m14:34:23.540027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095, now test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f)
[0m14:34:23.540027 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f, idle-time=0.015539884567260742s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m14:34:23.540027 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m14:34:23.555647 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f"
[0m14:34:23.555647 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m14:34:23.571261 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f"
[0m14:34:23.571261 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f"
[0m14:34:23.571261 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Category
from `workspace`.`default`.`avg_ticket_by_category`
where Category is null



  
  
      
    ) dbt_internal_test
[0m14:34:23.930711 [debug] [Thread-1 (]: SQL status: OK in 0.360 seconds
[0m14:34:23.930711 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-1265-17a4-a3eb-fb2cdf26cedb) - Closing
[0m14:34:23.930711 [info ] [Thread-1 (]: 24 of 43 PASS not_null_avg_ticket_by_category_Category ......................... [[32mPASS[0m in 0.39s]
[0m14:34:23.930711 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m14:34:23.930711 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m14:34:23.930711 [info ] [Thread-1 (]: 25 of 43 START test not_null_avg_ticket_by_category_avg_ticket ................. [RUN]
[0m14:34:23.930711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f, now test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41)
[0m14:34:23.946339 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m14:34:23.946339 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m14:34:23.946339 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41"
[0m14:34:23.946339 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m14:34:23.961964 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41"
[0m14:34:23.961964 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41"
[0m14:34:23.961964 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_ticket
from `workspace`.`default`.`avg_ticket_by_category`
where avg_ticket is null



  
  
      
    ) dbt_internal_test
[0m14:34:24.326059 [debug] [Thread-1 (]: SQL status: OK in 0.360 seconds
[0m14:34:24.330059 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-12a1-14bc-9115-c3e7a37f716c) - Closing
[0m14:34:24.332061 [info ] [Thread-1 (]: 25 of 43 PASS not_null_avg_ticket_by_category_avg_ticket ....................... [[32mPASS[0m in 0.40s]
[0m14:34:24.334617 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m14:34:24.335561 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m14:34:24.336564 [info ] [Thread-1 (]: 26 of 43 START test non_negative_monthly_revenue_monthly_revenue ............... [RUN]
[0m14:34:24.337814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41, now test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294)
[0m14:34:24.339816 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294, idle-time=0.008757352828979492s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m14:34:24.340813 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m14:34:24.349854 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294"
[0m14:34:24.352805 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m14:34:24.359804 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294"
[0m14:34:24.363804 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294"
[0m14:34:24.364804 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`monthly_revenue`
where TRY_CAST(REPLACE(monthly_revenue, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m14:34:25.165746 [debug] [Thread-1 (]: SQL status: OK in 0.800 seconds
[0m14:34:25.165746 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-12dd-14eb-8729-0d846f3cd712) - Closing
[0m14:34:25.165746 [info ] [Thread-1 (]: 26 of 43 PASS non_negative_monthly_revenue_monthly_revenue ..................... [[32mPASS[0m in 0.83s]
[0m14:34:25.181234 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m14:34:25.181234 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m14:34:25.181234 [info ] [Thread-1 (]: 27 of 43 START test not_null_monthly_revenue_month ............................. [RUN]
[0m14:34:25.181234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294, now test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b)
[0m14:34:25.181234 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b, idle-time=0.015487194061279297s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m14:34:25.181234 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m14:34:25.196856 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b"
[0m14:34:25.196856 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m14:34:25.196856 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b"
[0m14:34:25.196856 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b"
[0m14:34:25.196856 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month
from `workspace`.`default`.`monthly_revenue`
where month is null



  
  
      
    ) dbt_internal_test
[0m14:34:25.586312 [debug] [Thread-1 (]: SQL status: OK in 0.370 seconds
[0m14:34:25.586312 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-135e-1ae5-8e06-5569a79956d3) - Closing
[0m14:34:25.586312 [info ] [Thread-1 (]: 27 of 43 PASS not_null_monthly_revenue_month ................................... [[32mPASS[0m in 0.41s]
[0m14:34:25.601821 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m14:34:25.601821 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m14:34:25.601821 [info ] [Thread-1 (]: 28 of 43 START test not_null_monthly_revenue_monthly_revenue ................... [RUN]
[0m14:34:25.601821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b, now test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b)
[0m14:34:25.601821 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b, idle-time=0.015508890151977539s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m14:34:25.601821 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m14:34:25.617453 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b"
[0m14:34:25.617453 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m14:34:25.617453 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b"
[0m14:34:25.633070 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b"
[0m14:34:25.633070 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select monthly_revenue
from `workspace`.`default`.`monthly_revenue`
where monthly_revenue is null



  
  
      
    ) dbt_internal_test
[0m14:34:25.992670 [debug] [Thread-1 (]: SQL status: OK in 0.360 seconds
[0m14:34:25.992670 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-139f-1a52-b723-1e176d39ac82) - Closing
[0m14:34:25.992670 [info ] [Thread-1 (]: 28 of 43 PASS not_null_monthly_revenue_monthly_revenue ......................... [[32mPASS[0m in 0.39s]
[0m14:34:25.992670 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m14:34:25.992670 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m14:34:26.008218 [info ] [Thread-1 (]: 29 of 43 START test non_negative_payment_distribution_total_value .............. [RUN]
[0m14:34:26.008218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b, now test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282)
[0m14:34:26.008218 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282, idle-time=0.015547752380371094s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m14:34:26.008218 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m14:34:26.008218 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282"
[0m14:34:26.023797 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m14:34:26.023797 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282"
[0m14:34:26.023797 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282"
[0m14:34:26.023797 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`payment_distribution`
where TRY_CAST(REPLACE(total_value, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m14:34:26.789986 [debug] [Thread-1 (]: SQL status: OK in 0.770 seconds
[0m14:34:26.805617 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-13db-1b4c-9d5e-f21412780b96) - Closing
[0m14:34:26.805617 [info ] [Thread-1 (]: 29 of 43 PASS non_negative_payment_distribution_total_value .................... [[32mPASS[0m in 0.80s]
[0m14:34:26.805617 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m14:34:26.805617 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m14:34:26.805617 [info ] [Thread-1 (]: 30 of 43 START test not_null_payment_distribution_Payment_Method ............... [RUN]
[0m14:34:26.805617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282, now test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae)
[0m14:34:26.805617 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m14:34:26.805617 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m14:34:26.821277 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae"
[0m14:34:26.821277 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m14:34:26.836903 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae"
[0m14:34:26.836903 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae"
[0m14:34:26.836903 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Payment_Method
from `workspace`.`default`.`payment_distribution`
where Payment_Method is null



  
  
      
    ) dbt_internal_test
[0m14:34:27.196624 [debug] [Thread-1 (]: SQL status: OK in 0.360 seconds
[0m14:34:27.200626 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-1457-1ba4-8bf0-b3dab48f4b48) - Closing
[0m14:34:27.202628 [info ] [Thread-1 (]: 30 of 43 PASS not_null_payment_distribution_Payment_Method ..................... [[32mPASS[0m in 0.40s]
[0m14:34:27.205544 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m14:34:27.207567 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m14:34:27.208571 [info ] [Thread-1 (]: 31 of 43 START test not_null_payment_distribution_total_transactions ........... [RUN]
[0m14:34:27.210539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae, now test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8)
[0m14:34:27.211587 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8, idle-time=0.008959531784057617s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m14:34:27.212776 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m14:34:27.212776 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8"
[0m14:34:27.212776 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m14:34:27.228413 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8"
[0m14:34:27.228413 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8"
[0m14:34:27.228413 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_transactions
from `workspace`.`default`.`payment_distribution`
where total_transactions is null



  
  
      
    ) dbt_internal_test
[0m14:34:27.555763 [debug] [Thread-1 (]: SQL status: OK in 0.330 seconds
[0m14:34:27.555763 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-1493-1426-bddf-27c442fdb16e) - Closing
[0m14:34:27.555763 [info ] [Thread-1 (]: 31 of 43 PASS not_null_payment_distribution_total_transactions ................. [[32mPASS[0m in 0.35s]
[0m14:34:27.571297 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m14:34:27.571297 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m14:34:27.571297 [info ] [Thread-1 (]: 32 of 43 START test not_null_payment_distribution_total_value .................. [RUN]
[0m14:34:27.571297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8, now test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03)
[0m14:34:27.571297 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03, idle-time=0.015533447265625s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m14:34:27.571297 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m14:34:27.586929 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03"
[0m14:34:27.586929 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m14:34:27.602528 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03"
[0m14:34:27.602528 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03"
[0m14:34:27.602528 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_value
from `workspace`.`default`.`payment_distribution`
where total_value is null



  
  
      
    ) dbt_internal_test
[0m14:34:27.976852 [debug] [Thread-1 (]: SQL status: OK in 0.370 seconds
[0m14:34:27.976852 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-14cc-1c40-b5d4-fbe69acb2ec9) - Closing
[0m14:34:27.976852 [info ] [Thread-1 (]: 32 of 43 PASS not_null_payment_distribution_total_value ........................ [[32mPASS[0m in 0.41s]
[0m14:34:27.976852 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m14:34:27.976852 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m14:34:27.976852 [info ] [Thread-1 (]: 33 of 43 START test non_negative_sales_by_category_total_revenue ............... [RUN]
[0m14:34:27.976852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03, now test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41)
[0m14:34:27.992488 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41, idle-time=0.015636205673217773s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m14:34:27.992488 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m14:34:27.992488 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41"
[0m14:34:27.992488 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m14:34:28.008099 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41"
[0m14:34:28.008099 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41"
[0m14:34:28.008099 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`sales_by_category`
where TRY_CAST(REPLACE(total_revenue, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m14:34:28.695720 [debug] [Thread-1 (]: SQL status: OK in 0.690 seconds
[0m14:34:28.711344 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-150a-1630-8e6b-414ffda2bb0b) - Closing
[0m14:34:28.711344 [info ] [Thread-1 (]: 33 of 43 PASS non_negative_sales_by_category_total_revenue ..................... [[32mPASS[0m in 0.73s]
[0m14:34:28.711344 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m14:34:28.711344 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m14:34:28.726969 [info ] [Thread-1 (]: 34 of 43 START test not_null_sales_by_category_Category ........................ [RUN]
[0m14:34:28.726969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41, now test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507)
[0m14:34:28.726969 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507, idle-time=0.015625s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m14:34:28.726969 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m14:34:28.742588 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507"
[0m14:34:28.758248 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m14:34:28.758248 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507"
[0m14:34:28.773843 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507"
[0m14:34:28.773843 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Category
from `workspace`.`default`.`sales_by_category`
where Category is null



  
  
      
    ) dbt_internal_test
[0m14:34:29.118487 [debug] [Thread-1 (]: SQL status: OK in 0.340 seconds
[0m14:34:29.133981 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-157e-15a2-bfda-70fca9bc137b) - Closing
[0m14:34:29.133981 [info ] [Thread-1 (]: 34 of 43 PASS not_null_sales_by_category_Category .............................. [[32mPASS[0m in 0.41s]
[0m14:34:29.133981 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m14:34:29.133981 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m14:34:29.133981 [info ] [Thread-1 (]: 35 of 43 START test not_null_sales_by_category_total_orders .................... [RUN]
[0m14:34:29.133981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507, now test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e)
[0m14:34:29.133981 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m14:34:29.133981 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m14:34:29.153900 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e"
[0m14:34:29.155912 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m14:34:29.162900 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e"
[0m14:34:29.163953 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e"
[0m14:34:29.163953 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from `workspace`.`default`.`sales_by_category`
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m14:34:29.489259 [debug] [Thread-1 (]: SQL status: OK in 0.330 seconds
[0m14:34:29.492478 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-15b9-1d8d-87f6-97e55e5b3b1d) - Closing
[0m14:34:29.492478 [info ] [Thread-1 (]: 35 of 43 PASS not_null_sales_by_category_total_orders .......................... [[32mPASS[0m in 0.36s]
[0m14:34:29.492478 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m14:34:29.492478 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m14:34:29.492478 [info ] [Thread-1 (]: 36 of 43 START test not_null_sales_by_category_total_revenue ................... [RUN]
[0m14:34:29.492478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e, now test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd)
[0m14:34:29.492478 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m14:34:29.492478 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m14:34:29.508107 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd"
[0m14:34:29.523766 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m14:34:29.523766 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd"
[0m14:34:29.523766 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd"
[0m14:34:29.523766 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from `workspace`.`default`.`sales_by_category`
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m14:34:29.894187 [debug] [Thread-1 (]: SQL status: OK in 0.370 seconds
[0m14:34:29.897190 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-15f2-18b1-abc8-5554d0994653) - Closing
[0m14:34:29.900376 [info ] [Thread-1 (]: 36 of 43 PASS not_null_sales_by_category_total_revenue ......................... [[32mPASS[0m in 0.41s]
[0m14:34:29.902340 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m14:34:29.904338 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m14:34:29.906335 [info ] [Thread-1 (]: 37 of 43 START test non_negative_top_5_products_total_sales .................... [RUN]
[0m14:34:29.908005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd, now test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34)
[0m14:34:29.909001 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34, idle-time=0.009667158126831055s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m14:34:29.910004 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m14:34:29.919001 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34"
[0m14:34:29.921004 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m14:34:29.928000 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34"
[0m14:34:29.931070 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34"
[0m14:34:29.931070 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`top_5_products`
where TRY_CAST(REPLACE(total_sales, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m14:34:30.574288 [debug] [Thread-1 (]: SQL status: OK in 0.640 seconds
[0m14:34:30.578327 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-162e-1969-b451-dc94f69aa148) - Closing
[0m14:34:30.580332 [info ] [Thread-1 (]: 37 of 43 PASS non_negative_top_5_products_total_sales .......................... [[32mPASS[0m in 0.67s]
[0m14:34:30.582296 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m14:34:30.583296 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m14:34:30.585294 [info ] [Thread-1 (]: 38 of 43 START test not_null_top_5_products_product_id ......................... [RUN]
[0m14:34:30.587394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34, now test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe)
[0m14:34:30.587394 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe, idle-time=0.008081197738647461s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m14:34:30.587394 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m14:34:30.587394 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe"
[0m14:34:30.587394 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m14:34:30.603089 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe"
[0m14:34:30.603089 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe"
[0m14:34:30.603089 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `workspace`.`default`.`top_5_products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:34:30.977400 [debug] [Thread-1 (]: SQL status: OK in 0.370 seconds
[0m14:34:30.977400 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-1696-1c6f-ba7e-fbf3da9e3a9b) - Closing
[0m14:34:30.993160 [info ] [Thread-1 (]: 38 of 43 PASS not_null_top_5_products_product_id ............................... [[32mPASS[0m in 0.41s]
[0m14:34:30.994984 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m14:34:30.996940 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m14:34:30.998939 [info ] [Thread-1 (]: 39 of 43 START test not_null_top_5_products_total_sales ........................ [RUN]
[0m14:34:31.000550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe, now test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818)
[0m14:34:31.001549 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818, idle-time=0.008662700653076172s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m14:34:31.002550 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m14:34:31.012549 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818"
[0m14:34:31.014549 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m14:34:31.020551 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818"
[0m14:34:31.023550 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818"
[0m14:34:31.025120 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_sales
from `workspace`.`default`.`top_5_products`
where total_sales is null



  
  
      
    ) dbt_internal_test
[0m14:34:31.391079 [debug] [Thread-1 (]: SQL status: OK in 0.360 seconds
[0m14:34:31.394080 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-16d5-179f-8778-497c39dc4e01) - Closing
[0m14:34:31.396080 [info ] [Thread-1 (]: 39 of 43 PASS not_null_top_5_products_total_sales .............................. [[32mPASS[0m in 0.40s]
[0m14:34:31.399444 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m14:34:31.399444 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m14:34:31.399444 [info ] [Thread-1 (]: 40 of 43 START test non_negative_top_customers_total_spent ..................... [RUN]
[0m14:34:31.399444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818, now test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667)
[0m14:34:31.399444 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667, idle-time=0.0033648014068603516s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m14:34:31.399444 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m14:34:31.415123 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667"
[0m14:34:31.415123 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m14:34:31.430739 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667"
[0m14:34:31.430739 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667"
[0m14:34:31.430739 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`top_customers`
where TRY_CAST(REPLACE(total_spent, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m14:34:32.148914 [debug] [Thread-1 (]: SQL status: OK in 0.720 seconds
[0m14:34:32.148914 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-1714-1638-b123-7b0bce203065) - Closing
[0m14:34:32.148914 [info ] [Thread-1 (]: 40 of 43 PASS non_negative_top_customers_total_spent ........................... [[32mPASS[0m in 0.75s]
[0m14:34:32.164409 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m14:34:32.164409 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m14:34:32.164409 [info ] [Thread-1 (]: 41 of 43 START test not_null_top_customers_User_ID ............................. [RUN]
[0m14:34:32.164409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667, now test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0)
[0m14:34:32.164409 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0, idle-time=0.015495538711547852s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m14:34:32.164409 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m14:34:32.180069 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0"
[0m14:34:32.180069 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m14:34:32.180069 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0"
[0m14:34:32.180069 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0"
[0m14:34:32.180069 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select User_ID
from `workspace`.`default`.`top_customers`
where User_ID is null



  
  
      
    ) dbt_internal_test
[0m14:34:32.555628 [debug] [Thread-1 (]: SQL status: OK in 0.380 seconds
[0m14:34:32.555628 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-1788-10ac-8729-202e6ffc14ba) - Closing
[0m14:34:32.555628 [info ] [Thread-1 (]: 41 of 43 PASS not_null_top_customers_User_ID ................................... [[32mPASS[0m in 0.39s]
[0m14:34:32.555628 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m14:34:32.555628 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m14:34:32.555628 [info ] [Thread-1 (]: 42 of 43 START test not_null_top_customers_total_orders ........................ [RUN]
[0m14:34:32.571254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0, now test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746)
[0m14:34:32.571254 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746, idle-time=0.01562666893005371s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m14:34:32.571254 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m14:34:32.586888 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746"
[0m14:34:32.586888 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m14:34:32.586888 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746"
[0m14:34:32.602506 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746"
[0m14:34:32.602506 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from `workspace`.`default`.`top_customers`
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m14:34:32.946206 [debug] [Thread-1 (]: SQL status: OK in 0.340 seconds
[0m14:34:32.946206 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-17c8-1109-a6ec-c99bdeeb8ada) - Closing
[0m14:34:32.962918 [info ] [Thread-1 (]: 42 of 43 PASS not_null_top_customers_total_orders .............................. [[32mPASS[0m in 0.39s]
[0m14:34:32.964896 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m14:34:32.966879 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73
[0m14:34:32.968922 [info ] [Thread-1 (]: 43 of 43 START test not_null_top_customers_total_spent ......................... [RUN]
[0m14:34:32.970664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746, now test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73)
[0m14:34:32.971665 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, name=test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73, idle-time=0.008747100830078125s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m14:34:32.972664 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73
[0m14:34:32.982661 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73"
[0m14:34:32.984668 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73
[0m14:34:32.991661 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73"
[0m14:34:32.994020 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73"
[0m14:34:32.994020 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_spent
from `workspace`.`default`.`top_customers`
where total_spent is null



  
  
      
    ) dbt_internal_test
[0m14:34:33.321984 [debug] [Thread-1 (]: SQL status: OK in 0.330 seconds
[0m14:34:33.321984 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d, command-id=01f0836c-1802-1202-b623-be6cd0ecd24b) - Closing
[0m14:34:33.321984 [info ] [Thread-1 (]: 43 of 43 PASS not_null_top_customers_total_spent ............................... [[32mPASS[0m in 0.35s]
[0m14:34:33.321984 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73
[0m14:34:33.321984 [debug] [MainThread]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=master, idle-time=23.961212635040283s, language=None, compute-name=) - Reusing connection previously named master
[0m14:34:33.337614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:34:33.337614 [debug] [MainThread]: Connection 'list_workspace' was properly closed.
[0m14:34:33.337614 [debug] [MainThread]: On list_workspace: Close
[0m14:34:33.337614 [debug] [MainThread]: Databricks adapter: Connection(session-id=01f0836c-08c7-1437-891a-73d72a59597b) - Closing
[0m14:34:33.539351 [debug] [MainThread]: Connection 'list_workspace_default' was properly closed.
[0m14:34:33.539351 [debug] [MainThread]: On list_workspace_default: Close
[0m14:34:33.539351 [debug] [MainThread]: Databricks adapter: Connection(session-id=01f0836c-0981-1184-add7-217c3f87b555) - Closing
[0m14:34:33.758483 [debug] [MainThread]: Connection 'test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73' was properly closed.
[0m14:34:33.758483 [debug] [MainThread]: On test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73: Close
[0m14:34:33.758483 [debug] [MainThread]: Databricks adapter: Connection(session-id=01f0836c-0a54-1a00-9a6e-919769e2038d) - Closing
[0m14:34:33.976745 [info ] [MainThread]: 
[0m14:34:33.976745 [info ] [MainThread]: Finished running 34 data tests, 9 view models in 0 hours 0 minutes and 27.12 seconds (27.12s).
[0m14:34:33.992380 [debug] [MainThread]: Command end result
[0m14:34:34.070506 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m14:34:34.070506 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m14:34:34.086129 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m14:34:34.086129 [info ] [MainThread]: 
[0m14:34:34.101785 [info ] [MainThread]: [31mCompleted with 10 errors, 0 partial successes, and 0 warnings:[0m
[0m14:34:34.101785 [info ] [MainThread]: 
[0m14:34:34.101785 [error] [MainThread]: [31mFailure in test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:34:34.101785 [error] [MainThread]:   Database Error in test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 20 pos 9
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_accepted_values_sqlserv_e814246ceecd68245cb8ed7332e2da84.sql
[0m14:34:34.101785 [info ] [MainThread]: 
[0m14:34:34.101785 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_accepted_values_sqlserv_e814246ceecd68245cb8ed7332e2da84.sql
[0m14:34:34.101785 [info ] [MainThread]: 
[0m14:34:34.101785 [error] [MainThread]: [31mFailure in test source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_ (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:34:34.101785 [error] [MainThread]:   Got 8 results, configured to fail if != 0
[0m14:34:34.117385 [info ] [MainThread]: 
[0m14:34:34.117385 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_assert_source_structure_0af1e5f4dda30d85443523174084b59d.sql
[0m14:34:34.117385 [info ] [MainThread]: 
[0m14:34:34.117385 [error] [MainThread]: [31mFailure in test source_not_null_sqlserver_ecommerce_Category (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:34:34.117385 [error] [MainThread]:   Database Error in test source_not_null_sqlserver_ecommerce_Category (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Category.sql
[0m14:34:34.117385 [info ] [MainThread]: 
[0m14:34:34.117385 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Category.sql
[0m14:34:34.117385 [info ] [MainThread]: 
[0m14:34:34.133002 [error] [MainThread]: [31mFailure in test source_not_null_sqlserver_ecommerce_Discount (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:34:34.133002 [error] [MainThread]:   Database Error in test source_not_null_sqlserver_ecommerce_Discount (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Discount.sql
[0m14:34:34.133002 [info ] [MainThread]: 
[0m14:34:34.133002 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Discount.sql
[0m14:34:34.133002 [info ] [MainThread]: 
[0m14:34:34.133002 [error] [MainThread]: [31mFailure in test source_not_null_sqlserver_ecommerce_Final_Price (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:34:34.133002 [error] [MainThread]:   Database Error in test source_not_null_sqlserver_ecommerce_Final_Price (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Final_Price.sql
[0m14:34:34.133002 [info ] [MainThread]: 
[0m14:34:34.148631 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Final_Price.sql
[0m14:34:34.148631 [info ] [MainThread]: 
[0m14:34:34.148631 [error] [MainThread]: [31mFailure in test source_not_null_sqlserver_ecommerce_Payment_Method (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:34:34.148631 [error] [MainThread]:   Database Error in test source_not_null_sqlserver_ecommerce_Payment_Method (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Payment_Method.sql
[0m14:34:34.148631 [info ] [MainThread]: 
[0m14:34:34.148631 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Payment_Method.sql
[0m14:34:34.148631 [info ] [MainThread]: 
[0m14:34:34.166566 [error] [MainThread]: [31mFailure in test source_not_null_sqlserver_ecommerce_Price (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:34:34.169444 [error] [MainThread]:   Database Error in test source_not_null_sqlserver_ecommerce_Price (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Price.sql
[0m14:34:34.171927 [info ] [MainThread]: 
[0m14:34:34.174211 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Price.sql
[0m14:34:34.175210 [info ] [MainThread]: 
[0m14:34:34.177221 [error] [MainThread]: [31mFailure in test source_not_null_sqlserver_ecommerce_Product_ID (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:34:34.178211 [error] [MainThread]:   Database Error in test source_not_null_sqlserver_ecommerce_Product_ID (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Product_ID.sql
[0m14:34:34.183186 [info ] [MainThread]: 
[0m14:34:34.185175 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Product_ID.sql
[0m14:34:34.187171 [info ] [MainThread]: 
[0m14:34:34.188175 [error] [MainThread]: [31mFailure in test source_not_null_sqlserver_ecommerce_Purchase_Date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:34:34.190172 [error] [MainThread]:   Database Error in test source_not_null_sqlserver_ecommerce_Purchase_Date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Purchase_Date.sql
[0m14:34:34.191174 [info ] [MainThread]: 
[0m14:34:34.193178 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Purchase_Date.sql
[0m14:34:34.194175 [info ] [MainThread]: 
[0m14:34:34.196289 [error] [MainThread]: [31mFailure in test source_not_null_sqlserver_ecommerce_User_ID (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:34:34.196289 [error] [MainThread]:   Database Error in test source_not_null_sqlserver_ecommerce_User_ID (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_User_ID.sql
[0m14:34:34.196289 [info ] [MainThread]: 
[0m14:34:34.196289 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_User_ID.sql
[0m14:34:34.196289 [info ] [MainThread]: 
[0m14:34:34.196289 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=10 SKIP=0 NO-OP=0 TOTAL=43
[0m14:34:34.196289 [debug] [MainThread]: Command `dbt build` failed at 14:34:34.196289 after 34.04 seconds
[0m14:34:34.211912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193C2CF3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193C2F511D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193C2F510D0>]}
[0m14:34:34.211912 [debug] [MainThread]: Flushing usage events
[0m14:34:34.961058 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:36:04.988578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEEB439C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEEB48B4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEEB45FCD0>]}


============================== 14:36:04.996678 | b3ba7014-c16b-408e-954e-8db5e4f06c3a ==============================
[0m14:36:04.996678 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:36:04.999681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --target databricks', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:36:06.898864 [debug] [MainThread]: Spark adapter: Setting pyhive.hive logging to ERROR
[0m14:36:06.898864 [debug] [MainThread]: Spark adapter: Setting thrift.transport logging to ERROR
[0m14:36:06.898864 [debug] [MainThread]: Spark adapter: Setting thrift.protocol logging to ERROR
[0m14:36:08.648799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3ba7014-c16b-408e-954e-8db5e4f06c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEF4411F90>]}
[0m14:36:08.789426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3ba7014-c16b-408e-954e-8db5e4f06c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEEABA9B50>]}
[0m14:36:08.789426 [info ] [MainThread]: Registered adapter: databricks=1.10.4
[0m14:36:09.883428 [debug] [MainThread]: checksum: 3fbc73d786818920aecb1b2190495121ce0b60768fe54c46d521f1e82da30af9, vars: {}, profile: , target: databricks, version: 1.10.3
[0m14:36:10.445708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:36:10.445708 [debug] [MainThread]: Partial parsing: updated file: dbt_databricks_cicd://macros\assert_source_structure.sql
[0m14:36:11.164352 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m14:36:11.180002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3ba7014-c16b-408e-954e-8db5e4f06c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEF7BE5CD0>]}
[0m14:36:11.367817 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m14:36:11.367817 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m14:36:11.461593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3ba7014-c16b-408e-954e-8db5e4f06c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEF7EE3710>]}
[0m14:36:11.461593 [info ] [MainThread]: Found 9 models, 34 data tests, 1 source, 799 macros
[0m14:36:11.477224 [info ] [MainThread]: 
[0m14:36:11.477224 [info ] [MainThread]: Concurrency: 1 threads (target='databricks')
[0m14:36:11.477224 [info ] [MainThread]: 
[0m14:36:11.477224 [debug] [MainThread]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=master, idle-time=0s, language=None, compute-name=) - Creating connection
[0m14:36:11.492885 [debug] [MainThread]: Acquiring new databricks connection 'master'
[0m14:36:11.508473 [debug] [ThreadPool]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=list_workspace, idle-time=0s, language=None, compute-name=) - Creating connection
[0m14:36:11.508473 [debug] [ThreadPool]: Acquiring new databricks connection 'list_workspace'
[0m14:36:11.508473 [debug] [ThreadPool]: Using databricks connection "list_workspace"
[0m14:36:11.508473 [debug] [ThreadPool]: On list_workspace: GetSchemas(database=workspace, schema=None)
[0m14:36:11.508473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:12.274079 [debug] [ThreadPool]: Databricks adapter: Connection(session-id=01f0836c-5311-1729-bc06-e568f4b0b2c1) - Created
[0m14:36:12.789631 [debug] [ThreadPool]: SQL status: OK in 1.280 seconds
[0m14:36:12.789631 [debug] [ThreadPool]: Databricks adapter: Cursor(session-id=01f0836c-5311-1729-bc06-e568f4b0b2c1, command-id=01f0836c-5336-10e6-bd12-8d664e17cecb) - Closing
[0m14:36:12.789631 [debug] [ThreadPool]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=list_workspace_default, idle-time=0s, language=None, compute-name=) - Creating connection
[0m14:36:12.789631 [debug] [ThreadPool]: Acquiring new databricks connection 'list_workspace_default'
[0m14:36:12.820757 [debug] [ThreadPool]: Using databricks connection "list_workspace_default"
[0m14:36:12.820757 [debug] [ThreadPool]: On list_workspace_default: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "connection_name": "list_workspace_default"} */

    
SELECT
  table_name,
  if(table_type IN ('EXTERNAL', 'MANAGED', 'MANAGED_SHALLOW_CLONE', 'EXTERNAL_SHALLOW_CLONE'), 'table', lower(table_type)) AS table_type,
  lower(data_source_format) AS file_format,
  table_owner
FROM `system`.`information_schema`.`tables`
WHERE table_catalog = 'workspace' 
  AND table_schema = 'default'

  
[0m14:36:12.820757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:13.555125 [debug] [ThreadPool]: Databricks adapter: Connection(session-id=01f0836c-53d5-1823-a1e6-ab020d3e25be) - Created
[0m14:36:14.110089 [debug] [ThreadPool]: SQL status: OK in 1.290 seconds
[0m14:36:14.120220 [debug] [ThreadPool]: Databricks adapter: Cursor(session-id=01f0836c-53d5-1823-a1e6-ab020d3e25be, command-id=01f0836c-53fa-1a00-b749-b033816c67c6) - Closing
[0m14:36:14.126228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3ba7014-c16b-408e-954e-8db5e4f06c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEF79F47D0>]}
[0m14:36:14.133579 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce
[0m14:36:14.133579 [info ] [Thread-1 (]: 1 of 43 START sql view model default.src_ecommerce ............................. [RUN]
[0m14:36:14.133579 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=model.dbt_databricks_cicd.src_ecommerce, idle-time=0s, language=None, compute-name=) - Creating connection
[0m14:36:14.133579 [debug] [Thread-1 (]: Acquiring new databricks connection 'model.dbt_databricks_cicd.src_ecommerce'
[0m14:36:14.133579 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.src_ecommerce
[0m14:36:14.149207 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.src_ecommerce"
[0m14:36:14.149207 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.src_ecommerce
[0m14:36:14.183960 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:36:14.187959 [warn ] [Thread-1 (]: [[33mWARNING[0m]: Use revamped materializations based on separating create and insert.  This allows more performant column comments, as well as new column features.
You may opt into the new behavior sooner by setting `flags.use_materialization_v2` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m14:36:14.189868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'b3ba7014-c16b-408e-954e-8db5e4f06c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEF77F2C10>]}
[0m14:36:14.212625 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`src_ecommerce`
[0m14:36:14.228250 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.src_ecommerce"
[0m14:36:14.228250 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.src_ecommerce"
[0m14:36:14.243845 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.src_ecommerce"} */

  
  
  
  create or replace view `workspace`.`default`.`src_ecommerce`
  
  as (
    SELECT * FROM default.sales_ecommerce
  )

[0m14:36:14.243845 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:36:14.962039 [debug] [Thread-1 (]: Databricks adapter: Connection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d) - Created
[0m14:36:15.524132 [debug] [Thread-1 (]: SQL status: OK in 1.280 seconds
[0m14:36:15.539615 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-54c9-19bf-8043-756a92404808) - Closing
[0m14:36:15.555246 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:36:15.555246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3ba7014-c16b-408e-954e-8db5e4f06c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEF7F26650>]}
[0m14:36:15.555246 [info ] [Thread-1 (]: 1 of 43 OK created sql view model default.src_ecommerce ........................ [[32mOK[0m in 1.42s]
[0m14:36:15.555246 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce
[0m14:36:15.570866 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:36:15.570866 [info ] [Thread-1 (]: 2 of 43 START test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [RUN]
[0m14:36:15.570866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.src_ecommerce, now test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8)
[0m14:36:15.570866 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8, idle-time=0.015619516372680664s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.src_ecommerce
[0m14:36:15.570866 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:36:15.586502 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:36:15.586502 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:36:15.626642 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:36:15.629613 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:36:15.630644 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from `my_db`.`dbo`.`ecommerce`
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    'Credit Card','Net Banking','UPI','Debit Card','Cash on Delivery'
)



  
  
      
    ) dbt_internal_test
[0m14:36:16.087309 [debug] [Thread-1 (]: Databricks adapter: Exception while trying to execute query
/* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from `my_db`.`dbo`.`ecommerce`
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    'Credit Card','Net Banking','UPI','Debit Card','Cash on Delivery'
)



  
  
      
    ) dbt_internal_test
: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 20 pos 9
Error properties: diagnostic-info=org.apache.hive.service.cli.HiveSQLException: Error running query: [TABLE_OR_VIEW_NOT_FOUND] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 20 pos 9
	at org.apache.spark.sql.hive.thriftserver.HiveThriftServerErrors$.runningQueryError(HiveThriftServerErrors.scala:49)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:1036)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.org$apache$spark$sql$hive$thriftserver$SparkExecuteStatementOperation$$execute(SparkExecuteStatementOperation.scala:785)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$5(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.execution.SQLExecution$.withRootExecution(SQLExecution.scala:746)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$2(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.DatabricksTracingHelper.withAttributionContext(DatabricksSparkTracingHelper.scala:18)
	at com.databricks.spark.util.DatabricksTracingHelper.withSpanFromRequest(DatabricksSparkTracingHelper.scala:42)
	at com.databricks.spark.util.DBRTracing$.withSpanFromRequest(DBRTracing.scala:43)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$15(ThriftLocalProperties.scala:236)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:96)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:77)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags0(DatabricksSparkUsageLogger.scala:124)
	at com.databricks.spark.util.DatabricksSparkUsageLogger.withAttributionTags(DatabricksSparkUsageLogger.scala:232)
	at com.databricks.spark.util.UsageLogging.$anonfun$withAttributionTags$1(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:780)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:789)
	at com.databricks.spark.util.UsageLogging.withAttributionTags(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging.withAttributionTags$(UsageLogger.scala:666)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withAttributionTags(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$12(ThriftLocalProperties.scala:233)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties(ThriftLocalProperties.scala:229)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties$(ThriftLocalProperties.scala:89)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withLocalProperties(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:549)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:535)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2.run(SparkExecuteStatementOperation.scala:585)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 20 pos 9
	at org.apache.spark.sql.catalyst.ExtendedAnalysisException.copyPlan(ExtendedAnalysisException.scala:91)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:997)
	... 53 more
, operation-id=01f0836c-552f-18be-8cd3-01471c23b72e
[0m14:36:16.102869 [debug] [Thread-1 (]: Database Error in test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 20 pos 9
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_accepted_values_sqlserv_e814246ceecd68245cb8ed7332e2da84.sql
[0m14:36:16.102869 [error] [Thread-1 (]: 2 of 43 ERROR source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [[31mERROR[0m in 0.53s]
[0m14:36:16.102869 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:36:16.102869 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:36:16.118441 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8' to be skipped because of status 'error'.  Reason: Database Error in test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 20 pos 9
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_accepted_values_sqlserv_e814246ceecd68245cb8ed7332e2da84.sql.
[0m14:36:16.118441 [info ] [Thread-1 (]: 3 of 43 START test source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_  [RUN]
[0m14:36:16.118441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8, now test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef)
[0m14:36:16.118441 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef, idle-time=0.015571832656860352s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:36:16.118441 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:36:16.134107 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:36:16.134107 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:36:16.134107 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:36:16.153207 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:36:16.154213 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    with actual as (
        select 
            column_name, data_type
        from INFORMATION_SCHEMA.COLUMNS
        where table_name = 'ecommerce'
          and table_schema = 'dbo'
    ),
    expected as (
        select * from (
            values
            
                ('Category', 'varchar'),
            
                ('Discount', 'int'),
            
                ('Final_Price', 'float'),
            
                ('Payment_Method', 'varchar'),
            
                ('Price', 'float'),
            
                ('Product_ID', 'varchar'),
            
                ('Purchase_Date', 'date'),
            
                ('User_ID', 'varchar')
            
        ) as t(column_name, data_type)
    )
    select
        e.column_name,
        e.data_type
    from expected e
    left join actual a
        on e.column_name = a.column_name
       and e.data_type = a.data_type
    where a.column_name is null

  
  
      
    ) dbt_internal_test
[0m14:36:16.789829 [debug] [Thread-1 (]: SQL status: OK in 0.630 seconds
[0m14:36:16.807610 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-557f-1766-81b7-e48ef14e0f54) - Closing
[0m14:36:16.812609 [error] [Thread-1 (]: 3 of 43 FAIL 8 source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_  [[31mFAIL 8[0m in 0.69s]
[0m14:36:16.815316 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:36:16.816314 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:36:16.817315 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef' to be skipped because of status 'fail'.  Reason: Got 8 results, configured to fail if != 0.
[0m14:36:16.818308 [info ] [Thread-1 (]: 4 of 43 START test source_not_null_sqlserver_ecommerce_Category ................ [RUN]
[0m14:36:16.820308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407)
[0m14:36:16.821601 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, idle-time=0.00999307632446289s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:36:16.821601 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:36:16.821601 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:36:16.837270 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:36:16.837270 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:36:16.852851 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:36:16.852851 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Category
from `my_db`.`dbo`.`ecommerce`
where Category is null



  
  
      
    ) dbt_internal_test
[0m14:36:17.321168 [debug] [Thread-1 (]: Databricks adapter: Exception while trying to execute query
/* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Category
from `my_db`.`dbo`.`ecommerce`
where Category is null



  
  
      
    ) dbt_internal_test
: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
Error properties: diagnostic-info=org.apache.hive.service.cli.HiveSQLException: Error running query: [TABLE_OR_VIEW_NOT_FOUND] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.hive.thriftserver.HiveThriftServerErrors$.runningQueryError(HiveThriftServerErrors.scala:49)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:1036)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.org$apache$spark$sql$hive$thriftserver$SparkExecuteStatementOperation$$execute(SparkExecuteStatementOperation.scala:785)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$5(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.execution.SQLExecution$.withRootExecution(SQLExecution.scala:746)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$2(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.DatabricksTracingHelper.withAttributionContext(DatabricksSparkTracingHelper.scala:18)
	at com.databricks.spark.util.DatabricksTracingHelper.withSpanFromRequest(DatabricksSparkTracingHelper.scala:42)
	at com.databricks.spark.util.DBRTracing$.withSpanFromRequest(DBRTracing.scala:43)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$15(ThriftLocalProperties.scala:236)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:96)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:77)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags0(DatabricksSparkUsageLogger.scala:124)
	at com.databricks.spark.util.DatabricksSparkUsageLogger.withAttributionTags(DatabricksSparkUsageLogger.scala:232)
	at com.databricks.spark.util.UsageLogging.$anonfun$withAttributionTags$1(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:780)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:789)
	at com.databricks.spark.util.UsageLogging.withAttributionTags(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging.withAttributionTags$(UsageLogger.scala:666)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withAttributionTags(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$12(ThriftLocalProperties.scala:233)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties(ThriftLocalProperties.scala:229)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties$(ThriftLocalProperties.scala:89)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withLocalProperties(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:549)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:535)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2.run(SparkExecuteStatementOperation.scala:585)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.catalyst.ExtendedAnalysisException.copyPlan(ExtendedAnalysisException.scala:91)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:997)
	... 53 more
, operation-id=01f0836c-55e9-1e0b-a034-b5793e77c073
[0m14:36:17.321168 [debug] [Thread-1 (]: Database Error in test source_not_null_sqlserver_ecommerce_Category (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Category.sql
[0m14:36:17.321168 [error] [Thread-1 (]: 4 of 43 ERROR source_not_null_sqlserver_ecommerce_Category ..................... [[31mERROR[0m in 0.50s]
[0m14:36:17.321168 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:36:17.321168 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:36:17.321168 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_sqlserver_ecommerce_Category (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Category.sql.
[0m14:36:17.336828 [info ] [Thread-1 (]: 5 of 43 START test source_not_null_sqlserver_ecommerce_Discount ................ [RUN]
[0m14:36:17.336828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f)
[0m14:36:17.336828 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, idle-time=0.01566028594970703s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:36:17.336828 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:36:17.353621 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:36:17.356624 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:36:17.361622 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:36:17.364632 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:36:17.366629 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Discount
from `my_db`.`dbo`.`ecommerce`
where Discount is null



  
  
      
    ) dbt_internal_test
[0m14:36:17.649554 [debug] [Thread-1 (]: Databricks adapter: Exception while trying to execute query
/* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Discount
from `my_db`.`dbo`.`ecommerce`
where Discount is null



  
  
      
    ) dbt_internal_test
: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
Error properties: diagnostic-info=org.apache.hive.service.cli.HiveSQLException: Error running query: [TABLE_OR_VIEW_NOT_FOUND] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.hive.thriftserver.HiveThriftServerErrors$.runningQueryError(HiveThriftServerErrors.scala:49)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:1036)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.org$apache$spark$sql$hive$thriftserver$SparkExecuteStatementOperation$$execute(SparkExecuteStatementOperation.scala:785)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$5(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.execution.SQLExecution$.withRootExecution(SQLExecution.scala:746)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$2(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.DatabricksTracingHelper.withAttributionContext(DatabricksSparkTracingHelper.scala:18)
	at com.databricks.spark.util.DatabricksTracingHelper.withSpanFromRequest(DatabricksSparkTracingHelper.scala:42)
	at com.databricks.spark.util.DBRTracing$.withSpanFromRequest(DBRTracing.scala:43)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$15(ThriftLocalProperties.scala:236)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:96)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:77)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags0(DatabricksSparkUsageLogger.scala:124)
	at com.databricks.spark.util.DatabricksSparkUsageLogger.withAttributionTags(DatabricksSparkUsageLogger.scala:232)
	at com.databricks.spark.util.UsageLogging.$anonfun$withAttributionTags$1(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:780)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:789)
	at com.databricks.spark.util.UsageLogging.withAttributionTags(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging.withAttributionTags$(UsageLogger.scala:666)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withAttributionTags(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$12(ThriftLocalProperties.scala:233)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties(ThriftLocalProperties.scala:229)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties$(ThriftLocalProperties.scala:89)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withLocalProperties(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:549)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:535)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2.run(SparkExecuteStatementOperation.scala:585)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.catalyst.ExtendedAnalysisException.copyPlan(ExtendedAnalysisException.scala:91)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:997)
	... 53 more
, operation-id=01f0836c-5638-11cf-9dba-57ae25fd3dff
[0m14:36:17.673294 [debug] [Thread-1 (]: Database Error in test source_not_null_sqlserver_ecommerce_Discount (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Discount.sql
[0m14:36:17.675292 [error] [Thread-1 (]: 5 of 43 ERROR source_not_null_sqlserver_ecommerce_Discount ..................... [[31mERROR[0m in 0.34s]
[0m14:36:17.677305 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:36:17.679313 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:36:17.680312 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_sqlserver_ecommerce_Discount (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Discount.sql.
[0m14:36:17.683328 [info ] [Thread-1 (]: 6 of 43 START test source_not_null_sqlserver_ecommerce_Final_Price ............. [RUN]
[0m14:36:17.687307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d)
[0m14:36:17.690168 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, idle-time=0.014014959335327148s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:36:17.690168 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:36:17.705793 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:36:17.705793 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:36:17.721417 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:36:17.721417 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:36:17.721417 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Final_Price
from `my_db`.`dbo`.`ecommerce`
where Final_Price is null



  
  
      
    ) dbt_internal_test
[0m14:36:18.039532 [debug] [Thread-1 (]: Databricks adapter: Exception while trying to execute query
/* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Final_Price
from `my_db`.`dbo`.`ecommerce`
where Final_Price is null



  
  
      
    ) dbt_internal_test
: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
Error properties: diagnostic-info=org.apache.hive.service.cli.HiveSQLException: Error running query: [TABLE_OR_VIEW_NOT_FOUND] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.hive.thriftserver.HiveThriftServerErrors$.runningQueryError(HiveThriftServerErrors.scala:49)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:1036)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.org$apache$spark$sql$hive$thriftserver$SparkExecuteStatementOperation$$execute(SparkExecuteStatementOperation.scala:785)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$5(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.execution.SQLExecution$.withRootExecution(SQLExecution.scala:746)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$2(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.DatabricksTracingHelper.withAttributionContext(DatabricksSparkTracingHelper.scala:18)
	at com.databricks.spark.util.DatabricksTracingHelper.withSpanFromRequest(DatabricksSparkTracingHelper.scala:42)
	at com.databricks.spark.util.DBRTracing$.withSpanFromRequest(DBRTracing.scala:43)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$15(ThriftLocalProperties.scala:236)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:96)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:77)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags0(DatabricksSparkUsageLogger.scala:124)
	at com.databricks.spark.util.DatabricksSparkUsageLogger.withAttributionTags(DatabricksSparkUsageLogger.scala:232)
	at com.databricks.spark.util.UsageLogging.$anonfun$withAttributionTags$1(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:780)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:789)
	at com.databricks.spark.util.UsageLogging.withAttributionTags(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging.withAttributionTags$(UsageLogger.scala:666)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withAttributionTags(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$12(ThriftLocalProperties.scala:233)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties(ThriftLocalProperties.scala:229)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties$(ThriftLocalProperties.scala:89)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withLocalProperties(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:549)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:535)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2.run(SparkExecuteStatementOperation.scala:585)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.catalyst.ExtendedAnalysisException.copyPlan(ExtendedAnalysisException.scala:91)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:997)
	... 53 more
, operation-id=01f0836c-566f-1a33-995d-850db319cdd1
[0m14:36:18.039532 [debug] [Thread-1 (]: Database Error in test source_not_null_sqlserver_ecommerce_Final_Price (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Final_Price.sql
[0m14:36:18.039532 [error] [Thread-1 (]: 6 of 43 ERROR source_not_null_sqlserver_ecommerce_Final_Price .................. [[31mERROR[0m in 0.35s]
[0m14:36:18.055077 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:36:18.055077 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:36:18.055077 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_sqlserver_ecommerce_Final_Price (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Final_Price.sql.
[0m14:36:18.055077 [info ] [Thread-1 (]: 7 of 43 START test source_not_null_sqlserver_ecommerce_Payment_Method .......... [RUN]
[0m14:36:18.055077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae)
[0m14:36:18.055077 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, idle-time=0.015545368194580078s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:36:18.055077 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:36:18.070669 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:36:18.070669 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:36:18.086291 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:36:18.086291 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:36:18.086291 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Payment_Method
from `my_db`.`dbo`.`ecommerce`
where Payment_Method is null



  
  
      
    ) dbt_internal_test
[0m14:36:18.383477 [debug] [Thread-1 (]: Databricks adapter: Exception while trying to execute query
/* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Payment_Method
from `my_db`.`dbo`.`ecommerce`
where Payment_Method is null



  
  
      
    ) dbt_internal_test
: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
Error properties: diagnostic-info=org.apache.hive.service.cli.HiveSQLException: Error running query: [TABLE_OR_VIEW_NOT_FOUND] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.hive.thriftserver.HiveThriftServerErrors$.runningQueryError(HiveThriftServerErrors.scala:49)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:1036)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.org$apache$spark$sql$hive$thriftserver$SparkExecuteStatementOperation$$execute(SparkExecuteStatementOperation.scala:785)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$5(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.execution.SQLExecution$.withRootExecution(SQLExecution.scala:746)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$2(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.DatabricksTracingHelper.withAttributionContext(DatabricksSparkTracingHelper.scala:18)
	at com.databricks.spark.util.DatabricksTracingHelper.withSpanFromRequest(DatabricksSparkTracingHelper.scala:42)
	at com.databricks.spark.util.DBRTracing$.withSpanFromRequest(DBRTracing.scala:43)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$15(ThriftLocalProperties.scala:236)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:96)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:77)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags0(DatabricksSparkUsageLogger.scala:124)
	at com.databricks.spark.util.DatabricksSparkUsageLogger.withAttributionTags(DatabricksSparkUsageLogger.scala:232)
	at com.databricks.spark.util.UsageLogging.$anonfun$withAttributionTags$1(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:780)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:789)
	at com.databricks.spark.util.UsageLogging.withAttributionTags(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging.withAttributionTags$(UsageLogger.scala:666)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withAttributionTags(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$12(ThriftLocalProperties.scala:233)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties(ThriftLocalProperties.scala:229)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties$(ThriftLocalProperties.scala:89)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withLocalProperties(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:549)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:535)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2.run(SparkExecuteStatementOperation.scala:585)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.catalyst.ExtendedAnalysisException.copyPlan(ExtendedAnalysisException.scala:91)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:997)
	... 53 more
, operation-id=01f0836c-56a6-165c-a744-f4b4f4074036
[0m14:36:18.398983 [debug] [Thread-1 (]: Database Error in test source_not_null_sqlserver_ecommerce_Payment_Method (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Payment_Method.sql
[0m14:36:18.398983 [error] [Thread-1 (]: 7 of 43 ERROR source_not_null_sqlserver_ecommerce_Payment_Method ............... [[31mERROR[0m in 0.34s]
[0m14:36:18.398983 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:36:18.398983 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:36:18.398983 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_sqlserver_ecommerce_Payment_Method (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Payment_Method.sql.
[0m14:36:18.398983 [info ] [Thread-1 (]: 8 of 43 START test source_not_null_sqlserver_ecommerce_Price ................... [RUN]
[0m14:36:18.398983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01)
[0m14:36:18.414692 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, idle-time=0.01570868492126465s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:36:18.414692 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:36:18.414692 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:36:18.414692 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:36:18.430284 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:36:18.430284 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:36:18.430284 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Price
from `my_db`.`dbo`.`ecommerce`
where Price is null



  
  
      
    ) dbt_internal_test
[0m14:36:18.746903 [debug] [Thread-1 (]: Databricks adapter: Exception while trying to execute query
/* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Price
from `my_db`.`dbo`.`ecommerce`
where Price is null



  
  
      
    ) dbt_internal_test
: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
Error properties: diagnostic-info=org.apache.hive.service.cli.HiveSQLException: Error running query: [TABLE_OR_VIEW_NOT_FOUND] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.hive.thriftserver.HiveThriftServerErrors$.runningQueryError(HiveThriftServerErrors.scala:49)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:1036)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.org$apache$spark$sql$hive$thriftserver$SparkExecuteStatementOperation$$execute(SparkExecuteStatementOperation.scala:785)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$5(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.execution.SQLExecution$.withRootExecution(SQLExecution.scala:746)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$2(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.DatabricksTracingHelper.withAttributionContext(DatabricksSparkTracingHelper.scala:18)
	at com.databricks.spark.util.DatabricksTracingHelper.withSpanFromRequest(DatabricksSparkTracingHelper.scala:42)
	at com.databricks.spark.util.DBRTracing$.withSpanFromRequest(DBRTracing.scala:43)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$15(ThriftLocalProperties.scala:236)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:96)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:77)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags0(DatabricksSparkUsageLogger.scala:124)
	at com.databricks.spark.util.DatabricksSparkUsageLogger.withAttributionTags(DatabricksSparkUsageLogger.scala:232)
	at com.databricks.spark.util.UsageLogging.$anonfun$withAttributionTags$1(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:780)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:789)
	at com.databricks.spark.util.UsageLogging.withAttributionTags(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging.withAttributionTags$(UsageLogger.scala:666)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withAttributionTags(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$12(ThriftLocalProperties.scala:233)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties(ThriftLocalProperties.scala:229)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties$(ThriftLocalProperties.scala:89)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withLocalProperties(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:549)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:535)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2.run(SparkExecuteStatementOperation.scala:585)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.catalyst.ExtendedAnalysisException.copyPlan(ExtendedAnalysisException.scala:91)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:997)
	... 53 more
, operation-id=01f0836c-56db-1cf0-b70b-88ff68afc184
[0m14:36:18.746903 [debug] [Thread-1 (]: Database Error in test source_not_null_sqlserver_ecommerce_Price (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Price.sql
[0m14:36:18.746903 [error] [Thread-1 (]: 8 of 43 ERROR source_not_null_sqlserver_ecommerce_Price ........................ [[31mERROR[0m in 0.35s]
[0m14:36:18.746903 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:36:18.746903 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:36:18.746903 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_sqlserver_ecommerce_Price (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Price.sql.
[0m14:36:18.746903 [info ] [Thread-1 (]: 9 of 43 START test source_not_null_sqlserver_ecommerce_Product_ID .............. [RUN]
[0m14:36:18.785364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff)
[0m14:36:18.787379 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, idle-time=0.04047584533691406s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:36:18.788382 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:36:18.790470 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:36:18.790470 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:36:18.806144 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:36:18.806144 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:36:18.806144 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Product_ID
from `my_db`.`dbo`.`ecommerce`
where Product_ID is null



  
  
      
    ) dbt_internal_test
[0m14:36:19.113197 [debug] [Thread-1 (]: Databricks adapter: Exception while trying to execute query
/* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Product_ID
from `my_db`.`dbo`.`ecommerce`
where Product_ID is null



  
  
      
    ) dbt_internal_test
: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
Error properties: diagnostic-info=org.apache.hive.service.cli.HiveSQLException: Error running query: [TABLE_OR_VIEW_NOT_FOUND] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.hive.thriftserver.HiveThriftServerErrors$.runningQueryError(HiveThriftServerErrors.scala:49)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:1036)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.org$apache$spark$sql$hive$thriftserver$SparkExecuteStatementOperation$$execute(SparkExecuteStatementOperation.scala:785)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$5(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.execution.SQLExecution$.withRootExecution(SQLExecution.scala:746)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$2(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.DatabricksTracingHelper.withAttributionContext(DatabricksSparkTracingHelper.scala:18)
	at com.databricks.spark.util.DatabricksTracingHelper.withSpanFromRequest(DatabricksSparkTracingHelper.scala:42)
	at com.databricks.spark.util.DBRTracing$.withSpanFromRequest(DBRTracing.scala:43)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$15(ThriftLocalProperties.scala:236)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:96)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:77)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags0(DatabricksSparkUsageLogger.scala:124)
	at com.databricks.spark.util.DatabricksSparkUsageLogger.withAttributionTags(DatabricksSparkUsageLogger.scala:232)
	at com.databricks.spark.util.UsageLogging.$anonfun$withAttributionTags$1(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:780)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:789)
	at com.databricks.spark.util.UsageLogging.withAttributionTags(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging.withAttributionTags$(UsageLogger.scala:666)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withAttributionTags(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$12(ThriftLocalProperties.scala:233)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties(ThriftLocalProperties.scala:229)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties$(ThriftLocalProperties.scala:89)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withLocalProperties(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:549)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:535)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2.run(SparkExecuteStatementOperation.scala:585)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.catalyst.ExtendedAnalysisException.copyPlan(ExtendedAnalysisException.scala:91)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:997)
	... 53 more
, operation-id=01f0836c-5714-165a-a5e9-08000c51d3fb
[0m14:36:19.118361 [debug] [Thread-1 (]: Database Error in test source_not_null_sqlserver_ecommerce_Product_ID (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Product_ID.sql
[0m14:36:19.118361 [error] [Thread-1 (]: 9 of 43 ERROR source_not_null_sqlserver_ecommerce_Product_ID ................... [[31mERROR[0m in 0.33s]
[0m14:36:19.118361 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:36:19.118361 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:36:19.118361 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_sqlserver_ecommerce_Product_ID (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Product_ID.sql.
[0m14:36:19.118361 [info ] [Thread-1 (]: 10 of 43 START test source_not_null_sqlserver_ecommerce_Purchase_Date .......... [RUN]
[0m14:36:19.118361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17)
[0m14:36:19.118361 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:36:19.118361 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:36:19.133988 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:36:19.133988 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:36:19.149708 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:36:19.149708 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:36:19.149708 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Purchase_Date
from `my_db`.`dbo`.`ecommerce`
where Purchase_Date is null



  
  
      
    ) dbt_internal_test
[0m14:36:19.446182 [debug] [Thread-1 (]: Databricks adapter: Exception while trying to execute query
/* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Purchase_Date
from `my_db`.`dbo`.`ecommerce`
where Purchase_Date is null



  
  
      
    ) dbt_internal_test
: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
Error properties: diagnostic-info=org.apache.hive.service.cli.HiveSQLException: Error running query: [TABLE_OR_VIEW_NOT_FOUND] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.hive.thriftserver.HiveThriftServerErrors$.runningQueryError(HiveThriftServerErrors.scala:49)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:1036)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.org$apache$spark$sql$hive$thriftserver$SparkExecuteStatementOperation$$execute(SparkExecuteStatementOperation.scala:785)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$5(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.execution.SQLExecution$.withRootExecution(SQLExecution.scala:746)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$2(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.DatabricksTracingHelper.withAttributionContext(DatabricksSparkTracingHelper.scala:18)
	at com.databricks.spark.util.DatabricksTracingHelper.withSpanFromRequest(DatabricksSparkTracingHelper.scala:42)
	at com.databricks.spark.util.DBRTracing$.withSpanFromRequest(DBRTracing.scala:43)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$15(ThriftLocalProperties.scala:236)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:96)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:77)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags0(DatabricksSparkUsageLogger.scala:124)
	at com.databricks.spark.util.DatabricksSparkUsageLogger.withAttributionTags(DatabricksSparkUsageLogger.scala:232)
	at com.databricks.spark.util.UsageLogging.$anonfun$withAttributionTags$1(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:780)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:789)
	at com.databricks.spark.util.UsageLogging.withAttributionTags(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging.withAttributionTags$(UsageLogger.scala:666)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withAttributionTags(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$12(ThriftLocalProperties.scala:233)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties(ThriftLocalProperties.scala:229)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties$(ThriftLocalProperties.scala:89)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withLocalProperties(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:549)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:535)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2.run(SparkExecuteStatementOperation.scala:585)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.catalyst.ExtendedAnalysisException.copyPlan(ExtendedAnalysisException.scala:91)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:997)
	... 53 more
, operation-id=01f0836c-5748-1b31-851a-eca2612f2a3a
[0m14:36:19.461854 [debug] [Thread-1 (]: Database Error in test source_not_null_sqlserver_ecommerce_Purchase_Date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Purchase_Date.sql
[0m14:36:19.461854 [error] [Thread-1 (]: 10 of 43 ERROR source_not_null_sqlserver_ecommerce_Purchase_Date ............... [[31mERROR[0m in 0.34s]
[0m14:36:19.461854 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:36:19.461854 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:36:19.461854 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_sqlserver_ecommerce_Purchase_Date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Purchase_Date.sql.
[0m14:36:19.461854 [info ] [Thread-1 (]: 11 of 43 START test source_not_null_sqlserver_ecommerce_User_ID ................ [RUN]
[0m14:36:19.461854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc)
[0m14:36:19.477435 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc, idle-time=0.01558065414428711s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:36:19.477435 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:36:19.477435 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:36:19.477435 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:36:19.493065 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:36:19.493065 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:36:19.493065 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select User_ID
from `my_db`.`dbo`.`ecommerce`
where User_ID is null



  
  
      
    ) dbt_internal_test
[0m14:36:19.805619 [debug] [Thread-1 (]: Databricks adapter: Exception while trying to execute query
/* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select User_ID
from `my_db`.`dbo`.`ecommerce`
where User_ID is null



  
  
      
    ) dbt_internal_test
: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
Error properties: diagnostic-info=org.apache.hive.service.cli.HiveSQLException: Error running query: [TABLE_OR_VIEW_NOT_FOUND] org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.hive.thriftserver.HiveThriftServerErrors$.runningQueryError(HiveThriftServerErrors.scala:49)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:1036)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.unity.UCSEphemeralState$Handle.runWith(UCSEphemeralState.scala:51)
	at com.databricks.unity.HandleImpl.runWith(UCSHandle.scala:104)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.org$apache$spark$sql$hive$thriftserver$SparkExecuteStatementOperation$$execute(SparkExecuteStatementOperation.scala:785)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$5(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at org.apache.spark.sql.execution.SQLExecution$.withRootExecution(SQLExecution.scala:746)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.$anonfun$run$2(SparkExecuteStatementOperation.scala:572)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.DatabricksTracingHelper.withAttributionContext(DatabricksSparkTracingHelper.scala:18)
	at com.databricks.spark.util.DatabricksTracingHelper.withSpanFromRequest(DatabricksSparkTracingHelper.scala:42)
	at com.databricks.spark.util.DBRTracing$.withSpanFromRequest(DBRTracing.scala:43)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$15(ThriftLocalProperties.scala:236)
	at com.databricks.logging.AttributionContextTracing.$anonfun$withAttributionContext$1(AttributionContextTracing.scala:49)
	at com.databricks.logging.AttributionContext$.$anonfun$withValue$1(AttributionContext.scala:293)
	at scala.util.DynamicVariable.withValue(DynamicVariable.scala:59)
	at com.databricks.logging.AttributionContext$.withValue(AttributionContext.scala:289)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext(AttributionContextTracing.scala:47)
	at com.databricks.logging.AttributionContextTracing.withAttributionContext$(AttributionContextTracing.scala:44)
	at com.databricks.spark.util.PublicDBLogging.withAttributionContext(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags(AttributionContextTracing.scala:96)
	at com.databricks.logging.AttributionContextTracing.withAttributionTags$(AttributionContextTracing.scala:77)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags(DatabricksSparkUsageLogger.scala:30)
	at com.databricks.spark.util.PublicDBLogging.withAttributionTags0(DatabricksSparkUsageLogger.scala:124)
	at com.databricks.spark.util.DatabricksSparkUsageLogger.withAttributionTags(DatabricksSparkUsageLogger.scala:232)
	at com.databricks.spark.util.UsageLogging.$anonfun$withAttributionTags$1(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:780)
	at com.databricks.spark.util.UsageLogging$.withAttributionTags(UsageLogger.scala:789)
	at com.databricks.spark.util.UsageLogging.withAttributionTags(UsageLogger.scala:668)
	at com.databricks.spark.util.UsageLogging.withAttributionTags$(UsageLogger.scala:666)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withAttributionTags(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.$anonfun$withLocalProperties$12(ThriftLocalProperties.scala:233)
	at com.databricks.spark.util.IdentityClaim$.withClaim(IdentityClaim.scala:48)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties(ThriftLocalProperties.scala:229)
	at org.apache.spark.sql.hive.thriftserver.ThriftLocalProperties.withLocalProperties$(ThriftLocalProperties.scala:89)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.withLocalProperties(SparkExecuteStatementOperation.scala:75)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:549)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2$$anon$3.run(SparkExecuteStatementOperation.scala:535)
	at java.base/java.security.AccessController.doPrivileged(AccessController.java:712)
	at java.base/javax.security.auth.Subject.doAs(Subject.java:439)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1953)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation$$anon$2.run(SparkExecuteStatementOperation.scala:585)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: org.apache.spark.sql.catalyst.ExtendedAnalysisException: [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
	at org.apache.spark.sql.catalyst.ExtendedAnalysisException.copyPlan(ExtendedAnalysisException.scala:91)
	at org.apache.spark.sql.hive.thriftserver.SparkExecuteStatementOperation.$anonfun$execute$1(SparkExecuteStatementOperation.scala:997)
	... 53 more
, operation-id=01f0836c-577e-173a-b69e-f5be04f85b55
[0m14:36:19.805619 [debug] [Thread-1 (]: Database Error in test source_not_null_sqlserver_ecommerce_User_ID (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_User_ID.sql
[0m14:36:19.805619 [error] [Thread-1 (]: 11 of 43 ERROR source_not_null_sqlserver_ecommerce_User_ID ..................... [[31mERROR[0m in 0.34s]
[0m14:36:19.805619 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:36:19.805619 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.stg_ecommerce
[0m14:36:19.805619 [debug] [Thread-4 (]: Marking all children of 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_sqlserver_ecommerce_User_ID (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_User_ID.sql.
[0m14:36:19.821095 [info ] [Thread-1 (]: 12 of 43 START sql view model default.stg_ecommerce ............................ [RUN]
[0m14:36:19.821095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc, now model.dbt_databricks_cicd.stg_ecommerce)
[0m14:36:19.821095 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=model.dbt_databricks_cicd.stg_ecommerce, idle-time=0.015475988388061523s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:36:19.821095 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.stg_ecommerce
[0m14:36:19.821095 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.stg_ecommerce"
[0m14:36:19.821095 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.stg_ecommerce
[0m14:36:19.836719 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:36:19.836719 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`stg_ecommerce`
[0m14:36:19.836719 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.stg_ecommerce"
[0m14:36:19.836719 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.stg_ecommerce"
[0m14:36:19.836719 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.stg_ecommerce"} */

  
  
  
  create or replace view `workspace`.`default`.`stg_ecommerce`
  
  as (
    SELECT
  User_ID,
  Product_ID,
  Category,
  Price,
  Discount,
  Final_Price,
  Payment_Method,
  Purchase_Date
FROM `workspace`.`default`.`src_ecommerce`
  )

[0m14:36:20.398926 [debug] [Thread-1 (]: SQL status: OK in 0.550 seconds
[0m14:36:20.398926 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-57b3-1131-86c3-94fa8783d366) - Closing
[0m14:36:20.398926 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:36:20.398926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3ba7014-c16b-408e-954e-8db5e4f06c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEF7F77510>]}
[0m14:36:20.398926 [info ] [Thread-1 (]: 12 of 43 OK created sql view model default.stg_ecommerce ....................... [[32mOK[0m in 0.58s]
[0m14:36:20.414415 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.stg_ecommerce
[0m14:36:20.414415 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.avg_discount_by_category
[0m14:36:20.414415 [info ] [Thread-1 (]: 13 of 43 START sql view model default.avg_discount_by_category ................. [RUN]
[0m14:36:20.414415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.stg_ecommerce, now model.dbt_databricks_cicd.avg_discount_by_category)
[0m14:36:20.414415 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=model.dbt_databricks_cicd.avg_discount_by_category, idle-time=0.015489339828491211s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.stg_ecommerce
[0m14:36:20.414415 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.avg_discount_by_category
[0m14:36:20.430072 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.avg_discount_by_category"
[0m14:36:20.430072 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.avg_discount_by_category
[0m14:36:20.430072 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:36:20.430072 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`avg_discount_by_category`
[0m14:36:20.430072 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.avg_discount_by_category"
[0m14:36:20.445713 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.avg_discount_by_category"
[0m14:36:20.445713 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.avg_discount_by_category: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.avg_discount_by_category"} */

  
  
  
  create or replace view `workspace`.`default`.`avg_discount_by_category`
  
  as (
    SELECT
  Category,
  ROUND(AVG(CAST(`Discount` AS DOUBLE)), 2) AS avg_discount_percent
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY Category
ORDER BY avg_discount_percent DESC
  )

[0m14:36:21.024152 [debug] [Thread-1 (]: SQL status: OK in 0.580 seconds
[0m14:36:21.024152 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-580d-1ac7-9de6-51aea343ca46) - Closing
[0m14:36:21.024152 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:36:21.024152 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3ba7014-c16b-408e-954e-8db5e4f06c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEF7FA3110>]}
[0m14:36:21.024152 [info ] [Thread-1 (]: 13 of 43 OK created sql view model default.avg_discount_by_category ............ [[32mOK[0m in 0.61s]
[0m14:36:21.024152 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.avg_discount_by_category
[0m14:36:21.024152 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.avg_ticket_by_category
[0m14:36:21.039779 [info ] [Thread-1 (]: 14 of 43 START sql view model default.avg_ticket_by_category ................... [RUN]
[0m14:36:21.039779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.avg_discount_by_category, now model.dbt_databricks_cicd.avg_ticket_by_category)
[0m14:36:21.039779 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=model.dbt_databricks_cicd.avg_ticket_by_category, idle-time=0.015627145767211914s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.avg_discount_by_category
[0m14:36:21.039779 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.avg_ticket_by_category
[0m14:36:21.039779 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.avg_ticket_by_category"
[0m14:36:21.039779 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.avg_ticket_by_category
[0m14:36:21.066452 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:36:21.069452 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`avg_ticket_by_category`
[0m14:36:21.070451 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.avg_ticket_by_category"
[0m14:36:21.073456 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.avg_ticket_by_category"
[0m14:36:21.074458 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.avg_ticket_by_category: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.avg_ticket_by_category"} */

  
  
  
  create or replace view `workspace`.`default`.`avg_ticket_by_category`
  
  as (
    SELECT
  Category,
  ROUND(AVG(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS avg_ticket
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY Category
ORDER BY avg_ticket DESC
  )

[0m14:36:21.620160 [debug] [Thread-1 (]: SQL status: OK in 0.540 seconds
[0m14:36:21.622163 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-586e-1ce8-b51a-83ba08d1466e) - Closing
[0m14:36:21.624163 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:36:21.626164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3ba7014-c16b-408e-954e-8db5e4f06c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEF8443C50>]}
[0m14:36:21.629162 [info ] [Thread-1 (]: 14 of 43 OK created sql view model default.avg_ticket_by_category .............. [[32mOK[0m in 0.59s]
[0m14:36:21.631203 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.avg_ticket_by_category
[0m14:36:21.634009 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.monthly_revenue
[0m14:36:21.634009 [info ] [Thread-1 (]: 15 of 43 START sql view model default.monthly_revenue .......................... [RUN]
[0m14:36:21.634009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.avg_ticket_by_category, now model.dbt_databricks_cicd.monthly_revenue)
[0m14:36:21.634009 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=model.dbt_databricks_cicd.monthly_revenue, idle-time=0.007845163345336914s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.avg_ticket_by_category
[0m14:36:21.634009 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.monthly_revenue
[0m14:36:21.634009 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.monthly_revenue"
[0m14:36:21.634009 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.monthly_revenue
[0m14:36:21.649676 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:36:21.649676 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`monthly_revenue`
[0m14:36:21.649676 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.monthly_revenue"
[0m14:36:21.649676 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.monthly_revenue"
[0m14:36:21.649676 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.monthly_revenue: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.monthly_revenue"} */

  
  
  
  create or replace view `workspace`.`default`.`monthly_revenue`
  
  as (
    SELECT
  CAST(DATE_TRUNC('month', CAST(Purchase_Date AS DATE)) AS DATE) AS month,
  ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS monthly_revenue
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY 1
ORDER BY 1
  )

[0m14:36:22.244718 [debug] [Thread-1 (]: SQL status: OK in 0.580 seconds
[0m14:36:22.246719 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-58c7-1bb1-9f1b-b63856991e8b) - Closing
[0m14:36:22.248719 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:36:22.250720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3ba7014-c16b-408e-954e-8db5e4f06c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEF8440550>]}
[0m14:36:22.252720 [info ] [Thread-1 (]: 15 of 43 OK created sql view model default.monthly_revenue ..................... [[32mOK[0m in 0.62s]
[0m14:36:22.254700 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.monthly_revenue
[0m14:36:22.255686 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.payment_distribution
[0m14:36:22.258685 [info ] [Thread-1 (]: 16 of 43 START sql view model default.payment_distribution ..................... [RUN]
[0m14:36:22.261703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.monthly_revenue, now model.dbt_databricks_cicd.payment_distribution)
[0m14:36:22.262683 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=model.dbt_databricks_cicd.payment_distribution, idle-time=0.011963367462158203s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.monthly_revenue
[0m14:36:22.263723 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.payment_distribution
[0m14:36:22.270720 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.payment_distribution"
[0m14:36:22.272718 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.payment_distribution
[0m14:36:22.281398 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:36:22.283402 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`payment_distribution`
[0m14:36:22.285401 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.payment_distribution"
[0m14:36:22.287401 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.payment_distribution"
[0m14:36:22.289401 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.payment_distribution: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.payment_distribution"} */

  
  
  
  create or replace view `workspace`.`default`.`payment_distribution`
  
  as (
    SELECT
  Payment_Method,
  COUNT(*) AS total_transactions,
  ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS total_value
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY Payment_Method
ORDER BY total_value DESC
  )

[0m14:36:22.825307 [debug] [Thread-1 (]: SQL status: OK in 0.540 seconds
[0m14:36:22.828310 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-5926-1780-944a-a43cab60ed1e) - Closing
[0m14:36:22.829312 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:36:22.832312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3ba7014-c16b-408e-954e-8db5e4f06c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEF7F27850>]}
[0m14:36:22.833310 [info ] [Thread-1 (]: 16 of 43 OK created sql view model default.payment_distribution ................ [[32mOK[0m in 0.57s]
[0m14:36:22.835569 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.payment_distribution
[0m14:36:22.836702 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.sales_by_category
[0m14:36:22.836702 [info ] [Thread-1 (]: 17 of 43 START sql view model default.sales_by_category ........................ [RUN]
[0m14:36:22.836702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.payment_distribution, now model.dbt_databricks_cicd.sales_by_category)
[0m14:36:22.836702 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=model.dbt_databricks_cicd.sales_by_category, idle-time=0.005391120910644531s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.payment_distribution
[0m14:36:22.836702 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.sales_by_category
[0m14:36:22.836702 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.sales_by_category"
[0m14:36:22.852371 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.sales_by_category
[0m14:36:22.852371 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:36:22.852371 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`sales_by_category`
[0m14:36:22.852371 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.sales_by_category"
[0m14:36:22.867963 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.sales_by_category"
[0m14:36:22.867963 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.sales_by_category: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.sales_by_category"} */

  
  
  
  create or replace view `workspace`.`default`.`sales_by_category`
  
  as (
    SELECT
  Category,
  COUNT(*) AS total_orders,
  ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS total_revenue
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY Category
ORDER BY total_revenue DESC
  )

[0m14:36:23.429996 [debug] [Thread-1 (]: SQL status: OK in 0.560 seconds
[0m14:36:23.429996 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-597f-14f8-8a93-65058d67c94e) - Closing
[0m14:36:23.429996 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:36:23.429996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3ba7014-c16b-408e-954e-8db5e4f06c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEF8339ED0>]}
[0m14:36:23.429996 [info ] [Thread-1 (]: 17 of 43 OK created sql view model default.sales_by_category ................... [[32mOK[0m in 0.59s]
[0m14:36:23.429996 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.sales_by_category
[0m14:36:23.429996 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.top_5_products
[0m14:36:23.445484 [info ] [Thread-1 (]: 18 of 43 START sql view model default.top_5_products ........................... [RUN]
[0m14:36:23.445484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.sales_by_category, now model.dbt_databricks_cicd.top_5_products)
[0m14:36:23.445484 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=model.dbt_databricks_cicd.top_5_products, idle-time=0.015488386154174805s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.sales_by_category
[0m14:36:23.445484 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.top_5_products
[0m14:36:23.445484 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.top_5_products"
[0m14:36:23.462459 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.top_5_products
[0m14:36:23.467457 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:36:23.470460 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`top_5_products`
[0m14:36:23.471458 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.top_5_products"
[0m14:36:23.474476 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.top_5_products"
[0m14:36:23.476466 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.top_5_products: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.top_5_products"} */

  
  
  
  create or replace view `workspace`.`default`.`top_5_products`
  
  as (
    WITH base AS (
    SELECT
        product_id,
        ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS total_sales
    FROM `workspace`.`default`.`stg_ecommerce`
    GROUP BY product_id
)

SELECT
    product_id,
    total_sales
FROM base
ORDER BY total_sales DESC
LIMIT 5
  )

[0m14:36:24.196096 [debug] [Thread-1 (]: SQL status: OK in 0.700 seconds
[0m14:36:24.196096 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-59dc-1681-9997-963c48ffb794) - Closing
[0m14:36:24.196096 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:36:24.196096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3ba7014-c16b-408e-954e-8db5e4f06c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEF84C95D0>]}
[0m14:36:24.196096 [info ] [Thread-1 (]: 18 of 43 OK created sql view model default.top_5_products ...................... [[32mOK[0m in 0.75s]
[0m14:36:24.196096 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.top_5_products
[0m14:36:24.196096 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.top_customers
[0m14:36:24.196096 [info ] [Thread-1 (]: 19 of 43 START sql view model default.top_customers ............................ [RUN]
[0m14:36:24.211759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.top_5_products, now model.dbt_databricks_cicd.top_customers)
[0m14:36:24.211759 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=model.dbt_databricks_cicd.top_customers, idle-time=0.01566314697265625s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.top_5_products
[0m14:36:24.211759 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.top_customers
[0m14:36:24.211759 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.top_customers"
[0m14:36:24.211759 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.top_customers
[0m14:36:24.227354 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:36:24.227354 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`top_customers`
[0m14:36:24.227354 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.top_customers"
[0m14:36:24.227354 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.top_customers"
[0m14:36:24.227354 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.top_customers: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.top_customers"} */

  
  
  
  create or replace view `workspace`.`default`.`top_customers`
  
  as (
    SELECT
  User_ID,
  COUNT(*) AS total_orders,
  ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS total_spent
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY User_ID
ORDER BY total_spent DESC
LIMIT 10
  )

[0m14:36:24.883812 [debug] [Thread-1 (]: SQL status: OK in 0.660 seconds
[0m14:36:24.883812 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-5a50-14dd-a166-e7af75e8d892) - Closing
[0m14:36:24.883812 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:36:24.883812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3ba7014-c16b-408e-954e-8db5e4f06c3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEF8323090>]}
[0m14:36:24.883812 [info ] [Thread-1 (]: 19 of 43 OK created sql view model default.top_customers ....................... [[32mOK[0m in 0.69s]
[0m14:36:24.883812 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.top_customers
[0m14:36:24.883812 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m14:36:24.883812 [info ] [Thread-1 (]: 20 of 43 START test non_negative_avg_discount_by_category_avg_discount_percent . [RUN]
[0m14:36:24.883812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.top_customers, now test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f)
[0m14:36:24.899888 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f, idle-time=0.016075611114501953s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.top_customers
[0m14:36:24.901887 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m14:36:24.911927 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f"
[0m14:36:24.913882 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m14:36:24.916877 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f"
[0m14:36:24.916877 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f"
[0m14:36:24.916877 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`avg_discount_by_category`
where TRY_CAST(REPLACE(avg_discount_percent, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m14:36:25.258479 [debug] [Thread-1 (]: SQL status: OK in 0.340 seconds
[0m14:36:25.258479 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-5ab9-1f92-a735-b4b72c1c13d8) - Closing
[0m14:36:25.258479 [info ] [Thread-1 (]: 20 of 43 PASS non_negative_avg_discount_by_category_avg_discount_percent ....... [[32mPASS[0m in 0.37s]
[0m14:36:25.258479 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m14:36:25.274148 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m14:36:25.274148 [info ] [Thread-1 (]: 21 of 43 START test not_null_avg_discount_by_category_Category ................. [RUN]
[0m14:36:25.274148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f, now test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b)
[0m14:36:25.274148 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b, idle-time=0.015668869018554688s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m14:36:25.274148 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m14:36:25.289736 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b"
[0m14:36:25.289736 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m14:36:25.289736 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b"
[0m14:36:25.289736 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b"
[0m14:36:25.289736 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Category
from `workspace`.`default`.`avg_discount_by_category`
where Category is null



  
  
      
    ) dbt_internal_test
[0m14:36:25.672650 [debug] [Thread-1 (]: SQL status: OK in 0.380 seconds
[0m14:36:25.676650 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-5af3-1832-b40d-d9887296ee91) - Closing
[0m14:36:25.678652 [info ] [Thread-1 (]: 21 of 43 PASS not_null_avg_discount_by_category_Category ....................... [[32mPASS[0m in 0.40s]
[0m14:36:25.681652 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m14:36:25.683655 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m14:36:25.686651 [info ] [Thread-1 (]: 22 of 43 START test not_null_avg_discount_by_category_avg_discount_percent ..... [RUN]
[0m14:36:25.690654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b, now test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101)
[0m14:36:25.693661 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101, idle-time=0.015005111694335938s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m14:36:25.695656 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m14:36:25.714318 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101"
[0m14:36:25.714318 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m14:36:25.729946 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101"
[0m14:36:25.729946 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101"
[0m14:36:25.729946 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_discount_percent
from `workspace`.`default`.`avg_discount_by_category`
where avg_discount_percent is null



  
  
      
    ) dbt_internal_test
[0m14:36:26.101648 [debug] [Thread-1 (]: SQL status: OK in 0.370 seconds
[0m14:36:26.101648 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-5b34-1ad1-8552-385516c8f0b0) - Closing
[0m14:36:26.101648 [info ] [Thread-1 (]: 22 of 43 PASS not_null_avg_discount_by_category_avg_discount_percent ........... [[32mPASS[0m in 0.41s]
[0m14:36:26.101648 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m14:36:26.101648 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m14:36:26.101648 [info ] [Thread-1 (]: 23 of 43 START test non_negative_avg_ticket_by_category_avg_ticket ............. [RUN]
[0m14:36:26.101648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101, now test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095)
[0m14:36:26.101648 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m14:36:26.101648 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m14:36:26.117275 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095"
[0m14:36:26.117275 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m14:36:26.132910 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095"
[0m14:36:26.132910 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095"
[0m14:36:26.132910 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`avg_ticket_by_category`
where TRY_CAST(REPLACE(avg_ticket, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m14:36:26.477065 [debug] [Thread-1 (]: SQL status: OK in 0.340 seconds
[0m14:36:26.492549 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-5b72-1efe-bb22-5e47f461a1f0) - Closing
[0m14:36:26.492549 [info ] [Thread-1 (]: 23 of 43 PASS non_negative_avg_ticket_by_category_avg_ticket ................... [[32mPASS[0m in 0.39s]
[0m14:36:26.492549 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m14:36:26.492549 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m14:36:26.492549 [info ] [Thread-1 (]: 24 of 43 START test not_null_avg_ticket_by_category_Category ................... [RUN]
[0m14:36:26.492549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095, now test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f)
[0m14:36:26.492549 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m14:36:26.492549 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m14:36:26.508176 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f"
[0m14:36:26.508176 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m14:36:26.508176 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f"
[0m14:36:26.523852 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f"
[0m14:36:26.523852 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Category
from `workspace`.`default`.`avg_ticket_by_category`
where Category is null



  
  
      
    ) dbt_internal_test
[0m14:36:26.900312 [debug] [Thread-1 (]: SQL status: OK in 0.380 seconds
[0m14:36:26.906315 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-5bae-175e-aad7-822eebdd8e4e) - Closing
[0m14:36:26.908314 [info ] [Thread-1 (]: 24 of 43 PASS not_null_avg_ticket_by_category_Category ......................... [[32mPASS[0m in 0.42s]
[0m14:36:26.912316 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m14:36:26.913323 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m14:36:26.914390 [info ] [Thread-1 (]: 25 of 43 START test not_null_avg_ticket_by_category_avg_ticket ................. [RUN]
[0m14:36:26.914390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f, now test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41)
[0m14:36:26.914390 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41, idle-time=0.006075620651245117s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m14:36:26.914390 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m14:36:26.930022 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41"
[0m14:36:26.930022 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m14:36:26.945650 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41"
[0m14:36:26.945650 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41"
[0m14:36:26.945650 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_ticket
from `workspace`.`default`.`avg_ticket_by_category`
where avg_ticket is null



  
  
      
    ) dbt_internal_test
[0m14:36:27.274490 [debug] [Thread-1 (]: SQL status: OK in 0.330 seconds
[0m14:36:27.289977 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-5bf0-16dc-b62a-6029ef4d8aa3) - Closing
[0m14:36:27.289977 [info ] [Thread-1 (]: 25 of 43 PASS not_null_avg_ticket_by_category_avg_ticket ....................... [[32mPASS[0m in 0.38s]
[0m14:36:27.289977 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m14:36:27.289977 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m14:36:27.289977 [info ] [Thread-1 (]: 26 of 43 START test non_negative_monthly_revenue_monthly_revenue ............... [RUN]
[0m14:36:27.289977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41, now test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294)
[0m14:36:27.289977 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m14:36:27.289977 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m14:36:27.305680 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294"
[0m14:36:27.305680 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m14:36:27.321269 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294"
[0m14:36:27.321269 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294"
[0m14:36:27.321269 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`monthly_revenue`
where TRY_CAST(REPLACE(monthly_revenue, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m14:36:27.664261 [debug] [Thread-1 (]: SQL status: OK in 0.340 seconds
[0m14:36:27.664261 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-5c28-139d-b1db-e84591325352) - Closing
[0m14:36:27.664261 [info ] [Thread-1 (]: 26 of 43 PASS non_negative_monthly_revenue_monthly_revenue ..................... [[32mPASS[0m in 0.37s]
[0m14:36:27.679754 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m14:36:27.679754 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m14:36:27.679754 [info ] [Thread-1 (]: 27 of 43 START test not_null_monthly_revenue_month ............................. [RUN]
[0m14:36:27.679754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294, now test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b)
[0m14:36:27.679754 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b, idle-time=0.015493392944335938s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m14:36:27.679754 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m14:36:27.710994 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b"
[0m14:36:27.710994 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m14:36:27.726622 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b"
[0m14:36:27.726622 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b"
[0m14:36:27.726622 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month
from `workspace`.`default`.`monthly_revenue`
where month is null



  
  
      
    ) dbt_internal_test
[0m14:36:28.086808 [debug] [Thread-1 (]: SQL status: OK in 0.340 seconds
[0m14:36:28.086808 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-5c66-1de5-8405-279a336e09cc) - Closing
[0m14:36:28.086808 [info ] [Thread-1 (]: 27 of 43 PASS not_null_monthly_revenue_month ................................... [[32mPASS[0m in 0.41s]
[0m14:36:28.086808 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m14:36:28.086808 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m14:36:28.086808 [info ] [Thread-1 (]: 28 of 43 START test not_null_monthly_revenue_monthly_revenue ................... [RUN]
[0m14:36:28.102405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b, now test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b)
[0m14:36:28.102405 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b, idle-time=0.01559758186340332s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m14:36:28.102405 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m14:36:28.102405 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b"
[0m14:36:28.102405 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m14:36:28.118020 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b"
[0m14:36:28.118020 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b"
[0m14:36:28.118020 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select monthly_revenue
from `workspace`.`default`.`monthly_revenue`
where monthly_revenue is null



  
  
      
    ) dbt_internal_test
[0m14:36:28.493191 [debug] [Thread-1 (]: SQL status: OK in 0.380 seconds
[0m14:36:28.498224 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-5ca2-19e4-a668-c2d9f38ac5d6) - Closing
[0m14:36:28.500229 [info ] [Thread-1 (]: 28 of 43 PASS not_null_monthly_revenue_monthly_revenue ......................... [[32mPASS[0m in 0.41s]
[0m14:36:28.502187 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m14:36:28.504190 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m14:36:28.506185 [info ] [Thread-1 (]: 29 of 43 START test non_negative_payment_distribution_total_value .............. [RUN]
[0m14:36:28.508186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b, now test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282)
[0m14:36:28.509282 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282, idle-time=0.010050773620605469s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m14:36:28.509282 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m14:36:28.509282 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282"
[0m14:36:28.509282 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m14:36:28.524964 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282"
[0m14:36:28.524964 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282"
[0m14:36:28.524964 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`payment_distribution`
where TRY_CAST(REPLACE(total_value, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m14:36:28.898599 [debug] [Thread-1 (]: SQL status: OK in 0.370 seconds
[0m14:36:28.898599 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-5ce0-1544-b3e9-16599043fefb) - Closing
[0m14:36:28.898599 [info ] [Thread-1 (]: 29 of 43 PASS non_negative_payment_distribution_total_value .................... [[32mPASS[0m in 0.39s]
[0m14:36:28.898599 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m14:36:28.898599 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m14:36:28.898599 [info ] [Thread-1 (]: 30 of 43 START test not_null_payment_distribution_Payment_Method ............... [RUN]
[0m14:36:28.914224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282, now test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae)
[0m14:36:28.914224 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae, idle-time=0.015625s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m14:36:28.914224 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m14:36:28.914224 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae"
[0m14:36:28.914224 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m14:36:28.929866 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae"
[0m14:36:28.929866 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae"
[0m14:36:28.929866 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Payment_Method
from `workspace`.`default`.`payment_distribution`
where Payment_Method is null



  
  
      
    ) dbt_internal_test
[0m14:36:29.274495 [debug] [Thread-1 (]: SQL status: OK in 0.340 seconds
[0m14:36:29.274495 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-5d1e-14bb-9d69-2e884412c78d) - Closing
[0m14:36:29.274495 [info ] [Thread-1 (]: 30 of 43 PASS not_null_payment_distribution_Payment_Method ..................... [[32mPASS[0m in 0.38s]
[0m14:36:29.290190 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m14:36:29.290190 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m14:36:29.290190 [info ] [Thread-1 (]: 31 of 43 START test not_null_payment_distribution_total_transactions ........... [RUN]
[0m14:36:29.290190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae, now test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8)
[0m14:36:29.290190 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8, idle-time=0.015694379806518555s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m14:36:29.290190 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m14:36:29.305751 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8"
[0m14:36:29.305751 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m14:36:29.305751 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8"
[0m14:36:29.305751 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8"
[0m14:36:29.305751 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_transactions
from `workspace`.`default`.`payment_distribution`
where total_transactions is null



  
  
      
    ) dbt_internal_test
[0m14:36:29.703529 [debug] [Thread-1 (]: SQL status: OK in 0.400 seconds
[0m14:36:29.710531 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-5d57-174f-98c9-afd8fb9ee033) - Closing
[0m14:36:29.713642 [info ] [Thread-1 (]: 31 of 43 PASS not_null_payment_distribution_total_transactions ................. [[32mPASS[0m in 0.42s]
[0m14:36:29.715640 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m14:36:29.717640 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m14:36:29.719644 [info ] [Thread-1 (]: 32 of 43 START test not_null_payment_distribution_total_value .................. [RUN]
[0m14:36:29.721640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8, now test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03)
[0m14:36:29.723641 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03, idle-time=0.00999760627746582s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m14:36:29.724640 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m14:36:29.734643 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03"
[0m14:36:29.737643 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m14:36:29.744742 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03"
[0m14:36:29.746743 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03"
[0m14:36:29.748757 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_value
from `workspace`.`default`.`payment_distribution`
where total_value is null



  
  
      
    ) dbt_internal_test
[0m14:36:30.102640 [debug] [Thread-1 (]: SQL status: OK in 0.350 seconds
[0m14:36:30.118162 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-5d99-1621-8768-5d777d767412) - Closing
[0m14:36:30.118162 [info ] [Thread-1 (]: 32 of 43 PASS not_null_payment_distribution_total_value ........................ [[32mPASS[0m in 0.40s]
[0m14:36:30.118162 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m14:36:30.118162 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m14:36:30.118162 [info ] [Thread-1 (]: 33 of 43 START test non_negative_sales_by_category_total_revenue ............... [RUN]
[0m14:36:30.118162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03, now test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41)
[0m14:36:30.118162 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m14:36:30.118162 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m14:36:30.138129 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41"
[0m14:36:30.140130 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m14:36:30.148129 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41"
[0m14:36:30.149555 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41"
[0m14:36:30.149555 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`sales_by_category`
where TRY_CAST(REPLACE(total_revenue, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m14:36:30.493066 [debug] [Thread-1 (]: SQL status: OK in 0.340 seconds
[0m14:36:30.493066 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-5dd7-17c0-92a5-ce0bbee63cbf) - Closing
[0m14:36:30.493066 [info ] [Thread-1 (]: 33 of 43 PASS non_negative_sales_by_category_total_revenue ..................... [[32mPASS[0m in 0.37s]
[0m14:36:30.508560 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m14:36:30.508560 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m14:36:30.508560 [info ] [Thread-1 (]: 34 of 43 START test not_null_sales_by_category_Category ........................ [RUN]
[0m14:36:30.508560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41, now test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507)
[0m14:36:30.508560 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507, idle-time=0.015493631362915039s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m14:36:30.508560 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m14:36:30.524187 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507"
[0m14:36:30.524187 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m14:36:30.524187 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507"
[0m14:36:30.524187 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507"
[0m14:36:30.524187 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Category
from `workspace`.`default`.`sales_by_category`
where Category is null



  
  
      
    ) dbt_internal_test
[0m14:36:30.961894 [debug] [Thread-1 (]: SQL status: OK in 0.420 seconds
[0m14:36:30.977374 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-5e12-130d-8d67-bdd28ab2492d) - Closing
[0m14:36:30.977374 [info ] [Thread-1 (]: 34 of 43 PASS not_null_sales_by_category_Category .............................. [[32mPASS[0m in 0.47s]
[0m14:36:30.977374 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m14:36:30.977374 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m14:36:30.977374 [info ] [Thread-1 (]: 35 of 43 START test not_null_sales_by_category_total_orders .................... [RUN]
[0m14:36:30.977374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507, now test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e)
[0m14:36:30.977374 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m14:36:30.992998 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m14:36:30.992998 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e"
[0m14:36:30.992998 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m14:36:31.011367 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e"
[0m14:36:31.013405 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e"
[0m14:36:31.014409 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from `workspace`.`default`.`sales_by_category`
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m14:36:31.352239 [debug] [Thread-1 (]: SQL status: OK in 0.340 seconds
[0m14:36:31.367869 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-5e5a-1dd5-af41-24c072569d4d) - Closing
[0m14:36:31.367869 [info ] [Thread-1 (]: 35 of 43 PASS not_null_sales_by_category_total_orders .......................... [[32mPASS[0m in 0.39s]
[0m14:36:31.367869 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m14:36:31.367869 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m14:36:31.367869 [info ] [Thread-1 (]: 36 of 43 START test not_null_sales_by_category_total_revenue ................... [RUN]
[0m14:36:31.367869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e, now test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd)
[0m14:36:31.367869 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m14:36:31.367869 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m14:36:31.383522 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd"
[0m14:36:31.383522 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m14:36:31.399117 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd"
[0m14:36:31.399117 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd"
[0m14:36:31.399117 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from `workspace`.`default`.`sales_by_category`
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m14:36:31.775332 [debug] [Thread-1 (]: SQL status: OK in 0.380 seconds
[0m14:36:31.779333 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-5e96-151f-904c-ee87e504fe7a) - Closing
[0m14:36:31.781334 [info ] [Thread-1 (]: 36 of 43 PASS not_null_sales_by_category_total_revenue ......................... [[32mPASS[0m in 0.41s]
[0m14:36:31.782884 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m14:36:31.784837 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m14:36:31.785839 [info ] [Thread-1 (]: 37 of 43 START test non_negative_top_5_products_total_sales .................... [RUN]
[0m14:36:31.787887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd, now test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34)
[0m14:36:31.788976 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34, idle-time=0.008643627166748047s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m14:36:31.788976 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m14:36:31.788976 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34"
[0m14:36:31.788976 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m14:36:31.804644 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34"
[0m14:36:31.804644 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34"
[0m14:36:31.804644 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`top_5_products`
where TRY_CAST(REPLACE(total_sales, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m14:36:32.164387 [debug] [Thread-1 (]: SQL status: OK in 0.360 seconds
[0m14:36:32.164387 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-5ed4-18a9-832b-eb357617d13b) - Closing
[0m14:36:32.164387 [info ] [Thread-1 (]: 37 of 43 PASS non_negative_top_5_products_total_sales .......................... [[32mPASS[0m in 0.38s]
[0m14:36:32.179886 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m14:36:32.179886 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m14:36:32.179886 [info ] [Thread-1 (]: 38 of 43 START test not_null_top_5_products_product_id ......................... [RUN]
[0m14:36:32.179886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34, now test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe)
[0m14:36:32.179886 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe, idle-time=0.015499353408813477s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m14:36:32.179886 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m14:36:32.195545 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe"
[0m14:36:32.195545 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m14:36:32.195545 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe"
[0m14:36:32.195545 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe"
[0m14:36:32.211119 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `workspace`.`default`.`top_5_products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:36:32.542106 [debug] [Thread-1 (]: SQL status: OK in 0.330 seconds
[0m14:36:32.546117 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-5f11-11b6-b6cd-3bbb36f3ad5b) - Closing
[0m14:36:32.548105 [info ] [Thread-1 (]: 38 of 43 PASS not_null_top_5_products_product_id ............................... [[32mPASS[0m in 0.37s]
[0m14:36:32.551107 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m14:36:32.553106 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m14:36:32.554105 [info ] [Thread-1 (]: 39 of 43 START test not_null_top_5_products_total_sales ........................ [RUN]
[0m14:36:32.556206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe, now test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818)
[0m14:36:32.556206 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818, idle-time=0.008100748062133789s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m14:36:32.556206 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m14:36:32.556206 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818"
[0m14:36:32.556206 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m14:36:32.571839 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818"
[0m14:36:32.571839 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818"
[0m14:36:32.571839 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_sales
from `workspace`.`default`.`top_5_products`
where total_sales is null



  
  
      
    ) dbt_internal_test
[0m14:36:32.931521 [debug] [Thread-1 (]: SQL status: OK in 0.360 seconds
[0m14:36:32.931521 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-5f49-13ce-aa50-f898abf87d13) - Closing
[0m14:36:32.931521 [info ] [Thread-1 (]: 39 of 43 PASS not_null_top_5_products_total_sales .............................. [[32mPASS[0m in 0.38s]
[0m14:36:32.931521 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m14:36:32.947147 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m14:36:32.947147 [info ] [Thread-1 (]: 40 of 43 START test non_negative_top_customers_total_spent ..................... [RUN]
[0m14:36:32.947147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818, now test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667)
[0m14:36:32.947147 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667, idle-time=0.015625715255737305s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m14:36:32.947147 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m14:36:32.947147 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667"
[0m14:36:32.962776 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m14:36:32.962776 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667"
[0m14:36:32.962776 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667"
[0m14:36:32.978900 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`top_customers`
where TRY_CAST(REPLACE(total_spent, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m14:36:33.337191 [debug] [Thread-1 (]: SQL status: OK in 0.360 seconds
[0m14:36:33.352684 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-5f86-1853-b27f-0cf5633be18e) - Closing
[0m14:36:33.352684 [info ] [Thread-1 (]: 40 of 43 PASS non_negative_top_customers_total_spent ........................... [[32mPASS[0m in 0.41s]
[0m14:36:33.352684 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m14:36:33.352684 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m14:36:33.352684 [info ] [Thread-1 (]: 41 of 43 START test not_null_top_customers_User_ID ............................. [RUN]
[0m14:36:33.352684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667, now test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0)
[0m14:36:33.368302 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m14:36:33.368302 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m14:36:33.368302 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0"
[0m14:36:33.368302 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m14:36:33.399642 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0"
[0m14:36:33.399642 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0"
[0m14:36:33.399642 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select User_ID
from `workspace`.`default`.`top_customers`
where User_ID is null



  
  
      
    ) dbt_internal_test
[0m14:36:33.774360 [debug] [Thread-1 (]: SQL status: OK in 0.370 seconds
[0m14:36:33.777398 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-5fc8-1124-8bd4-76fa5523cbf8) - Closing
[0m14:36:33.779360 [info ] [Thread-1 (]: 41 of 43 PASS not_null_top_customers_User_ID ................................... [[32mPASS[0m in 0.43s]
[0m14:36:33.782365 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m14:36:33.783365 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m14:36:33.784365 [info ] [Thread-1 (]: 42 of 43 START test not_null_top_customers_total_orders ........................ [RUN]
[0m14:36:33.786875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0, now test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746)
[0m14:36:33.787874 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746, idle-time=0.008513689041137695s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m14:36:33.788874 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m14:36:33.790067 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746"
[0m14:36:33.790067 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m14:36:33.805700 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746"
[0m14:36:33.805700 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746"
[0m14:36:33.805700 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from `workspace`.`default`.`top_customers`
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m14:36:34.164423 [debug] [Thread-1 (]: SQL status: OK in 0.360 seconds
[0m14:36:34.164423 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-6006-150e-9056-243fa9b6e683) - Closing
[0m14:36:34.164423 [info ] [Thread-1 (]: 42 of 43 PASS not_null_top_customers_total_orders .............................. [[32mPASS[0m in 0.38s]
[0m14:36:34.164423 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m14:36:34.164423 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73
[0m14:36:34.164423 [info ] [Thread-1 (]: 43 of 43 START test not_null_top_customers_total_spent ......................... [RUN]
[0m14:36:34.164423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746, now test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73)
[0m14:36:34.164423 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, name=test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m14:36:34.164423 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73
[0m14:36:34.180007 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73"
[0m14:36:34.180007 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73
[0m14:36:34.195647 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73"
[0m14:36:34.195647 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73"
[0m14:36:34.195647 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_spent
from `workspace`.`default`.`top_customers`
where total_spent is null



  
  
      
    ) dbt_internal_test
[0m14:36:34.539439 [debug] [Thread-1 (]: SQL status: OK in 0.340 seconds
[0m14:36:34.539439 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d, command-id=01f0836c-6040-1ae2-be60-5efc836695d5) - Closing
[0m14:36:34.539439 [info ] [Thread-1 (]: 43 of 43 PASS not_null_top_customers_total_spent ............................... [[32mPASS[0m in 0.38s]
[0m14:36:34.539439 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73
[0m14:36:34.539439 [debug] [MainThread]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=master, idle-time=20.412152528762817s, language=None, compute-name=) - Reusing connection previously named master
[0m14:36:34.555024 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:36:34.555024 [debug] [MainThread]: Connection 'list_workspace' was properly closed.
[0m14:36:34.555024 [debug] [MainThread]: On list_workspace: Close
[0m14:36:34.555024 [debug] [MainThread]: Databricks adapter: Connection(session-id=01f0836c-5311-1729-bc06-e568f4b0b2c1) - Closing
[0m14:36:34.758639 [debug] [MainThread]: Connection 'list_workspace_default' was properly closed.
[0m14:36:34.758639 [debug] [MainThread]: On list_workspace_default: Close
[0m14:36:34.758639 [debug] [MainThread]: Databricks adapter: Connection(session-id=01f0836c-53d5-1823-a1e6-ab020d3e25be) - Closing
[0m14:36:34.977297 [debug] [MainThread]: Connection 'test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73' was properly closed.
[0m14:36:34.992781 [debug] [MainThread]: On test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73: Close
[0m14:36:34.992781 [debug] [MainThread]: Databricks adapter: Connection(session-id=01f0836c-54a9-1f82-b31f-169af665ec0d) - Closing
[0m14:36:35.195482 [info ] [MainThread]: 
[0m14:36:35.195482 [info ] [MainThread]: Finished running 34 data tests, 9 view models in 0 hours 0 minutes and 23.72 seconds (23.72s).
[0m14:36:35.211068 [debug] [MainThread]: Command end result
[0m14:36:35.306491 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m14:36:35.311501 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m14:36:35.321342 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m14:36:35.321342 [info ] [MainThread]: 
[0m14:36:35.321342 [info ] [MainThread]: [31mCompleted with 10 errors, 0 partial successes, and 0 warnings:[0m
[0m14:36:35.321342 [info ] [MainThread]: 
[0m14:36:35.321342 [error] [MainThread]: [31mFailure in test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:36:35.336973 [error] [MainThread]:   Database Error in test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 20 pos 9
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_accepted_values_sqlserv_e814246ceecd68245cb8ed7332e2da84.sql
[0m14:36:35.336973 [info ] [MainThread]: 
[0m14:36:35.336973 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_accepted_values_sqlserv_e814246ceecd68245cb8ed7332e2da84.sql
[0m14:36:35.336973 [info ] [MainThread]: 
[0m14:36:35.336973 [error] [MainThread]: [31mFailure in test source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_ (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:36:35.336973 [error] [MainThread]:   Got 8 results, configured to fail if != 0
[0m14:36:35.336973 [info ] [MainThread]: 
[0m14:36:35.352593 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_assert_source_structure_0af1e5f4dda30d85443523174084b59d.sql
[0m14:36:35.352593 [info ] [MainThread]: 
[0m14:36:35.352593 [error] [MainThread]: [31mFailure in test source_not_null_sqlserver_ecommerce_Category (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:36:35.352593 [error] [MainThread]:   Database Error in test source_not_null_sqlserver_ecommerce_Category (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Category.sql
[0m14:36:35.352593 [info ] [MainThread]: 
[0m14:36:35.352593 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Category.sql
[0m14:36:35.352593 [info ] [MainThread]: 
[0m14:36:35.368224 [error] [MainThread]: [31mFailure in test source_not_null_sqlserver_ecommerce_Discount (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:36:35.368224 [error] [MainThread]:   Database Error in test source_not_null_sqlserver_ecommerce_Discount (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Discount.sql
[0m14:36:35.368224 [info ] [MainThread]: 
[0m14:36:35.368224 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Discount.sql
[0m14:36:35.387251 [info ] [MainThread]: 
[0m14:36:35.390251 [error] [MainThread]: [31mFailure in test source_not_null_sqlserver_ecommerce_Final_Price (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:36:35.393247 [error] [MainThread]:   Database Error in test source_not_null_sqlserver_ecommerce_Final_Price (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Final_Price.sql
[0m14:36:35.396257 [info ] [MainThread]: 
[0m14:36:35.398376 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Final_Price.sql
[0m14:36:35.398376 [info ] [MainThread]: 
[0m14:36:35.398376 [error] [MainThread]: [31mFailure in test source_not_null_sqlserver_ecommerce_Payment_Method (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:36:35.398376 [error] [MainThread]:   Database Error in test source_not_null_sqlserver_ecommerce_Payment_Method (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Payment_Method.sql
[0m14:36:35.398376 [info ] [MainThread]: 
[0m14:36:35.398376 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Payment_Method.sql
[0m14:36:35.398376 [info ] [MainThread]: 
[0m14:36:35.398376 [error] [MainThread]: [31mFailure in test source_not_null_sqlserver_ecommerce_Price (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:36:35.398376 [error] [MainThread]:   Database Error in test source_not_null_sqlserver_ecommerce_Price (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Price.sql
[0m14:36:35.414014 [info ] [MainThread]: 
[0m14:36:35.414014 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Price.sql
[0m14:36:35.414014 [info ] [MainThread]: 
[0m14:36:35.414014 [error] [MainThread]: [31mFailure in test source_not_null_sqlserver_ecommerce_Product_ID (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:36:35.414014 [error] [MainThread]:   Database Error in test source_not_null_sqlserver_ecommerce_Product_ID (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Product_ID.sql
[0m14:36:35.414014 [info ] [MainThread]: 
[0m14:36:35.414014 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Product_ID.sql
[0m14:36:35.414014 [info ] [MainThread]: 
[0m14:36:35.429661 [error] [MainThread]: [31mFailure in test source_not_null_sqlserver_ecommerce_Purchase_Date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:36:35.429661 [error] [MainThread]:   Database Error in test source_not_null_sqlserver_ecommerce_Purchase_Date (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Purchase_Date.sql
[0m14:36:35.429661 [info ] [MainThread]: 
[0m14:36:35.429661 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_Purchase_Date.sql
[0m14:36:35.429661 [info ] [MainThread]: 
[0m14:36:35.429661 [error] [MainThread]: [31mFailure in test source_not_null_sqlserver_ecommerce_User_ID (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:36:35.429661 [error] [MainThread]:   Database Error in test source_not_null_sqlserver_ecommerce_User_ID (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)
  [TABLE_OR_VIEW_NOT_FOUND] The table or view `my_db`.`dbo`.`ecommerce` cannot be found. Verify the spelling and correctness of the schema and catalog.
  If you did not qualify the name with a schema, verify the current_schema() output, or qualify the name with the correct schema and catalog.
  To tolerate the error on drop use DROP VIEW IF EXISTS or DROP TABLE IF EXISTS. SQLSTATE: 42P01; line 17 pos 5
  compiled code at target\run\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_User_ID.sql
[0m14:36:35.429661 [info ] [MainThread]: 
[0m14:36:35.445254 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_not_null_sqlserver_ecommerce_User_ID.sql
[0m14:36:35.445254 [info ] [MainThread]: 
[0m14:36:35.445254 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=10 SKIP=0 NO-OP=0 TOTAL=43
[0m14:36:35.445254 [debug] [MainThread]: Command `dbt build` failed at 14:36:35.445254 after 30.64 seconds
[0m14:36:35.445254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE4993DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEE4BF0550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEEB427650>]}
[0m14:36:35.445254 [debug] [MainThread]: Flushing usage events
[0m14:36:36.227705 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:38:27.617068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D9263E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D92BB410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D9261FD0>]}


============================== 14:38:27.632733 | 98092d95-b29c-4d31-9907-cf8f3cea00d6 ==============================
[0m14:38:27.632733 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:38:27.632733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt build --target databricks', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:38:29.446232 [debug] [MainThread]: Spark adapter: Setting pyhive.hive logging to ERROR
[0m14:38:29.446232 [debug] [MainThread]: Spark adapter: Setting thrift.transport logging to ERROR
[0m14:38:29.446232 [debug] [MainThread]: Spark adapter: Setting thrift.protocol logging to ERROR
[0m14:38:31.221974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98092d95-b29c-4d31-9907-cf8f3cea00d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8E44AEC90>]}
[0m14:38:31.336863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98092d95-b29c-4d31-9907-cf8f3cea00d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D89D9C50>]}
[0m14:38:31.336863 [info ] [MainThread]: Registered adapter: databricks=1.10.4
[0m14:38:32.508152 [debug] [MainThread]: checksum: 3fbc73d786818920aecb1b2190495121ce0b60768fe54c46d521f1e82da30af9, vars: {}, profile: , target: databricks, version: 1.10.3
[0m14:38:32.824072 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_databricks_cicd: raw\sqlserver\schema.yml - Runtime Error
    Syntax error near line 12
    ------------------------------
    9  |         description: Tabela de vendas do e-commerce
    10 | 
    11 |         # Teste global da estrutura da tabela:
    12 |         {% if target.name == 'sqlserver' %}
    13 |         tests:
    14 |           - assert_source_structure:
    15 |               expected_columns:
    
    Raw Error:
    ------------------------------
    while scanning for the next token
    found character that cannot start any token
      in "<unicode string>", line 12, column 10
[0m14:38:32.828608 [debug] [MainThread]: Command `dbt build` failed at 14:38:32.827618 after 5.33 seconds
[0m14:38:32.830613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D2803DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D9263790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8D92632D0>]}
[0m14:38:32.832600 [debug] [MainThread]: Flushing usage events
[0m14:38:34.312900 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:40:17.851941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9804BBD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9804BB0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9804B8250>]}


============================== 14:40:17.867605 | 70e92e40-c17d-4957-b5f5-f9bbfeca5118 ==============================
[0m14:40:17.867605 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:40:17.867605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --target databricks', 'send_anonymous_usage_stats': 'True'}
[0m14:40:19.571008 [debug] [MainThread]: Spark adapter: Setting pyhive.hive logging to ERROR
[0m14:40:19.571008 [debug] [MainThread]: Spark adapter: Setting thrift.transport logging to ERROR
[0m14:40:19.571008 [debug] [MainThread]: Spark adapter: Setting thrift.protocol logging to ERROR
[0m14:40:21.352243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70e92e40-c17d-4957-b5f5-f9bbfeca5118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A98B4724D0>]}
[0m14:40:21.462410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70e92e40-c17d-4957-b5f5-f9bbfeca5118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9FFB99AD0>]}
[0m14:40:21.462410 [info ] [MainThread]: Registered adapter: databricks=1.10.4
[0m14:40:22.539898 [debug] [MainThread]: checksum: 3fbc73d786818920aecb1b2190495121ce0b60768fe54c46d521f1e82da30af9, vars: {}, profile: , target: databricks, version: 1.10.3
[0m14:40:22.825780 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_databricks_cicd: raw\sqlserver\schema.yml - Runtime Error
    Syntax error near line 13
    ------------------------------
    10 | 
    11 |         # Teste global da estrutura da tabela:
    12 |         tests:
    13 |           {% if target.name == 'sqlserver' %}
    14 |           - assert_source_structure:
    15 |               expected_columns:
    16 |                 - name: Category
    
    Raw Error:
    ------------------------------
    while scanning for the next token
    found character that cannot start any token
      in "<unicode string>", line 13, column 12
[0m14:40:22.829781 [debug] [MainThread]: Command `dbt build` failed at 14:40:22.829781 after 5.10 seconds
[0m14:40:22.831780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9804BACD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9F99C3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A980510190>]}
[0m14:40:22.832779 [debug] [MainThread]: Flushing usage events
[0m14:40:23.430591 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:41:58.149637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DE931E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DE9334D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DE9326D0>]}


============================== 14:41:58.165303 | 0a8be076-f759-4aff-996f-986381b5f922 ==============================
[0m14:41:58.165303 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:41:58.165303 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --target databricks', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:41:59.960890 [debug] [MainThread]: Spark adapter: Setting pyhive.hive logging to ERROR
[0m14:41:59.960890 [debug] [MainThread]: Spark adapter: Setting thrift.transport logging to ERROR
[0m14:41:59.960890 [debug] [MainThread]: Spark adapter: Setting thrift.protocol logging to ERROR
[0m14:42:02.011812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a8be076-f759-4aff-996f-986381b5f922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E91A3AD0>]}
[0m14:42:02.133803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a8be076-f759-4aff-996f-986381b5f922', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DD8A1F10>]}
[0m14:42:02.133803 [info ] [MainThread]: Registered adapter: databricks=1.10.4
[0m14:42:03.305932 [debug] [MainThread]: checksum: 3fbc73d786818920aecb1b2190495121ce0b60768fe54c46d521f1e82da30af9, vars: {}, profile: , target: databricks, version: 1.10.3
[0m14:42:03.540481 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_databricks_cicd: raw\sqlserver\schema.yml - Runtime Error
    Syntax error near line 13
    ------------------------------
    10 | 
    11 |         # Teste global da estrutura da tabela:
    12 |         tests:
    13 |           {% if target.name == 'sqlserver' %}
    14 |           
    15 |           - assert_source_structure:
    16 |               expected_columns:
    
    Raw Error:
    ------------------------------
    while scanning for the next token
    found character that cannot start any token
      in "<unicode string>", line 13, column 12
[0m14:42:03.559319 [debug] [MainThread]: Command `dbt build` failed at 14:42:03.559319 after 5.53 seconds
[0m14:42:03.561330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9D7EC3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DE98AE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9DE98AF90>]}
[0m14:42:03.562325 [debug] [MainThread]: Flushing usage events
[0m14:42:04.164659 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:44:18.368200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901CDD0A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901CDD29D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901CDD1A50>]}


============================== 14:44:18.368200 | d0c7fe41-bf7b-4a57-bb2e-fc8953bb200f ==============================
[0m14:44:18.368200 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:44:18.368200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --target databricks --models staging+', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:44:18.368200 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m14:44:18.383827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd0c7fe41-bf7b-4a57-bb2e-fc8953bb200f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901CDFFF50>]}
[0m14:44:20.097452 [debug] [MainThread]: Spark adapter: Setting pyhive.hive logging to ERROR
[0m14:44:20.099451 [debug] [MainThread]: Spark adapter: Setting thrift.transport logging to ERROR
[0m14:44:20.100466 [debug] [MainThread]: Spark adapter: Setting thrift.protocol logging to ERROR
[0m14:44:21.867891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0c7fe41-bf7b-4a57-bb2e-fc8953bb200f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029028067F50>]}
[0m14:44:21.976803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0c7fe41-bf7b-4a57-bb2e-fc8953bb200f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901C539C90>]}
[0m14:44:21.976803 [info ] [MainThread]: Registered adapter: databricks=1.10.4
[0m14:44:23.071449 [debug] [MainThread]: checksum: 3fbc73d786818920aecb1b2190495121ce0b60768fe54c46d521f1e82da30af9, vars: {}, profile: , target: databricks, version: 1.10.3
[0m14:44:23.590575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:44:23.592575 [debug] [MainThread]: Partial parsing: updated file: dbt_databricks_cicd://macros\assert_source_structure.sql
[0m14:44:24.290773 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m14:44:24.317891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0c7fe41-bf7b-4a57-bb2e-fc8953bb200f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029029650B90>]}
[0m14:44:24.507870 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m14:44:24.507870 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m14:44:24.601618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0c7fe41-bf7b-4a57-bb2e-fc8953bb200f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002902991BB90>]}
[0m14:44:24.601618 [info ] [MainThread]: Found 9 models, 34 data tests, 1 source, 799 macros
[0m14:44:24.601618 [info ] [MainThread]: 
[0m14:44:24.617241 [info ] [MainThread]: Concurrency: 1 threads (target='databricks')
[0m14:44:24.617241 [info ] [MainThread]: 
[0m14:44:24.617241 [debug] [MainThread]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=master, idle-time=0s, language=None, compute-name=) - Creating connection
[0m14:44:24.617241 [debug] [MainThread]: Acquiring new databricks connection 'master'
[0m14:44:24.632869 [debug] [ThreadPool]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=list_workspace, idle-time=0s, language=None, compute-name=) - Creating connection
[0m14:44:24.632869 [debug] [ThreadPool]: Acquiring new databricks connection 'list_workspace'
[0m14:44:24.632869 [debug] [ThreadPool]: Using databricks connection "list_workspace"
[0m14:44:24.632869 [debug] [ThreadPool]: On list_workspace: GetSchemas(database=workspace, schema=None)
[0m14:44:24.632869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:25.493205 [debug] [ThreadPool]: Databricks adapter: Connection(session-id=01f0836d-790d-151f-93e3-d6f9fa310fd0) - Created
[0m14:44:26.039455 [debug] [ThreadPool]: SQL status: OK in 1.410 seconds
[0m14:44:26.039455 [debug] [ThreadPool]: Databricks adapter: Cursor(session-id=01f0836d-790d-151f-93e3-d6f9fa310fd0, command-id=01f0836d-792b-1f8c-9363-cc13601dfd8f) - Closing
[0m14:44:26.055088 [debug] [ThreadPool]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=list_workspace_default, idle-time=0s, language=None, compute-name=) - Creating connection
[0m14:44:26.055088 [debug] [ThreadPool]: Acquiring new databricks connection 'list_workspace_default'
[0m14:44:26.083325 [debug] [ThreadPool]: Using databricks connection "list_workspace_default"
[0m14:44:26.085317 [debug] [ThreadPool]: On list_workspace_default: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "connection_name": "list_workspace_default"} */

    
SELECT
  table_name,
  if(table_type IN ('EXTERNAL', 'MANAGED', 'MANAGED_SHALLOW_CLONE', 'EXTERNAL_SHALLOW_CLONE'), 'table', lower(table_type)) AS table_type,
  lower(data_source_format) AS file_format,
  table_owner
FROM `system`.`information_schema`.`tables`
WHERE table_catalog = 'workspace' 
  AND table_schema = 'default'

  
[0m14:44:26.087315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:26.883032 [debug] [ThreadPool]: Databricks adapter: Connection(session-id=01f0836d-79de-1c67-962f-72133658c2cb) - Created
[0m14:44:27.352325 [debug] [ThreadPool]: SQL status: OK in 1.270 seconds
[0m14:44:27.367951 [debug] [ThreadPool]: Databricks adapter: Cursor(session-id=01f0836d-79de-1c67-962f-72133658c2cb, command-id=01f0836d-79ff-1c23-b7d1-36054ab89a1a) - Closing
[0m14:44:27.367951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0c7fe41-bf7b-4a57-bb2e-fc8953bb200f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029019EC43D0>]}
[0m14:44:27.383579 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce
[0m14:44:27.383579 [info ] [Thread-1 (]: 1 of 33 START sql view model default.src_ecommerce ............................. [RUN]
[0m14:44:27.383579 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=model.dbt_databricks_cicd.src_ecommerce, idle-time=0s, language=None, compute-name=) - Creating connection
[0m14:44:27.383579 [debug] [Thread-1 (]: Acquiring new databricks connection 'model.dbt_databricks_cicd.src_ecommerce'
[0m14:44:27.383579 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.src_ecommerce
[0m14:44:27.412555 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.src_ecommerce"
[0m14:44:27.414780 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.src_ecommerce
[0m14:44:27.430408 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:44:27.430408 [warn ] [Thread-1 (]: [[33mWARNING[0m]: Use revamped materializations based on separating create and insert.  This allows more performant column comments, as well as new column features.
You may opt into the new behavior sooner by setting `flags.use_materialization_v2` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m14:44:27.446077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'd0c7fe41-bf7b-4a57-bb2e-fc8953bb200f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029029636A10>]}
[0m14:44:27.477289 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`src_ecommerce`
[0m14:44:27.517044 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.src_ecommerce"
[0m14:44:27.520060 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.src_ecommerce"
[0m14:44:27.521055 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.src_ecommerce"} */

  
  
  
  create or replace view `workspace`.`default`.`src_ecommerce`
  
  as (
    SELECT * FROM default.sales_ecommerce
  )

[0m14:44:27.523045 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:44:28.242962 [debug] [Thread-1 (]: Databricks adapter: Connection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2) - Created
[0m14:44:28.852433 [debug] [Thread-1 (]: SQL status: OK in 1.330 seconds
[0m14:44:28.852433 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-7ace-14f1-9be7-5e9b36ecfec2) - Closing
[0m14:44:28.868105 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:44:28.883736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0c7fe41-bf7b-4a57-bb2e-fc8953bb200f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029029637F90>]}
[0m14:44:28.883736 [info ] [Thread-1 (]: 1 of 33 OK created sql view model default.src_ecommerce ........................ [[32mOK[0m in 1.50s]
[0m14:44:28.883736 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce
[0m14:44:28.883736 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.stg_ecommerce
[0m14:44:28.883736 [info ] [Thread-1 (]: 2 of 33 START sql view model default.stg_ecommerce ............................. [RUN]
[0m14:44:28.899314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.src_ecommerce, now model.dbt_databricks_cicd.stg_ecommerce)
[0m14:44:28.899314 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=model.dbt_databricks_cicd.stg_ecommerce, idle-time=0.015577554702758789s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.src_ecommerce
[0m14:44:28.899314 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.stg_ecommerce
[0m14:44:28.899314 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.stg_ecommerce"
[0m14:44:28.899314 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.stg_ecommerce
[0m14:44:28.914941 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:44:28.914941 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`stg_ecommerce`
[0m14:44:28.914941 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.stg_ecommerce"
[0m14:44:28.914941 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.stg_ecommerce"
[0m14:44:28.914941 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.stg_ecommerce"} */

  
  
  
  create or replace view `workspace`.`default`.`stg_ecommerce`
  
  as (
    SELECT
  User_ID,
  Product_ID,
  Category,
  Price,
  Discount,
  Final_Price,
  Payment_Method,
  Purchase_Date
FROM `workspace`.`default`.`src_ecommerce`
  )

[0m14:44:29.476837 [debug] [Thread-1 (]: SQL status: OK in 0.560 seconds
[0m14:44:29.476837 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-7b36-1631-9c1d-e81b72b1e2a6) - Closing
[0m14:44:29.476837 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:44:29.476837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0c7fe41-bf7b-4a57-bb2e-fc8953bb200f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029029666C90>]}
[0m14:44:29.476837 [info ] [Thread-1 (]: 2 of 33 OK created sql view model default.stg_ecommerce ........................ [[32mOK[0m in 0.58s]
[0m14:44:29.476837 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.stg_ecommerce
[0m14:44:29.492343 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.avg_discount_by_category
[0m14:44:29.492343 [info ] [Thread-1 (]: 3 of 33 START sql view model default.avg_discount_by_category .................. [RUN]
[0m14:44:29.492343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.stg_ecommerce, now model.dbt_databricks_cicd.avg_discount_by_category)
[0m14:44:29.492343 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=model.dbt_databricks_cicd.avg_discount_by_category, idle-time=0.015505790710449219s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.stg_ecommerce
[0m14:44:29.492343 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.avg_discount_by_category
[0m14:44:29.508029 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.avg_discount_by_category"
[0m14:44:29.508029 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.avg_discount_by_category
[0m14:44:29.508029 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:44:29.508029 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`avg_discount_by_category`
[0m14:44:29.523640 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.avg_discount_by_category"
[0m14:44:29.523640 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.avg_discount_by_category"
[0m14:44:29.523640 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.avg_discount_by_category: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.avg_discount_by_category"} */

  
  
  
  create or replace view `workspace`.`default`.`avg_discount_by_category`
  
  as (
    SELECT
  Category,
  ROUND(AVG(CAST(`Discount` AS DOUBLE)), 2) AS avg_discount_percent
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY Category
ORDER BY avg_discount_percent DESC
  )

[0m14:44:30.103412 [debug] [Thread-1 (]: SQL status: OK in 0.580 seconds
[0m14:44:30.103412 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-7b92-13a8-8a2c-cb6e1980804f) - Closing
[0m14:44:30.103412 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:44:30.103412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0c7fe41-bf7b-4a57-bb2e-fc8953bb200f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029029D0E110>]}
[0m14:44:30.103412 [info ] [Thread-1 (]: 3 of 33 OK created sql view model default.avg_discount_by_category ............. [[32mOK[0m in 0.61s]
[0m14:44:30.103412 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.avg_discount_by_category
[0m14:44:30.103412 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.avg_ticket_by_category
[0m14:44:30.103412 [info ] [Thread-1 (]: 4 of 33 START sql view model default.avg_ticket_by_category .................... [RUN]
[0m14:44:30.118997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.avg_discount_by_category, now model.dbt_databricks_cicd.avg_ticket_by_category)
[0m14:44:30.118997 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=model.dbt_databricks_cicd.avg_ticket_by_category, idle-time=0.015584945678710938s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.avg_discount_by_category
[0m14:44:30.118997 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.avg_ticket_by_category
[0m14:44:30.118997 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.avg_ticket_by_category"
[0m14:44:30.118997 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.avg_ticket_by_category
[0m14:44:30.138023 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:44:30.141021 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`avg_ticket_by_category`
[0m14:44:30.143021 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.avg_ticket_by_category"
[0m14:44:30.145066 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.avg_ticket_by_category"
[0m14:44:30.147048 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.avg_ticket_by_category: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.avg_ticket_by_category"} */

  
  
  
  create or replace view `workspace`.`default`.`avg_ticket_by_category`
  
  as (
    SELECT
  Category,
  ROUND(AVG(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS avg_ticket
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY Category
ORDER BY avg_ticket DESC
  )

[0m14:44:30.785224 [debug] [Thread-1 (]: SQL status: OK in 0.640 seconds
[0m14:44:30.787225 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-7bf1-1374-9f44-06546234c376) - Closing
[0m14:44:30.789225 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:44:30.791227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0c7fe41-bf7b-4a57-bb2e-fc8953bb200f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029029CD6F90>]}
[0m14:44:30.793225 [info ] [Thread-1 (]: 4 of 33 OK created sql view model default.avg_ticket_by_category ............... [[32mOK[0m in 0.67s]
[0m14:44:30.794845 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.avg_ticket_by_category
[0m14:44:30.796798 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.monthly_revenue
[0m14:44:30.797971 [info ] [Thread-1 (]: 5 of 33 START sql view model default.monthly_revenue ........................... [RUN]
[0m14:44:30.800261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.avg_ticket_by_category, now model.dbt_databricks_cicd.monthly_revenue)
[0m14:44:30.801220 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=model.dbt_databricks_cicd.monthly_revenue, idle-time=0.009992599487304688s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.avg_ticket_by_category
[0m14:44:30.802261 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.monthly_revenue
[0m14:44:30.805299 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.monthly_revenue"
[0m14:44:30.805299 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.monthly_revenue
[0m14:44:30.805299 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:44:30.805299 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`monthly_revenue`
[0m14:44:30.820970 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.monthly_revenue"
[0m14:44:30.820970 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.monthly_revenue"
[0m14:44:30.820970 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.monthly_revenue: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.monthly_revenue"} */

  
  
  
  create or replace view `workspace`.`default`.`monthly_revenue`
  
  as (
    SELECT
  CAST(DATE_TRUNC('month', CAST(Purchase_Date AS DATE)) AS DATE) AS month,
  ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS monthly_revenue
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY 1
ORDER BY 1
  )

[0m14:44:31.383839 [debug] [Thread-1 (]: SQL status: OK in 0.560 seconds
[0m14:44:31.383839 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-7c58-18ee-bfed-4a7cb9612048) - Closing
[0m14:44:31.383839 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:44:31.383839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0c7fe41-bf7b-4a57-bb2e-fc8953bb200f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290299252D0>]}
[0m14:44:31.383839 [info ] [Thread-1 (]: 5 of 33 OK created sql view model default.monthly_revenue ...................... [[32mOK[0m in 0.58s]
[0m14:44:31.399467 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.monthly_revenue
[0m14:44:31.399467 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.payment_distribution
[0m14:44:31.399467 [info ] [Thread-1 (]: 6 of 33 START sql view model default.payment_distribution ...................... [RUN]
[0m14:44:31.399467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.monthly_revenue, now model.dbt_databricks_cicd.payment_distribution)
[0m14:44:31.399467 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=model.dbt_databricks_cicd.payment_distribution, idle-time=0.015627622604370117s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.monthly_revenue
[0m14:44:31.399467 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.payment_distribution
[0m14:44:31.415132 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.payment_distribution"
[0m14:44:31.415132 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.payment_distribution
[0m14:44:31.415132 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:44:31.415132 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`payment_distribution`
[0m14:44:31.432354 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.payment_distribution"
[0m14:44:31.434314 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.payment_distribution"
[0m14:44:31.435313 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.payment_distribution: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.payment_distribution"} */

  
  
  
  create or replace view `workspace`.`default`.`payment_distribution`
  
  as (
    SELECT
  Payment_Method,
  COUNT(*) AS total_transactions,
  ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS total_value
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY Payment_Method
ORDER BY total_value DESC
  )

[0m14:44:32.094735 [debug] [Thread-1 (]: SQL status: OK in 0.660 seconds
[0m14:44:32.096736 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-7cb4-1e88-9eba-8d0a0ff9019a) - Closing
[0m14:44:32.098737 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:44:32.100736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0c7fe41-bf7b-4a57-bb2e-fc8953bb200f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029029D7C4D0>]}
[0m14:44:32.101734 [info ] [Thread-1 (]: 6 of 33 OK created sql view model default.payment_distribution ................. [[32mOK[0m in 0.70s]
[0m14:44:32.103741 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.payment_distribution
[0m14:44:32.105752 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.sales_by_category
[0m14:44:32.106735 [info ] [Thread-1 (]: 7 of 33 START sql view model default.sales_by_category ......................... [RUN]
[0m14:44:32.109213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.payment_distribution, now model.dbt_databricks_cicd.sales_by_category)
[0m14:44:32.110216 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=model.dbt_databricks_cicd.sales_by_category, idle-time=0.010479927062988281s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.payment_distribution
[0m14:44:32.112231 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.sales_by_category
[0m14:44:32.117298 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.sales_by_category"
[0m14:44:32.117298 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.sales_by_category
[0m14:44:32.117298 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:44:32.117298 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`sales_by_category`
[0m14:44:32.132933 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.sales_by_category"
[0m14:44:32.132933 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.sales_by_category"
[0m14:44:32.132933 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.sales_by_category: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.sales_by_category"} */

  
  
  
  create or replace view `workspace`.`default`.`sales_by_category`
  
  as (
    SELECT
  Category,
  COUNT(*) AS total_orders,
  ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS total_revenue
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY Category
ORDER BY total_revenue DESC
  )

[0m14:44:32.680626 [debug] [Thread-1 (]: SQL status: OK in 0.550 seconds
[0m14:44:32.680626 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-7d21-1251-a95c-596f82ab26c5) - Closing
[0m14:44:32.696115 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:44:32.696115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0c7fe41-bf7b-4a57-bb2e-fc8953bb200f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029029CC5A10>]}
[0m14:44:32.696115 [info ] [Thread-1 (]: 7 of 33 OK created sql view model default.sales_by_category .................... [[32mOK[0m in 0.59s]
[0m14:44:32.696115 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.sales_by_category
[0m14:44:32.711744 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.top_5_products
[0m14:44:32.711744 [info ] [Thread-1 (]: 8 of 33 START sql view model default.top_5_products ............................ [RUN]
[0m14:44:32.711744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.sales_by_category, now model.dbt_databricks_cicd.top_5_products)
[0m14:44:32.711744 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=model.dbt_databricks_cicd.top_5_products, idle-time=0.015629291534423828s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.sales_by_category
[0m14:44:32.711744 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.top_5_products
[0m14:44:32.727405 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.top_5_products"
[0m14:44:32.727405 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.top_5_products
[0m14:44:32.727405 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:44:32.727405 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`top_5_products`
[0m14:44:32.727405 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.top_5_products"
[0m14:44:32.727405 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.top_5_products"
[0m14:44:32.743063 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.top_5_products: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.top_5_products"} */

  
  
  
  create or replace view `workspace`.`default`.`top_5_products`
  
  as (
    WITH base AS (
    SELECT
        product_id,
        ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS total_sales
    FROM `workspace`.`default`.`stg_ecommerce`
    GROUP BY product_id
)

SELECT
    product_id,
    total_sales
FROM base
ORDER BY total_sales DESC
LIMIT 5
  )

[0m14:44:33.315613 [debug] [Thread-1 (]: SQL status: OK in 0.570 seconds
[0m14:44:33.317614 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-7d7e-1175-99db-a2ba6c97e183) - Closing
[0m14:44:33.319615 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:44:33.321690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0c7fe41-bf7b-4a57-bb2e-fc8953bb200f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029029D67DD0>]}
[0m14:44:33.321690 [info ] [Thread-1 (]: 8 of 33 OK created sql view model default.top_5_products ....................... [[32mOK[0m in 0.61s]
[0m14:44:33.321690 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.top_5_products
[0m14:44:33.321690 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.top_customers
[0m14:44:33.321690 [info ] [Thread-1 (]: 9 of 33 START sql view model default.top_customers ............................. [RUN]
[0m14:44:33.321690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.top_5_products, now model.dbt_databricks_cicd.top_customers)
[0m14:44:33.321690 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=model.dbt_databricks_cicd.top_customers, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.top_5_products
[0m14:44:33.321690 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.top_customers
[0m14:44:33.337319 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.top_customers"
[0m14:44:33.337319 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.top_customers
[0m14:44:33.337319 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m14:44:33.337319 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`top_customers`
[0m14:44:33.337319 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.top_customers"
[0m14:44:33.352944 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.top_customers"
[0m14:44:33.352944 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.top_customers: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.top_customers"} */

  
  
  
  create or replace view `workspace`.`default`.`top_customers`
  
  as (
    SELECT
  User_ID,
  COUNT(*) AS total_orders,
  ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS total_spent
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY User_ID
ORDER BY total_spent DESC
LIMIT 10
  )

[0m14:44:33.916853 [debug] [Thread-1 (]: SQL status: OK in 0.560 seconds
[0m14:44:33.919894 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-7dda-1c87-835f-1e0b5cb83ac3) - Closing
[0m14:44:33.920850 [debug] [Thread-1 (]: Applying tags to relation None
[0m14:44:33.922893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0c7fe41-bf7b-4a57-bb2e-fc8953bb200f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029029CC6510>]}
[0m14:44:33.924892 [info ] [Thread-1 (]: 9 of 33 OK created sql view model default.top_customers ........................ [[32mOK[0m in 0.60s]
[0m14:44:33.926852 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.top_customers
[0m14:44:33.928854 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m14:44:33.930196 [info ] [Thread-1 (]: 10 of 33 START test non_negative_avg_discount_by_category_avg_discount_percent . [RUN]
[0m14:44:33.932406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.top_customers, now test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f)
[0m14:44:33.933406 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f, idle-time=0.010512590408325195s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.top_customers
[0m14:44:33.934406 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m14:44:33.947574 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f"
[0m14:44:33.949580 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m14:44:33.976806 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f"
[0m14:44:33.976806 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f"
[0m14:44:33.976806 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`avg_discount_by_category`
where TRY_CAST(REPLACE(avg_discount_percent, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m14:44:34.352804 [debug] [Thread-1 (]: SQL status: OK in 0.360 seconds
[0m14:44:34.352804 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-7e3b-10a2-a7ba-8e457acc05cb) - Closing
[0m14:44:34.352804 [info ] [Thread-1 (]: 10 of 33 PASS non_negative_avg_discount_by_category_avg_discount_percent ....... [[32mPASS[0m in 0.42s]
[0m14:44:34.352804 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m14:44:34.352804 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m14:44:34.352804 [info ] [Thread-1 (]: 11 of 33 START test not_null_avg_discount_by_category_Category ................. [RUN]
[0m14:44:34.368382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f, now test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b)
[0m14:44:34.368382 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b, idle-time=0.01557779312133789s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m14:44:34.368382 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m14:44:34.384072 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b"
[0m14:44:34.384072 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m14:44:34.384072 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b"
[0m14:44:34.401852 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b"
[0m14:44:34.402851 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Category
from `workspace`.`default`.`avg_discount_by_category`
where Category is null



  
  
      
    ) dbt_internal_test
[0m14:44:34.789761 [debug] [Thread-1 (]: SQL status: OK in 0.390 seconds
[0m14:44:34.805248 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-7e7a-12d5-90e4-d78a65f6cb76) - Closing
[0m14:44:34.805248 [info ] [Thread-1 (]: 11 of 33 PASS not_null_avg_discount_by_category_Category ....................... [[32mPASS[0m in 0.44s]
[0m14:44:34.805248 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m14:44:34.805248 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m14:44:34.805248 [info ] [Thread-1 (]: 12 of 33 START test not_null_avg_discount_by_category_avg_discount_percent ..... [RUN]
[0m14:44:34.805248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b, now test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101)
[0m14:44:34.805248 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m14:44:34.805248 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m14:44:34.820871 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101"
[0m14:44:34.820871 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m14:44:34.837756 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101"
[0m14:44:34.841724 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101"
[0m14:44:34.842724 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_discount_percent
from `workspace`.`default`.`avg_discount_by_category`
where avg_discount_percent is null



  
  
      
    ) dbt_internal_test
[0m14:44:35.196194 [debug] [Thread-1 (]: SQL status: OK in 0.350 seconds
[0m14:44:35.196194 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-7ebd-1814-b652-399670c5b083) - Closing
[0m14:44:35.196194 [info ] [Thread-1 (]: 12 of 33 PASS not_null_avg_discount_by_category_avg_discount_percent ........... [[32mPASS[0m in 0.39s]
[0m14:44:35.211682 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m14:44:35.211682 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m14:44:35.211682 [info ] [Thread-1 (]: 13 of 33 START test non_negative_avg_ticket_by_category_avg_ticket ............. [RUN]
[0m14:44:35.211682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101, now test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095)
[0m14:44:35.211682 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095, idle-time=0.0154876708984375s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m14:44:35.211682 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m14:44:35.227341 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095"
[0m14:44:35.227341 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m14:44:35.227341 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095"
[0m14:44:35.227341 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095"
[0m14:44:35.242927 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`avg_ticket_by_category`
where TRY_CAST(REPLACE(avg_ticket, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m14:44:35.607425 [debug] [Thread-1 (]: SQL status: OK in 0.360 seconds
[0m14:44:35.611426 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-7efa-1a71-b695-f1f595c8c84e) - Closing
[0m14:44:35.613427 [info ] [Thread-1 (]: 13 of 33 PASS non_negative_avg_ticket_by_category_avg_ticket ................... [[32mPASS[0m in 0.40s]
[0m14:44:35.616469 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m14:44:35.617773 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m14:44:35.617773 [info ] [Thread-1 (]: 14 of 33 START test not_null_avg_ticket_by_category_Category ................... [RUN]
[0m14:44:35.617773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095, now test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f)
[0m14:44:35.617773 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f, idle-time=0.005346775054931641s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m14:44:35.617773 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m14:44:35.617773 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f"
[0m14:44:35.633436 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m14:44:35.633436 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f"
[0m14:44:35.633436 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f"
[0m14:44:35.633436 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Category
from `workspace`.`default`.`avg_ticket_by_category`
where Category is null



  
  
      
    ) dbt_internal_test
[0m14:44:35.976756 [debug] [Thread-1 (]: SQL status: OK in 0.340 seconds
[0m14:44:35.976756 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-7f38-15a8-8a29-0d1ba503089c) - Closing
[0m14:44:35.976756 [info ] [Thread-1 (]: 14 of 33 PASS not_null_avg_ticket_by_category_Category ......................... [[32mPASS[0m in 0.36s]
[0m14:44:35.976756 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m14:44:35.976756 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m14:44:35.976756 [info ] [Thread-1 (]: 15 of 33 START test not_null_avg_ticket_by_category_avg_ticket ................. [RUN]
[0m14:44:35.992243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f, now test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41)
[0m14:44:35.992243 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41, idle-time=0.015487432479858398s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m14:44:35.992243 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m14:44:35.992243 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41"
[0m14:44:35.992243 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m14:44:36.007871 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41"
[0m14:44:36.007871 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41"
[0m14:44:36.007871 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_ticket
from `workspace`.`default`.`avg_ticket_by_category`
where avg_ticket is null



  
  
      
    ) dbt_internal_test
[0m14:44:36.367388 [debug] [Thread-1 (]: SQL status: OK in 0.360 seconds
[0m14:44:36.367388 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-7f70-15b2-93a0-bd3655d9e40b) - Closing
[0m14:44:36.367388 [info ] [Thread-1 (]: 15 of 33 PASS not_null_avg_ticket_by_category_avg_ticket ....................... [[32mPASS[0m in 0.38s]
[0m14:44:36.367388 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m14:44:36.367388 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m14:44:36.383698 [info ] [Thread-1 (]: 16 of 33 START test non_negative_monthly_revenue_monthly_revenue ............... [RUN]
[0m14:44:36.384693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41, now test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294)
[0m14:44:36.386695 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294, idle-time=0.019307374954223633s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m14:44:36.388696 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m14:44:36.402162 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294"
[0m14:44:36.406161 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m14:44:36.415238 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294"
[0m14:44:36.415238 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294"
[0m14:44:36.415238 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`monthly_revenue`
where TRY_CAST(REPLACE(monthly_revenue, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m14:44:36.757911 [debug] [Thread-1 (]: SQL status: OK in 0.340 seconds
[0m14:44:36.773439 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-7fae-1b6c-a934-a24d6d26e587) - Closing
[0m14:44:36.773439 [info ] [Thread-1 (]: 16 of 33 PASS non_negative_monthly_revenue_monthly_revenue ..................... [[32mPASS[0m in 0.39s]
[0m14:44:36.773439 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m14:44:36.773439 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m14:44:36.773439 [info ] [Thread-1 (]: 17 of 33 START test not_null_monthly_revenue_month ............................. [RUN]
[0m14:44:36.773439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294, now test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b)
[0m14:44:36.773439 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m14:44:36.773439 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m14:44:36.789027 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b"
[0m14:44:36.789027 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m14:44:36.804653 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b"
[0m14:44:36.804653 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b"
[0m14:44:36.804653 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month
from `workspace`.`default`.`monthly_revenue`
where month is null



  
  
      
    ) dbt_internal_test
[0m14:44:37.195496 [debug] [Thread-1 (]: SQL status: OK in 0.390 seconds
[0m14:44:37.195496 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-7fea-14dd-b25e-749556eb6d8b) - Closing
[0m14:44:37.195496 [info ] [Thread-1 (]: 17 of 33 PASS not_null_monthly_revenue_month ................................... [[32mPASS[0m in 0.42s]
[0m14:44:37.195496 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m14:44:37.210982 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m14:44:37.210982 [info ] [Thread-1 (]: 18 of 33 START test not_null_monthly_revenue_monthly_revenue ................... [RUN]
[0m14:44:37.210982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b, now test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b)
[0m14:44:37.210982 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b, idle-time=0.015486478805541992s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m14:44:37.210982 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m14:44:37.210982 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b"
[0m14:44:37.226619 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m14:44:37.226619 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b"
[0m14:44:37.226619 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b"
[0m14:44:37.226619 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select monthly_revenue
from `workspace`.`default`.`monthly_revenue`
where monthly_revenue is null



  
  
      
    ) dbt_internal_test
[0m14:44:37.586972 [debug] [Thread-1 (]: SQL status: OK in 0.340 seconds
[0m14:44:37.586972 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-802b-15ce-83ce-bf98128b1284) - Closing
[0m14:44:37.586972 [info ] [Thread-1 (]: 18 of 33 PASS not_null_monthly_revenue_monthly_revenue ......................... [[32mPASS[0m in 0.38s]
[0m14:44:37.586972 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m14:44:37.602641 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m14:44:37.602641 [info ] [Thread-1 (]: 19 of 33 START test non_negative_payment_distribution_total_value .............. [RUN]
[0m14:44:37.602641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b, now test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282)
[0m14:44:37.602641 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282, idle-time=0.015668630599975586s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m14:44:37.602641 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m14:44:37.618226 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282"
[0m14:44:37.618226 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m14:44:37.618226 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282"
[0m14:44:37.633850 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282"
[0m14:44:37.633850 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`payment_distribution`
where TRY_CAST(REPLACE(total_value, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m14:44:38.020288 [debug] [Thread-1 (]: SQL status: OK in 0.390 seconds
[0m14:44:38.024497 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-8068-1126-aa1b-d6c1aacc7bd7) - Closing
[0m14:44:38.024497 [info ] [Thread-1 (]: 19 of 33 PASS non_negative_payment_distribution_total_value .................... [[32mPASS[0m in 0.42s]
[0m14:44:38.024497 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m14:44:38.024497 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m14:44:38.024497 [info ] [Thread-1 (]: 20 of 33 START test not_null_payment_distribution_Payment_Method ............... [RUN]
[0m14:44:38.024497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282, now test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae)
[0m14:44:38.024497 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m14:44:38.024497 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m14:44:38.040121 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae"
[0m14:44:38.040121 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m14:44:38.055782 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae"
[0m14:44:38.055782 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae"
[0m14:44:38.055782 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Payment_Method
from `workspace`.`default`.`payment_distribution`
where Payment_Method is null



  
  
      
    ) dbt_internal_test
[0m14:44:38.414899 [debug] [Thread-1 (]: SQL status: OK in 0.360 seconds
[0m14:44:38.414899 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-80a8-12d6-a623-b2a7dbb1d281) - Closing
[0m14:44:38.414899 [info ] [Thread-1 (]: 20 of 33 PASS not_null_payment_distribution_Payment_Method ..................... [[32mPASS[0m in 0.39s]
[0m14:44:38.414899 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m14:44:38.414899 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m14:44:38.414899 [info ] [Thread-1 (]: 21 of 33 START test not_null_payment_distribution_total_transactions ........... [RUN]
[0m14:44:38.414899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae, now test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8)
[0m14:44:38.431053 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8, idle-time=0.016154766082763672s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m14:44:38.432097 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m14:44:38.441092 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8"
[0m14:44:38.443094 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m14:44:38.452774 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8"
[0m14:44:38.455774 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8"
[0m14:44:38.457779 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_transactions
from `workspace`.`default`.`payment_distribution`
where total_transactions is null



  
  
      
    ) dbt_internal_test
[0m14:44:38.953185 [debug] [Thread-1 (]: SQL status: OK in 0.490 seconds
[0m14:44:38.956188 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-80e5-1360-a512-87d493735a4c) - Closing
[0m14:44:38.959187 [info ] [Thread-1 (]: 21 of 33 PASS not_null_payment_distribution_total_transactions ................. [[32mPASS[0m in 0.54s]
[0m14:44:38.961195 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m14:44:38.962192 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m14:44:38.964193 [info ] [Thread-1 (]: 22 of 33 START test not_null_payment_distribution_total_value .................. [RUN]
[0m14:44:38.965802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8, now test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03)
[0m14:44:38.966801 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03, idle-time=0.008613348007202148s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m14:44:38.967814 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m14:44:38.977106 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03"
[0m14:44:38.980106 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m14:44:38.987109 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03"
[0m14:44:38.990114 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03"
[0m14:44:38.992107 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_value
from `workspace`.`default`.`payment_distribution`
where total_value is null



  
  
      
    ) dbt_internal_test
[0m14:44:39.352166 [debug] [Thread-1 (]: SQL status: OK in 0.360 seconds
[0m14:44:39.352166 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-8136-140f-b6b4-831686087f84) - Closing
[0m14:44:39.352166 [info ] [Thread-1 (]: 22 of 33 PASS not_null_payment_distribution_total_value ........................ [[32mPASS[0m in 0.39s]
[0m14:44:39.352166 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m14:44:39.352166 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m14:44:39.352166 [info ] [Thread-1 (]: 23 of 33 START test non_negative_sales_by_category_total_revenue ............... [RUN]
[0m14:44:39.352166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03, now test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41)
[0m14:44:39.367790 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41, idle-time=0.015624523162841797s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m14:44:39.367790 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m14:44:39.367790 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41"
[0m14:44:39.367790 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m14:44:39.383461 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41"
[0m14:44:39.383461 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41"
[0m14:44:39.383461 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`sales_by_category`
where TRY_CAST(REPLACE(total_revenue, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m14:44:39.743043 [debug] [Thread-1 (]: SQL status: OK in 0.360 seconds
[0m14:44:39.743043 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-8173-1775-9e85-f3967adb4087) - Closing
[0m14:44:39.758967 [info ] [Thread-1 (]: 23 of 33 PASS non_negative_sales_by_category_total_revenue ..................... [[32mPASS[0m in 0.41s]
[0m14:44:39.762019 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m14:44:39.762977 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m14:44:39.763980 [info ] [Thread-1 (]: 24 of 33 START test not_null_sales_by_category_Category ........................ [RUN]
[0m14:44:39.766090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41, now test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507)
[0m14:44:39.767089 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507, idle-time=0.008558273315429688s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m14:44:39.768089 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m14:44:39.774500 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507"
[0m14:44:39.774500 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m14:44:39.774500 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507"
[0m14:44:39.774500 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507"
[0m14:44:39.790128 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Category
from `workspace`.`default`.`sales_by_category`
where Category is null



  
  
      
    ) dbt_internal_test
[0m14:44:40.133558 [debug] [Thread-1 (]: SQL status: OK in 0.340 seconds
[0m14:44:40.133558 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-81b0-1883-9d48-1412eaecf5d6) - Closing
[0m14:44:40.133558 [info ] [Thread-1 (]: 24 of 33 PASS not_null_sales_by_category_Category .............................. [[32mPASS[0m in 0.37s]
[0m14:44:40.133558 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m14:44:40.133558 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m14:44:40.133558 [info ] [Thread-1 (]: 25 of 33 START test not_null_sales_by_category_total_orders .................... [RUN]
[0m14:44:40.149184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507, now test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e)
[0m14:44:40.149184 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e, idle-time=0.01562643051147461s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m14:44:40.149184 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m14:44:40.149184 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e"
[0m14:44:40.164769 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m14:44:40.164769 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e"
[0m14:44:40.164769 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e"
[0m14:44:40.164769 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from `workspace`.`default`.`sales_by_category`
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m14:44:40.523793 [debug] [Thread-1 (]: SQL status: OK in 0.360 seconds
[0m14:44:40.523793 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-81eb-1c60-9baa-6fcd0a03427b) - Closing
[0m14:44:40.539283 [info ] [Thread-1 (]: 25 of 33 PASS not_null_sales_by_category_total_orders .......................... [[32mPASS[0m in 0.41s]
[0m14:44:40.539283 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m14:44:40.539283 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m14:44:40.539283 [info ] [Thread-1 (]: 26 of 33 START test not_null_sales_by_category_total_revenue ................... [RUN]
[0m14:44:40.539283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e, now test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd)
[0m14:44:40.539283 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m14:44:40.539283 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m14:44:40.554952 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd"
[0m14:44:40.554952 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m14:44:40.554952 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd"
[0m14:44:40.554952 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd"
[0m14:44:40.570613 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from `workspace`.`default`.`sales_by_category`
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m14:44:40.971381 [debug] [Thread-1 (]: SQL status: OK in 0.400 seconds
[0m14:44:40.974382 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-8228-1050-9941-77990eb96754) - Closing
[0m14:44:40.976381 [info ] [Thread-1 (]: 26 of 33 PASS not_null_sales_by_category_total_revenue ......................... [[32mPASS[0m in 0.44s]
[0m14:44:40.979723 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m14:44:40.980722 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m14:44:40.981723 [info ] [Thread-1 (]: 27 of 33 START test non_negative_top_5_products_total_sales .................... [RUN]
[0m14:44:40.983764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd, now test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34)
[0m14:44:40.984814 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34, idle-time=0.008433103561401367s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m14:44:40.986776 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m14:44:40.992982 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34"
[0m14:44:40.992982 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m14:44:40.992982 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34"
[0m14:44:40.992982 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34"
[0m14:44:40.992982 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`top_5_products`
where TRY_CAST(REPLACE(total_sales, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m14:44:41.367461 [debug] [Thread-1 (]: SQL status: OK in 0.360 seconds
[0m14:44:41.367461 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-826a-1298-96c5-d6d934b551fa) - Closing
[0m14:44:41.367461 [info ] [Thread-1 (]: 27 of 33 PASS non_negative_top_5_products_total_sales .......................... [[32mPASS[0m in 0.38s]
[0m14:44:41.367461 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m14:44:41.367461 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m14:44:41.367461 [info ] [Thread-1 (]: 28 of 33 START test not_null_top_5_products_product_id ......................... [RUN]
[0m14:44:41.367461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34, now test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe)
[0m14:44:41.367461 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m14:44:41.367461 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m14:44:41.383079 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe"
[0m14:44:41.383079 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m14:44:41.398705 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe"
[0m14:44:41.398705 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe"
[0m14:44:41.398705 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `workspace`.`default`.`top_5_products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:44:41.742353 [debug] [Thread-1 (]: SQL status: OK in 0.340 seconds
[0m14:44:41.742353 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-82a6-175e-8303-414b11c166be) - Closing
[0m14:44:41.742353 [info ] [Thread-1 (]: 28 of 33 PASS not_null_top_5_products_product_id ............................... [[32mPASS[0m in 0.37s]
[0m14:44:41.757929 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m14:44:41.757929 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m14:44:41.757929 [info ] [Thread-1 (]: 29 of 33 START test not_null_top_5_products_total_sales ........................ [RUN]
[0m14:44:41.757929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe, now test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818)
[0m14:44:41.757929 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818, idle-time=0.01557612419128418s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m14:44:41.757929 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m14:44:41.773573 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818"
[0m14:44:41.773573 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m14:44:41.789185 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818"
[0m14:44:41.789185 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818"
[0m14:44:41.789185 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_sales
from `workspace`.`default`.`top_5_products`
where total_sales is null



  
  
      
    ) dbt_internal_test
[0m14:44:42.164275 [debug] [Thread-1 (]: SQL status: OK in 0.380 seconds
[0m14:44:42.164275 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-82e1-1a39-9d46-083846111b38) - Closing
[0m14:44:42.164275 [info ] [Thread-1 (]: 29 of 33 PASS not_null_top_5_products_total_sales .............................. [[32mPASS[0m in 0.41s]
[0m14:44:42.164275 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m14:44:42.164275 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m14:44:42.164275 [info ] [Thread-1 (]: 30 of 33 START test non_negative_top_customers_total_spent ..................... [RUN]
[0m14:44:42.164275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818, now test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667)
[0m14:44:42.179898 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667, idle-time=0.01562356948852539s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m14:44:42.179898 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m14:44:42.179898 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667"
[0m14:44:42.179898 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m14:44:42.195529 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667"
[0m14:44:42.195529 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667"
[0m14:44:42.195529 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`top_customers`
where TRY_CAST(REPLACE(total_spent, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m14:44:42.524230 [debug] [Thread-1 (]: SQL status: OK in 0.330 seconds
[0m14:44:42.524230 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-8321-1297-83f5-f10d7a5fe5ff) - Closing
[0m14:44:42.539860 [info ] [Thread-1 (]: 30 of 33 PASS non_negative_top_customers_total_spent ........................... [[32mPASS[0m in 0.36s]
[0m14:44:42.539860 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m14:44:42.539860 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m14:44:42.539860 [info ] [Thread-1 (]: 31 of 33 START test not_null_top_customers_User_ID ............................. [RUN]
[0m14:44:42.539860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667, now test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0)
[0m14:44:42.539860 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0, idle-time=0.015630006790161133s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m14:44:42.539860 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m14:44:42.555486 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0"
[0m14:44:42.555486 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m14:44:42.555486 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0"
[0m14:44:42.571108 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0"
[0m14:44:42.571108 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select User_ID
from `workspace`.`default`.`top_customers`
where User_ID is null



  
  
      
    ) dbt_internal_test
[0m14:44:42.937391 [debug] [Thread-1 (]: SQL status: OK in 0.370 seconds
[0m14:44:42.941399 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-8359-1198-8a07-31f2776b4514) - Closing
[0m14:44:42.943394 [info ] [Thread-1 (]: 31 of 33 PASS not_null_top_customers_User_ID ................................... [[32mPASS[0m in 0.40s]
[0m14:44:42.945282 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m14:44:42.947239 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m14:44:42.949236 [info ] [Thread-1 (]: 32 of 33 START test not_null_top_customers_total_orders ........................ [RUN]
[0m14:44:42.951384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0, now test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746)
[0m14:44:42.952365 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746, idle-time=0.00897073745727539s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m14:44:42.954363 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m14:44:42.962461 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746"
[0m14:44:42.962461 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m14:44:42.962461 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746"
[0m14:44:42.962461 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746"
[0m14:44:42.962461 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from `workspace`.`default`.`top_customers`
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m14:44:43.337476 [debug] [Thread-1 (]: SQL status: OK in 0.360 seconds
[0m14:44:43.353003 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-8396-1f56-aceb-9103efc3d4d4) - Closing
[0m14:44:43.353003 [info ] [Thread-1 (]: 32 of 33 PASS not_null_top_customers_total_orders .............................. [[32mPASS[0m in 0.40s]
[0m14:44:43.353003 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m14:44:43.353003 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73
[0m14:44:43.353003 [info ] [Thread-1 (]: 33 of 33 START test not_null_top_customers_total_spent ......................... [RUN]
[0m14:44:43.353003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746, now test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73)
[0m14:44:43.353003 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, name=test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m14:44:43.368626 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73
[0m14:44:43.368626 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73"
[0m14:44:43.368626 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73
[0m14:44:43.388596 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73"
[0m14:44:43.390600 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73"
[0m14:44:43.392599 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_spent
from `workspace`.`default`.`top_customers`
where total_spent is null



  
  
      
    ) dbt_internal_test
[0m14:44:43.717251 [debug] [Thread-1 (]: SQL status: OK in 0.320 seconds
[0m14:44:43.721254 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2, command-id=01f0836d-83d6-1123-a2ca-9dbb4b92e960) - Closing
[0m14:44:43.723255 [info ] [Thread-1 (]: 33 of 33 PASS not_null_top_customers_total_spent ............................... [[32mPASS[0m in 0.37s]
[0m14:44:43.724858 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73
[0m14:44:43.727216 [debug] [MainThread]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=master, idle-time=16.3436381816864s, language=None, compute-name=) - Reusing connection previously named master
[0m14:44:43.727216 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:44:43.727216 [debug] [MainThread]: Connection 'list_workspace' was properly closed.
[0m14:44:43.727216 [debug] [MainThread]: On list_workspace: Close
[0m14:44:43.727216 [debug] [MainThread]: Databricks adapter: Connection(session-id=01f0836d-790d-151f-93e3-d6f9fa310fd0) - Closing
[0m14:44:43.936704 [debug] [MainThread]: Connection 'list_workspace_default' was properly closed.
[0m14:44:43.938719 [debug] [MainThread]: On list_workspace_default: Close
[0m14:44:43.939719 [debug] [MainThread]: Databricks adapter: Connection(session-id=01f0836d-79de-1c67-962f-72133658c2cb) - Closing
[0m14:44:44.156409 [debug] [MainThread]: Connection 'test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73' was properly closed.
[0m14:44:44.158424 [debug] [MainThread]: On test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73: Close
[0m14:44:44.159423 [debug] [MainThread]: Databricks adapter: Connection(session-id=01f0836d-7aaf-189b-b669-0afa61a7e7f2) - Closing
[0m14:44:44.374521 [info ] [MainThread]: 
[0m14:44:44.376119 [info ] [MainThread]: Finished running 24 data tests, 9 view models in 0 hours 0 minutes and 19.76 seconds (19.76s).
[0m14:44:44.383832 [debug] [MainThread]: Command end result
[0m14:44:44.461998 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m14:44:44.461998 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m14:44:44.489958 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m14:44:44.490959 [info ] [MainThread]: 
[0m14:44:44.493300 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:44:44.494302 [info ] [MainThread]: 
[0m14:44:44.496301 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=33
[0m14:44:44.498347 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:44:44.501311 [debug] [MainThread]: Command `dbt build` succeeded at 14:44:44.501311 after 26.27 seconds
[0m14:44:44.503316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290163C3E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901CE2F210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002901CE2FF50>]}
[0m14:44:44.504306 [debug] [MainThread]: Flushing usage events
[0m14:44:45.249842 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:47:37.009403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001341BF19490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001341BC05450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001341BF442D0>]}


============================== 14:47:37.016889 | e1e65c8b-f8ca-4a80-a4df-1a8806d4b9e8 ==============================
[0m14:47:37.016889 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:47:37.018888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --target sqlserver', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:47:37.930305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1e65c8b-f8ca-4a80-a4df-1a8806d4b9e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001341BF55E50>]}
[0m14:47:38.055235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1e65c8b-f8ca-4a80-a4df-1a8806d4b9e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001341AE71E90>]}
[0m14:47:38.055235 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:47:38.820709 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m14:47:39.024030 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:47:39.024030 [debug] [MainThread]: previous checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, current checksum: 3fbc73d786818920aecb1b2190495121ce0b60768fe54c46d521f1e82da30af9
[0m14:47:39.024030 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:47:39.024030 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:47:39.039646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e1e65c8b-f8ca-4a80-a4df-1a8806d4b9e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001341B614410>]}
[0m14:47:42.289884 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_customers' which is disabled
[0m14:47:42.289884 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_customers' which is disabled
[0m14:47:42.289884 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_customers' which is disabled
[0m14:47:42.289884 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_customers' which is disabled
[0m14:47:42.305501 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_5_products' which is disabled
[0m14:47:42.305501 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_5_products' which is disabled
[0m14:47:42.305501 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'top_5_products' which is disabled
[0m14:47:42.305501 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'monthly_revenue' which is disabled
[0m14:47:42.305501 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'monthly_revenue' which is disabled
[0m14:47:42.305501 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'monthly_revenue' which is disabled
[0m14:47:42.305501 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_discount_by_category' which is disabled
[0m14:47:42.305501 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_discount_by_category' which is disabled
[0m14:47:42.305501 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_discount_by_category' which is disabled
[0m14:47:42.305501 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_ticket_by_category' which is disabled
[0m14:47:42.305501 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_ticket_by_category' which is disabled
[0m14:47:42.305501 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'avg_ticket_by_category' which is disabled
[0m14:47:42.305501 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'payment_distribution' which is disabled
[0m14:47:42.305501 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'payment_distribution' which is disabled
[0m14:47:42.321130 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'payment_distribution' which is disabled
[0m14:47:42.321130 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'payment_distribution' which is disabled
[0m14:47:42.321130 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'sales_by_category' which is disabled
[0m14:47:42.321130 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'sales_by_category' which is disabled
[0m14:47:42.321130 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'sales_by_category' which is disabled
[0m14:47:42.321130 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41' (dbt_databricks_cicd/models\mart\databricks\schema.yml) depends on a node named 'sales_by_category' which is disabled
[0m14:47:42.555495 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m14:47:42.571111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1e65c8b-f8ca-4a80-a4df-1a8806d4b9e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001341DC1B050>]}
[0m14:47:42.758541 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m14:47:42.774164 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m14:47:42.852522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1e65c8b-f8ca-4a80-a4df-1a8806d4b9e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001341DACD050>]}
[0m14:47:42.868146 [info ] [MainThread]: Found 2 models, 10 data tests, 1 source, 627 macros
[0m14:47:42.868146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1e65c8b-f8ca-4a80-a4df-1a8806d4b9e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001341DF8B550>]}
[0m14:47:42.868146 [info ] [MainThread]: 
[0m14:47:42.868146 [info ] [MainThread]: Concurrency: 1 threads (target='sqlserver')
[0m14:47:42.868146 [info ] [MainThread]: 
[0m14:47:42.883773 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:47:42.902850 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db_dbo'
[0m14:47:42.946854 [debug] [ThreadPool]: dbt-sqlserver
[0m14:47:42.946854 [debug] [ThreadPool]: Using sqlserver connection "list_my_db_dbo"
[0m14:47:42.946854 [debug] [ThreadPool]: On list_my_db_dbo: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db_dbo"} */
USE [my_db];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:47:42.946854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:47:42.946854 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:47:43.071126 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m14:47:43.135019 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:47:43.138022 [debug] [ThreadPool]: On list_my_db_dbo: ROLLBACK
[0m14:47:43.140019 [debug] [ThreadPool]: On list_my_db_dbo: Close
[0m14:47:43.144016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1e65c8b-f8ca-4a80-a4df-1a8806d4b9e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001341C6DAB50>]}
[0m14:47:43.147019 [debug] [MainThread]: On master: COMMIT
[0m14:47:43.150060 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__Debit_Card__Cash_on_Delivery.c5ab2fdc18
[0m14:47:43.150060 [info ] [Thread-1 (]: 1 of 10 START test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__Debit_Card__Cash_on_Delivery  [RUN]
[0m14:47:43.150060 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__Debit_Card__Cash_on_Delivery.c5ab2fdc18'
[0m14:47:43.150060 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__Debit_Card__Cash_on_Delivery.c5ab2fdc18
[0m14:47:43.181313 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__Debit_Card__Cash_on_Delivery.c5ab2fdc18"
[0m14:47:43.181313 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__Debit_Card__Cash_on_Delivery.c5ab2fdc18
[0m14:47:43.228201 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__Debit_Card__Cash_on_Delivery.c5ab2fdc18"
[0m14:47:43.244059 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__Debit_Card__Cash_on_Delivery.c5ab2fdc18"
[0m14:47:43.246063 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__Debit_Card__Cash_on_Delivery.c5ab2fdc18: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__Debit_Card__Cash_on_Delivery.c5ab2fdc18"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_945e42d2eeb05e13a70a262d6bed5785_10042]
   as 
    
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from "MY_DB"."dbo"."ecommerce"
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    ''Credit Card'',''Net Banking'',''Debit Card'',''Cash on Delivery''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_945e42d2eeb05e13a70a262d6bed5785_10042]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_945e42d2eeb05e13a70a262d6bed5785_10042]
  ;')
[0m14:47:43.247101 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:47:43.248100 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:47:43.254067 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:47:43.258141 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:47:43.273811 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__Debit_Card__Cash_on_Delivery.c5ab2fdc18: ROLLBACK
[0m14:47:43.273811 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__Debit_Card__Cash_on_Delivery.c5ab2fdc18: Close
[0m14:47:43.273811 [error] [Thread-1 (]: 1 of 10 FAIL 1 source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__Debit_Card__Cash_on_Delivery  [[31mFAIL 1[0m in 0.12s]
[0m14:47:43.273811 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__Debit_Card__Cash_on_Delivery.c5ab2fdc18
[0m14:47:43.273811 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:47:43.289398 [info ] [Thread-1 (]: 2 of 10 START test source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_  [RUN]
[0m14:47:43.289398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__Debit_Card__Cash_on_Delivery.c5ab2fdc18, now test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef)
[0m14:47:43.289398 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:47:43.289398 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:47:43.305020 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:47:43.305020 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:47:43.305020 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:47:43.305020 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_9a59e771c154aa693079c3068fb4d43b_16648]
   as 
    
    with actual as (
        select 
            column_name, data_type
        from INFORMATION_SCHEMA.COLUMNS
        where table_name = ''ecommerce''
          and table_schema = ''dbo''
    ),
    expected as (
        select * from (
            values
            
                (''Category'', ''varchar''),
            
                (''Discount'', ''int''),
            
                (''Final_Price'', ''float''),
            
                (''Payment_Method'', ''varchar''),
            
                (''Price'', ''float''),
            
                (''Product_ID'', ''varchar''),
            
                (''Purchase_Date'', ''date''),
            
                (''User_ID'', ''varchar'')
            
        ) as t(column_name, data_type)
    )
    select
        e.column_name,
        e.data_type
    from expected e
    left join actual a
        on e.column_name = a.column_name
       and e.data_type = a.data_type
    where a.column_name is null

  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_9a59e771c154aa693079c3068fb4d43b_16648]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_9a59e771c154aa693079c3068fb4d43b_16648]
  ;')
[0m14:47:43.305020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:43.305020 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:47:43.305020 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:47:43.367029 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:47:43.367029 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef: ROLLBACK
[0m14:47:43.367029 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef: Close
[0m14:47:43.367029 [info ] [Thread-1 (]: 2 of 10 PASS source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_  [[32mPASS[0m in 0.08s]
[0m14:47:43.367029 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:47:43.367029 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:47:43.367029 [info ] [Thread-1 (]: 3 of 10 START test source_not_null_sqlserver_ecommerce_Category ................ [RUN]
[0m14:47:43.367029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407)
[0m14:47:43.367029 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:47:43.382686 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:47:43.382686 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:47:43.398321 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:47:43.398321 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:47:43.398321 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_13128]
   as 
    
    
    



select Category
from "MY_DB"."dbo"."ecommerce"
where Category is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_13128]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_13128]
  ;')
[0m14:47:43.398321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:43.398321 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:47:43.398321 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:47:43.413907 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:47:43.413907 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: ROLLBACK
[0m14:47:43.413907 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: Close
[0m14:47:43.429571 [info ] [Thread-1 (]: 3 of 10 PASS source_not_null_sqlserver_ecommerce_Category ...................... [[32mPASS[0m in 0.05s]
[0m14:47:43.429571 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:47:43.429571 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:47:43.429571 [info ] [Thread-1 (]: 4 of 10 START test source_not_null_sqlserver_ecommerce_Discount ................ [RUN]
[0m14:47:43.429571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f)
[0m14:47:43.429571 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:47:43.445205 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:47:43.445205 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:47:43.445205 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:47:43.445205 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:47:43.460784 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_3850]
   as 
    
    
    



select Discount
from "MY_DB"."dbo"."ecommerce"
where Discount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_3850]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_3850]
  ;')
[0m14:47:43.460784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:43.460784 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:47:43.460784 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:47:43.460784 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:47:43.476446 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: ROLLBACK
[0m14:47:43.476446 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: Close
[0m14:47:43.476446 [info ] [Thread-1 (]: 4 of 10 PASS source_not_null_sqlserver_ecommerce_Discount ...................... [[32mPASS[0m in 0.05s]
[0m14:47:43.476446 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:47:43.476446 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:47:43.476446 [info ] [Thread-1 (]: 5 of 10 START test source_not_null_sqlserver_ecommerce_Final_Price ............. [RUN]
[0m14:47:43.476446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d)
[0m14:47:43.476446 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:47:43.492034 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:47:43.492034 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:47:43.507665 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:47:43.507665 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:47:43.507665 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_1697]
   as 
    
    
    



select Final_Price
from "MY_DB"."dbo"."ecommerce"
where Final_Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_1697]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_1697]
  ;')
[0m14:47:43.507665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:43.507665 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:47:43.507665 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:47:43.523290 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:47:43.523290 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: ROLLBACK
[0m14:47:43.523290 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: Close
[0m14:47:43.523290 [info ] [Thread-1 (]: 5 of 10 PASS source_not_null_sqlserver_ecommerce_Final_Price ................... [[32mPASS[0m in 0.05s]
[0m14:47:43.523290 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:47:43.538929 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:47:43.538929 [info ] [Thread-1 (]: 6 of 10 START test source_not_null_sqlserver_ecommerce_Payment_Method .......... [RUN]
[0m14:47:43.538929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae)
[0m14:47:43.538929 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:47:43.538929 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:47:43.555988 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:47:43.560984 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:47:43.562994 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:47:43.564986 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_2231]
   as 
    
    
    



select Payment_Method
from "MY_DB"."dbo"."ecommerce"
where Payment_Method is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_2231]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_2231]
  ;')
[0m14:47:43.565986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:43.566985 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:47:43.568987 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:47:43.580074 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:47:43.583109 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: ROLLBACK
[0m14:47:43.585112 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: Close
[0m14:47:43.586129 [info ] [Thread-1 (]: 6 of 10 PASS source_not_null_sqlserver_ecommerce_Payment_Method ................ [[32mPASS[0m in 0.05s]
[0m14:47:43.586129 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:47:43.586129 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:47:43.586129 [info ] [Thread-1 (]: 7 of 10 START test source_not_null_sqlserver_ecommerce_Price ................... [RUN]
[0m14:47:43.586129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01)
[0m14:47:43.586129 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:47:43.601829 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:47:43.601829 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:47:43.601829 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:47:43.617383 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:47:43.617383 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_7477]
   as 
    
    
    



select Price
from "MY_DB"."dbo"."ecommerce"
where Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_7477]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_7477]
  ;')
[0m14:47:43.617383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:43.617383 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:47:43.617383 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:47:43.633012 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:47:43.633012 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: ROLLBACK
[0m14:47:43.633012 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: Close
[0m14:47:43.633012 [info ] [Thread-1 (]: 7 of 10 PASS source_not_null_sqlserver_ecommerce_Price ......................... [[32mPASS[0m in 0.05s]
[0m14:47:43.633012 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:47:43.633012 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:47:43.633012 [info ] [Thread-1 (]: 8 of 10 START test source_not_null_sqlserver_ecommerce_Product_ID .............. [RUN]
[0m14:47:43.633012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff)
[0m14:47:43.648673 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:47:43.648673 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:47:43.648673 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:47:43.664267 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:47:43.664267 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:47:43.664267 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_14550]
   as 
    
    
    



select Product_ID
from "MY_DB"."dbo"."ecommerce"
where Product_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_14550]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_14550]
  ;')
[0m14:47:43.664267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:43.664267 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:47:43.664267 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:47:43.679887 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:47:43.695509 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: ROLLBACK
[0m14:47:43.695509 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: Close
[0m14:47:43.695509 [info ] [Thread-1 (]: 8 of 10 PASS source_not_null_sqlserver_ecommerce_Product_ID .................... [[32mPASS[0m in 0.06s]
[0m14:47:43.695509 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:47:43.695509 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:47:43.711132 [info ] [Thread-1 (]: 9 of 10 START test source_not_null_sqlserver_ecommerce_Purchase_Date ........... [RUN]
[0m14:47:43.711132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17)
[0m14:47:43.711132 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:47:43.726764 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:47:43.726764 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:47:43.726764 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:47:43.726764 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:47:43.726764 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_6929]
   as 
    
    
    



select Purchase_Date
from "MY_DB"."dbo"."ecommerce"
where Purchase_Date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_6929]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_6929]
  ;')
[0m14:47:43.742383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:43.742383 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:47:43.742383 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:47:43.742383 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:47:43.758012 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: ROLLBACK
[0m14:47:43.758012 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: Close
[0m14:47:43.758012 [info ] [Thread-1 (]: 9 of 10 PASS source_not_null_sqlserver_ecommerce_Purchase_Date ................. [[32mPASS[0m in 0.05s]
[0m14:47:43.758012 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:47:43.758012 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:47:43.758012 [info ] [Thread-1 (]: 10 of 10 START test source_not_null_sqlserver_ecommerce_User_ID ................ [RUN]
[0m14:47:43.758012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc)
[0m14:47:43.758012 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:47:43.773634 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:47:43.773634 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:47:43.773634 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:47:43.790733 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:47:43.791648 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_2838]
   as 
    
    
    



select User_ID
from "MY_DB"."dbo"."ecommerce"
where User_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_2838]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_2838]
  ;')
[0m14:47:43.793643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:47:43.794643 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:47:43.795643 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:47:43.805807 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:47:43.808843 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: ROLLBACK
[0m14:47:43.810840 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: Close
[0m14:47:43.811806 [info ] [Thread-1 (]: 10 of 10 PASS source_not_null_sqlserver_ecommerce_User_ID ...................... [[32mPASS[0m in 0.05s]
[0m14:47:43.814843 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:47:43.816807 [debug] [MainThread]: On master: COMMIT
[0m14:47:43.818841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:47:43.821141 [debug] [MainThread]: Connection 'list_my_db_dbo' was properly closed.
[0m14:47:43.823144 [debug] [MainThread]: Connection 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc' was properly closed.
[0m14:47:43.825140 [info ] [MainThread]: 
[0m14:47:43.826147 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m14:47:43.831143 [debug] [MainThread]: Command end result
[0m14:47:43.898288 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m14:47:43.898288 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m14:47:43.913920 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m14:47:43.913920 [info ] [MainThread]: 
[0m14:47:43.913920 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:47:43.913920 [info ] [MainThread]: 
[0m14:47:43.913920 [error] [MainThread]: [31mFailure in test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__Debit_Card__Cash_on_Delivery (dbt_databricks_cicd/models\raw\sqlserver\schema.yml)[0m
[0m14:47:43.929533 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:47:43.929533 [info ] [MainThread]: 
[0m14:47:43.929533 [info ] [MainThread]:   compiled code at target\compiled\dbt_databricks_cicd\dbt_databricks_cicd/models\raw\sqlserver\schema.yml\source_accepted_values_sqlserv_2ec4b08bcac6751259f0b3de03ea70d9.sql
[0m14:47:43.929533 [info ] [MainThread]: 
[0m14:47:43.929533 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=10
[0m14:47:43.929533 [debug] [MainThread]: Command `dbt test` failed at 14:47:43.929533 after 7.06 seconds
[0m14:47:43.929533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000134154B3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001341BF670D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001341BDE6950>]}
[0m14:47:43.929533 [debug] [MainThread]: Flushing usage events
[0m14:47:44.524237 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:48:05.228898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218726711D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021872672E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021872672150>]}


============================== 14:48:05.244947 | 743e488d-a555-4ea0-bbbf-b101804a4fb7 ==============================
[0m14:48:05.244947 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:48:05.247945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --target sqlserver', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:48:06.384000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '743e488d-a555-4ea0-bbbf-b101804a4fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002186F414250>]}
[0m14:48:06.525724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '743e488d-a555-4ea0-bbbf-b101804a4fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218715DDDD0>]}
[0m14:48:06.527726 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m14:48:07.382720 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m14:48:07.946590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:48:07.946590 [debug] [MainThread]: Partial parsing: updated file: dbt_databricks_cicd://dbt_databricks_cicd/models\raw\sqlserver\schema.yml
[0m14:48:09.023801 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m14:48:09.055051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '743e488d-a555-4ea0-bbbf-b101804a4fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021873FF3B90>]}
[0m14:48:09.226653 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m14:48:09.226653 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m14:48:09.304779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '743e488d-a555-4ea0-bbbf-b101804a4fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021874A21790>]}
[0m14:48:09.304779 [info ] [MainThread]: Found 2 models, 10 data tests, 1 source, 627 macros
[0m14:48:09.304779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '743e488d-a555-4ea0-bbbf-b101804a4fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218747D3690>]}
[0m14:48:09.304779 [info ] [MainThread]: 
[0m14:48:09.320401 [info ] [MainThread]: Concurrency: 1 threads (target='sqlserver')
[0m14:48:09.320401 [info ] [MainThread]: 
[0m14:48:09.320401 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m14:48:09.320401 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db_dbo'
[0m14:48:09.351651 [debug] [ThreadPool]: dbt-sqlserver
[0m14:48:09.367276 [debug] [ThreadPool]: Using sqlserver connection "list_my_db_dbo"
[0m14:48:09.367276 [debug] [ThreadPool]: On list_my_db_dbo: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db_dbo"} */
USE [my_db];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m14:48:09.367276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:09.367276 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:48:09.494618 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m14:48:09.539492 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:48:09.539492 [debug] [ThreadPool]: On list_my_db_dbo: ROLLBACK
[0m14:48:09.555120 [debug] [ThreadPool]: On list_my_db_dbo: Close
[0m14:48:09.555120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '743e488d-a555-4ea0-bbbf-b101804a4fb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002187471DC10>]}
[0m14:48:09.555120 [debug] [MainThread]: On master: COMMIT
[0m14:48:09.570747 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:48:09.570747 [info ] [Thread-1 (]: 1 of 10 START test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [RUN]
[0m14:48:09.570747 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8'
[0m14:48:09.570747 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:48:09.597661 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:48:09.599664 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:48:09.632942 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:48:09.632942 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m14:48:09.632942 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7948c8751759ef023ec7d17501389f26_5956]
   as 
    
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from "MY_DB"."dbo"."ecommerce"
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    ''Credit Card'',''Net Banking'',''UPI'',''Debit Card'',''Cash on Delivery''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7948c8751759ef023ec7d17501389f26_5956]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7948c8751759ef023ec7d17501389f26_5956]
  ;')
[0m14:48:09.632942 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:48:09.632942 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:48:09.648571 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:48:09.664207 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:48:09.679819 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: ROLLBACK
[0m14:48:09.695446 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: Close
[0m14:48:09.695446 [info ] [Thread-1 (]: 1 of 10 PASS source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [[32mPASS[0m in 0.12s]
[0m14:48:09.695446 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m14:48:09.695446 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:48:09.695446 [info ] [Thread-1 (]: 2 of 10 START test source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_  [RUN]
[0m14:48:09.711071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8, now test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef)
[0m14:48:09.711071 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:48:09.726709 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:48:09.726709 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:48:09.742330 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:48:09.757951 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m14:48:09.757951 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_9a59e771c154aa693079c3068fb4d43b_15490]
   as 
    
    with actual as (
        select 
            column_name, data_type
        from INFORMATION_SCHEMA.COLUMNS
        where table_name = ''ecommerce''
          and table_schema = ''dbo''
    ),
    expected as (
        select * from (
            values
            
                (''Category'', ''varchar''),
            
                (''Discount'', ''int''),
            
                (''Final_Price'', ''float''),
            
                (''Payment_Method'', ''varchar''),
            
                (''Price'', ''float''),
            
                (''Product_ID'', ''varchar''),
            
                (''Purchase_Date'', ''date''),
            
                (''User_ID'', ''varchar'')
            
        ) as t(column_name, data_type)
    )
    select
        e.column_name,
        e.data_type
    from expected e
    left join actual a
        on e.column_name = a.column_name
       and e.data_type = a.data_type
    where a.column_name is null

  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_9a59e771c154aa693079c3068fb4d43b_15490]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_9a59e771c154aa693079c3068fb4d43b_15490]
  ;')
[0m14:48:09.757951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:09.757951 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:48:09.757951 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:48:09.852349 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:48:09.852349 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef: ROLLBACK
[0m14:48:09.852349 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef: Close
[0m14:48:09.852349 [info ] [Thread-1 (]: 2 of 10 PASS source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_  [[32mPASS[0m in 0.16s]
[0m14:48:09.852349 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m14:48:09.852349 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:48:09.852349 [info ] [Thread-1 (]: 3 of 10 START test source_not_null_sqlserver_ecommerce_Category ................ [RUN]
[0m14:48:09.852349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407)
[0m14:48:09.867964 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:48:09.867964 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:48:09.867964 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:48:09.883588 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:48:09.883588 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m14:48:09.883588 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_3021]
   as 
    
    
    



select Category
from "MY_DB"."dbo"."ecommerce"
where Category is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_3021]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_3021]
  ;')
[0m14:48:09.883588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:09.883588 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:48:09.883588 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:48:09.914838 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:48:09.914838 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: ROLLBACK
[0m14:48:09.914838 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: Close
[0m14:48:09.914838 [info ] [Thread-1 (]: 3 of 10 PASS source_not_null_sqlserver_ecommerce_Category ...................... [[32mPASS[0m in 0.06s]
[0m14:48:09.914838 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m14:48:09.914838 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:48:09.914838 [info ] [Thread-1 (]: 4 of 10 START test source_not_null_sqlserver_ecommerce_Discount ................ [RUN]
[0m14:48:09.914838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f)
[0m14:48:09.914838 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:48:09.930473 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:48:09.930473 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:48:09.946089 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:48:09.946089 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m14:48:09.946089 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_3856]
   as 
    
    
    



select Discount
from "MY_DB"."dbo"."ecommerce"
where Discount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_3856]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_3856]
  ;')
[0m14:48:09.946089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:09.946089 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:48:09.946089 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:48:09.961741 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:48:09.961741 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: ROLLBACK
[0m14:48:09.961741 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: Close
[0m14:48:09.961741 [info ] [Thread-1 (]: 4 of 10 PASS source_not_null_sqlserver_ecommerce_Discount ...................... [[32mPASS[0m in 0.05s]
[0m14:48:09.977339 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m14:48:09.977339 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:48:09.977339 [info ] [Thread-1 (]: 5 of 10 START test source_not_null_sqlserver_ecommerce_Final_Price ............. [RUN]
[0m14:48:09.977339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d)
[0m14:48:09.977339 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:48:09.977339 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:48:09.992962 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:48:09.992962 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:48:09.992962 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m14:48:09.992962 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_15802]
   as 
    
    
    



select Final_Price
from "MY_DB"."dbo"."ecommerce"
where Final_Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_15802]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_15802]
  ;')
[0m14:48:09.992962 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:09.992962 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:48:09.992962 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:48:10.008593 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:48:10.008593 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: ROLLBACK
[0m14:48:10.024217 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: Close
[0m14:48:10.024217 [info ] [Thread-1 (]: 5 of 10 PASS source_not_null_sqlserver_ecommerce_Final_Price ................... [[32mPASS[0m in 0.05s]
[0m14:48:10.024217 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m14:48:10.024217 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:48:10.024217 [info ] [Thread-1 (]: 6 of 10 START test source_not_null_sqlserver_ecommerce_Payment_Method .......... [RUN]
[0m14:48:10.024217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae)
[0m14:48:10.024217 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:48:10.039842 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:48:10.039842 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:48:10.039842 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:48:10.039842 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m14:48:10.055462 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_18167]
   as 
    
    
    



select Payment_Method
from "MY_DB"."dbo"."ecommerce"
where Payment_Method is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_18167]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_18167]
  ;')
[0m14:48:10.055462 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:10.055462 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:48:10.055462 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:48:10.055462 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:48:10.071087 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: ROLLBACK
[0m14:48:10.071087 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: Close
[0m14:48:10.071087 [info ] [Thread-1 (]: 6 of 10 PASS source_not_null_sqlserver_ecommerce_Payment_Method ................ [[32mPASS[0m in 0.05s]
[0m14:48:10.071087 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m14:48:10.071087 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:48:10.071087 [info ] [Thread-1 (]: 7 of 10 START test source_not_null_sqlserver_ecommerce_Price ................... [RUN]
[0m14:48:10.071087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01)
[0m14:48:10.071087 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:48:10.092038 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:48:10.095057 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:48:10.100037 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:48:10.103045 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m14:48:10.105042 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_4897]
   as 
    
    
    



select Price
from "MY_DB"."dbo"."ecommerce"
where Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_4897]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_4897]
  ;')
[0m14:48:10.106040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:10.107042 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:48:10.108043 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:48:10.120238 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:48:10.124230 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: ROLLBACK
[0m14:48:10.126229 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: Close
[0m14:48:10.128269 [info ] [Thread-1 (]: 7 of 10 PASS source_not_null_sqlserver_ecommerce_Price ......................... [[32mPASS[0m in 0.06s]
[0m14:48:10.130233 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m14:48:10.132232 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:48:10.133231 [info ] [Thread-1 (]: 8 of 10 START test source_not_null_sqlserver_ecommerce_Product_ID .............. [RUN]
[0m14:48:10.134299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff)
[0m14:48:10.134299 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:48:10.134299 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:48:10.134299 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:48:10.149929 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:48:10.149929 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m14:48:10.149929 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_3119]
   as 
    
    
    



select Product_ID
from "MY_DB"."dbo"."ecommerce"
where Product_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_3119]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_3119]
  ;')
[0m14:48:10.149929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:10.149929 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:48:10.149929 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:48:10.165600 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:48:10.165600 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: ROLLBACK
[0m14:48:10.165600 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: Close
[0m14:48:10.165600 [info ] [Thread-1 (]: 8 of 10 PASS source_not_null_sqlserver_ecommerce_Product_ID .................... [[32mPASS[0m in 0.03s]
[0m14:48:10.181185 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m14:48:10.181185 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:48:10.181185 [info ] [Thread-1 (]: 9 of 10 START test source_not_null_sqlserver_ecommerce_Purchase_Date ........... [RUN]
[0m14:48:10.181185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17)
[0m14:48:10.181185 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:48:10.181185 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:48:10.196853 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:48:10.196853 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:48:10.196853 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m14:48:10.196853 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_15079]
   as 
    
    
    



select Purchase_Date
from "MY_DB"."dbo"."ecommerce"
where Purchase_Date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_15079]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_15079]
  ;')
[0m14:48:10.196853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:10.212443 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:48:10.212443 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:48:10.212443 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:48:10.229524 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: ROLLBACK
[0m14:48:10.231524 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: Close
[0m14:48:10.233528 [info ] [Thread-1 (]: 9 of 10 PASS source_not_null_sqlserver_ecommerce_Purchase_Date ................. [[32mPASS[0m in 0.05s]
[0m14:48:10.236264 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m14:48:10.237223 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:48:10.238224 [info ] [Thread-1 (]: 10 of 10 START test source_not_null_sqlserver_ecommerce_User_ID ................ [RUN]
[0m14:48:10.240421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc)
[0m14:48:10.241421 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:48:10.243636 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:48:10.243636 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:48:10.243636 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:48:10.259269 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m14:48:10.259269 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_10845]
   as 
    
    
    



select User_ID
from "MY_DB"."dbo"."ecommerce"
where User_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_10845]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_10845]
  ;')
[0m14:48:10.259269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:10.259269 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m14:48:10.259269 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m14:48:10.274895 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:48:10.274895 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: ROLLBACK
[0m14:48:10.274895 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: Close
[0m14:48:10.274895 [info ] [Thread-1 (]: 10 of 10 PASS source_not_null_sqlserver_ecommerce_User_ID ...................... [[32mPASS[0m in 0.04s]
[0m14:48:10.274895 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m14:48:10.274895 [debug] [MainThread]: On master: COMMIT
[0m14:48:10.274895 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:48:10.290519 [debug] [MainThread]: Connection 'list_my_db_dbo' was properly closed.
[0m14:48:10.290519 [debug] [MainThread]: Connection 'test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc' was properly closed.
[0m14:48:10.290519 [info ] [MainThread]: 
[0m14:48:10.290519 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m14:48:10.290519 [debug] [MainThread]: Command end result
[0m14:48:10.368874 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m14:48:10.368874 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m14:48:10.384494 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m14:48:10.400122 [info ] [MainThread]: 
[0m14:48:10.400122 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:48:10.400122 [info ] [MainThread]: 
[0m14:48:10.400122 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m14:48:10.400122 [debug] [MainThread]: Command `dbt test` succeeded at 14:48:10.400122 after 5.37 seconds
[0m14:48:10.400122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002186BB93DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002186BDF11D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002186BDF04D0>]}
[0m14:48:10.415741 [debug] [MainThread]: Flushing usage events
[0m14:48:11.007902 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:23:08.051551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F231F1A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F231F01D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F231F1310>]}


============================== 15:23:08.059779 | f2fc27ff-b80a-4762-9e4c-a56d80180b6f ==============================
[0m15:23:08.059779 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:23:08.061745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --target sqlserver', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:23:09.009328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2fc27ff-b80a-4762-9e4c-a56d80180b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F2321E810>]}
[0m15:23:09.132997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2fc27ff-b80a-4762-9e4c-a56d80180b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F22161F10>]}
[0m15:23:09.132997 [info ] [MainThread]: Registered adapter: sqlserver=1.9.0
[0m15:23:09.946293 [debug] [MainThread]: checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331, vars: {}, profile: , target: sqlserver, version: 1.10.3
[0m15:23:10.572029 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m15:23:10.867724 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m15:23:10.900047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2fc27ff-b80a-4762-9e4c-a56d80180b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F22186410>]}
[0m15:23:11.179480 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m15:23:11.196266 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m15:23:11.289703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2fc27ff-b80a-4762-9e4c-a56d80180b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F2299D810>]}
[0m15:23:11.305330 [info ] [MainThread]: Found 2 models, 10 data tests, 1 source, 627 macros
[0m15:23:11.305330 [info ] [MainThread]: 
[0m15:23:11.305330 [info ] [MainThread]: Concurrency: 1 threads (target='sqlserver')
[0m15:23:11.320957 [info ] [MainThread]: 
[0m15:23:11.320957 [debug] [MainThread]: Acquiring new sqlserver connection 'master'
[0m15:23:11.336577 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db'
[0m15:23:11.403453 [debug] [ThreadPool]: dbt-sqlserver
[0m15:23:11.405451 [debug] [ThreadPool]: Using sqlserver connection "list_my_db"
[0m15:23:11.407450 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db"} */
USE [my_db];
    select  name as [schema]
    from sys.schemas with (nolock) 
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:23:11.408451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:11.409450 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:23:11.524648 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m15:23:11.540274 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:23:11.540274 [debug] [ThreadPool]: On list_my_db: Close
[0m15:23:11.540274 [debug] [ThreadPool]: Acquiring new sqlserver connection 'list_my_db_dbo'
[0m15:23:11.555896 [debug] [ThreadPool]: dbt-sqlserver
[0m15:23:11.555896 [debug] [ThreadPool]: Using sqlserver connection "list_my_db_dbo"
[0m15:23:11.555896 [debug] [ThreadPool]: On list_my_db_dbo: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "connection_name": "list_my_db_dbo"} */
USE [my_db];
    with base as (
      select
        DB_NAME() as [database],
        t.name as [name],
        SCHEMA_NAME(t.schema_id) as [schema],
        'table' as table_type
      from sys.tables as t with (nolock)
      union all
      select
        DB_NAME() as [database],
        v.name as [name],
        SCHEMA_NAME(v.schema_id) as [schema],
        'view' as table_type
      from sys.views as v with (nolock)
    )
    select * from base
    where [schema] like 'dbo'
    
    OPTION (LABEL = 'dbt-sqlserver');

  
[0m15:23:11.571521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:11.571521 [debug] [ThreadPool]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:23:11.571521 [debug] [ThreadPool]: sqlserver adapter: Connected to db: my_db
[0m15:23:11.633986 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:23:11.633986 [debug] [ThreadPool]: On list_my_db_dbo: ROLLBACK
[0m15:23:11.633986 [debug] [ThreadPool]: On list_my_db_dbo: Close
[0m15:23:11.649616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2fc27ff-b80a-4762-9e4c-a56d80180b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F24BA3310>]}
[0m15:23:11.649616 [debug] [MainThread]: On master: COMMIT
[0m15:23:11.649616 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m15:23:11.649616 [info ] [Thread-1 (]: 1 of 12 START test source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [RUN]
[0m15:23:11.665243 [debug] [Thread-1 (]: Acquiring new sqlserver connection 'test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8'
[0m15:23:11.665243 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m15:23:11.736256 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m15:23:11.738258 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m15:23:11.774552 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m15:23:11.774552 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"
[0m15:23:11.774552 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7948c8751759ef023ec7d17501389f26_5805]
   as 
    
    
    

with all_values as (

    select
        Payment_Method as value_field,
        count(*) as n_records

    from "MY_DB"."dbo"."ecommerce"
    group by Payment_Method

)

select *
from all_values
where value_field not in (
    ''Credit Card'',''Net Banking'',''UPI'',''Debit Card'',''Cash on Delivery''
)



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7948c8751759ef023ec7d17501389f26_5805]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7948c8751759ef023ec7d17501389f26_5805]
  ;')
[0m15:23:11.774552 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:23:11.774552 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:23:11.774552 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m15:23:11.820950 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:23:11.836015 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: ROLLBACK
[0m15:23:11.836015 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8: Close
[0m15:23:11.836015 [info ] [Thread-1 (]: 1 of 12 PASS source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery  [[32mPASS[0m in 0.17s]
[0m15:23:11.836015 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8
[0m15:23:11.836015 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m15:23:11.836015 [info ] [Thread-1 (]: 2 of 12 START test source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_  [RUN]
[0m15:23:11.836015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_accepted_values_sqlserver_ecommerce_Payment_Method__Credit_Card__Net_Banking__UPI__Debit_Card__Cash_on_Delivery.f9d7fc03e8, now test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef)
[0m15:23:11.851642 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m15:23:11.898534 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m15:23:11.898534 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m15:23:11.914143 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m15:23:11.914143 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"
[0m15:23:11.914143 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_9a59e771c154aa693079c3068fb4d43b_17958]
   as 
    
    with actual as (
        select 
            column_name, data_type
        from INFORMATION_SCHEMA.COLUMNS
        where table_name = ''ecommerce''
          and table_schema = ''dbo''
    ),
    expected as (
        select * from (
            values
            
                (''Category'', ''varchar''),
            
                (''Discount'', ''int''),
            
                (''Final_Price'', ''float''),
            
                (''Payment_Method'', ''varchar''),
            
                (''Price'', ''float''),
            
                (''Product_ID'', ''varchar''),
            
                (''Purchase_Date'', ''date''),
            
                (''User_ID'', ''varchar'')
            
        ) as t(column_name, data_type)
    )
    select
        e.column_name,
        e.data_type
    from expected e
    left join actual a
        on e.column_name = a.column_name
       and e.data_type = a.data_type
    where a.column_name is null

  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_9a59e771c154aa693079c3068fb4d43b_17958]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_9a59e771c154aa693079c3068fb4d43b_17958]
  ;')
[0m15:23:11.929767 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:11.932667 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:23:11.935667 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m15:23:11.994096 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:23:11.994096 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef: ROLLBACK
[0m15:23:11.994096 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef: Close
[0m15:23:11.994096 [info ] [Thread-1 (]: 2 of 12 PASS source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_  [[32mPASS[0m in 0.16s]
[0m15:23:11.994096 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef
[0m15:23:12.009727 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m15:23:12.009727 [info ] [Thread-1 (]: 3 of 12 START test source_not_null_sqlserver_ecommerce_Category ................ [RUN]
[0m15:23:12.009727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_assert_source_structure_sqlserver_ecommerce__name_Category_data_type_varchar____name_Discount_data_type_int____name_Final_Price_data_type_float____name_Payment_Method_data_type_varchar____name_Price_data_type_float____name_Product_ID_data_type_varchar____name_Purchase_Date_data_type_date____name_User_ID_data_type_varchar_.48074441ef, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407)
[0m15:23:12.009727 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m15:23:12.025347 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m15:23:12.025347 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m15:23:12.025347 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m15:23:12.025347 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"
[0m15:23:12.041201 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_11263]
   as 
    
    
    



select Category
from "MY_DB"."dbo"."ecommerce"
where Category is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_11263]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_1d42587dad758e4d02f35151eae87fd6_11263]
  ;')
[0m15:23:12.044202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:12.046202 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:23:12.049241 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m15:23:12.070892 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:23:12.070892 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: ROLLBACK
[0m15:23:12.070892 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407: Close
[0m15:23:12.070892 [info ] [Thread-1 (]: 3 of 12 PASS source_not_null_sqlserver_ecommerce_Category ...................... [[32mPASS[0m in 0.06s]
[0m15:23:12.070892 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407
[0m15:23:12.086518 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m15:23:12.086518 [info ] [Thread-1 (]: 4 of 12 START test source_not_null_sqlserver_ecommerce_Discount ................ [RUN]
[0m15:23:12.086518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Category.27b73b2407, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f)
[0m15:23:12.086518 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m15:23:12.108556 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m15:23:12.111546 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m15:23:12.119659 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m15:23:12.123674 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"
[0m15:23:12.125664 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_12023]
   as 
    
    
    



select Discount
from "MY_DB"."dbo"."ecommerce"
where Discount is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_12023]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_625c46632096eb9e0c11e4a43006c670_12023]
  ;')
[0m15:23:12.126659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:12.128659 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:23:12.130661 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m15:23:12.157847 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:23:12.164206 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: ROLLBACK
[0m15:23:12.164206 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f: Close
[0m15:23:12.164206 [info ] [Thread-1 (]: 4 of 12 PASS source_not_null_sqlserver_ecommerce_Discount ...................... [[32mPASS[0m in 0.08s]
[0m15:23:12.164206 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f
[0m15:23:12.164206 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m15:23:12.164206 [info ] [Thread-1 (]: 5 of 12 START test source_not_null_sqlserver_ecommerce_Final_Price ............. [RUN]
[0m15:23:12.164206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Discount.170f95d03f, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d)
[0m15:23:12.179839 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m15:23:12.194579 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m15:23:12.197573 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m15:23:12.204609 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m15:23:12.207574 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"
[0m15:23:12.208572 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_15492]
   as 
    
    
    



select Final_Price
from "MY_DB"."dbo"."ecommerce"
where Final_Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_15492]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_2c8d889fb816fb0fe64ea2fee14e9eaf_15492]
  ;')
[0m15:23:12.209572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:12.211682 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:23:12.212685 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m15:23:12.227765 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:23:12.227765 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: ROLLBACK
[0m15:23:12.227765 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d: Close
[0m15:23:12.227765 [info ] [Thread-1 (]: 5 of 12 PASS source_not_null_sqlserver_ecommerce_Final_Price ................... [[32mPASS[0m in 0.06s]
[0m15:23:12.227765 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d
[0m15:23:12.227765 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m15:23:12.227765 [info ] [Thread-1 (]: 6 of 12 START test source_not_null_sqlserver_ecommerce_Payment_Method .......... [RUN]
[0m15:23:12.227765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Final_Price.447255466d, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae)
[0m15:23:12.227765 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m15:23:12.255925 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m15:23:12.257922 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m15:23:12.264922 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m15:23:12.267922 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"
[0m15:23:12.269818 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_3486]
   as 
    
    
    



select Payment_Method
from "MY_DB"."dbo"."ecommerce"
where Payment_Method is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_3486]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_3f8b356bcfe8cdc90455e1a827ed5135_3486]
  ;')
[0m15:23:12.269818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:12.269818 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:23:12.269818 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m15:23:12.285441 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:23:12.285441 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: ROLLBACK
[0m15:23:12.285441 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae: Close
[0m15:23:12.285441 [info ] [Thread-1 (]: 6 of 12 PASS source_not_null_sqlserver_ecommerce_Payment_Method ................ [[32mPASS[0m in 0.06s]
[0m15:23:12.285441 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae
[0m15:23:12.285441 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m15:23:12.301072 [info ] [Thread-1 (]: 7 of 12 START test source_not_null_sqlserver_ecommerce_Price ................... [RUN]
[0m15:23:12.301072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Payment_Method.8f222d4cae, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01)
[0m15:23:12.301072 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m15:23:12.316696 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m15:23:12.316696 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m15:23:12.316696 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m15:23:12.332332 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"
[0m15:23:12.332332 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_3095]
   as 
    
    
    



select Price
from "MY_DB"."dbo"."ecommerce"
where Price is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_3095]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_1544ad91be61af9a05c7c7a9011fe99e_3095]
  ;')
[0m15:23:12.332332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:12.332332 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:23:12.332332 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m15:23:12.364871 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:23:12.369000 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: ROLLBACK
[0m15:23:12.371003 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01: Close
[0m15:23:12.373007 [info ] [Thread-1 (]: 7 of 12 PASS source_not_null_sqlserver_ecommerce_Price ......................... [[32mPASS[0m in 0.07s]
[0m15:23:12.377002 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01
[0m15:23:12.379007 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m15:23:12.382001 [info ] [Thread-1 (]: 8 of 12 START test source_not_null_sqlserver_ecommerce_Product_ID .............. [RUN]
[0m15:23:12.384207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Price.0885aa9d01, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff)
[0m15:23:12.387206 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m15:23:12.398268 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m15:23:12.398268 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m15:23:12.413897 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m15:23:12.413897 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"
[0m15:23:12.413897 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_14816]
   as 
    
    
    



select Product_ID
from "MY_DB"."dbo"."ecommerce"
where Product_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_14816]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_7a906581a0e26969b13ff6984714a743_14816]
  ;')
[0m15:23:12.413897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:12.413897 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:23:12.413897 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m15:23:12.445157 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:23:12.445157 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: ROLLBACK
[0m15:23:12.445157 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff: Close
[0m15:23:12.460769 [info ] [Thread-1 (]: 8 of 12 PASS source_not_null_sqlserver_ecommerce_Product_ID .................... [[32mPASS[0m in 0.08s]
[0m15:23:12.460769 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff
[0m15:23:12.460769 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m15:23:12.460769 [info ] [Thread-1 (]: 9 of 12 START test source_not_null_sqlserver_ecommerce_Purchase_Date ........... [RUN]
[0m15:23:12.460769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Product_ID.d13ec40eff, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17)
[0m15:23:12.460769 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m15:23:12.483580 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m15:23:12.485581 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m15:23:12.493583 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m15:23:12.496583 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"
[0m15:23:12.497585 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_9398]
   as 
    
    
    



select Purchase_Date
from "MY_DB"."dbo"."ecommerce"
where Purchase_Date is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_9398]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_2bfcb17f27f3f21e6eed947a22a6423e_9398]
  ;')
[0m15:23:12.498583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:12.500581 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:23:12.501580 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m15:23:12.508637 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:23:12.508637 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: ROLLBACK
[0m15:23:12.508637 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17: Close
[0m15:23:12.524262 [info ] [Thread-1 (]: 9 of 12 PASS source_not_null_sqlserver_ecommerce_Purchase_Date ................. [[32mPASS[0m in 0.06s]
[0m15:23:12.524262 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17
[0m15:23:12.524262 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m15:23:12.524262 [info ] [Thread-1 (]: 10 of 12 START test source_not_null_sqlserver_ecommerce_User_ID ................ [RUN]
[0m15:23:12.524262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_Purchase_Date.e786531a17, now test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc)
[0m15:23:12.524262 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m15:23:12.539940 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m15:23:12.539940 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m15:23:12.539940 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m15:23:12.539940 [debug] [Thread-1 (]: Using sqlserver connection "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"
[0m15:23:12.539940 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc"} */

    -- Create target schema if it does not
  USE [my_db];
  IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'dbo')
  BEGIN
    EXEC('CREATE SCHEMA [dbo]')
  END

  

  
  EXEC('create view 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_16084]
   as 
    
    
    



select User_ID
from "MY_DB"."dbo"."ecommerce"
where User_ID is null



  ;')
  select
    
    count(*) as failures,
    case when count(*) != 0
      then 'true' else 'false' end as should_warn,
    case when count(*) != 0
      then 'true' else 'false' end as should_error
  from (
    select * from 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_16084]
  
  ) dbt_internal_test;

  EXEC('drop view 
    [dbo].[testview_5cef0262c7fe2f5ca6f3d4035b69eb02_16084]
  ;')
[0m15:23:12.539940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:12.555531 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:23:12.555531 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m15:23:12.555531 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:23:12.573460 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: ROLLBACK
[0m15:23:12.575461 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc: Close
[0m15:23:12.578463 [info ] [Thread-1 (]: 10 of 12 PASS source_not_null_sqlserver_ecommerce_User_ID ...................... [[32mPASS[0m in 0.05s]
[0m15:23:12.582464 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc
[0m15:23:12.586637 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce
[0m15:23:12.589651 [info ] [Thread-1 (]: 11 of 12 START sql view model dbo.src_ecommerce ................................ [RUN]
[0m15:23:12.591641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.source_not_null_sqlserver_ecommerce_User_ID.b3ec5e36fc, now model.dbt_databricks_cicd.src_ecommerce)
[0m15:23:12.593640 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.src_ecommerce
[0m15:23:12.602858 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.src_ecommerce"
[0m15:23:12.608857 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.src_ecommerce
[0m15:23:12.712756 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.src_ecommerce"
[0m15:23:12.712756 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.src_ecommerce"
[0m15:23:12.728382 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.src_ecommerce"} */
USE [my_db];
    
    

    

    
    USE [my_db];
    EXEC('
        create view "dbo"."src_ecommerce__dbt_tmp" as 

select * from "MY_DB"."dbo"."ecommerce";
    ')


[0m15:23:12.728382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:12.728382 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:23:12.728382 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m15:23:12.744008 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:23:12.759638 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.src_ecommerce"
[0m15:23:12.759638 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.src_ecommerce"} */
USE [my_db];
      EXEC sp_rename 'dbo.src_ecommerce', 'src_ecommerce__dbt_backup'
[0m15:23:13.800296 [debug] [Thread-1 (]: SQL status: OK in 1.000 seconds
[0m15:23:13.805358 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.src_ecommerce"
[0m15:23:13.805358 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.src_ecommerce"} */
USE [my_db];
      EXEC sp_rename 'dbo.src_ecommerce__dbt_tmp', 'src_ecommerce'
[0m15:23:13.805358 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:23:13.836614 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: COMMIT
[0m15:23:13.852236 [debug] [Thread-1 (]: Applying DROP to: "my_db"."dbo"."src_ecommerce__dbt_backup"
[0m15:23:13.852236 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:23:13.852236 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.src_ecommerce"
[0m15:23:13.867860 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.src_ecommerce"} */

        USE [my_db];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'my_db'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'src_ecommerce__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:23:14.206504 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:23:14.210504 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.src_ecommerce"
[0m15:23:14.212505 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.src_ecommerce"} */

      
      
    
    USE [my_db];
    EXEC('DROP view IF EXISTS "dbo"."src_ecommerce__dbt_backup";');

[0m15:23:14.219499 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:23:14.223504 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: ROLLBACK
[0m15:23:14.226502 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: Close
[0m15:23:14.234501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2fc27ff-b80a-4762-9e4c-a56d80180b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F252F5390>]}
[0m15:23:14.237523 [info ] [Thread-1 (]: 11 of 12 OK created sql view model dbo.src_ecommerce ........................... [[32mOK[0m in 1.64s]
[0m15:23:14.241502 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce
[0m15:23:14.242573 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.stg_ecommerce
[0m15:23:14.242573 [info ] [Thread-1 (]: 12 of 12 START sql view model dbo.stg_ecommerce ................................ [RUN]
[0m15:23:14.242573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.src_ecommerce, now model.dbt_databricks_cicd.stg_ecommerce)
[0m15:23:14.242573 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.stg_ecommerce
[0m15:23:14.264122 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.stg_ecommerce"
[0m15:23:14.267126 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.stg_ecommerce
[0m15:23:14.279122 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.stg_ecommerce"
[0m15:23:14.282124 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.stg_ecommerce"
[0m15:23:14.284121 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.stg_ecommerce"} */
USE [my_db];
    
    

    

    
    USE [my_db];
    EXEC('
        create view "dbo"."stg_ecommerce__dbt_tmp" as 

SELECT
    
        CAST(User_ID AS VARCHAR) AS User_ID,
        CAST(Product_ID AS VARCHAR) AS Product_ID,
        CAST(Category AS VARCHAR) AS Category,
        CAST(Price AS FLOAT) AS Price,
        CAST(Discount AS INT) AS Discount,
        CAST(Final_Price AS FLOAT) AS Final_Price,
        CAST(Payment_Method AS VARCHAR) AS Payment_Method,
        CAST(Purchase_Date AS DATE) AS Purchase_Date
    
FROM "MY_DB"."dbo"."ecommerce";
    ')


[0m15:23:14.287125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:14.289125 [debug] [Thread-1 (]: sqlserver adapter: Using connection string: DRIVER={ODBC Driver 17 for SQL Server};SERVER=LAPTOP-NV4PR600,1433;Database=my_db;UID={dbt_user};PWD=***;encrypt=Yes;TrustServerCertificate=Yes;APP=dbt-sqlserver/1.9.0
[0m15:23:14.290265 [debug] [Thread-1 (]: sqlserver adapter: Connected to db: my_db
[0m15:23:14.299264 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:23:14.313352 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.stg_ecommerce"
[0m15:23:14.314351 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.stg_ecommerce"} */
USE [my_db];
      EXEC sp_rename 'dbo.stg_ecommerce', 'stg_ecommerce__dbt_backup'
[0m15:23:14.586384 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:23:14.602002 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.stg_ecommerce"
[0m15:23:14.602002 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.stg_ecommerce"} */
USE [my_db];
      EXEC sp_rename 'dbo.stg_ecommerce__dbt_tmp', 'stg_ecommerce'
[0m15:23:14.602002 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:23:14.602002 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: COMMIT
[0m15:23:14.617592 [debug] [Thread-1 (]: Applying DROP to: "my_db"."dbo"."stg_ecommerce__dbt_backup"
[0m15:23:14.617592 [debug] [Thread-1 (]: dbt-sqlserver
[0m15:23:14.617592 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.stg_ecommerce"
[0m15:23:14.617592 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.stg_ecommerce"} */

        USE [my_db];
        select
            sch.name as schema_name,
            obj.name as view_name
        from sys.sql_expression_dependencies refs
        inner join sys.objects obj
        on refs.referencing_id = obj.object_id
        inner join sys.schemas sch
        on obj.schema_id = sch.schema_id
        where refs.referenced_database_name = 'my_db'
        and refs.referenced_schema_name = 'dbo'
        and refs.referenced_entity_name = 'stg_ecommerce__dbt_backup'
        and refs.referencing_class = 1
        and obj.type = 'V'
        
    OPTION (LABEL = 'dbt-sqlserver');

      
[0m15:23:14.664732 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:23:14.669732 [debug] [Thread-1 (]: Using sqlserver connection "model.dbt_databricks_cicd.stg_ecommerce"
[0m15:23:14.670734 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "dbt_databricks_cicd", "target_name": "sqlserver", "node_id": "model.dbt_databricks_cicd.stg_ecommerce"} */

      
      
    
    USE [my_db];
    EXEC('DROP view IF EXISTS "dbo"."stg_ecommerce__dbt_backup";');

[0m15:23:14.677730 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:23:14.679842 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: ROLLBACK
[0m15:23:14.679842 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: Close
[0m15:23:14.679842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2fc27ff-b80a-4762-9e4c-a56d80180b6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F259D21D0>]}
[0m15:23:14.679842 [info ] [Thread-1 (]: 12 of 12 OK created sql view model dbo.stg_ecommerce ........................... [[32mOK[0m in 0.44s]
[0m15:23:14.679842 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.stg_ecommerce
[0m15:23:14.695468 [debug] [MainThread]: On master: COMMIT
[0m15:23:14.695468 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:14.695468 [debug] [MainThread]: Connection 'list_my_db' was properly closed.
[0m15:23:14.695468 [debug] [MainThread]: Connection 'list_my_db_dbo' was properly closed.
[0m15:23:14.695468 [debug] [MainThread]: Connection 'model.dbt_databricks_cicd.stg_ecommerce' was properly closed.
[0m15:23:14.695468 [info ] [MainThread]: 
[0m15:23:14.695468 [info ] [MainThread]: Finished running 10 data tests, 2 view models in 0 hours 0 minutes and 3.37 seconds (3.37s).
[0m15:23:14.711094 [debug] [MainThread]: Command end result
[0m15:23:14.837565 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m15:23:14.855376 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m15:23:14.867448 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m15:23:14.867448 [info ] [MainThread]: 
[0m15:23:14.867448 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:23:14.867448 [info ] [MainThread]: 
[0m15:23:14.867448 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m15:23:14.867448 [debug] [MainThread]: Command `dbt build` succeeded at 15:23:14.867448 after 6.96 seconds
[0m15:23:14.867448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F1C803DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F1CA610D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F1CA604D0>]}
[0m15:23:14.867448 [debug] [MainThread]: Flushing usage events
[0m15:23:16.284773 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:24:13.898459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C770CFA050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C770D28590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C770D283D0>]}


============================== 15:24:13.905462 | 7a7fbdd7-13f3-452c-9ef6-c275479f0aa8 ==============================
[0m15:24:13.905462 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:24:13.907465 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build --target databricks --models staging+', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:24:13.909470 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of
`--resource-type model --select`
[0m15:24:13.911464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7a7fbdd7-13f3-452c-9ef6-c275479f0aa8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C770CF2990>]}
[0m15:24:15.648303 [debug] [MainThread]: Spark adapter: Setting pyhive.hive logging to ERROR
[0m15:24:15.648303 [debug] [MainThread]: Spark adapter: Setting thrift.transport logging to ERROR
[0m15:24:15.648303 [debug] [MainThread]: Spark adapter: Setting thrift.protocol logging to ERROR
[0m15:24:17.679557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a7fbdd7-13f3-452c-9ef6-c275479f0aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C76DB33510>]}
[0m15:24:17.900904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a7fbdd7-13f3-452c-9ef6-c275479f0aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C770459BD0>]}
[0m15:24:17.902906 [info ] [MainThread]: Registered adapter: databricks=1.10.4
[0m15:24:19.149445 [debug] [MainThread]: checksum: 3fbc73d786818920aecb1b2190495121ce0b60768fe54c46d521f1e82da30af9, vars: {}, profile: , target: databricks, version: 1.10.3
[0m15:24:19.400216 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:24:19.400216 [debug] [MainThread]: previous checksum: 3fbc73d786818920aecb1b2190495121ce0b60768fe54c46d521f1e82da30af9, current checksum: 136566b3e36444f529acd895ee0315ebaa97f244a4cd6a9860c3053f0a594331
[0m15:24:19.415843 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:24:19.415843 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:24:19.415843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7a7fbdd7-13f3-452c-9ef6-c275479f0aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7703F01D0>]}
[0m15:24:24.086642 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m15:24:24.102302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a7fbdd7-13f3-452c-9ef6-c275479f0aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C77D6B8F50>]}
[0m15:24:24.305287 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m15:24:24.305287 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m15:24:24.398728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a7fbdd7-13f3-452c-9ef6-c275479f0aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C77D9FEDD0>]}
[0m15:24:24.398728 [info ] [MainThread]: Found 9 models, 34 data tests, 1 source, 799 macros
[0m15:24:24.414388 [info ] [MainThread]: 
[0m15:24:24.414388 [info ] [MainThread]: Concurrency: 1 threads (target='databricks')
[0m15:24:24.414388 [info ] [MainThread]: 
[0m15:24:24.414388 [debug] [MainThread]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=master, idle-time=0s, language=None, compute-name=) - Creating connection
[0m15:24:24.414388 [debug] [MainThread]: Acquiring new databricks connection 'master'
[0m15:24:24.445660 [debug] [ThreadPool]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=list_workspace, idle-time=0s, language=None, compute-name=) - Creating connection
[0m15:24:24.445660 [debug] [ThreadPool]: Acquiring new databricks connection 'list_workspace'
[0m15:24:24.445660 [debug] [ThreadPool]: Using databricks connection "list_workspace"
[0m15:24:24.445660 [debug] [ThreadPool]: On list_workspace: GetSchemas(database=workspace, schema=None)
[0m15:24:24.445660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:25.550602 [debug] [ThreadPool]: Databricks adapter: Connection(session-id=01f08373-0f95-1894-93bd-dd8cad39c259) - Created
[0m15:24:26.195674 [debug] [ThreadPool]: SQL status: OK in 1.750 seconds
[0m15:24:26.195674 [debug] [ThreadPool]: Databricks adapter: Cursor(session-id=01f08373-0f95-1894-93bd-dd8cad39c259, command-id=01f08373-0fbc-13dd-a11f-f788ab823232) - Closing
[0m15:24:26.195674 [debug] [ThreadPool]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=list_workspace_default, idle-time=0s, language=None, compute-name=) - Creating connection
[0m15:24:26.195674 [debug] [ThreadPool]: Acquiring new databricks connection 'list_workspace_default'
[0m15:24:26.227060 [debug] [ThreadPool]: Using databricks connection "list_workspace_default"
[0m15:24:26.227060 [debug] [ThreadPool]: On list_workspace_default: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "connection_name": "list_workspace_default"} */

    
SELECT
  table_name,
  if(table_type IN ('EXTERNAL', 'MANAGED', 'MANAGED_SHALLOW_CLONE', 'EXTERNAL_SHALLOW_CLONE'), 'table', lower(table_type)) AS table_type,
  lower(data_source_format) AS file_format,
  table_owner
FROM `system`.`information_schema`.`tables`
WHERE table_catalog = 'workspace' 
  AND table_schema = 'default'

  
[0m15:24:26.227060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:24:26.980223 [debug] [ThreadPool]: Databricks adapter: Connection(session-id=01f08373-1074-1135-8992-a3a326d4d0d4) - Created
[0m15:24:27.462056 [debug] [ThreadPool]: SQL status: OK in 1.230 seconds
[0m15:24:27.477572 [debug] [ThreadPool]: Databricks adapter: Cursor(session-id=01f08373-1074-1135-8992-a3a326d4d0d4, command-id=01f08373-1090-1a7b-b595-1a136192f126) - Closing
[0m15:24:27.493192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a7fbdd7-13f3-452c-9ef6-c275479f0aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C77D4FB650>]}
[0m15:24:27.515348 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce
[0m15:24:27.517346 [info ] [Thread-1 (]: 1 of 33 START sql view model default.src_ecommerce ............................. [RUN]
[0m15:24:27.520345 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=model.dbt_databricks_cicd.src_ecommerce, idle-time=0s, language=None, compute-name=) - Creating connection
[0m15:24:27.522345 [debug] [Thread-1 (]: Acquiring new databricks connection 'model.dbt_databricks_cicd.src_ecommerce'
[0m15:24:27.524488 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.src_ecommerce
[0m15:24:27.552503 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.src_ecommerce"
[0m15:24:27.554543 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.src_ecommerce
[0m15:24:27.570170 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m15:24:27.585806 [warn ] [Thread-1 (]: [[33mWARNING[0m]: Use revamped materializations based on separating create and insert.  This allows more performant column comments, as well as new column features.
You may opt into the new behavior sooner by setting `flags.use_materialization_v2` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m15:24:27.585806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '7a7fbdd7-13f3-452c-9ef6-c275479f0aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C77D4F9A50>]}
[0m15:24:27.617058 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`src_ecommerce`
[0m15:24:27.645961 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.src_ecommerce"
[0m15:24:27.649015 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.src_ecommerce"
[0m15:24:27.649015 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.src_ecommerce"} */

  
  
  
  create or replace view `workspace`.`default`.`src_ecommerce`
  
  as (
    SELECT * FROM default.sales_ecommerce
  )

[0m15:24:27.649015 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:24:28.394326 [debug] [Thread-1 (]: Databricks adapter: Connection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee) - Created
[0m15:24:29.121723 [debug] [Thread-1 (]: SQL status: OK in 1.470 seconds
[0m15:24:29.123723 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-1167-1b2c-9541-3e346fe267e7) - Closing
[0m15:24:29.143952 [debug] [Thread-1 (]: Applying tags to relation None
[0m15:24:29.143952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a7fbdd7-13f3-452c-9ef6-c275479f0aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C77D54B450>]}
[0m15:24:29.143952 [info ] [Thread-1 (]: 1 of 33 OK created sql view model default.src_ecommerce ........................ [[32mOK[0m in 1.62s]
[0m15:24:29.160955 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce
[0m15:24:29.162926 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.stg_ecommerce
[0m15:24:29.165075 [info ] [Thread-1 (]: 2 of 33 START sql view model default.stg_ecommerce ............................. [RUN]
[0m15:24:29.167652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.src_ecommerce, now model.dbt_databricks_cicd.stg_ecommerce)
[0m15:24:29.168650 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=model.dbt_databricks_cicd.stg_ecommerce, idle-time=0.024698257446289062s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.src_ecommerce
[0m15:24:29.169651 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.stg_ecommerce
[0m15:24:29.180823 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.stg_ecommerce"
[0m15:24:29.180823 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.stg_ecommerce
[0m15:24:29.180823 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m15:24:29.180823 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`stg_ecommerce`
[0m15:24:29.180823 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.stg_ecommerce"
[0m15:24:29.196468 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.stg_ecommerce"
[0m15:24:29.196468 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.stg_ecommerce"} */

  
  
  
  create or replace view `workspace`.`default`.`stg_ecommerce`
  
  as (
    SELECT
  User_ID,
  Product_ID,
  Category,
  Price,
  Discount,
  Final_Price,
  Payment_Method,
  Purchase_Date
FROM `workspace`.`default`.`src_ecommerce`
  )

[0m15:24:29.781072 [debug] [Thread-1 (]: SQL status: OK in 0.580 seconds
[0m15:24:29.781072 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-11e2-1f3b-8e27-5ac0eb031d84) - Closing
[0m15:24:29.796258 [debug] [Thread-1 (]: Applying tags to relation None
[0m15:24:29.800265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a7fbdd7-13f3-452c-9ef6-c275479f0aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C77D57BD50>]}
[0m15:24:29.801813 [info ] [Thread-1 (]: 2 of 33 OK created sql view model default.stg_ecommerce ........................ [[32mOK[0m in 0.63s]
[0m15:24:29.801813 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.stg_ecommerce
[0m15:24:29.811146 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.avg_discount_by_category
[0m15:24:29.815138 [info ] [Thread-1 (]: 3 of 33 START sql view model default.avg_discount_by_category .................. [RUN]
[0m15:24:29.817149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.stg_ecommerce, now model.dbt_databricks_cicd.avg_discount_by_category)
[0m15:24:29.820254 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=model.dbt_databricks_cicd.avg_discount_by_category, idle-time=0.020994901657104492s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.stg_ecommerce
[0m15:24:29.820254 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.avg_discount_by_category
[0m15:24:29.837081 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.avg_discount_by_category"
[0m15:24:29.840077 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.avg_discount_by_category
[0m15:24:29.849250 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m15:24:29.854251 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`avg_discount_by_category`
[0m15:24:29.863395 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.avg_discount_by_category"
[0m15:24:29.868567 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.avg_discount_by_category"
[0m15:24:29.868567 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.avg_discount_by_category: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.avg_discount_by_category"} */

  
  
  
  create or replace view `workspace`.`default`.`avg_discount_by_category`
  
  as (
    SELECT
  Category,
  ROUND(AVG(CAST(`Discount` AS DOUBLE)), 2) AS avg_discount_percent
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY Category
ORDER BY avg_discount_percent DESC
  )

[0m15:24:30.405474 [debug] [Thread-1 (]: SQL status: OK in 0.540 seconds
[0m15:24:30.408482 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-1249-145c-81f9-ed4847bb91ab) - Closing
[0m15:24:30.411471 [debug] [Thread-1 (]: Applying tags to relation None
[0m15:24:30.414532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a7fbdd7-13f3-452c-9ef6-c275479f0aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C770752C10>]}
[0m15:24:30.414532 [info ] [Thread-1 (]: 3 of 33 OK created sql view model default.avg_discount_by_category ............. [[32mOK[0m in 0.60s]
[0m15:24:30.414532 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.avg_discount_by_category
[0m15:24:30.414532 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.avg_ticket_by_category
[0m15:24:30.414532 [info ] [Thread-1 (]: 4 of 33 START sql view model default.avg_ticket_by_category .................... [RUN]
[0m15:24:30.414532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.avg_discount_by_category, now model.dbt_databricks_cicd.avg_ticket_by_category)
[0m15:24:30.427988 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=model.dbt_databricks_cicd.avg_ticket_by_category, idle-time=0.013455390930175781s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.avg_discount_by_category
[0m15:24:30.430944 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.avg_ticket_by_category
[0m15:24:30.432364 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.avg_ticket_by_category"
[0m15:24:30.449330 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.avg_ticket_by_category
[0m15:24:30.449330 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m15:24:30.464613 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`avg_ticket_by_category`
[0m15:24:30.467612 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.avg_ticket_by_category"
[0m15:24:30.469611 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.avg_ticket_by_category"
[0m15:24:30.471611 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.avg_ticket_by_category: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.avg_ticket_by_category"} */

  
  
  
  create or replace view `workspace`.`default`.`avg_ticket_by_category`
  
  as (
    SELECT
  Category,
  ROUND(AVG(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS avg_ticket
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY Category
ORDER BY avg_ticket DESC
  )

[0m15:24:31.022498 [debug] [Thread-1 (]: SQL status: OK in 0.550 seconds
[0m15:24:31.025500 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-12a4-1c14-8a7e-9a89bebcd5c0) - Closing
[0m15:24:31.028541 [debug] [Thread-1 (]: Applying tags to relation None
[0m15:24:31.031500 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a7fbdd7-13f3-452c-9ef6-c275479f0aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C77076BE50>]}
[0m15:24:31.035534 [info ] [Thread-1 (]: 4 of 33 OK created sql view model default.avg_ticket_by_category ............... [[32mOK[0m in 0.62s]
[0m15:24:31.037504 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.avg_ticket_by_category
[0m15:24:31.039589 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.monthly_revenue
[0m15:24:31.042124 [info ] [Thread-1 (]: 5 of 33 START sql view model default.monthly_revenue ........................... [RUN]
[0m15:24:31.045132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.avg_ticket_by_category, now model.dbt_databricks_cicd.monthly_revenue)
[0m15:24:31.048122 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=model.dbt_databricks_cicd.monthly_revenue, idle-time=0.01662135124206543s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.avg_ticket_by_category
[0m15:24:31.050124 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.monthly_revenue
[0m15:24:31.064007 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.monthly_revenue"
[0m15:24:31.066028 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.monthly_revenue
[0m15:24:31.080933 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m15:24:31.080933 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`monthly_revenue`
[0m15:24:31.080933 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.monthly_revenue"
[0m15:24:31.080933 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.monthly_revenue"
[0m15:24:31.093873 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.monthly_revenue: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.monthly_revenue"} */

  
  
  
  create or replace view `workspace`.`default`.`monthly_revenue`
  
  as (
    SELECT
  CAST(DATE_TRUNC('month', CAST(Purchase_Date AS DATE)) AS DATE) AS month,
  ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS monthly_revenue
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY 1
ORDER BY 1
  )

[0m15:24:31.667027 [debug] [Thread-1 (]: SQL status: OK in 0.570 seconds
[0m15:24:31.670027 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-1303-18aa-ad37-60610383bc1a) - Closing
[0m15:24:31.673029 [debug] [Thread-1 (]: Applying tags to relation None
[0m15:24:31.676029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a7fbdd7-13f3-452c-9ef6-c275479f0aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7707D6990>]}
[0m15:24:31.678032 [info ] [Thread-1 (]: 5 of 33 OK created sql view model default.monthly_revenue ...................... [[32mOK[0m in 0.63s]
[0m15:24:31.680246 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.monthly_revenue
[0m15:24:31.680246 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.payment_distribution
[0m15:24:31.680246 [info ] [Thread-1 (]: 6 of 33 START sql view model default.payment_distribution ...................... [RUN]
[0m15:24:31.680246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.monthly_revenue, now model.dbt_databricks_cicd.payment_distribution)
[0m15:24:31.680246 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=model.dbt_databricks_cicd.payment_distribution, idle-time=0.005216360092163086s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.monthly_revenue
[0m15:24:31.680246 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.payment_distribution
[0m15:24:31.710052 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.payment_distribution"
[0m15:24:31.715063 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.payment_distribution
[0m15:24:31.725788 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m15:24:31.725788 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`payment_distribution`
[0m15:24:31.725788 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.payment_distribution"
[0m15:24:31.744145 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.payment_distribution"
[0m15:24:31.746147 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.payment_distribution: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.payment_distribution"} */

  
  
  
  create or replace view `workspace`.`default`.`payment_distribution`
  
  as (
    SELECT
  Payment_Method,
  COUNT(*) AS total_transactions,
  ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS total_value
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY Payment_Method
ORDER BY total_value DESC
  )

[0m15:24:32.311942 [debug] [Thread-1 (]: SQL status: OK in 0.560 seconds
[0m15:24:32.311942 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-1367-1240-a22d-1fda0d464cda) - Closing
[0m15:24:32.311942 [debug] [Thread-1 (]: Applying tags to relation None
[0m15:24:32.311942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a7fbdd7-13f3-452c-9ef6-c275479f0aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7707D5310>]}
[0m15:24:32.327120 [info ] [Thread-1 (]: 6 of 33 OK created sql view model default.payment_distribution ................. [[32mOK[0m in 0.63s]
[0m15:24:32.328204 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.payment_distribution
[0m15:24:32.328204 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.sales_by_category
[0m15:24:32.328204 [info ] [Thread-1 (]: 7 of 33 START sql view model default.sales_by_category ......................... [RUN]
[0m15:24:32.328204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.payment_distribution, now model.dbt_databricks_cicd.sales_by_category)
[0m15:24:32.328204 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=model.dbt_databricks_cicd.sales_by_category, idle-time=0.016261577606201172s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.payment_distribution
[0m15:24:32.344569 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.sales_by_category
[0m15:24:32.344569 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.sales_by_category"
[0m15:24:32.344569 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.sales_by_category
[0m15:24:32.368994 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m15:24:32.371733 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`sales_by_category`
[0m15:24:32.378736 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.sales_by_category"
[0m15:24:32.381733 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.sales_by_category"
[0m15:24:32.383733 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.sales_by_category: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.sales_by_category"} */

  
  
  
  create or replace view `workspace`.`default`.`sales_by_category`
  
  as (
    SELECT
  Category,
  COUNT(*) AS total_orders,
  ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS total_revenue
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY Category
ORDER BY total_revenue DESC
  )

[0m15:24:32.987684 [debug] [Thread-1 (]: SQL status: OK in 0.600 seconds
[0m15:24:32.990256 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-13c8-1580-8dc5-856cccc772ad) - Closing
[0m15:24:32.992261 [debug] [Thread-1 (]: Applying tags to relation None
[0m15:24:32.995648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a7fbdd7-13f3-452c-9ef6-c275479f0aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C77DA1C350>]}
[0m15:24:32.997105 [info ] [Thread-1 (]: 7 of 33 OK created sql view model default.sales_by_category .................... [[32mOK[0m in 0.67s]
[0m15:24:32.999663 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.sales_by_category
[0m15:24:33.001667 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.top_5_products
[0m15:24:33.003735 [info ] [Thread-1 (]: 8 of 33 START sql view model default.top_5_products ............................ [RUN]
[0m15:24:33.005589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.sales_by_category, now model.dbt_databricks_cicd.top_5_products)
[0m15:24:33.006989 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=model.dbt_databricks_cicd.top_5_products, idle-time=0.012351036071777344s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.sales_by_category
[0m15:24:33.009995 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.top_5_products
[0m15:24:33.018708 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.top_5_products"
[0m15:24:33.020749 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.top_5_products
[0m15:24:33.033090 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m15:24:33.038085 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`top_5_products`
[0m15:24:33.043903 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.top_5_products"
[0m15:24:33.046950 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.top_5_products"
[0m15:24:33.048904 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.top_5_products: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.top_5_products"} */

  
  
  
  create or replace view `workspace`.`default`.`top_5_products`
  
  as (
    WITH base AS (
    SELECT
        product_id,
        ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS total_sales
    FROM `workspace`.`default`.`stg_ecommerce`
    GROUP BY product_id
)

SELECT
    product_id,
    total_sales
FROM base
ORDER BY total_sales DESC
LIMIT 5
  )

[0m15:24:33.692863 [debug] [Thread-1 (]: SQL status: OK in 0.640 seconds
[0m15:24:33.697861 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-142e-150d-9812-2e92b17172dc) - Closing
[0m15:24:33.702867 [debug] [Thread-1 (]: Applying tags to relation None
[0m15:24:33.708863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a7fbdd7-13f3-452c-9ef6-c275479f0aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C77D9FE790>]}
[0m15:24:33.711864 [info ] [Thread-1 (]: 8 of 33 OK created sql view model default.top_5_products ....................... [[32mOK[0m in 0.70s]
[0m15:24:33.715862 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.top_5_products
[0m15:24:33.718865 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.top_customers
[0m15:24:33.722864 [info ] [Thread-1 (]: 9 of 33 START sql view model default.top_customers ............................. [RUN]
[0m15:24:33.726864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.top_5_products, now model.dbt_databricks_cicd.top_customers)
[0m15:24:33.729867 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=model.dbt_databricks_cicd.top_customers, idle-time=0.02000117301940918s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.top_5_products
[0m15:24:33.731879 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.top_customers
[0m15:24:33.757926 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.top_customers"
[0m15:24:33.762864 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.top_customers
[0m15:24:33.777867 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m15:24:33.783868 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`top_customers`
[0m15:24:33.787868 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.top_customers"
[0m15:24:33.791865 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.top_customers"
[0m15:24:33.793864 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.top_customers: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.top_customers"} */

  
  
  
  create or replace view `workspace`.`default`.`top_customers`
  
  as (
    SELECT
  User_ID,
  COUNT(*) AS total_orders,
  ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS total_spent
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY User_ID
ORDER BY total_spent DESC
LIMIT 10
  )

[0m15:24:34.354463 [debug] [Thread-1 (]: SQL status: OK in 0.560 seconds
[0m15:24:34.357473 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-14a0-116e-9f48-27e06ef86f23) - Closing
[0m15:24:34.359469 [debug] [Thread-1 (]: Applying tags to relation None
[0m15:24:34.362473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a7fbdd7-13f3-452c-9ef6-c275479f0aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7707E7610>]}
[0m15:24:34.364471 [info ] [Thread-1 (]: 9 of 33 OK created sql view model default.top_customers ........................ [[32mOK[0m in 0.64s]
[0m15:24:34.367468 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.top_customers
[0m15:24:34.370467 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m15:24:34.372470 [info ] [Thread-1 (]: 10 of 33 START test non_negative_avg_discount_by_category_avg_discount_percent . [RUN]
[0m15:24:34.374473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.top_customers, now test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f)
[0m15:24:34.376469 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f, idle-time=0.013996601104736328s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.top_customers
[0m15:24:34.378466 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m15:24:34.389763 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f"
[0m15:24:34.394763 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m15:24:34.435858 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f"
[0m15:24:34.438651 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f"
[0m15:24:34.438651 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`avg_discount_by_category`
where TRY_CAST(REPLACE(avg_discount_percent, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m15:24:34.840203 [debug] [Thread-1 (]: SQL status: OK in 0.400 seconds
[0m15:24:34.847216 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-1503-15c9-b708-cb2d4809b9a9) - Closing
[0m15:24:34.854205 [info ] [Thread-1 (]: 10 of 33 PASS non_negative_avg_discount_by_category_avg_discount_percent ....... [[32mPASS[0m in 0.48s]
[0m15:24:34.858231 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m15:24:34.860228 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m15:24:34.861227 [info ] [Thread-1 (]: 11 of 33 START test not_null_avg_discount_by_category_Category ................. [RUN]
[0m15:24:34.863228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f, now test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b)
[0m15:24:34.864228 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b, idle-time=0.011028051376342773s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m15:24:34.866228 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m15:24:34.888229 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b"
[0m15:24:34.893226 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m15:24:34.902410 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b"
[0m15:24:34.905010 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b"
[0m15:24:34.907565 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Category
from `workspace`.`default`.`avg_discount_by_category`
where Category is null



  
  
      
    ) dbt_internal_test
[0m15:24:35.253230 [debug] [Thread-1 (]: SQL status: OK in 0.340 seconds
[0m15:24:35.258282 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-154b-1264-9472-d4c9ec1ca18d) - Closing
[0m15:24:35.260282 [info ] [Thread-1 (]: 11 of 33 PASS not_null_avg_discount_by_category_Category ....................... [[32mPASS[0m in 0.40s]
[0m15:24:35.263282 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m15:24:35.265288 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m15:24:35.266291 [info ] [Thread-1 (]: 12 of 33 START test not_null_avg_discount_by_category_avg_discount_percent ..... [RUN]
[0m15:24:35.268281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b, now test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101)
[0m15:24:35.269283 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101, idle-time=0.009000301361083984s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m15:24:35.271187 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m15:24:35.271187 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101"
[0m15:24:35.271187 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m15:24:35.286810 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101"
[0m15:24:35.286810 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101"
[0m15:24:35.286810 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_discount_percent
from `workspace`.`default`.`avg_discount_by_category`
where avg_discount_percent is null



  
  
      
    ) dbt_internal_test
[0m15:24:35.665649 [debug] [Thread-1 (]: SQL status: OK in 0.380 seconds
[0m15:24:35.665649 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-1585-1275-8e5a-d27ecaea0bc2) - Closing
[0m15:24:35.665649 [info ] [Thread-1 (]: 12 of 33 PASS not_null_avg_discount_by_category_avg_discount_percent ........... [[32mPASS[0m in 0.40s]
[0m15:24:35.665649 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m15:24:35.665649 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m15:24:35.665649 [info ] [Thread-1 (]: 13 of 33 START test non_negative_avg_ticket_by_category_avg_ticket ............. [RUN]
[0m15:24:35.665649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101, now test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095)
[0m15:24:35.665649 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m15:24:35.665649 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m15:24:35.701731 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095"
[0m15:24:35.705052 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m15:24:35.716130 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095"
[0m15:24:35.716130 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095"
[0m15:24:35.716130 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`avg_ticket_by_category`
where TRY_CAST(REPLACE(avg_ticket, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m15:24:36.091245 [debug] [Thread-1 (]: SQL status: OK in 0.380 seconds
[0m15:24:36.096283 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-15c6-1af2-823b-5b03e4688be4) - Closing
[0m15:24:36.098246 [info ] [Thread-1 (]: 13 of 33 PASS non_negative_avg_ticket_by_category_avg_ticket ................... [[32mPASS[0m in 0.43s]
[0m15:24:36.101251 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m15:24:36.102249 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m15:24:36.104971 [info ] [Thread-1 (]: 14 of 33 START test not_null_avg_ticket_by_category_Category ................... [RUN]
[0m15:24:36.107159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095, now test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f)
[0m15:24:36.109162 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f, idle-time=0.009919166564941406s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m15:24:36.110159 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m15:24:36.121593 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f"
[0m15:24:36.126068 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m15:24:36.132741 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f"
[0m15:24:36.135707 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f"
[0m15:24:36.139290 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Category
from `workspace`.`default`.`avg_ticket_by_category`
where Category is null



  
  
      
    ) dbt_internal_test
[0m15:24:36.480115 [debug] [Thread-1 (]: SQL status: OK in 0.340 seconds
[0m15:24:36.484009 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-1605-1f24-9e51-8c501ecdc4e6) - Closing
[0m15:24:36.486770 [info ] [Thread-1 (]: 14 of 33 PASS not_null_avg_ticket_by_category_Category ......................... [[32mPASS[0m in 0.38s]
[0m15:24:36.490874 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m15:24:36.492879 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m15:24:36.493879 [info ] [Thread-1 (]: 15 of 33 START test not_null_avg_ticket_by_category_avg_ticket ................. [RUN]
[0m15:24:36.495961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f, now test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41)
[0m15:24:36.497956 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41, idle-time=0.01019287109375s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m15:24:36.499575 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m15:24:36.511005 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41"
[0m15:24:36.514007 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m15:24:36.522912 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41"
[0m15:24:36.525916 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41"
[0m15:24:36.527930 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_ticket
from `workspace`.`default`.`avg_ticket_by_category`
where avg_ticket is null



  
  
      
    ) dbt_internal_test
[0m15:24:36.883560 [debug] [Thread-1 (]: SQL status: OK in 0.350 seconds
[0m15:24:36.888358 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-1640-1e8d-b942-1cec7e988883) - Closing
[0m15:24:36.890361 [info ] [Thread-1 (]: 15 of 33 PASS not_null_avg_ticket_by_category_avg_ticket ....................... [[32mPASS[0m in 0.40s]
[0m15:24:36.893008 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m15:24:36.894006 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m15:24:36.896004 [info ] [Thread-1 (]: 16 of 33 START test non_negative_monthly_revenue_monthly_revenue ............... [RUN]
[0m15:24:36.898004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41, now test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294)
[0m15:24:36.898942 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294, idle-time=0.00858163833618164s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m15:24:36.900944 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m15:24:36.910944 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294"
[0m15:24:36.913948 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m15:24:36.928945 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294"
[0m15:24:36.931945 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294"
[0m15:24:36.933944 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`monthly_revenue`
where TRY_CAST(REPLACE(monthly_revenue, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m15:24:37.316122 [debug] [Thread-1 (]: SQL status: OK in 0.380 seconds
[0m15:24:37.321343 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-167e-1908-acc7-26f39744fdbe) - Closing
[0m15:24:37.324061 [info ] [Thread-1 (]: 16 of 33 PASS non_negative_monthly_revenue_monthly_revenue ..................... [[32mPASS[0m in 0.43s]
[0m15:24:37.327104 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m15:24:37.329062 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m15:24:37.331328 [info ] [Thread-1 (]: 17 of 33 START test not_null_monthly_revenue_month ............................. [RUN]
[0m15:24:37.332321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294, now test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b)
[0m15:24:37.334042 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b, idle-time=0.009981632232666016s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m15:24:37.338100 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m15:24:37.348794 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b"
[0m15:24:37.351792 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m15:24:37.361376 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b"
[0m15:24:37.363295 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b"
[0m15:24:37.365294 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month
from `workspace`.`default`.`monthly_revenue`
where month is null



  
  
      
    ) dbt_internal_test
[0m15:24:37.727398 [debug] [Thread-1 (]: SQL status: OK in 0.360 seconds
[0m15:24:37.735396 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-16c0-1672-808e-87a3528d940d) - Closing
[0m15:24:37.739395 [info ] [Thread-1 (]: 17 of 33 PASS not_null_monthly_revenue_month ................................... [[32mPASS[0m in 0.41s]
[0m15:24:37.742401 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m15:24:37.745396 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m15:24:37.747398 [info ] [Thread-1 (]: 18 of 33 START test not_null_monthly_revenue_monthly_revenue ................... [RUN]
[0m15:24:37.750396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b, now test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b)
[0m15:24:37.754397 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b, idle-time=0.015001773834228516s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m15:24:37.757397 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m15:24:37.770559 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b"
[0m15:24:37.774568 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m15:24:37.782293 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b"
[0m15:24:37.786297 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b"
[0m15:24:37.789293 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select monthly_revenue
from `workspace`.`default`.`monthly_revenue`
where monthly_revenue is null



  
  
      
    ) dbt_internal_test
[0m15:24:38.119550 [debug] [Thread-1 (]: SQL status: OK in 0.330 seconds
[0m15:24:38.124271 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-1701-1828-a1fc-cb8b26d05dbe) - Closing
[0m15:24:38.125853 [info ] [Thread-1 (]: 18 of 33 PASS not_null_monthly_revenue_monthly_revenue ......................... [[32mPASS[0m in 0.38s]
[0m15:24:38.125853 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m15:24:38.125853 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m15:24:38.136152 [info ] [Thread-1 (]: 19 of 33 START test non_negative_payment_distribution_total_value .............. [RUN]
[0m15:24:38.140147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b, now test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282)
[0m15:24:38.141158 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282, idle-time=0.015305280685424805s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m15:24:38.143154 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m15:24:38.158146 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282"
[0m15:24:38.162153 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m15:24:38.172067 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282"
[0m15:24:38.176059 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282"
[0m15:24:38.179374 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`payment_distribution`
where TRY_CAST(REPLACE(total_value, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m15:24:38.548635 [debug] [Thread-1 (]: SQL status: OK in 0.370 seconds
[0m15:24:38.552634 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-173c-1c7e-9b79-4d8fdcc6a48f) - Closing
[0m15:24:38.555641 [info ] [Thread-1 (]: 19 of 33 PASS non_negative_payment_distribution_total_value .................... [[32mPASS[0m in 0.42s]
[0m15:24:38.558641 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m15:24:38.560638 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m15:24:38.562640 [info ] [Thread-1 (]: 20 of 33 START test not_null_payment_distribution_Payment_Method ............... [RUN]
[0m15:24:38.564029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282, now test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae)
[0m15:24:38.566030 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae, idle-time=0.010391473770141602s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m15:24:38.567029 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m15:24:38.577055 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae"
[0m15:24:38.579058 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m15:24:38.584645 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae"
[0m15:24:38.584645 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae"
[0m15:24:38.584645 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Payment_Method
from `workspace`.`default`.`payment_distribution`
where Payment_Method is null



  
  
      
    ) dbt_internal_test
[0m15:24:38.983393 [debug] [Thread-1 (]: SQL status: OK in 0.400 seconds
[0m15:24:38.986395 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-177c-1716-88de-f8fd17e17f48) - Closing
[0m15:24:38.988393 [info ] [Thread-1 (]: 20 of 33 PASS not_null_payment_distribution_Payment_Method ..................... [[32mPASS[0m in 0.42s]
[0m15:24:38.990867 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m15:24:38.993432 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m15:24:38.995437 [info ] [Thread-1 (]: 21 of 33 START test not_null_payment_distribution_total_transactions ........... [RUN]
[0m15:24:38.997629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae, now test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8)
[0m15:24:38.998590 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8, idle-time=0.01019740104675293s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m15:24:38.999631 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m15:24:39.009594 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8"
[0m15:24:39.011590 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m15:24:39.017597 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8"
[0m15:24:39.019607 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8"
[0m15:24:39.022593 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_transactions
from `workspace`.`default`.`payment_distribution`
where total_transactions is null



  
  
      
    ) dbt_internal_test
[0m15:24:39.388085 [debug] [Thread-1 (]: SQL status: OK in 0.360 seconds
[0m15:24:39.394085 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-17bd-1607-8362-25e5734b9f2d) - Closing
[0m15:24:39.397100 [info ] [Thread-1 (]: 21 of 33 PASS not_null_payment_distribution_total_transactions ................. [[32mPASS[0m in 0.40s]
[0m15:24:39.400088 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m15:24:39.403091 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m15:24:39.405110 [info ] [Thread-1 (]: 22 of 33 START test not_null_payment_distribution_total_value .................. [RUN]
[0m15:24:39.407087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8, now test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03)
[0m15:24:39.408084 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03, idle-time=0.011993408203125s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m15:24:39.410089 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m15:24:39.426086 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03"
[0m15:24:39.428091 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m15:24:39.439549 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03"
[0m15:24:39.443316 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03"
[0m15:24:39.445316 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_value
from `workspace`.`default`.`payment_distribution`
where total_value is null



  
  
      
    ) dbt_internal_test
[0m15:24:39.807443 [debug] [Thread-1 (]: SQL status: OK in 0.360 seconds
[0m15:24:39.811436 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-17fe-1f5a-a223-e3baa45149a5) - Closing
[0m15:24:39.813447 [info ] [Thread-1 (]: 22 of 33 PASS not_null_payment_distribution_total_value ........................ [[32mPASS[0m in 0.41s]
[0m15:24:39.816890 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m15:24:39.818895 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m15:24:39.820896 [info ] [Thread-1 (]: 23 of 33 START test non_negative_sales_by_category_total_revenue ............... [RUN]
[0m15:24:39.822900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03, now test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41)
[0m15:24:39.823905 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41, idle-time=0.010457277297973633s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m15:24:39.825893 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m15:24:39.840736 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41"
[0m15:24:39.845352 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m15:24:39.857354 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41"
[0m15:24:39.860353 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41"
[0m15:24:39.862356 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`sales_by_category`
where TRY_CAST(REPLACE(total_revenue, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m15:24:40.208507 [debug] [Thread-1 (]: SQL status: OK in 0.340 seconds
[0m15:24:40.214692 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-183d-1b13-bb5f-2a7ae1fdd524) - Closing
[0m15:24:40.218724 [info ] [Thread-1 (]: 23 of 33 PASS non_negative_sales_by_category_total_revenue ..................... [[32mPASS[0m in 0.40s]
[0m15:24:40.220630 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m15:24:40.220630 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m15:24:40.220630 [info ] [Thread-1 (]: 24 of 33 START test not_null_sales_by_category_Category ........................ [RUN]
[0m15:24:40.234134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41, now test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507)
[0m15:24:40.239124 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507, idle-time=0.020463943481445312s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m15:24:40.241121 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m15:24:40.259445 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507"
[0m15:24:40.262431 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m15:24:40.279510 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507"
[0m15:24:40.283515 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507"
[0m15:24:40.286511 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Category
from `workspace`.`default`.`sales_by_category`
where Category is null



  
  
      
    ) dbt_internal_test
[0m15:24:40.633099 [debug] [Thread-1 (]: SQL status: OK in 0.350 seconds
[0m15:24:40.633099 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-187e-1a6b-b604-ba8a6a2c5918) - Closing
[0m15:24:40.633099 [info ] [Thread-1 (]: 24 of 33 PASS not_null_sales_by_category_Category .............................. [[32mPASS[0m in 0.40s]
[0m15:24:40.633099 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m15:24:40.633099 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m15:24:40.648585 [info ] [Thread-1 (]: 25 of 33 START test not_null_sales_by_category_total_orders .................... [RUN]
[0m15:24:40.648585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507, now test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e)
[0m15:24:40.648585 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e, idle-time=0.015486001968383789s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m15:24:40.648585 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m15:24:40.648585 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e"
[0m15:24:40.648585 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m15:24:40.664214 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e"
[0m15:24:40.664214 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e"
[0m15:24:40.664214 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from `workspace`.`default`.`sales_by_category`
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m15:24:40.992855 [debug] [Thread-1 (]: SQL status: OK in 0.330 seconds
[0m15:24:40.992855 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-18b9-1a53-99f9-db881f72a76d) - Closing
[0m15:24:40.992855 [info ] [Thread-1 (]: 25 of 33 PASS not_null_sales_by_category_total_orders .......................... [[32mPASS[0m in 0.34s]
[0m15:24:40.992855 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m15:24:40.992855 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m15:24:40.992855 [info ] [Thread-1 (]: 26 of 33 START test not_null_sales_by_category_total_revenue ................... [RUN]
[0m15:24:41.008478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e, now test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd)
[0m15:24:41.008478 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd, idle-time=0.015622615814208984s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m15:24:41.008478 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m15:24:41.008478 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd"
[0m15:24:41.008478 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m15:24:41.029887 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd"
[0m15:24:41.032860 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd"
[0m15:24:41.034854 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from `workspace`.`default`.`sales_by_category`
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m15:24:41.379751 [debug] [Thread-1 (]: SQL status: OK in 0.340 seconds
[0m15:24:41.379751 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-18f0-185f-91d0-608c8af80d75) - Closing
[0m15:24:41.379751 [info ] [Thread-1 (]: 26 of 33 PASS not_null_sales_by_category_total_revenue ......................... [[32mPASS[0m in 0.37s]
[0m15:24:41.395234 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m15:24:41.395234 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m15:24:41.395234 [info ] [Thread-1 (]: 27 of 33 START test non_negative_top_5_products_total_sales .................... [RUN]
[0m15:24:41.395234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd, now test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34)
[0m15:24:41.395234 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34, idle-time=0.015483379364013672s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m15:24:41.395234 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m15:24:41.410906 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34"
[0m15:24:41.410906 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m15:24:41.410906 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34"
[0m15:24:41.410906 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34"
[0m15:24:41.410906 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`top_5_products`
where TRY_CAST(REPLACE(total_sales, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m15:24:41.807214 [debug] [Thread-1 (]: SQL status: OK in 0.400 seconds
[0m15:24:41.811215 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-192d-11ca-a696-855ba89432e8) - Closing
[0m15:24:41.813218 [info ] [Thread-1 (]: 27 of 33 PASS non_negative_top_5_products_total_sales .......................... [[32mPASS[0m in 0.42s]
[0m15:24:41.816217 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m15:24:41.818218 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m15:24:41.819215 [info ] [Thread-1 (]: 28 of 33 START test not_null_top_5_products_product_id ......................... [RUN]
[0m15:24:41.820310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34, now test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe)
[0m15:24:41.820310 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe, idle-time=0.008094072341918945s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m15:24:41.820310 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m15:24:41.820310 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe"
[0m15:24:41.820310 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m15:24:41.961133 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe"
[0m15:24:41.961133 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe"
[0m15:24:41.961133 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `workspace`.`default`.`top_5_products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:24:42.308475 [debug] [Thread-1 (]: SQL status: OK in 0.350 seconds
[0m15:24:42.312475 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-197e-1527-afd5-4bd9afa3eaa8) - Closing
[0m15:24:42.314147 [info ] [Thread-1 (]: 28 of 33 PASS not_null_top_5_products_product_id ............................... [[32mPASS[0m in 0.49s]
[0m15:24:42.314147 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m15:24:42.314147 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m15:24:42.314147 [info ] [Thread-1 (]: 29 of 33 START test not_null_top_5_products_total_sales ........................ [RUN]
[0m15:24:42.314147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe, now test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818)
[0m15:24:42.314147 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m15:24:42.314147 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m15:24:42.329817 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818"
[0m15:24:42.329817 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m15:24:42.345771 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818"
[0m15:24:42.347782 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818"
[0m15:24:42.349781 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_sales
from `workspace`.`default`.`top_5_products`
where total_sales is null



  
  
      
    ) dbt_internal_test
[0m15:24:42.699862 [debug] [Thread-1 (]: SQL status: OK in 0.350 seconds
[0m15:24:42.706977 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-19b9-1538-9f01-697d49f8b44f) - Closing
[0m15:24:42.710610 [info ] [Thread-1 (]: 29 of 33 PASS not_null_top_5_products_total_sales .............................. [[32mPASS[0m in 0.40s]
[0m15:24:42.715041 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m15:24:42.719034 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m15:24:42.722030 [info ] [Thread-1 (]: 30 of 33 START test non_negative_top_customers_total_spent ..................... [RUN]
[0m15:24:42.725034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818, now test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667)
[0m15:24:42.728030 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667, idle-time=0.01742410659790039s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m15:24:42.731794 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m15:24:42.754980 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667"
[0m15:24:42.758980 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m15:24:42.774895 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667"
[0m15:24:42.780639 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667"
[0m15:24:42.783642 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`top_customers`
where TRY_CAST(REPLACE(total_spent, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m15:24:43.124643 [debug] [Thread-1 (]: SQL status: OK in 0.340 seconds
[0m15:24:43.128866 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-19fb-1993-b9c6-c6ad1559872d) - Closing
[0m15:24:43.130985 [info ] [Thread-1 (]: 30 of 33 PASS non_negative_top_customers_total_spent ........................... [[32mPASS[0m in 0.41s]
[0m15:24:43.133996 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m15:24:43.134995 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m15:24:43.136487 [info ] [Thread-1 (]: 31 of 33 START test not_null_top_customers_User_ID ............................. [RUN]
[0m15:24:43.138949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667, now test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0)
[0m15:24:43.139987 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0, idle-time=0.009001016616821289s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m15:24:43.140986 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m15:24:43.154006 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0"
[0m15:24:43.157050 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m15:24:43.165731 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0"
[0m15:24:43.171588 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0"
[0m15:24:43.173494 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select User_ID
from `workspace`.`default`.`top_customers`
where User_ID is null



  
  
      
    ) dbt_internal_test
[0m15:24:43.497100 [debug] [Thread-1 (]: SQL status: OK in 0.320 seconds
[0m15:24:43.497100 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-1a36-1eb2-be8a-47f5fe2e464f) - Closing
[0m15:24:43.514676 [info ] [Thread-1 (]: 31 of 33 PASS not_null_top_customers_User_ID ................................... [[32mPASS[0m in 0.38s]
[0m15:24:43.514676 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m15:24:43.514676 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m15:24:43.514676 [info ] [Thread-1 (]: 32 of 33 START test not_null_top_customers_total_orders ........................ [RUN]
[0m15:24:43.514676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0, now test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746)
[0m15:24:43.514676 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m15:24:43.514676 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m15:24:43.539201 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746"
[0m15:24:43.541385 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m15:24:43.554385 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746"
[0m15:24:43.555422 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746"
[0m15:24:43.555422 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from `workspace`.`default`.`top_customers`
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m15:24:43.896610 [debug] [Thread-1 (]: SQL status: OK in 0.340 seconds
[0m15:24:43.896610 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-1a71-183b-a147-3fef7c7e8690) - Closing
[0m15:24:43.896610 [info ] [Thread-1 (]: 32 of 33 PASS not_null_top_customers_total_orders .............................. [[32mPASS[0m in 0.38s]
[0m15:24:43.896610 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m15:24:43.915018 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73
[0m15:24:43.919528 [info ] [Thread-1 (]: 33 of 33 START test not_null_top_customers_total_spent ......................... [RUN]
[0m15:24:43.919528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746, now test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73)
[0m15:24:43.919528 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, name=test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73, idle-time=0.022918224334716797s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m15:24:43.919528 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73
[0m15:24:43.930971 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73"
[0m15:24:43.930971 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73
[0m15:24:43.930971 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73"
[0m15:24:43.951347 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73"
[0m15:24:43.953029 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_spent
from `workspace`.`default`.`top_customers`
where total_spent is null



  
  
      
    ) dbt_internal_test
[0m15:24:44.290515 [debug] [Thread-1 (]: SQL status: OK in 0.340 seconds
[0m15:24:44.294560 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-1147-1bfa-90d6-79419188e0ee, command-id=01f08373-1aad-1d8f-8776-e12d3c3db7bb) - Closing
[0m15:24:44.298563 [info ] [Thread-1 (]: 33 of 33 PASS not_null_top_customers_total_spent ............................... [[32mPASS[0m in 0.38s]
[0m15:24:44.301566 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73
[0m15:24:44.304565 [debug] [MainThread]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=master, idle-time=16.810372352600098s, language=None, compute-name=) - Reusing connection previously named master
[0m15:24:44.305776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:24:44.306782 [debug] [MainThread]: Connection 'list_workspace' was properly closed.
[0m15:24:44.307779 [debug] [MainThread]: On list_workspace: Close
[0m15:24:44.308792 [debug] [MainThread]: Databricks adapter: Connection(session-id=01f08373-0f95-1894-93bd-dd8cad39c259) - Closing
[0m15:24:44.495740 [debug] [MainThread]: Connection 'list_workspace_default' was properly closed.
[0m15:24:44.495740 [debug] [MainThread]: On list_workspace_default: Close
[0m15:24:44.495740 [debug] [MainThread]: Databricks adapter: Connection(session-id=01f08373-1074-1135-8992-a3a326d4d0d4) - Closing
[0m15:24:44.696132 [debug] [MainThread]: Connection 'test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73' was properly closed.
[0m15:24:44.696132 [debug] [MainThread]: On test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73: Close
[0m15:24:44.713862 [debug] [MainThread]: Databricks adapter: Connection(session-id=01f08373-1147-1bfa-90d6-79419188e0ee) - Closing
[0m15:24:44.913353 [info ] [MainThread]: 
[0m15:24:44.913353 [info ] [MainThread]: Finished running 24 data tests, 9 view models in 0 hours 0 minutes and 20.50 seconds (20.50s).
[0m15:24:44.932425 [debug] [MainThread]: Command end result
[0m15:24:45.025687 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m15:24:45.028275 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m15:24:45.043910 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m15:24:45.043910 [info ] [MainThread]: 
[0m15:24:45.043910 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:24:45.043910 [info ] [MainThread]: 
[0m15:24:45.052129 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=33
[0m15:24:45.054305 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:24:45.057461 [debug] [MainThread]: Command `dbt build` succeeded at 15:24:45.056461 after 31.29 seconds
[0m15:24:45.058462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C76A2B3E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C76A511690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C76F8F9ED0>]}
[0m15:24:45.061462 [debug] [MainThread]: Flushing usage events
[0m15:24:45.804527 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:25:06.414460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD8DFCC510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD8DFCE990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD8DFCD810>]}


============================== 15:25:06.430113 | 47e56484-127b-4297-a1e0-265902947f16 ==============================
[0m15:25:06.430113 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:25:06.430113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\Documentos\\Python-SQL\\Projetos\\Projeto DBT Databricks CICD\\logs', 'profiles_dir': 'C:\\Users\\diniz\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt build --target databricks --select staging+', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:25:08.185773 [debug] [MainThread]: Spark adapter: Setting pyhive.hive logging to ERROR
[0m15:25:08.186774 [debug] [MainThread]: Spark adapter: Setting thrift.transport logging to ERROR
[0m15:25:08.188773 [debug] [MainThread]: Spark adapter: Setting thrift.protocol logging to ERROR
[0m15:25:09.977489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47e56484-127b-4297-a1e0-265902947f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD8E0090D0>]}
[0m15:25:10.101942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47e56484-127b-4297-a1e0-265902947f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD8D749DD0>]}
[0m15:25:10.101942 [info ] [MainThread]: Registered adapter: databricks=1.10.4
[0m15:25:11.258423 [debug] [MainThread]: checksum: 3fbc73d786818920aecb1b2190495121ce0b60768fe54c46d521f1e82da30af9, vars: {}, profile: , target: databricks, version: 1.10.3
[0m15:25:12.024000 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:25:12.024000 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:25:12.039639 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_databricks_cicd.mart.sqlserver
[0m15:25:12.123540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47e56484-127b-4297-a1e0-265902947f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD9A5B0450>]}
[0m15:25:12.414805 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m15:25:12.414805 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m15:25:12.507946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47e56484-127b-4297-a1e0-265902947f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD8B7816D0>]}
[0m15:25:12.507946 [info ] [MainThread]: Found 9 models, 34 data tests, 1 source, 799 macros
[0m15:25:12.507946 [info ] [MainThread]: 
[0m15:25:12.523580 [info ] [MainThread]: Concurrency: 1 threads (target='databricks')
[0m15:25:12.523580 [info ] [MainThread]: 
[0m15:25:12.523580 [debug] [MainThread]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=master, idle-time=0s, language=None, compute-name=) - Creating connection
[0m15:25:12.523580 [debug] [MainThread]: Acquiring new databricks connection 'master'
[0m15:25:12.539207 [debug] [ThreadPool]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=list_workspace, idle-time=0s, language=None, compute-name=) - Creating connection
[0m15:25:12.539207 [debug] [ThreadPool]: Acquiring new databricks connection 'list_workspace'
[0m15:25:12.539207 [debug] [ThreadPool]: Using databricks connection "list_workspace"
[0m15:25:12.539207 [debug] [ThreadPool]: On list_workspace: GetSchemas(database=workspace, schema=None)
[0m15:25:12.539207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:13.273467 [debug] [ThreadPool]: Databricks adapter: Connection(session-id=01f08373-2c0a-1bdb-a281-7a27c45302c2) - Created
[0m15:25:13.570631 [debug] [ThreadPool]: SQL status: OK in 1.030 seconds
[0m15:25:13.570631 [debug] [ThreadPool]: Databricks adapter: Cursor(session-id=01f08373-2c0a-1bdb-a281-7a27c45302c2, command-id=01f08373-2c29-1ea9-b4ce-a91f00656377) - Closing
[0m15:25:13.570631 [debug] [ThreadPool]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=list_workspace_default, idle-time=0s, language=None, compute-name=) - Creating connection
[0m15:25:13.570631 [debug] [ThreadPool]: Acquiring new databricks connection 'list_workspace_default'
[0m15:25:13.601773 [debug] [ThreadPool]: Using databricks connection "list_workspace_default"
[0m15:25:13.601773 [debug] [ThreadPool]: On list_workspace_default: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "connection_name": "list_workspace_default"} */

    
SELECT
  table_name,
  if(table_type IN ('EXTERNAL', 'MANAGED', 'MANAGED_SHALLOW_CLONE', 'EXTERNAL_SHALLOW_CLONE'), 'table', lower(table_type)) AS table_type,
  lower(data_source_format) AS file_format,
  table_owner
FROM `system`.`information_schema`.`tables`
WHERE table_catalog = 'workspace' 
  AND table_schema = 'default'

  
[0m15:25:13.601773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:14.308763 [debug] [ThreadPool]: Databricks adapter: Connection(session-id=01f08373-2ca9-18a1-9c0e-45202489877b) - Created
[0m15:25:14.789231 [debug] [ThreadPool]: SQL status: OK in 1.190 seconds
[0m15:25:14.804713 [debug] [ThreadPool]: Databricks adapter: Cursor(session-id=01f08373-2ca9-18a1-9c0e-45202489877b, command-id=01f08373-2cc5-1f9c-8b07-fb9af51b6af4) - Closing
[0m15:25:14.804713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47e56484-127b-4297-a1e0-265902947f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD9927EED0>]}
[0m15:25:14.820340 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.src_ecommerce
[0m15:25:14.820340 [info ] [Thread-1 (]: 1 of 33 START sql view model default.src_ecommerce ............................. [RUN]
[0m15:25:14.820340 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=model.dbt_databricks_cicd.src_ecommerce, idle-time=0s, language=None, compute-name=) - Creating connection
[0m15:25:14.820340 [debug] [Thread-1 (]: Acquiring new databricks connection 'model.dbt_databricks_cicd.src_ecommerce'
[0m15:25:14.820340 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.src_ecommerce
[0m15:25:14.845372 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.src_ecommerce"
[0m15:25:14.848336 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.src_ecommerce
[0m15:25:14.868405 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m15:25:14.868405 [warn ] [Thread-1 (]: [[33mWARNING[0m]: Use revamped materializations based on separating create and insert.  This allows more performant column comments, as well as new column features.
You may opt into the new behavior sooner by setting `flags.use_materialization_v2` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m15:25:14.868405 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '47e56484-127b-4297-a1e0-265902947f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD9A9107D0>]}
[0m15:25:14.899668 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`src_ecommerce`
[0m15:25:14.915285 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.src_ecommerce"
[0m15:25:14.915285 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.src_ecommerce"
[0m15:25:14.930913 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.src_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.src_ecommerce"} */

  
  
  
  create or replace view `workspace`.`default`.`src_ecommerce`
  
  as (
    SELECT * FROM default.sales_ecommerce
  )

[0m15:25:14.930913 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:25:15.615690 [debug] [Thread-1 (]: Databricks adapter: Connection(session-id=01f08373-2d72-1152-96a1-06df33fa0386) - Created
[0m15:25:16.189647 [debug] [Thread-1 (]: SQL status: OK in 1.260 seconds
[0m15:25:16.191649 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-2d8d-1aaa-a34b-e35f26dab778) - Closing
[0m15:25:16.214186 [debug] [Thread-1 (]: Applying tags to relation None
[0m15:25:16.214186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47e56484-127b-4297-a1e0-265902947f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD9A8DD0D0>]}
[0m15:25:16.214186 [info ] [Thread-1 (]: 1 of 33 OK created sql view model default.src_ecommerce ........................ [[32mOK[0m in 1.39s]
[0m15:25:16.214186 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.src_ecommerce
[0m15:25:16.229815 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.stg_ecommerce
[0m15:25:16.229815 [info ] [Thread-1 (]: 2 of 33 START sql view model default.stg_ecommerce ............................. [RUN]
[0m15:25:16.229815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.src_ecommerce, now model.dbt_databricks_cicd.stg_ecommerce)
[0m15:25:16.229815 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=model.dbt_databricks_cicd.stg_ecommerce, idle-time=0.015628576278686523s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.src_ecommerce
[0m15:25:16.229815 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.stg_ecommerce
[0m15:25:16.245480 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.stg_ecommerce"
[0m15:25:16.252908 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.stg_ecommerce
[0m15:25:16.258946 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m15:25:16.261944 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`stg_ecommerce`
[0m15:25:16.264201 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.stg_ecommerce"
[0m15:25:16.268201 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.stg_ecommerce"
[0m15:25:16.270202 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.stg_ecommerce: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.stg_ecommerce"} */

  
  
  
  create or replace view `workspace`.`default`.`stg_ecommerce`
  
  as (
    SELECT
  User_ID,
  Product_ID,
  Category,
  Price,
  Discount,
  Final_Price,
  Payment_Method,
  Purchase_Date
FROM `workspace`.`default`.`src_ecommerce`
  )

[0m15:25:16.819710 [debug] [Thread-1 (]: SQL status: OK in 0.550 seconds
[0m15:25:16.822716 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-2df0-1f83-8d97-f669b8d6746d) - Closing
[0m15:25:16.824712 [debug] [Thread-1 (]: Applying tags to relation None
[0m15:25:16.827746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47e56484-127b-4297-a1e0-265902947f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD9A91AE90>]}
[0m15:25:16.830414 [info ] [Thread-1 (]: 2 of 33 OK created sql view model default.stg_ecommerce ........................ [[32mOK[0m in 0.60s]
[0m15:25:16.834417 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.stg_ecommerce
[0m15:25:16.838458 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.avg_discount_by_category
[0m15:25:16.840462 [info ] [Thread-1 (]: 3 of 33 START sql view model default.avg_discount_by_category .................. [RUN]
[0m15:25:16.843703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.stg_ecommerce, now model.dbt_databricks_cicd.avg_discount_by_category)
[0m15:25:16.846703 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=model.dbt_databricks_cicd.avg_discount_by_category, idle-time=0.0189821720123291s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.stg_ecommerce
[0m15:25:16.851706 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.avg_discount_by_category
[0m15:25:16.863517 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.avg_discount_by_category"
[0m15:25:16.868518 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.avg_discount_by_category
[0m15:25:16.877520 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m15:25:16.881518 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`avg_discount_by_category`
[0m15:25:16.884521 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.avg_discount_by_category"
[0m15:25:16.887522 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.avg_discount_by_category"
[0m15:25:16.889529 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.avg_discount_by_category: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.avg_discount_by_category"} */

  
  
  
  create or replace view `workspace`.`default`.`avg_discount_by_category`
  
  as (
    SELECT
  Category,
  ROUND(AVG(CAST(`Discount` AS DOUBLE)), 2) AS avg_discount_percent
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY Category
ORDER BY avg_discount_percent DESC
  )

[0m15:25:17.441856 [debug] [Thread-1 (]: SQL status: OK in 0.550 seconds
[0m15:25:17.443855 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-2e50-127b-98b4-acf9d123ffef) - Closing
[0m15:25:17.445855 [debug] [Thread-1 (]: Applying tags to relation None
[0m15:25:17.448893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47e56484-127b-4297-a1e0-265902947f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD9A928750>]}
[0m15:25:17.450856 [info ] [Thread-1 (]: 3 of 33 OK created sql view model default.avg_discount_by_category ............. [[32mOK[0m in 0.61s]
[0m15:25:17.453860 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.avg_discount_by_category
[0m15:25:17.454853 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.avg_ticket_by_category
[0m15:25:17.456855 [info ] [Thread-1 (]: 4 of 33 START sql view model default.avg_ticket_by_category .................... [RUN]
[0m15:25:17.458854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.avg_discount_by_category, now model.dbt_databricks_cicd.avg_ticket_by_category)
[0m15:25:17.459853 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=model.dbt_databricks_cicd.avg_ticket_by_category, idle-time=0.01096034049987793s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.avg_discount_by_category
[0m15:25:17.460854 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.avg_ticket_by_category
[0m15:25:17.469855 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.avg_ticket_by_category"
[0m15:25:17.472859 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.avg_ticket_by_category
[0m15:25:17.487857 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m15:25:17.490858 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`avg_ticket_by_category`
[0m15:25:17.493058 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.avg_ticket_by_category"
[0m15:25:17.495059 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.avg_ticket_by_category"
[0m15:25:17.497085 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.avg_ticket_by_category: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.avg_ticket_by_category"} */

  
  
  
  create or replace view `workspace`.`default`.`avg_ticket_by_category`
  
  as (
    SELECT
  Category,
  ROUND(AVG(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS avg_ticket
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY Category
ORDER BY avg_ticket DESC
  )

[0m15:25:18.119406 [debug] [Thread-1 (]: SQL status: OK in 0.620 seconds
[0m15:25:18.123439 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-2eac-15a0-af55-e5dc44738bfc) - Closing
[0m15:25:18.125409 [debug] [Thread-1 (]: Applying tags to relation None
[0m15:25:18.127409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47e56484-127b-4297-a1e0-265902947f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD9ACFEE10>]}
[0m15:25:18.130367 [info ] [Thread-1 (]: 4 of 33 OK created sql view model default.avg_ticket_by_category ............... [[32mOK[0m in 0.67s]
[0m15:25:18.134207 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.avg_ticket_by_category
[0m15:25:18.134207 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.monthly_revenue
[0m15:25:18.134207 [info ] [Thread-1 (]: 5 of 33 START sql view model default.monthly_revenue ........................... [RUN]
[0m15:25:18.134207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.avg_ticket_by_category, now model.dbt_databricks_cicd.monthly_revenue)
[0m15:25:18.134207 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=model.dbt_databricks_cicd.monthly_revenue, idle-time=0.0067980289459228516s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.avg_ticket_by_category
[0m15:25:18.134207 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.monthly_revenue
[0m15:25:18.153144 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.monthly_revenue"
[0m15:25:18.153144 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.monthly_revenue
[0m15:25:18.172157 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m15:25:18.174161 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`monthly_revenue`
[0m15:25:18.176159 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.monthly_revenue"
[0m15:25:18.178903 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.monthly_revenue"
[0m15:25:18.181913 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.monthly_revenue: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.monthly_revenue"} */

  
  
  
  create or replace view `workspace`.`default`.`monthly_revenue`
  
  as (
    SELECT
  CAST(DATE_TRUNC('month', CAST(Purchase_Date AS DATE)) AS DATE) AS month,
  ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS monthly_revenue
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY 1
ORDER BY 1
  )

[0m15:25:18.797316 [debug] [Thread-1 (]: SQL status: OK in 0.610 seconds
[0m15:25:18.800880 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-2f15-1114-8533-34c486e6413d) - Closing
[0m15:25:18.804163 [debug] [Thread-1 (]: Applying tags to relation None
[0m15:25:18.806159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47e56484-127b-4297-a1e0-265902947f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD9ACFFCD0>]}
[0m15:25:18.807161 [info ] [Thread-1 (]: 5 of 33 OK created sql view model default.monthly_revenue ...................... [[32mOK[0m in 0.67s]
[0m15:25:18.810701 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.monthly_revenue
[0m15:25:18.813712 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.payment_distribution
[0m15:25:18.816704 [info ] [Thread-1 (]: 6 of 33 START sql view model default.payment_distribution ...................... [RUN]
[0m15:25:18.818701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.monthly_revenue, now model.dbt_databricks_cicd.payment_distribution)
[0m15:25:18.819700 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=model.dbt_databricks_cicd.payment_distribution, idle-time=0.013540267944335938s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.monthly_revenue
[0m15:25:18.820700 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.payment_distribution
[0m15:25:18.833701 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.payment_distribution"
[0m15:25:18.836991 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.payment_distribution
[0m15:25:18.843683 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m15:25:18.851684 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`payment_distribution`
[0m15:25:18.855750 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.payment_distribution"
[0m15:25:18.857682 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.payment_distribution"
[0m15:25:18.859684 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.payment_distribution: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.payment_distribution"} */

  
  
  
  create or replace view `workspace`.`default`.`payment_distribution`
  
  as (
    SELECT
  Payment_Method,
  COUNT(*) AS total_transactions,
  ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS total_value
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY Payment_Method
ORDER BY total_value DESC
  )

[0m15:25:19.472779 [debug] [Thread-1 (]: SQL status: OK in 0.610 seconds
[0m15:25:19.474679 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-2f7c-1a9b-ad42-b5bab960164b) - Closing
[0m15:25:19.476718 [debug] [Thread-1 (]: Applying tags to relation None
[0m15:25:19.480080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47e56484-127b-4297-a1e0-265902947f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD9ACC2750>]}
[0m15:25:19.482080 [info ] [Thread-1 (]: 6 of 33 OK created sql view model default.payment_distribution ................. [[32mOK[0m in 0.66s]
[0m15:25:19.484075 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.payment_distribution
[0m15:25:19.486076 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.sales_by_category
[0m15:25:19.487070 [info ] [Thread-1 (]: 7 of 33 START sql view model default.sales_by_category ......................... [RUN]
[0m15:25:19.489369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.payment_distribution, now model.dbt_databricks_cicd.sales_by_category)
[0m15:25:19.490563 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=model.dbt_databricks_cicd.sales_by_category, idle-time=0.010483741760253906s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.payment_distribution
[0m15:25:19.491605 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.sales_by_category
[0m15:25:19.503610 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.sales_by_category"
[0m15:25:19.506605 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.sales_by_category
[0m15:25:19.514760 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m15:25:19.517758 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`sales_by_category`
[0m15:25:19.521760 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.sales_by_category"
[0m15:25:19.523759 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.sales_by_category"
[0m15:25:19.525765 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.sales_by_category: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.sales_by_category"} */

  
  
  
  create or replace view `workspace`.`default`.`sales_by_category`
  
  as (
    SELECT
  Category,
  COUNT(*) AS total_orders,
  ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS total_revenue
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY Category
ORDER BY total_revenue DESC
  )

[0m15:25:20.161990 [debug] [Thread-1 (]: SQL status: OK in 0.640 seconds
[0m15:25:20.163989 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-2fe1-1672-8fef-834bb6fee8cc) - Closing
[0m15:25:20.165084 [debug] [Thread-1 (]: Applying tags to relation None
[0m15:25:20.165084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47e56484-127b-4297-a1e0-265902947f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD9AD43790>]}
[0m15:25:20.165084 [info ] [Thread-1 (]: 7 of 33 OK created sql view model default.sales_by_category .................... [[32mOK[0m in 0.68s]
[0m15:25:20.165084 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.sales_by_category
[0m15:25:20.165084 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.top_5_products
[0m15:25:20.165084 [info ] [Thread-1 (]: 8 of 33 START sql view model default.top_5_products ............................ [RUN]
[0m15:25:20.165084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.sales_by_category, now model.dbt_databricks_cicd.top_5_products)
[0m15:25:20.165084 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=model.dbt_databricks_cicd.top_5_products, idle-time=0.0s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.sales_by_category
[0m15:25:20.165084 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.top_5_products
[0m15:25:20.180720 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.top_5_products"
[0m15:25:20.180720 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.top_5_products
[0m15:25:20.196367 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m15:25:20.196367 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`top_5_products`
[0m15:25:20.196367 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.top_5_products"
[0m15:25:20.196367 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.top_5_products"
[0m15:25:20.196367 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.top_5_products: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.top_5_products"} */

  
  
  
  create or replace view `workspace`.`default`.`top_5_products`
  
  as (
    WITH base AS (
    SELECT
        product_id,
        ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS total_sales
    FROM `workspace`.`default`.`stg_ecommerce`
    GROUP BY product_id
)

SELECT
    product_id,
    total_sales
FROM base
ORDER BY total_sales DESC
LIMIT 5
  )

[0m15:25:20.792019 [debug] [Thread-1 (]: SQL status: OK in 0.600 seconds
[0m15:25:20.795107 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-3049-1878-bbad-85a04d00be8b) - Closing
[0m15:25:20.797107 [debug] [Thread-1 (]: Applying tags to relation None
[0m15:25:20.799110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47e56484-127b-4297-a1e0-265902947f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD9A91E910>]}
[0m15:25:20.801114 [info ] [Thread-1 (]: 8 of 33 OK created sql view model default.top_5_products ....................... [[32mOK[0m in 0.63s]
[0m15:25:20.803077 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.top_5_products
[0m15:25:20.805069 [debug] [Thread-1 (]: Began running node model.dbt_databricks_cicd.top_customers
[0m15:25:20.806075 [info ] [Thread-1 (]: 9 of 33 START sql view model default.top_customers ............................. [RUN]
[0m15:25:20.808069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.top_5_products, now model.dbt_databricks_cicd.top_customers)
[0m15:25:20.810070 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=model.dbt_databricks_cicd.top_customers, idle-time=0.01096034049987793s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.top_5_products
[0m15:25:20.812069 [debug] [Thread-1 (]: Began compiling node model.dbt_databricks_cicd.top_customers
[0m15:25:20.819110 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_databricks_cicd.top_customers"
[0m15:25:20.821108 [debug] [Thread-1 (]: Began executing node model.dbt_databricks_cicd.top_customers
[0m15:25:20.829076 [debug] [Thread-1 (]: MATERIALIZING VIEW
[0m15:25:20.833073 [debug] [Thread-1 (]: Creating view `workspace`.`default`.`top_customers`
[0m15:25:20.837990 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_databricks_cicd.top_customers"
[0m15:25:20.837990 [debug] [Thread-1 (]: Using databricks connection "model.dbt_databricks_cicd.top_customers"
[0m15:25:20.837990 [debug] [Thread-1 (]: On model.dbt_databricks_cicd.top_customers: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "model.dbt_databricks_cicd.top_customers"} */

  
  
  
  create or replace view `workspace`.`default`.`top_customers`
  
  as (
    SELECT
  User_ID,
  COUNT(*) AS total_orders,
  ROUND(SUM(CAST(REPLACE(`Final_Price`, ',', '.') AS DOUBLE)), 2) AS total_spent
FROM `workspace`.`default`.`stg_ecommerce`
GROUP BY User_ID
ORDER BY total_spent DESC
LIMIT 10
  )

[0m15:25:21.483705 [debug] [Thread-1 (]: SQL status: OK in 0.640 seconds
[0m15:25:21.485704 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-30aa-1e1d-b3ef-c61194350341) - Closing
[0m15:25:21.486667 [debug] [Thread-1 (]: Applying tags to relation None
[0m15:25:21.488703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47e56484-127b-4297-a1e0-265902947f16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD9ACEC8D0>]}
[0m15:25:21.490669 [info ] [Thread-1 (]: 9 of 33 OK created sql view model default.top_customers ........................ [[32mOK[0m in 0.68s]
[0m15:25:21.494713 [debug] [Thread-1 (]: Finished running node model.dbt_databricks_cicd.top_customers
[0m15:25:21.496717 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m15:25:21.497716 [info ] [Thread-1 (]: 10 of 33 START test non_negative_avg_discount_by_category_avg_discount_percent . [RUN]
[0m15:25:21.499831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_databricks_cicd.top_customers, now test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f)
[0m15:25:21.504012 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f, idle-time=0.014157533645629883s, language=sql, compute-name=) - Reusing connection previously named model.dbt_databricks_cicd.top_customers
[0m15:25:21.505019 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m15:25:21.523890 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f"
[0m15:25:21.528821 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m15:25:21.569017 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f"
[0m15:25:21.571032 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f"
[0m15:25:21.572983 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`avg_discount_by_category`
where TRY_CAST(REPLACE(avg_discount_percent, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m15:25:21.924568 [debug] [Thread-1 (]: SQL status: OK in 0.350 seconds
[0m15:25:21.932033 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-311a-139e-b04d-8ed113d6a6eb) - Closing
[0m15:25:21.932033 [info ] [Thread-1 (]: 10 of 33 PASS non_negative_avg_discount_by_category_avg_discount_percent ....... [[32mPASS[0m in 0.43s]
[0m15:25:21.944997 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m15:25:21.947992 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m15:25:21.948994 [info ] [Thread-1 (]: 11 of 33 START test not_null_avg_discount_by_category_Category ................. [RUN]
[0m15:25:21.951000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f, now test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b)
[0m15:25:21.952001 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b, idle-time=0.019968032836914062s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_avg_discount_by_category_avg_discount_percent.c2755bf97f
[0m15:25:21.953996 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m15:25:21.987672 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b"
[0m15:25:21.989669 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m15:25:22.006816 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b"
[0m15:25:22.011467 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b"
[0m15:25:22.013457 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Category
from `workspace`.`default`.`avg_discount_by_category`
where Category is null



  
  
      
    ) dbt_internal_test
[0m15:25:22.382536 [debug] [Thread-1 (]: SQL status: OK in 0.370 seconds
[0m15:25:22.386748 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-315e-1f56-a210-620e40e7150d) - Closing
[0m15:25:22.388789 [info ] [Thread-1 (]: 11 of 33 PASS not_null_avg_discount_by_category_Category ....................... [[32mPASS[0m in 0.44s]
[0m15:25:22.392691 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m15:25:22.395408 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m15:25:22.396413 [info ] [Thread-1 (]: 12 of 33 START test not_null_avg_discount_by_category_avg_discount_percent ..... [RUN]
[0m15:25:22.398336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b, now test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101)
[0m15:25:22.399334 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101, idle-time=0.01054525375366211s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_avg_discount_by_category_Category.237c8c010b
[0m15:25:22.400335 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m15:25:22.414652 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101"
[0m15:25:22.418614 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m15:25:22.435155 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101"
[0m15:25:22.437381 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101"
[0m15:25:22.439379 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_discount_percent
from `workspace`.`default`.`avg_discount_by_category`
where avg_discount_percent is null



  
  
      
    ) dbt_internal_test
[0m15:25:22.794074 [debug] [Thread-1 (]: SQL status: OK in 0.350 seconds
[0m15:25:22.800840 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-319e-1a96-b544-f6e2976f7a0a) - Closing
[0m15:25:22.803730 [info ] [Thread-1 (]: 12 of 33 PASS not_null_avg_discount_by_category_avg_discount_percent ........... [[32mPASS[0m in 0.41s]
[0m15:25:22.806729 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m15:25:22.810232 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m15:25:22.812227 [info ] [Thread-1 (]: 13 of 33 START test non_negative_avg_ticket_by_category_avg_ticket ............. [RUN]
[0m15:25:22.815225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101, now test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095)
[0m15:25:22.816223 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095, idle-time=0.012492656707763672s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_avg_discount_by_category_avg_discount_percent.622396a101
[0m15:25:22.818223 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m15:25:22.834277 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095"
[0m15:25:22.836284 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m15:25:22.845118 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095"
[0m15:25:22.847114 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095"
[0m15:25:22.848117 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`avg_ticket_by_category`
where TRY_CAST(REPLACE(avg_ticket, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m15:25:23.205250 [debug] [Thread-1 (]: SQL status: OK in 0.350 seconds
[0m15:25:23.209416 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-31dd-12ae-ab4b-6bddf7882f1a) - Closing
[0m15:25:23.211417 [info ] [Thread-1 (]: 13 of 33 PASS non_negative_avg_ticket_by_category_avg_ticket ................... [[32mPASS[0m in 0.40s]
[0m15:25:23.213302 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m15:25:23.215259 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m15:25:23.216268 [info ] [Thread-1 (]: 14 of 33 START test not_null_avg_ticket_by_category_Category ................... [RUN]
[0m15:25:23.218297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095, now test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f)
[0m15:25:23.219258 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f, idle-time=0.007841110229492188s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_avg_ticket_by_category_avg_ticket.6ca601b095
[0m15:25:23.220298 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m15:25:23.223966 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f"
[0m15:25:23.223966 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m15:25:23.239604 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f"
[0m15:25:23.239604 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f"
[0m15:25:23.239604 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Category
from `workspace`.`default`.`avg_ticket_by_category`
where Category is null



  
  
      
    ) dbt_internal_test
[0m15:25:23.625392 [debug] [Thread-1 (]: SQL status: OK in 0.390 seconds
[0m15:25:23.632392 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-3219-1bb8-8546-4316a02d4900) - Closing
[0m15:25:23.636392 [info ] [Thread-1 (]: 14 of 33 PASS not_null_avg_ticket_by_category_Category ......................... [[32mPASS[0m in 0.42s]
[0m15:25:23.641687 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m15:25:23.644387 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m15:25:23.647390 [info ] [Thread-1 (]: 15 of 33 START test not_null_avg_ticket_by_category_avg_ticket ................. [RUN]
[0m15:25:23.650385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f, now test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41)
[0m15:25:23.652738 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41, idle-time=0.015345335006713867s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_avg_ticket_by_category_Category.e0cd76451f
[0m15:25:23.653738 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m15:25:23.677389 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41"
[0m15:25:23.680390 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m15:25:23.697301 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41"
[0m15:25:23.701754 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41"
[0m15:25:23.705755 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select avg_ticket
from `workspace`.`default`.`avg_ticket_by_category`
where avg_ticket is null



  
  
      
    ) dbt_internal_test
[0m15:25:24.029742 [debug] [Thread-1 (]: SQL status: OK in 0.320 seconds
[0m15:25:24.035759 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-325f-1d4b-a3ed-252ded593c99) - Closing
[0m15:25:24.038760 [info ] [Thread-1 (]: 15 of 33 PASS not_null_avg_ticket_by_category_avg_ticket ....................... [[32mPASS[0m in 0.39s]
[0m15:25:24.042937 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m15:25:24.045937 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m15:25:24.047936 [info ] [Thread-1 (]: 16 of 33 START test non_negative_monthly_revenue_monthly_revenue ............... [RUN]
[0m15:25:24.050936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41, now test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294)
[0m15:25:24.052937 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294, idle-time=0.014173507690429688s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_avg_ticket_by_category_avg_ticket.68d6992a41
[0m15:25:24.054935 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m15:25:24.076937 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294"
[0m15:25:24.079937 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m15:25:24.093938 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294"
[0m15:25:24.096941 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294"
[0m15:25:24.098938 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`monthly_revenue`
where TRY_CAST(REPLACE(monthly_revenue, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m15:25:24.470712 [debug] [Thread-1 (]: SQL status: OK in 0.370 seconds
[0m15:25:24.477888 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-329c-190b-9933-62da91180f15) - Closing
[0m15:25:24.479885 [info ] [Thread-1 (]: 16 of 33 PASS non_negative_monthly_revenue_monthly_revenue ..................... [[32mPASS[0m in 0.43s]
[0m15:25:24.483584 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m15:25:24.486593 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m15:25:24.489585 [info ] [Thread-1 (]: 17 of 33 START test not_null_monthly_revenue_month ............................. [RUN]
[0m15:25:24.492610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294, now test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b)
[0m15:25:24.494589 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b, idle-time=0.014703750610351562s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_monthly_revenue_monthly_revenue.68b6895294
[0m15:25:24.496586 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m15:25:24.514353 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b"
[0m15:25:24.514353 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m15:25:24.527172 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b"
[0m15:25:24.530174 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b"
[0m15:25:24.531175 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select month
from `workspace`.`default`.`monthly_revenue`
where month is null



  
  
      
    ) dbt_internal_test
[0m15:25:24.896535 [debug] [Thread-1 (]: SQL status: OK in 0.360 seconds
[0m15:25:24.898645 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-32dd-1e89-8ad0-0ab4644b4cb1) - Closing
[0m15:25:24.909246 [info ] [Thread-1 (]: 17 of 33 PASS not_null_monthly_revenue_month ................................... [[32mPASS[0m in 0.42s]
[0m15:25:24.913252 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m15:25:24.916253 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m15:25:24.918251 [info ] [Thread-1 (]: 18 of 33 START test not_null_monthly_revenue_monthly_revenue ................... [RUN]
[0m15:25:24.920249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b, now test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b)
[0m15:25:24.926336 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b, idle-time=0.01708507537841797s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_monthly_revenue_month.ee51ac609b
[0m15:25:24.928335 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m15:25:24.942504 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b"
[0m15:25:24.946638 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m15:25:24.963364 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b"
[0m15:25:24.963854 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b"
[0m15:25:24.963854 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select monthly_revenue
from `workspace`.`default`.`monthly_revenue`
where monthly_revenue is null



  
  
      
    ) dbt_internal_test
[0m15:25:25.298654 [debug] [Thread-1 (]: SQL status: OK in 0.330 seconds
[0m15:25:25.303661 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-3320-15ac-856d-6592d506c00b) - Closing
[0m15:25:25.306966 [info ] [Thread-1 (]: 18 of 33 PASS not_null_monthly_revenue_monthly_revenue ......................... [[32mPASS[0m in 0.39s]
[0m15:25:25.309971 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m15:25:25.311969 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m15:25:25.312968 [info ] [Thread-1 (]: 19 of 33 START test non_negative_payment_distribution_total_value .............. [RUN]
[0m15:25:25.315779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b, now test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282)
[0m15:25:25.317779 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282, idle-time=0.009811162948608398s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_monthly_revenue_monthly_revenue.02fcba701b
[0m15:25:25.318780 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m15:25:25.339964 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282"
[0m15:25:25.344968 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m15:25:25.353827 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282"
[0m15:25:25.358370 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282"
[0m15:25:25.361372 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`payment_distribution`
where TRY_CAST(REPLACE(total_value, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m15:25:25.713923 [debug] [Thread-1 (]: SQL status: OK in 0.350 seconds
[0m15:25:25.723350 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-335c-136f-bf56-7f8663980384) - Closing
[0m15:25:25.727352 [info ] [Thread-1 (]: 19 of 33 PASS non_negative_payment_distribution_total_value .................... [[32mPASS[0m in 0.41s]
[0m15:25:25.732350 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m15:25:25.734352 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m15:25:25.736349 [info ] [Thread-1 (]: 20 of 33 START test not_null_payment_distribution_Payment_Method ............... [RUN]
[0m15:25:25.741357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282, now test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae)
[0m15:25:25.744351 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae, idle-time=0.01599860191345215s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_payment_distribution_total_value.c4ae109282
[0m15:25:25.747352 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m15:25:25.774458 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae"
[0m15:25:25.779454 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m15:25:25.786456 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae"
[0m15:25:25.790458 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae"
[0m15:25:25.793457 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Payment_Method
from `workspace`.`default`.`payment_distribution`
where Payment_Method is null



  
  
      
    ) dbt_internal_test
[0m15:25:26.120017 [debug] [Thread-1 (]: SQL status: OK in 0.320 seconds
[0m15:25:26.128017 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-339e-169b-afd4-02fe814e99c8) - Closing
[0m15:25:26.133433 [info ] [Thread-1 (]: 20 of 33 PASS not_null_payment_distribution_Payment_Method ..................... [[32mPASS[0m in 0.39s]
[0m15:25:26.139000 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m15:25:26.142982 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m15:25:26.143983 [info ] [Thread-1 (]: 21 of 33 START test not_null_payment_distribution_total_transactions ........... [RUN]
[0m15:25:26.148085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae, now test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8)
[0m15:25:26.149092 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8, idle-time=0.017070531845092773s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_payment_distribution_Payment_Method.bd80df3cae
[0m15:25:26.150090 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m15:25:26.163496 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8"
[0m15:25:26.165496 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m15:25:26.173506 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8"
[0m15:25:26.176495 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8"
[0m15:25:26.177496 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_transactions
from `workspace`.`default`.`payment_distribution`
where total_transactions is null



  
  
      
    ) dbt_internal_test
[0m15:25:26.520956 [debug] [Thread-1 (]: SQL status: OK in 0.340 seconds
[0m15:25:26.527413 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-33d8-1cfd-b45f-8e94fbe72712) - Closing
[0m15:25:26.527413 [info ] [Thread-1 (]: 21 of 33 PASS not_null_payment_distribution_total_transactions ................. [[32mPASS[0m in 0.38s]
[0m15:25:26.539436 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m15:25:26.544060 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m15:25:26.544060 [info ] [Thread-1 (]: 22 of 33 START test not_null_payment_distribution_total_value .................. [RUN]
[0m15:25:26.544060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8, now test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03)
[0m15:25:26.544060 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03, idle-time=0.016646862030029297s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_payment_distribution_total_transactions.928411e2e8
[0m15:25:26.544060 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m15:25:26.571746 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03"
[0m15:25:26.577307 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m15:25:26.593163 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03"
[0m15:25:26.598168 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03"
[0m15:25:26.600167 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_value
from `workspace`.`default`.`payment_distribution`
where total_value is null



  
  
      
    ) dbt_internal_test
[0m15:25:26.935600 [debug] [Thread-1 (]: SQL status: OK in 0.330 seconds
[0m15:25:26.941501 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-3419-1362-a824-0773c7e11451) - Closing
[0m15:25:26.944507 [info ] [Thread-1 (]: 22 of 33 PASS not_null_payment_distribution_total_value ........................ [[32mPASS[0m in 0.40s]
[0m15:25:26.948503 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m15:25:26.950502 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m15:25:26.954620 [info ] [Thread-1 (]: 23 of 33 START test non_negative_sales_by_category_total_revenue ............... [RUN]
[0m15:25:26.958597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03, now test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41)
[0m15:25:26.960589 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41, idle-time=0.01508021354675293s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_payment_distribution_total_value.58135f5f03
[0m15:25:26.962649 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m15:25:26.981646 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41"
[0m15:25:26.983649 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m15:25:26.994957 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41"
[0m15:25:27.004447 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41"
[0m15:25:27.009446 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`sales_by_category`
where TRY_CAST(REPLACE(total_revenue, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m15:25:27.374020 [debug] [Thread-1 (]: SQL status: OK in 0.360 seconds
[0m15:25:27.376982 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-3459-1731-bbd8-b9c5a1444222) - Closing
[0m15:25:27.380022 [info ] [Thread-1 (]: 23 of 33 PASS non_negative_sales_by_category_total_revenue ..................... [[32mPASS[0m in 0.42s]
[0m15:25:27.381988 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m15:25:27.382987 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m15:25:27.383987 [info ] [Thread-1 (]: 24 of 33 START test not_null_sales_by_category_Category ........................ [RUN]
[0m15:25:27.387988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41, now test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507)
[0m15:25:27.389986 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507, idle-time=0.011005878448486328s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_sales_by_category_total_revenue.8ad171ef41
[0m15:25:27.391025 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m15:25:27.399057 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507"
[0m15:25:27.399057 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m15:25:27.411995 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507"
[0m15:25:27.413995 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507"
[0m15:25:27.415994 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Category
from `workspace`.`default`.`sales_by_category`
where Category is null



  
  
      
    ) dbt_internal_test
[0m15:25:27.749642 [debug] [Thread-1 (]: SQL status: OK in 0.330 seconds
[0m15:25:27.754734 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-3496-1170-abdc-10dba60d0701) - Closing
[0m15:25:27.756736 [info ] [Thread-1 (]: 24 of 33 PASS not_null_sales_by_category_Category .............................. [[32mPASS[0m in 0.37s]
[0m15:25:27.759736 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m15:25:27.760735 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m15:25:27.762503 [info ] [Thread-1 (]: 25 of 33 START test not_null_sales_by_category_total_orders .................... [RUN]
[0m15:25:27.763504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507, now test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e)
[0m15:25:27.765502 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e, idle-time=0.0077669620513916016s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_sales_by_category_Category.e69cdf4507
[0m15:25:27.766501 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m15:25:27.776505 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e"
[0m15:25:27.779616 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m15:25:27.787514 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e"
[0m15:25:27.791520 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e"
[0m15:25:27.792518 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from `workspace`.`default`.`sales_by_category`
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m15:25:28.157113 [debug] [Thread-1 (]: SQL status: OK in 0.360 seconds
[0m15:25:28.161116 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-34ce-1bb0-8f49-ee7dfdb41332) - Closing
[0m15:25:28.163117 [info ] [Thread-1 (]: 25 of 33 PASS not_null_sales_by_category_total_orders .......................... [[32mPASS[0m in 0.40s]
[0m15:25:28.166116 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m15:25:28.167073 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m15:25:28.169076 [info ] [Thread-1 (]: 26 of 33 START test not_null_sales_by_category_total_revenue ................... [RUN]
[0m15:25:28.171402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e, now test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd)
[0m15:25:28.173403 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd, idle-time=0.00929403305053711s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_sales_by_category_total_orders.024c423e1e
[0m15:25:28.174401 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m15:25:28.183405 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd"
[0m15:25:28.186405 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m15:25:28.193399 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd"
[0m15:25:28.195543 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd"
[0m15:25:28.196547 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_revenue
from `workspace`.`default`.`sales_by_category`
where total_revenue is null



  
  
      
    ) dbt_internal_test
[0m15:25:28.525065 [debug] [Thread-1 (]: SQL status: OK in 0.330 seconds
[0m15:25:28.529068 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-350c-1971-9e02-a2f8baf1fcb3) - Closing
[0m15:25:28.531068 [info ] [Thread-1 (]: 26 of 33 PASS not_null_sales_by_category_total_revenue ......................... [[32mPASS[0m in 0.36s]
[0m15:25:28.534074 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m15:25:28.536146 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m15:25:28.536146 [info ] [Thread-1 (]: 27 of 33 START test non_negative_top_5_products_total_sales .................... [RUN]
[0m15:25:28.536146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd, now test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34)
[0m15:25:28.536146 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34, idle-time=0.00507807731628418s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_sales_by_category_total_revenue.fb1162affd
[0m15:25:28.536146 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m15:25:28.551775 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34"
[0m15:25:28.557264 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m15:25:28.563261 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34"
[0m15:25:28.565265 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34"
[0m15:25:28.566265 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`top_5_products`
where TRY_CAST(REPLACE(total_sales, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m15:25:28.905525 [debug] [Thread-1 (]: SQL status: OK in 0.340 seconds
[0m15:25:28.909528 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-3545-1960-882a-83d8d2991d7e) - Closing
[0m15:25:28.912529 [info ] [Thread-1 (]: 27 of 33 PASS non_negative_top_5_products_total_sales .......................... [[32mPASS[0m in 0.38s]
[0m15:25:28.914106 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m15:25:28.916063 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m15:25:28.917065 [info ] [Thread-1 (]: 28 of 33 START test not_null_top_5_products_product_id ......................... [RUN]
[0m15:25:28.919787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34, now test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe)
[0m15:25:28.921835 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe, idle-time=0.009317159652709961s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_top_5_products_total_sales.b51b2dea34
[0m15:25:28.922808 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m15:25:28.930828 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe"
[0m15:25:28.933792 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m15:25:28.941073 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe"
[0m15:25:28.943076 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe"
[0m15:25:28.946072 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `workspace`.`default`.`top_5_products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:25:29.313427 [debug] [Thread-1 (]: SQL status: OK in 0.370 seconds
[0m15:25:29.317427 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-357f-1365-9791-3868bb3e5bdd) - Closing
[0m15:25:29.319890 [info ] [Thread-1 (]: 28 of 33 PASS not_null_top_5_products_product_id ............................... [[32mPASS[0m in 0.40s]
[0m15:25:29.323037 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m15:25:29.324045 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m15:25:29.325045 [info ] [Thread-1 (]: 29 of 33 START test not_null_top_5_products_total_sales ........................ [RUN]
[0m15:25:29.327418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe, now test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818)
[0m15:25:29.328417 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818, idle-time=0.008526325225830078s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_top_5_products_product_id.c6ac160bfe
[0m15:25:29.329418 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m15:25:29.341685 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818"
[0m15:25:29.343642 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m15:25:29.349675 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818"
[0m15:25:29.353436 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818"
[0m15:25:29.355433 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_sales
from `workspace`.`default`.`top_5_products`
where total_sales is null



  
  
      
    ) dbt_internal_test
[0m15:25:29.711767 [debug] [Thread-1 (]: SQL status: OK in 0.350 seconds
[0m15:25:29.716761 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-35bd-1344-9981-c8b4741c2f57) - Closing
[0m15:25:29.719768 [info ] [Thread-1 (]: 29 of 33 PASS not_null_top_5_products_total_sales .............................. [[32mPASS[0m in 0.39s]
[0m15:25:29.722764 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m15:25:29.723761 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m15:25:29.724773 [info ] [Thread-1 (]: 30 of 33 START test non_negative_top_customers_total_spent ..................... [RUN]
[0m15:25:29.726763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818, now test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667)
[0m15:25:29.727761 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667, idle-time=0.007992744445800781s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_top_5_products_total_sales.e20b869818
[0m15:25:29.728764 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m15:25:29.742510 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667"
[0m15:25:29.745507 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m15:25:29.752946 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667"
[0m15:25:29.755591 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667"
[0m15:25:29.756597 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
select *
from `workspace`.`default`.`top_customers`
where TRY_CAST(REPLACE(total_spent, ',', '.') AS DOUBLE) < 0

  
  
      
    ) dbt_internal_test
[0m15:25:30.086397 [debug] [Thread-1 (]: SQL status: OK in 0.330 seconds
[0m15:25:30.086397 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-35fb-15ef-ad85-a456f5a7503c) - Closing
[0m15:25:30.086397 [info ] [Thread-1 (]: 30 of 33 PASS non_negative_top_customers_total_spent ........................... [[32mPASS[0m in 0.36s]
[0m15:25:30.086397 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m15:25:30.104486 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m15:25:30.105522 [info ] [Thread-1 (]: 31 of 33 START test not_null_top_customers_User_ID ............................. [RUN]
[0m15:25:30.107978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667, now test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0)
[0m15:25:30.108976 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0, idle-time=0.022578716278076172s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.non_negative_top_customers_total_spent.38e4f29667
[0m15:25:30.109976 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m15:25:30.119758 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0"
[0m15:25:30.121794 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m15:25:30.127793 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0"
[0m15:25:30.129750 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0"
[0m15:25:30.130753 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select User_ID
from `workspace`.`default`.`top_customers`
where User_ID is null



  
  
      
    ) dbt_internal_test
[0m15:25:30.457964 [debug] [Thread-1 (]: SQL status: OK in 0.330 seconds
[0m15:25:30.461964 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-3633-1ed4-8487-5481300fa5f4) - Closing
[0m15:25:30.463966 [info ] [Thread-1 (]: 31 of 33 PASS not_null_top_customers_User_ID ................................... [[32mPASS[0m in 0.36s]
[0m15:25:30.467364 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m15:25:30.468884 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m15:25:30.470880 [info ] [Thread-1 (]: 32 of 33 START test not_null_top_customers_total_orders ........................ [RUN]
[0m15:25:30.472773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0, now test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746)
[0m15:25:30.473773 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746, idle-time=0.010808467864990234s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_top_customers_User_ID.7df96963c0
[0m15:25:30.475784 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m15:25:30.485780 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746"
[0m15:25:30.489727 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m15:25:30.494764 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746"
[0m15:25:30.496768 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746"
[0m15:25:30.498706 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from `workspace`.`default`.`top_customers`
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m15:25:30.851897 [debug] [Thread-1 (]: SQL status: OK in 0.350 seconds
[0m15:25:30.851897 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-366c-11a3-8ba3-3d2a0c742068) - Closing
[0m15:25:30.851897 [info ] [Thread-1 (]: 32 of 33 PASS not_null_top_customers_total_orders .............................. [[32mPASS[0m in 0.38s]
[0m15:25:30.851897 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m15:25:30.851897 [debug] [Thread-1 (]: Began running node test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73
[0m15:25:30.867525 [info ] [Thread-1 (]: 33 of 33 START test not_null_top_customers_total_spent ......................... [RUN]
[0m15:25:30.867525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746, now test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73)
[0m15:25:30.867525 [debug] [Thread-1 (]: Databricks adapter: DatabricksDBTConnection(session-id=01f08373-2d72-1152-96a1-06df33fa0386, name=test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73, idle-time=0.01562786102294922s, language=sql, compute-name=) - Reusing connection previously named test.dbt_databricks_cicd.not_null_top_customers_total_orders.32b439c746
[0m15:25:30.867525 [debug] [Thread-1 (]: Began compiling node test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73
[0m15:25:30.883149 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73"
[0m15:25:30.883149 [debug] [Thread-1 (]: Began executing node test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73
[0m15:25:30.883149 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73"
[0m15:25:30.883149 [debug] [Thread-1 (]: Using databricks connection "test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73"
[0m15:25:30.883149 [debug] [Thread-1 (]: On test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73: /* {"app": "dbt", "dbt_version": "1.10.3", "dbt_databricks_version": "1.10.4", "databricks_sql_connector_version": "4.0.5", "profile_name": "dbt_databricks_cicd", "target_name": "databricks", "node_id": "test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_spent
from `workspace`.`default`.`top_customers`
where total_spent is null



  
  
      
    ) dbt_internal_test
[0m15:25:31.213792 [debug] [Thread-1 (]: SQL status: OK in 0.320 seconds
[0m15:25:31.217788 [debug] [Thread-1 (]: Databricks adapter: Cursor(session-id=01f08373-2d72-1152-96a1-06df33fa0386, command-id=01f08373-36a8-190e-b144-85c5acd2def4) - Closing
[0m15:25:31.219794 [info ] [Thread-1 (]: 33 of 33 PASS not_null_top_customers_total_spent ............................... [[32mPASS[0m in 0.35s]
[0m15:25:31.221774 [debug] [Thread-1 (]: Finished running node test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73
[0m15:25:31.224853 [debug] [MainThread]: Databricks adapter: DatabricksDBTConnection(session-id=None, name=master, idle-time=16.420140504837036s, language=None, compute-name=) - Reusing connection previously named master
[0m15:25:31.226857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:31.227855 [debug] [MainThread]: Connection 'list_workspace' was properly closed.
[0m15:25:31.228854 [debug] [MainThread]: On list_workspace: Close
[0m15:25:31.229859 [debug] [MainThread]: Databricks adapter: Connection(session-id=01f08373-2c0a-1bdb-a281-7a27c45302c2) - Closing
[0m15:25:31.430200 [debug] [MainThread]: Connection 'list_workspace_default' was properly closed.
[0m15:25:31.445679 [debug] [MainThread]: On list_workspace_default: Close
[0m15:25:31.445679 [debug] [MainThread]: Databricks adapter: Connection(session-id=01f08373-2ca9-18a1-9c0e-45202489877b) - Closing
[0m15:25:31.648953 [debug] [MainThread]: Connection 'test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73' was properly closed.
[0m15:25:31.648953 [debug] [MainThread]: On test.dbt_databricks_cicd.not_null_top_customers_total_spent.426b0eae73: Close
[0m15:25:31.648953 [debug] [MainThread]: Databricks adapter: Connection(session-id=01f08373-2d72-1152-96a1-06df33fa0386) - Closing
[0m15:25:31.852882 [info ] [MainThread]: 
[0m15:25:31.852882 [info ] [MainThread]: Finished running 24 data tests, 9 view models in 0 hours 0 minutes and 19.33 seconds (19.33s).
[0m15:25:31.868524 [debug] [MainThread]: Command end result
[0m15:25:31.961279 [debug] [MainThread]: Wrote artifact WritableManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\manifest.json
[0m15:25:31.961279 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\semantic_manifest.json
[0m15:25:31.976902 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\Documentos\Python-SQL\Projetos\Projeto DBT Databricks CICD\target\run_results.json
[0m15:25:31.976902 [info ] [MainThread]: 
[0m15:25:31.976902 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:25:31.976902 [info ] [MainThread]: 
[0m15:25:31.976902 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=33
[0m15:25:31.992526 [debug] [MainThread]: Command `dbt build` succeeded at 15:25:31.976902 after 25.71 seconds
[0m15:25:31.992526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD87503E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD9AD41B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AD8DCC47D0>]}
[0m15:25:31.992526 [debug] [MainThread]: Flushing usage events
[0m15:25:32.726533 [debug] [MainThread]: An error was encountered while trying to flush usage events
